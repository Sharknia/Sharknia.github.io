<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[RSS Feed of SharkniA]]></title><description><![CDATA[만 4살 백엔드 개발자]]></description><link>https://sharknia.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Mon, 04 Mar 2024 10:14:09 GMT</lastBuildDate><item><title><![CDATA[Postgresql의 JSON과 JSONB]]></title><description><![CDATA[서론 JSON은 이제는 아주 익숙한 데이터 저장 형식입니다. Postgresql에서는 JSON 타입을 지원해 이 데이터를 효과적으로 다룰 수 있도록 하는데, JSONB…]]></description><link>https://sharknia.github.io/Postgresql의-JSON과-JSONB/</link><guid isPermaLink="false">https://sharknia.github.io/Postgresql의-JSON과-JSONB/</guid><pubDate>Mon, 04 Mar 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;JSON은 이제는 아주 익숙한 데이터 저장 형식입니다. Postgresql에서는 JSON 타입을 지원해 이 데이터를 효과적으로 다룰 수 있도록 하는데, JSONB 타입을 또 지원합니다. &lt;/p&gt;
&lt;p&gt;이 두 타입은 저장 방식과 처리 속도, 기능성 측면에서 차이가 있습니다. 각각의 타입은 특정 사용 사례에 더 적합할 수 있으므로, 차이점을 이해하는 것이 중요합니다.&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;JSON&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt; 데이터 타입은 입력된 JSON 데이터를 텍스트 기반의 형식으로 저장합니다.&lt;/li&gt;
&lt;li&gt;데이터는 그대로의 형태로 저장되므로, 입력 시점과 동일한 형태로 데이터를 검색할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt; 타입은 JSON 데이터를 분석하거나 조작할 때 마다 원본 텍스트를 해석해야 하므로, &lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;에 비해 연산이 느릴 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt; 형식은 원본 데이터의 형식을 보존하는 것이 중요할 때 유용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;strong&gt;JSONB&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt; 데이터 타입은 JSON 데이터를 바이너리 형식으로 저장합니다. 이는 데이터를 저장하기 전에 처리(분석 및 재구성)하여 저장 공간을 최적화하고, 검색 및 조작 속도를 향상시킵니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 내부적으로 인덱싱이 가능하므로, 큰 데이터 세트에서 검색과 조작이 훨씬 빠릅니다.&lt;/li&gt;
&lt;li&gt;바이너리 형식으로 인해, 데이터를 저장할 때 순서가 변경되거나 중복 키가 제거될 수 있습니다. 따라서, 원본 데이터의 정확한 형식과 순서를 보존하지 않습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 연산자와 함수를 지원하여, 데이터에 대한 복잡한 쿼리를 수행할 수 있게 해줍니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;주요 차이점 요약 및 결론&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;저장 방식:&lt;/strong&gt;  &lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt;은 텍스트 기반으로, &lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 바이너리 형식으로 데이터를 저장합니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;처리 속도:&lt;/strong&gt;  &lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 데이터 처리와 쿼리 수행이 더 빠릅니다, 특히 인덱스를 사용할 때.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;공간 효율:&lt;/strong&gt;  &lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 데이터를 최적화하여 저장하기 때문에, 같은 데이터를 &lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt;보다 적은 공간을 사용해 저장할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;기능성:&lt;/strong&gt;  &lt;code class=&quot;language-text&quot;&gt;JSONB&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt;보다 더 많은 연산자와 함수를 지원합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;사용 사례에 따라, 원본 JSON 데이터의 형식과 순서를 정확히 유지할 필요가 있다면 JSON을, 데이터에 대한 빠른 검색과 조작을 필요로 한다면 JSONB를 선택하는 것이 좋습니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Geocoder와 Reverse Geocoder]]></title><description><![CDATA[Geocoder와 Reverse Geocoder란? 간단하게 이야기해 주소로 위도와 경도를 얻거나(Geocoder) 위도와 경도로 주소를 얻는(Reverse Geocoder…]]></description><link>https://sharknia.github.io/Geocoder와-Reverse-Geocoder/</link><guid isPermaLink="false">https://sharknia.github.io/Geocoder와-Reverse-Geocoder/</guid><pubDate>Tue, 27 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/363465acb9640730da588ad37d9dc1a6/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9AAeizwqYvgqUsxCTrBGToxCWniSgnyqmnj21pVDDrVnHrFK5kjidciyWcyKRdhSMfQqNiAWTkwKgpAGztwACi78Eh7IMhqkOi6YkmqhOrKZXvK6O3dqr+fZo2+9KqLtvwL+T3LdmtH1SpmkuknIYhnULgX4EiY4BmqIAAX+3CH+oEYWhKpysZrGqn7qcidnKxvTyfNXsoOjobquQHVhes9/Qs9+odrZtYL2cP6eQFoN1DYCAA4uUAAN0rA14nRKQpXWVkLeSfXK7m8HoyKnGrzGMlsHbwciDZzmBipi2k97usZPEgoXJtH64sSaKcRF9eAB8hgADbKENeJocj59Dl5BunIWSzqXU68PGyqFCd2HX7cbExsdhwsvN2rPo7rG604ZqpXdOjnI2km4Xe24Ic3kAAmibGH6aIpKfPbGva76torqNx8GK6MeCd39MN4mEPa+8faiZ5taf29eXys1/l8J5YK53NJBuIntpC2xvAAhjmA9+pSONp0uDe26IcJqWc6yoWMm8V97DdzJoYA5aaKrKrczNlsCsVYSdbn+SbGqRbjOHchZ2bgllaAADYZcIcp0ZlLI4m6Njjn6Him+XpmGztUnswoOTmHkuTkmilmx9s5Zvl3xtinVgk35Kkn0pgXQWcmkDZ20AAHuoBn+fEZOkG7TDN8HIVranZapsfqFFqKVpn41SZ1kvblExinVQfaN+ZrqFRK+BIpd3FoZuCntrAIOBAACcuwKcrAihphGnpBWtoy7DtUHHrkurilmKXWF5SGV2P2GNUWavZ2DGfjq2fyKidBeXcQyUdgWXhQGjmgAAu8kCurkGuK0KuKMQuJkVt4wdtX0hsHEoo2MxiE8xik0xrGQ1tGUmsGkbsHYUsH8PsIcJtZQDuqIBwrEYjEdy/fwshwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/363465acb9640730da588ad37d9dc1a6/ca1dc/image1.png&apos; srcset=&apos;/static/363465acb9640730da588ad37d9dc1a6/e7570/image1.png 170w,
/static/363465acb9640730da588ad37d9dc1a6/f46e7/image1.png 340w,
/static/363465acb9640730da588ad37d9dc1a6/ca1dc/image1.png 680w,
/static/363465acb9640730da588ad37d9dc1a6/02d09/image1.png 1020w,
/static/363465acb9640730da588ad37d9dc1a6/9d567/image1.png 1360w,
/static/363465acb9640730da588ad37d9dc1a6/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Geocoder와 Reverse Geocoder란?&lt;/h2&gt;
&lt;p&gt;간단하게 이야기해 주소로 위도와 경도를 얻거나(Geocoder) 위도와 경도로 주소를 얻는(Reverse Geocoder) 것을 의미합니다. &lt;/p&gt;
&lt;h3&gt;왜 필요할까?&lt;/h3&gt;
&lt;p&gt;주소로는 서로간의 거리를 계산하기 힘들기 떄문에 변환이 필요하고, 위도와 경도는 사람이 읽기 힘들기 때문에 다시 주소로 변환이 필요합니다. 이 때 사용하는 기술입니다. &lt;/p&gt;
&lt;h2&gt;geopy&lt;/h2&gt;
&lt;p&gt;파이썬에서 geopy를 사용하면 간단하게 Reverse Geocoder와 Geocoder를 구현해볼 수 있습니다. &lt;/p&gt;
&lt;p&gt;테스트에 앞서 우선 geopy를 설치해줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; geopy&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Geocoder 예제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;from geopy.geocoders &lt;span class=&quot;token function&quot;&gt;import&lt;/span&gt; Nominatim

&lt;span class=&quot;token comment&quot;&gt;# Nominatim 서비스 초기화 (user_agent 설정 필요)&lt;/span&gt;
geolocator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Nominatim&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user_agent&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;geoapiExercises&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 변환하고자 하는 주소&lt;/span&gt;
address &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;서울특별시 중구 세종대로 110&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 주소를 위도와 경도로 변환&lt;/span&gt;
location &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; geolocator.geocode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;address&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; location:
    print&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;((&lt;/span&gt;location.latitude&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; location.longitude&lt;span class=&quot;token punctuation&quot;&gt;))&lt;/span&gt;&lt;/span&gt;
else:
    print&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;좌표를 찾을 수 없습니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위의 코드를 실행하면 해당 주소에 해당하는 좌표(위도와 경도) 값을 얻을 수 있습니다. &lt;/p&gt;
&lt;h3&gt;Reverse Geocoder 예제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; geopy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geocoders &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Nominatim

geolocator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Nominatim&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user_agent&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;geoapiExercises&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 예시 좌표, language 인자를 reverse 메소드 호출 시 사용&lt;/span&gt;
location &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; geolocator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reverse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;37.541578, 126.840436&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exactly_one&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; language&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;ko&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;address&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;주소를 찾을 수 없습니다. &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;변환된 주소를 얻을 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;강서로, 화곡1동, 강서구, 서울특별시, 07726, 대한민국&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;reerse method에 language를 함께 넣어주면 한글 주소를 얻을 수 있습니다. &lt;/p&gt;
&lt;h3&gt;이외에는?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;geopy&lt;/code&gt;는 지오코딩과 역 지오코딩 외에도 다양한 기능을 제공합니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;거리 계산: &lt;code class=&quot;language-text&quot;&gt;geopy.distance&lt;/code&gt;를 사용하면 두 지점(위도와 경도 좌표) 사이의 거리를 계산할 수 있습니다. 여러 가지 거리 계산 방법(예: Vincenty, Great Circle)을 제공합니다.&lt;/li&gt;
&lt;li&gt;다양한 지오코더 지원: &lt;code class=&quot;language-text&quot;&gt;Nominatim&lt;/code&gt; 외에도 &lt;code class=&quot;language-text&quot;&gt;GoogleV3&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Bing&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;OpenCage&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;ArcGIS&lt;/code&gt; 등 다양한 지오코딩 서비스를 지원합니다. 각 서비스마다 특징과 사용 방법이 다를 수 있습니다.&lt;/li&gt;
&lt;li&gt;유연한 API 사용: &lt;code class=&quot;language-text&quot;&gt;geopy&lt;/code&gt;는 사용자가 다양한 외부 지오코딩 서비스에 쉽게 접근할 수 있도록 돕습니다. 이를 통해 개발자는 특정 서비스의 API 제한이나 사용 제한에 구애받지 않고 서비스를 선택할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Nominatim?&lt;/h3&gt;
&lt;p&gt;위의 예시에서는 &lt;code class=&quot;language-text&quot;&gt;Nominatim&lt;/code&gt; 을 사용했습니다. &lt;code class=&quot;language-text&quot;&gt;Nominatim&lt;/code&gt;은 OpenStreetMap 데이터를 기반으로 하는 지리적 위치 조회 서비스로, 공개된 무료 API 이지만 공정한 사용 정책이 걸려있어 실제 서비스에서 사용하기에는 무리가 있습니다. &lt;/p&gt;
&lt;h2&gt;그 밖에 다른 서비스는?&lt;/h2&gt;
&lt;p&gt;그렇다면 상용화를 위해서는 어떤 서비스를 이용해야 할까요? 간략하게 찾아서 정리해봤습니다. 국내에서는 크게 네이버/카카오/구글을 사용할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;Naver Map API&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;월 300만건 무료, REST API 지원, 300만개 초과시 건당 0.5원&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ncloud.com/product/applicationService/maps&quot;&gt;https://www.ncloud.com/product/applicationService/maps&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://guide.ncloud-docs.com/docs/maps-reversegeocoding-api&quot;&gt;https://guide.ncloud-docs.com/docs/maps-reversegeocoding-api&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Kakao Map API&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;월 300만건, 하루 30만건, 초과 시 협의 필요&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developers.kakao.com/docs/latest/ko/getting-started/quota&quot;&gt;https://developers.kakao.com/docs/latest/ko/getting-started/quota&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://apis.map.kakao.com/web/documentation/#services_Geocoder&quot;&gt;https://apis.map.kakao.com/web/documentation/#services_Geocoder&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Google Maps Platform&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;10만회 이하 : 1000회당 5달러&lt;/li&gt;
&lt;li&gt;10만회 ~ 50만회 : 1000회당 4달러&lt;/li&gt;
&lt;li&gt;50만회 이상 : 협의&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mapsplatform.google.com/pricing/?hl=ko&quot;&gt;월간 200달러의 무료 크레딧을 제공합니다.&lt;/a&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://mapsplatform.google.com/pricing/?hl=ko&quot;&gt;https://mapsplatform.google.com/pricing/?hl=ko&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.google.com/maps/documentation/geocoding/usage-and-billing?hl=ko&quot;&gt;https://developers.google.com/maps/documentation/geocoding/usage-and-billing?hl=ko&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Apple Silicon과 pyenv]]></title><description><![CDATA[서론 새로운 프로젝트의 백엔드 언어가 파이썬으로 확정되었습니다. 파이썬 버전은 추후 머신러닝 사용을 감안하여 현재 라이브러리와 가장 호환성이 좋을 것으로 생각되는 3.9버전을 사용하려고 합니다. 다만, 파이썬 3.…]]></description><link>https://sharknia.github.io/Apple-Silicon과-pyenv/</link><guid isPermaLink="false">https://sharknia.github.io/Apple-Silicon과-pyenv/</guid><pubDate>Mon, 26 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/898b7d30f1f8bb709163a72f9441dd68/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9AAELAwELAwEKAwAIARkhGx4oJAwaGhcrMCdJVVyCkHWYpFR6hyVFUBcoLhUhIQ0YFAMMBQEKAwELBAELBAACDAUACgMUHBUvNjErMCo6R0gsPD8tREpBX2lhgo1+nqhff4pDX2gnPUMmOUEkLzEhKSUTGxcHDggFDQYABA4HEBcQQEE6U11fMUZIZnyCTmRqP1xlbYyVoL3DqsfMgqCoZ4eQRGRsS2t4VG11SVJVTk1QISIfDhELAAkRCw0TDk1TUoeTmDFKUD1VXWB9hH2ao3+WmoOSlMDJyc3d3pWxt0ZeZUddakFWXWFscFtdYiUkIRMTDQADDAUSFxIoLys+UFNLV1dTXWdreXh5i5JfcnozSloiNUFgb3OEkJRVY2kyR1VBUFU2QkM+P0EfHxwODwgAFBoVNDw4bHVxmZ+ZQ1RWSFZZdYKDXG10hZabjay6hqe3Yn2KWWdsk5WQXF5ZaGNacXNskZGMWFRNLyohAC83M0tVUGZtbqOrrUJWXj9aZlhzfnaMkm+AhC1NXG2Ci6yxsWdxcZKSi52WjGJnaVdob5SUk2BcX0M6MAAkLSs9RT8lLCklNkAtPkc7TFZUY2qLkpFidn9zjpmToaSXpKZkdX1xfodbaXE2QEReYFl4c2tPSkg4MScAEhgVMDg2TllXRlRVNUBATVpcdYuWRFllQk9SeYCAl6GiwMK7kpaTSE9WKDM3NDYvYFxUfHFnSEE7JSAbAAkQCxwhHjU4N0tXVz1OUDNERjdNVDFNWj9ebUtRT4uOiMHAuLCzsU9SUHJ3b2lzcU1MRUpANCMhGQkPBwABCwUCDAQTFxAnLCcgLzAnOj4yQkNJWVhKWFZ9g3u4urLAwbinqJ+Zn5hveHVETEkpLSgqJx0UFg8BCwMq0NcMppcIqwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/898b7d30f1f8bb709163a72f9441dd68/ca1dc/image1.png&apos; srcset=&apos;/static/898b7d30f1f8bb709163a72f9441dd68/e7570/image1.png 170w,
/static/898b7d30f1f8bb709163a72f9441dd68/f46e7/image1.png 340w,
/static/898b7d30f1f8bb709163a72f9441dd68/ca1dc/image1.png 680w,
/static/898b7d30f1f8bb709163a72f9441dd68/02d09/image1.png 1020w,
/static/898b7d30f1f8bb709163a72f9441dd68/9d567/image1.png 1360w,
/static/898b7d30f1f8bb709163a72f9441dd68/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;새로운 프로젝트의 백엔드 언어가 파이썬으로 확정되었습니다. 파이썬 버전은 추후 머신러닝 사용을 감안하여 현재 라이브러리와 가장 호환성이 좋을 것으로 생각되는 3.9버전을 사용하려고 합니다. 다만, 파이썬 3.9는 그다지 최신 버전은 아닙니다. 최근에 타입스크립트를 만지면서 nvm을 좋게 사용한 경험도 있고, 이번에 내친김에 파이썬에서도 버전관리를 해주는 툴인 pyenv를 사용해서 환경을 꾸며보기로 했습니다. &lt;/p&gt;
&lt;h2&gt;설치&lt;/h2&gt;
&lt;p&gt;설치는 아주 간단합니다. homebrew는 미리 설치되어 있어야 합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;brew &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; pyenv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;pyenv를 설치해주고,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--list&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.9&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 명령어를 사용하면 현재 설치 가능한 파이썬 3.9버전의 리스트를 확인할 수 있습니다. 현재 3.9의 최신 버전은 3.9.18로 보입니다. 해당 버전을 설치해줍니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.9&lt;/span&gt;.18&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;간단하게 파이썬이 설치.. 되지 않았습니다! 오류가 납니다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c314b473ea139d35439aa72b775a3a18/c8df6/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 50.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABgklEQVR42o1S2XKDMAz0hySZJFwGcyTB5AIC5Pr/P9pq1dKZdvrQhx3JkrxaWTbv9xvTNOF+v2MYBozjiDzPsdlssN1u1a5Wq3/DPITo8Xgouq7D9XpFWRYIwxBxHCEIAiyXyz+w+PZ/EHZdj9PpjLr28L7B5XJB7gpUZYUoirFeU2mgCIJQFG8V9Nns9wSmrnNUVSqqrNqqstjvLZqmwOHgpEkuZyfIJJZjt/usLYocWZYp6WKxUDKqNd4fRNVJx0ySCGmawLkU1sZqsyz5ilt52wwus1oTRZE8SSy5RC3PhGmaBq/XC33fi7qdKNnL+LWoq/UJvPcSr6RhKbHDt8/F0RJpmioxFRte5kLattWFcDEk58Zvt5uCTSu5yFoSEjMhfeecTGQ1ZoqiUDIu43g8Ks7nM05iScKuLOYl1tLOiujPeZ5pDRWQjH/x+Xzq+LQEG1ExcwRV87+O46DxeYr5u7HecDwWtV2rBUwwNhfxAs/88JOANTM5cyTh2FTN9/4Ao1Y2f092pugAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/c314b473ea139d35439aa72b775a3a18/ca1dc/image2.png&apos; srcset=&apos;/static/c314b473ea139d35439aa72b775a3a18/e7570/image2.png 170w,
/static/c314b473ea139d35439aa72b775a3a18/f46e7/image2.png 340w,
/static/c314b473ea139d35439aa72b775a3a18/ca1dc/image2.png 680w,
/static/c314b473ea139d35439aa72b775a3a18/02d09/image2.png 1020w,
/static/c314b473ea139d35439aa72b775a3a18/9d567/image2.png 1360w,
/static/c314b473ea139d35439aa72b775a3a18/c8df6/image2.png 1778w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;해결&lt;/h2&gt;
&lt;p&gt;챗지피티한테 물어보거나 검색을 해보는 등 여러가지 방법을 써보면 많은 방법이 나옵니다. zshrc에 여러 명령어를 export 해주거나 특정 라이브러리를 설치해주거나.. 또는 파이썬 버전을 바꾸던가 &lt;/p&gt;
&lt;p&gt;여러가지 방법을 시도했지만 잘 되지 않았습니다. 여전히 같은 오류가 발생합니다. &lt;/p&gt;
&lt;p&gt;문제는 홈브루에 있었습니다. &lt;/p&gt;
&lt;h3&gt;Homebrew 버전 확인 및 최신 버전 설치&lt;/h3&gt;
&lt;h4&gt;Homebrew 버전 확인&lt;/h4&gt;
&lt;p&gt;아래 코드로 내 homebrew를 확인할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;which&lt;/span&gt; brew&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드를 실행했을 때에,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;/usr/local/bin/brew&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;가 출력된다면 구버전의 Homebrew가 설치되어 있는 것입니다. &lt;/p&gt;
&lt;h4&gt;Homebrew 구버전 삭제&lt;/h4&gt;
&lt;p&gt;다음의 명령어로 Homebrew를 삭제할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;/bin/bash &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-fsSL&lt;/span&gt; https://raw.githubusercontent.com/Homebrew/install/HEAD/uninstall.sh&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 코드를 실행한 뒤에도 &lt;code class=&quot;language-text&quot;&gt;which brew&lt;/code&gt; 를 실행해보면 여전히 위치가 나옵니다. 이 경우에는 삭제 코드를 다시 실행해주면 됩니다. 정상적으로 삭제 된다면 &lt;code class=&quot;language-text&quot;&gt;command not found&lt;/code&gt; 가 발생합니다. &lt;/p&gt;
&lt;h4&gt;Homebrew 최신 버전 설치&lt;/h4&gt;
&lt;p&gt;아래의 명령어로 최신 버전을 설치할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;/bin/bash &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-fsSL&lt;/span&gt; https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;설치가 완료되면 다음과 같은 문구가 나타납니다. 버전에 따라 다를 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Installation successful&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Homebrew has enabled anonymous aggregate formulae and cask analytics.
Read the analytics documentation &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;and how to opt-out&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; here:
  https://docs.brew.sh/Analytics
No analytics data has been sent yet &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nor will any be during this &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; run&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;.

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Homebrew is run entirely by unpaid volunteers. Please consider donating:
  https://github.com/Homebrew/brew&lt;span class=&quot;token comment&quot;&gt;#donations&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Next steps:
- Run these two commands &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; your terminal to &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; Homebrew to your &lt;span class=&quot;token environment constant&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;echo&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;eval &quot;$(/opt/homebrew/bin/brew shellenv)&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; /Users/UserName/.zprofile
    &lt;span class=&quot;token builtin class-name&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;/opt/homebrew/bin/brew shellenv&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
- Run brew &lt;span class=&quot;token builtin class-name&quot;&gt;help&lt;/span&gt; to get started
- Further documentation:
    https://docs.brew.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next steps를 보니, 다음의 명령어를 실행하라고 합니다. 위는 제 예시로, 터미널의 명령어를 복사하면 됩니다. 줄의 명령어를 실행하고 &lt;code class=&quot;language-text&quot;&gt;which brew&lt;/code&gt; 를 다시 실행해보면&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;/opt/homebrew/bin/brew&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 표시되면 최신 버전의 brew가 설치된 것입니다. &lt;/p&gt;
&lt;h3&gt;다시 pyenv, python 설치&lt;/h3&gt;
&lt;p&gt;다시 위로 돌아가서, pyenv과 python을 설치해주면 이번에는 오류가 발생하지 않습니다. 해~결~&lt;/p&gt;
&lt;h2&gt;pyenv 설치 후&lt;/h2&gt;
&lt;p&gt;설치된 파이썬 버전 리스트를 확인할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv versions&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;현재 사용중인 파이썬 버전을 확인할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv version&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;사용중인 파이썬을 설치한 버전으로 바꿔줍니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv global &lt;span class=&quot;token number&quot;&gt;3.9&lt;/span&gt;.18&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;현재 디렉토리에서만 사용할 파이썬 버전을 지정할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv &lt;span class=&quot;token builtin class-name&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.9&lt;/span&gt;.18&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;쉘에만 적용할수도 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pyenv shell &lt;span class=&quot;token number&quot;&gt;3.9&lt;/span&gt;.9&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;참고&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.lainyzine.com/ko/article/how-to-install-homebrew-for-m1-apple-silicon/&quot;&gt;https://www.lainyzine.com/ko/article/how-to-install-homebrew-for-m1-apple-silicon/&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI 프로젝트의 시작]]></title><description><![CDATA[서론 FastAPI-Python을 새로운 프로젝트의 백엔드 언어로 선정하였습니다. 프로젝트 초기화 과정을 기록합니다.  poetry…]]></description><link>https://sharknia.github.io/FastAPI-프로젝트의-시작/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI-프로젝트의-시작/</guid><pubDate>Mon, 26 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/adb18d1525c33547b1aa1478dbaf1263/bb4c7/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 35.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVR42n1Rv0vDQBT+YqstuikILv4HDkJxqmDpoptLpeAgWQSh7m432CQX0oTE3F0JCCkZOuQPkA4d/b/iyxVtq4cPju/d+/V9dw9Ym/ULTbbKVZVl6DNYEByAsab2a2SsbaxjbEdjTvmS7ZmTwu9DegsIN9asyhki9a6QukcIw0Oo4BjS76EgUuUNkPFTut9C8DtIp7ceWJaNFVs8RxbmmMWfeI86mKU2lH9JDS9Q/AmS2yikTYPOyJ8QDlG8jSj3gCK5/6twSmqUt4R0IyTPLfLPEY1PaOAI4rWr1Sh+o0/qd+gl1xBOX3/LlF+gMv3lR9JCOWhsxfK8jYTiNUn2uIuM7W8Isf5byuaWzUXf261xe9M/9gW6imCL+S0CTQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/adb18d1525c33547b1aa1478dbaf1263/ca1dc/image1.png&apos; srcset=&apos;/static/adb18d1525c33547b1aa1478dbaf1263/e7570/image1.png 170w,
/static/adb18d1525c33547b1aa1478dbaf1263/f46e7/image1.png 340w,
/static/adb18d1525c33547b1aa1478dbaf1263/ca1dc/image1.png 680w,
/static/adb18d1525c33547b1aa1478dbaf1263/02d09/image1.png 1020w,
/static/adb18d1525c33547b1aa1478dbaf1263/bb4c7/image1.png 1023w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;FastAPI-Python을 새로운 프로젝트의 백엔드 언어로 선정하였습니다. 프로젝트 초기화 과정을 기록합니다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/Poetry&quot;&gt;poetry&lt;/a&gt; 환경 구성은 이미 끝났다고 가정하고, 해당 라이브러리를 활용하여 환경을 꾸미겠습니다. &lt;/p&gt;
&lt;h2&gt;필수라고 생각되는 라이브러리 설치&lt;/h2&gt;
&lt;h3&gt;FastAPI&lt;/h3&gt;
&lt;p&gt;FastAPI를 웹 프레임워크로 선정하였으니, 이를 먼저 설치해줍니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; fastapi&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Uvicorn&lt;/h3&gt;
&lt;p&gt;ASGI 서버로 FastAPI 애플리케이션을 호스팅하는 데 사용됩니다. FastAPI 공식 문서에서도 Uvicorn을 사용하는 것을 권장하고 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; uvicorn&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;SQLAlchemy 2.0&lt;/h3&gt;
&lt;p&gt;이미 직전 회사에서 많은 일을 함께 겪었던 &lt;del&gt;(^^)&lt;/del&gt; 든든한 동지네요. 이번에도 2.0을 설치는 하지만, 비동기 엔진은 절대 사용하지 않을 예정입니다. 아무튼 설치해줍니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; sqlalchemy@^2.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Alembic&lt;/h3&gt;
&lt;p&gt;SQLAlchemy를 위한 데이터베이스 마이그레이션 도구입니다. 데이터베이스 스키마 변경을 버전 관리할 수 있게 해줍니다. 지난 회사에서는 이 부분을 적용하지 못했었는데, 이번에는 잘 해보려고 합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; alembic&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;HTTPX&lt;/h3&gt;
&lt;p&gt;비동기 HTTP 클라이언트 라이브러리입니다. FastAPI 애플리케이션 내부에서 비동기적으로 외부 API 호출을 수행할 때 사용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; httpx&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Passlib &amp;#x26; python-jose&lt;/h3&gt;
&lt;p&gt;보안 및 인증을 위한 라이브러리입니다. Passlib는 비밀번호 해싱을, python-jose는 JWT(JSON Web Tokens) 생성 및 검증을 위해 사용됩니다. 기본적으로 JWT 토큰을 사용하게 될 것 같으므로 설치해줍니다. Zsh가 괄호 &lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt;를 특별한 패턴으로 해석하기 때문에 위와는 설치 명령어가 조금 다릅니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;passlib[bcrypt]&apos;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;python-jose[cryptography]&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;테스트 코드를 위한 라이브러리 설치&lt;/h2&gt;
&lt;p&gt;이번에도 프로젝트 작업시간이 굉장히 빡빡한데, 가능하면 TDD를 지켜보고 싶습니다. 가능할지 모르겠지만, 일단 라이브러리 설치는 해두려고 합니다. 해당 라이브러리들은 실서버 환경에서는 필요하지 않으므로 &lt;code class=&quot;language-text&quot;&gt;--dev&lt;/code&gt; 옵션을 붙여주겠습니다. &lt;/p&gt;
&lt;h3&gt;pytest&lt;/h3&gt;
&lt;p&gt;Python에서 가장 널리 사용되는 테스트 프레임워크 중 하나로, 강력한 기능과 플러그인 시스템을 제공합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--dev&lt;/span&gt; pytest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;pytest-asyncio&lt;/h3&gt;
&lt;p&gt;비동기 코드를 위한 pytest 플러그인으로, asyncio를 사용하는 비동기 함수를 테스트할 수 있게 해줍니다. FastAPI는 비동기 프레임워크이므로, 이 플러그인은 비동기 요청 및 비동기 데이터베이스 작업을 테스트하는 데 유용합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--dev&lt;/span&gt; pytest-asyncio&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;pytest-cov&lt;/h3&gt;
&lt;p&gt;코드 커버리지를 측정하기 위한 pytest 플러그인입니다. 테스트가 얼마나 많은 코드를 실행하는지를 분석하고, 테스트가 누락된 영역을 식별하는 데 도움을 줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--dev&lt;/span&gt; pytest-cov&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[arc browser]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/arc-browser/</link><guid isPermaLink="false">https://sharknia.github.io/arc-browser/</guid><pubDate>Thu, 22 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;작업을 하다보면 항상 뭔가 찾게 됩니다. 좀 더 편한 것, 좀 덜 귀찮은 것, 좀 더 새로운 것 등등.. &lt;/p&gt;
&lt;p&gt;항상 새로운 것에서 자극을 많이 받는 것 같습니다. 매일 하던 것만 하면 재미 없잖아요. &lt;/p&gt;
&lt;p&gt;접한지는 조금 되었지만 사용하지 않고 있었는데, 이제 새롭게 사용해보려고 하는 건 arc 브라우저 입니다. &lt;/p&gt;
&lt;hr style=&quot;border: none; height: 1px; background-color: #e0e0e0; margin: 16px 0;&quot; /&gt;
저는 지금까지는 개인적인 용도로는 사파리를 주로 사용하고 있었습니다. 아이폰-아이패드-맥을 모두 사용하고 있기 때문이기도 하고 딱~히 불편함을 못느끼고 통합성이 너무 좋아서 불편 없이 사용하고 있었습니다. 
&lt;p&gt;업무용으로는 크롬을 사용하고, 개인용 윈도우 데스크탑에서는 엣지를 사용하고 있었는데 왜 그렇냐? 하면 사실 딱히 이유는 없습니다.. 다만 업무용 환경과 개인용 환경이 합쳐지는 걸 좋아하지 않아 구분해서 사용하고 있었다, 정도겠네요. &lt;/p&gt;
&lt;h2&gt;그런데 왜 arc 브라우저를 갑자기?&lt;/h2&gt;
&lt;p&gt;앞에서 언급한대로 새로운게 좋기 때문입니다. 이번에 또 이직을 하게 되면서 환경이 확 바뀌게 되었는데, 뭔가 같이 변화를 가져가면 좋잖아요. &lt;/p&gt;
&lt;p&gt;주변 개발자들이 많이 사용하고 있었기도 합니다. 추천도 받았구요. 자세한 장점은 좀 더 써보면 정리할 수 있지 않을까 합니다. &lt;/p&gt;
&lt;h3&gt;첫인상?&lt;/h3&gt;
&lt;p&gt;일단 디자인이 유려합니다. 주변에서 추천해주신 분들 중에서는 arc 브라우저를 사용하다가 크롬이나 엣지를 보면 촌스러워 보인다고 말씀해주신 분도 있습니다. &lt;del&gt;(사실 엣지는 요즘.. 코파일럿이 지저분하게 붙었다는 느낌이어서 번잡하다는 느낌이 들긴 합니다.)&lt;/del&gt; &lt;/p&gt;
&lt;h2&gt;어떤 기능들을 사용하나요?&lt;/h2&gt;
&lt;h3&gt;Little Arc&lt;/h3&gt;
&lt;p&gt;외부 어플리케이션에서 링크를 클릭하여 브라우저를 여는 경우가 있습니다. 독특하게도 이 때 아크 브라우저에서는 해당 링크가 Little Arc 창에서 열립니다. &lt;/p&gt;
&lt;p&gt;다른 열려있는 탭들에 영향을 주지 않고 모달처럼 더 작은 브라우저 창에서 새로운 링크가 열리게 됩니다. 따라서 산만하지 않게 원래의 작업을 유지할 수 있습니다. 물론 메인 탭에 리틀 아크에서 열린 탭을 포함시킬 수도 있습니다. &lt;/p&gt;
&lt;p&gt;외부 링크가 아니고 직접 실행할 수도 있는데, 브라우저 상에서 뿐만 아니라 시스템 전역 어디에서든 &lt;code class=&quot;language-text&quot;&gt;Cmd&lt;/code&gt; + &lt;code class=&quot;language-text&quot;&gt;Option&lt;/code&gt; + &lt;code class=&quot;language-text&quot;&gt;N&lt;/code&gt; **** 단축키를 통해 리틀 아크를 실행할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;Space&lt;/h3&gt;
&lt;p&gt;Arc 브라우저에서는 Space라는 분리된 공간을 제공합니다. 이는 사파리의 신규 기능인 프로필 기능과 비슷하지만, 더 유려한 UI와 편의성을 제공합니다. &lt;/p&gt;
&lt;p&gt;사용자는 Space를 통해 작업 탭과 개인 또는 프로젝트 별로 관련된 탭을 그룹화 하여 분리할 수 있습니다. 각 Space는 자체적인 탭, 테마, 아이콘 등을 가지며 그러면서도 즐겨찾기는 모든 Space에서 공유되어 편리하게 이용할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;이외에도..&lt;/h3&gt;
&lt;p&gt;이외에도 많은 독특한 기능을 제공합니다. 개인적으로는 Split 기능도 열심히 사용을 해보려고 합니다. &lt;/p&gt;
&lt;p&gt;개인적으로는 한글이 지원이 아직 안된다는 점, 윈도우에서 지원이 아직 제공되지 않는다는 점이 아쉽습니다. &lt;/p&gt;
&lt;p&gt;자세한 내용은 더욱 써보고 정리해보려고 합니다. 해당 페이지에서는 개인 확인 용도로 기록을 늘려가려고 합니다. &lt;/p&gt;
&lt;h2&gt;같이 보기&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.hongkiat.com/blog/arc-browser-keyboard-shortcuts/&quot;&gt;https://www.hongkiat.com/blog/arc-browser-keyboard-shortcuts/&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[식별 관계와 비식별 관계, 그리고 CASCADE 옵션의 이해]]></title><description><![CDATA[서론 새로 개발할 서비스의 DB 설계 작업이 시작되었습니다. DB…]]></description><link>https://sharknia.github.io/식별-관계와-비식별-관계-그리고-CASCADE-옵션의-이해/</link><guid isPermaLink="false">https://sharknia.github.io/식별-관계와-비식별-관계-그리고-CASCADE-옵션의-이해/</guid><pubDate>Sun, 18 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/bc310b8110b7cbc64aace68596c6da79/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJUlEQVR42n2P62vTYBSH85eJf4Ef/ey8CyrIpBOFsQmOqgwcCILVDzKmbnWTzrHWzW00SLPVtUvn0rVNr0ma3nJ/m+RNmryv6TL96OHhcDj8Hg6H8DAO8PF5IYTwf8s/I7SIEcYh/l+zWBPexVOfN8kvW5nVberrj/3YSjKZzo5NhP7lAwgH4wB3DII+0qGXKZSibxbXvpNNXqzUWsub5AaZe/tpQwN24LsIued5TECMA4K1ibCg2NlSG1jwZ55piv1kgT/sOsVmm+U6Yk+udoHujsPhvWAgrND0se6gMq9kS4ICrJbYW03tXbwxE/lIpU8afE8qN9tNyRJ1D/jjfAhh+djyMHCRbHrFlnRQ5AcaMCx75dv2pWuTU6/j5HFN1ozTOs+psK15KkQ2woFl+5gwR3joBq/6fcP9Xe9RDNcUpRzDLq6lLly+feVpLJDpcn3v4FgErqB5kuWbHrZGYwjDQQZEqul1VZtmOxTT6sja++X13X06laF3DhkyzyR2KLrU4DXIKe5g6AEHhxC6jTTLk4HblkC+0k6k8ye1lgmdo9Mq3xmUG0KhVFOM4a9io9ob1vtmH4wM6J+BCM0cqaYjGVCUQIHl41vU1cjcxOTs/en5O09e3JuefzC7EHkeW9qkcmy3LCgScHTL120v6IQyhDKAkmH3NYvrKoUKt7S+e+tRdOLhs+tT0ZuPX96dWXj1IUEesTQrcF1VNqBqusE91XT+AKS9QWOnbG7oAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/bc310b8110b7cbc64aace68596c6da79/ca1dc/image1.png&apos; srcset=&apos;/static/bc310b8110b7cbc64aace68596c6da79/e7570/image1.png 170w,
/static/bc310b8110b7cbc64aace68596c6da79/f46e7/image1.png 340w,
/static/bc310b8110b7cbc64aace68596c6da79/ca1dc/image1.png 680w,
/static/bc310b8110b7cbc64aace68596c6da79/02d09/image1.png 1020w,
/static/bc310b8110b7cbc64aace68596c6da79/9d567/image1.png 1360w,
/static/bc310b8110b7cbc64aace68596c6da79/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;새로 개발할 서비스의 DB 설계 작업이 시작되었습니다. DB를 설계하는 것은 많이 해본 일이어서 저도 모르게 무결성이나 관계성 등 중요한 내용을 챙기고 있지만, 이런것들은 말로 설명하라고 하면 어려울 때도 많습니다. &lt;/p&gt;
&lt;p&gt;그래서 이번 기회에 해당 개념들에 대해서 기회가 날때마다 정리하는 습관을 들이려고 합니다. &lt;/p&gt;
&lt;h3&gt;DB가 문서도 없고, 관계성도 정의되어 있지 않다면?&lt;/h3&gt;
&lt;p&gt;전에 있던 회사에서는 정규화는 고사하고 아예  테이블들의 관계를 설정하지 않았었고, 관계성의 정의에 대한 문서화도 되어있지않아 어느 테이블의 어느 컬럼이 다른 어느 테이블과의 관계를 가지는지를 확인하기 위해서는 “감”을 사용하거나 코드를 읽고 파악해야 해 그야말로 전쟁터를 방불케했습니다. 무언가 하나를 수정할 경우 데이터 무결성이 깨지고 오류가 발생하는 것을 막는 일은 전쟁터에서 많아도, 신경을 곤두세워도 피하기 쉽지 않았습니다. &lt;/p&gt;
&lt;p&gt;어떻게 생각하면 이렇게 문서도 없고 관계성도 정의되지 않은데다가 하나의 프로젝트를 여러 개발자가 손 댔을 경우 얼마나 유지보수가 어려워지는지, 개발 생산성이 얼마나 떨어지는지 깨닫게 되는 좋은 경험을 했구나, 하는 생각도 합니다. 그런 아비규환을 겪기 전에는 무결성이나 관계성 정의가 중요하다고 공부를 해도 와닿지 않았었거든요. &lt;del&gt;(역시 사람은 맞아봐야 깨닫습니다)&lt;/del&gt;  &lt;/p&gt;
&lt;p&gt;특히 이번 프로젝트에서는 개인적으로 많은 목적을 담고 있기 때문에 저도 함께 등한시 했던 작업들에 더 주의를 기울이려고 합니다. 오늘은 체계적인 문서화를 위해 DB 설계를 &lt;a href=&quot;https://www.erdcloud.com/&quot;&gt;ERD-Cloud&lt;/a&gt;로 진행했고, 그 과정에서 새롭게 정리된 개념들에 대해 정리하고 넘어가겠습니다. &lt;/p&gt;
&lt;h2&gt;관계 유형&lt;/h2&gt;
&lt;p&gt;먼저 관계 유형에 대해 간단하게 정리하고 넘어가겠습니다. 관계 유형은 테이블 간의 데이터가 어떻게 연결되는지를 정의합니다. 기본적으로 세 가지 관계 유형이 있습니다. &lt;/p&gt;
&lt;h3&gt;1:1 관계&lt;/h3&gt;
&lt;p&gt;이 관계는 한 테이블의 레코드가 다른 테이블의 단 하나의 레코드와만 관련될 때 발생합니다. 예를 들어 사용자 테이블과 사용자 상세 정보 테이블 간의 관계를 생각하면 쉽습니다. 상세 정보는 한 유저 당 하나만 존재합니다. &lt;/p&gt;
&lt;p&gt;종종 데이터를 논리적으로 분리하거나, 특정 정보에 대한 보안 요구 사항이 다를 때 사용됩니다. &lt;/p&gt;
&lt;h3&gt;1:N 관계&lt;/h3&gt;
&lt;p&gt;가장 흔한 관계유형입니다. 외래키를 사용하여 부모 테이블과 자식 테이블 간의 연결을 구현합니다. 한 테이블의 레코드가 다른 테이블의 여러 레코드와 관련될 수 있습니다. 예를 들면 사용자 테이블과 주문 리스트 테이블을 생각하면 쉽습니다. 한 사용자가 주문을 여러번 할 수 있기 때문에, 유저 테이블에는 레코드가 하나지만 주문 테이블에는 여러 레코드가 존재할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;N:N 관계&lt;/h3&gt;
&lt;p&gt;두 테이블 간에 서로 다수의 레코드가 관련될 수 있습니다. 이 관계는 직접적으로 데이터베이스에 표현될 수 없으며, 일반적으로 두 테이블간의 다대다 관계를 1:N으로 분해하는 연결 테이블을 사용하여 구현됩니다. 예를 들어, 학생 테이블과 수업 간의 관계에서 한 학생이 여러 수업을 듣고 하나의 수업에 여러 학생이 등록될 수 있습니다. &lt;/p&gt;
&lt;h2&gt;식별 관계와 비식별 관계&lt;/h2&gt;
&lt;p&gt;식별 관계와 비식별 관계는 데이터베이스 설계에서 테이블 간의 연결 방식을 정의하는 두 가지 방법입니다. &lt;/p&gt;
&lt;h3&gt;식별 관계(Identifying Relationship)&lt;/h3&gt;
&lt;p&gt;이 관계에서는 자식 테이블의 기본키에 부모 테이블의 기본키가 포함됩니다. 이는 자식 테이블의 레코드가 부모 테이블의 레코드 없이는 존재할 수 없음을 의미합니다. &lt;/p&gt;
&lt;p&gt;이 관계는 강한 의존성이 있는 테이블 간에 사용됩니다. 예를 들어 자식 테이블이 부모 테이블의 생명주기에 밀접하게 결합되어 있을 때 적합합니다. &lt;/p&gt;
&lt;h3&gt;비식별 관계 (Non-Identifying Relationship)&lt;/h3&gt;
&lt;p&gt;비식별 관계에서는 자식 테이블이 부모 테이블을 참조하는 외래키를 가지지만 이 외래키가 자식 테이블의 기본 키에는 속하지 않습니다. 자식 테이블의 레코드는 부모 테이블의 레코드와 독립적으로 존재할 수 있습니다. 예를 들어, 직원 테이블에서 부서 테이블을 참조하는 경우 직원은 부서에 속하지 않더라도 독립적으로 존재할 수 있습니다. &lt;/p&gt;
&lt;p&gt;즉 테이블간 서로 관련은 있지만, 서로의 존재에 필수적이지 않을 때 적합합니다. &lt;/p&gt;
&lt;h3&gt;무조건 식별관계로 묶어두는게 정답일까?&lt;/h3&gt;
&lt;p&gt;식별 관계는 테이블간의 강한 연결과 무결성을 보장하는 데 유용합니다. 반면 비식별 관계는 데이터 모델의 확장성과 유연성을 높이는 데 도움이 됩니다. &lt;/p&gt;
&lt;p&gt;그냥 단순하게 생각하면 반드시 가능할때마다 식별관계로 묶어두는게 좋지 않을까? 라고 쉽게 생각이 들기도 합니다. 하지만 식별 관계를 과도하게 사용하면 여러가지 문제가 발생할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;1. 유연성 감소&lt;/h4&gt;
&lt;p&gt;식별 관계는 자식 테이블이 부모 테이블의 존재에 종속되는 것이나 똑같습니다. 이렇게 만들어진 강한 결합도는 요구 사항이 변경될 때 테이블간의 관계를 수정하기 어렵게 만듭니다. &lt;/p&gt;
&lt;p&gt;만약 부모 테이블의 기본 키 구조가 변경되면 이를 참조하는 모든 자식 테이블의 구조가 함께 변경되어야 합니다. 이는 유지보수에 문제를 초래할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;2. 확장성 문제&lt;/h4&gt;
&lt;p&gt;식별 관계는 데이터 모델을 특정 구조에 굳건히 묶어 놓음으로써 시스템의 확장성을 제한할 수 있습니다. 특히 대규모 시스템에서는 요구 사항이 시간에 따라 변할 수 있으므로 유연하게 대응할 수 있는 비식별 관계가 더 유리할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;3. 데이터 모델의 복잡성 증가&lt;/h4&gt;
&lt;p&gt;과도하게 증가한 복잡성은 데이터 모델을 이해하고 관리하는 데 더 많은 노력이 필요함을 의미합니다. &lt;/p&gt;
&lt;h3&gt;그렇다면 싹 다 비식별 관계로 묶으면 되지 않을까?&lt;/h3&gt;
&lt;p&gt;식별 관계를 사용했을 때 발생하는 문제점들은 유연함과 단순함이 너무 없어 어지럽기도 합니다. 그렇다면 비식별 관계만으로 정의를 하면 이 모든 문제들이 해결될까요? 물론 비식별 관계만을 고집하면 발생할 수 있는 문제점들도 있습니다. &lt;/p&gt;
&lt;h4&gt;1. 데이터 무결성의 약화, 데이터 관리의 어려움&lt;/h4&gt;
&lt;p&gt;비식별 관계는 자식 테이블이 부모 테이블에 느슨하게 연결되어 있으므로 데이터의 무결성을 유지하기 위한 추가적인 제약 조건이나 규칙을 구현해야 할 수 있습니다. 즉, 데이터의 일관성과 정확성을 보장하는 데 있어 추가적인 노력이 필요할 수도 있음을 의미합니다. &lt;/p&gt;
&lt;p&gt;이는 데이터 관리의 어려움으로 이어집니다. 예를 들어 부모 테이블이 삭제될 때 자식 테이블에 대한 처리를 비식별관계에서는 수동으로 관리해야 할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;2. 관계의 명확성 감소&lt;/h4&gt;
&lt;p&gt;테이블간의 관계가 덜 명확해지면, 복잡한 데이터 모델에서 테이블간의 관계를 이해하고 추적하기 어렵게 만들 수 있습니다. &lt;/p&gt;
&lt;h4&gt;3. 과도한 유연성의 함정&lt;/h4&gt;
&lt;p&gt;과도한 유연성은 결국 모델의 명확성을 흐리게 하고 미래의 확장성에 대한 고려 없이 단기적인 해결에 치중하게 만들 수 있습니다. 대충 지어진 모래성이 무너지는 느낌이 이런게 아닐까요? 큰 집일수록 기초가 튼튼해야 함을 전 회사에서 느꼈습니다. &lt;/p&gt;
&lt;h3&gt;결론&lt;/h3&gt;
&lt;p&gt;데이터베이스 설계에 있어서 식별 관계와 비식별 관계를 적절히 혼합하여 사용하는 것이 중요합니다. 각각의 관계 유형이 가진 장단점을 이해하고 프로젝트의 요구 사항과 목표에 따라 최적의 접근 방식을 선택해야 합니다. 따라서, 단일한 접근 방식에만 의존하기보다는 유연하게 접근하여, 각 상황에 가장 적합한 데이터 모델링 전략을 개발하는 것이 필요합니다.&lt;/p&gt;
&lt;h2&gt;CASCADE&lt;/h2&gt;
&lt;p&gt;CASCADE는 데이터베이스 관리 시스템에서 외래 키 제약 조건의 일환으로 사용할 수 있는 옵션입니다. 이 옵션은 부모 테이블의 레코드가 업데이트 되거나 삭제될 때 관련된 자식 테이블의 레코드에 대해 자동으로 같은 작업을 수행하도록 설정합니다. &lt;/p&gt;
&lt;h3&gt;CASCADE의 주요 기능&lt;/h3&gt;
&lt;h4&gt;CASCADE DELETE&lt;/h4&gt;
&lt;p&gt;부모 테이블의 레코드가 삭제될 경우 해당 레코드와 연결된 자식 테이블의 레코드도 자동으로 삭제됩니다. 이는 참조 무결성을 유지합니다. &lt;/p&gt;
&lt;h4&gt;CASCADE UPDATE&lt;/h4&gt;
&lt;p&gt;부모 테이블의 기본 키 값이 변경될 경우 해당 변경이 자식 테이블의 관련 외래키 값에도 자동으로 반영됩니다. &lt;/p&gt;
&lt;h3&gt;비식별 관계에서의 CASCADE 사용&lt;/h3&gt;
&lt;p&gt;CASCADE 설정은 식별/비식별 관련없이 모두 적용할 수 있습니다. 따라서 이 설정을 활용해 위에서 살펴봤던 비식별 관계의 약점을 보완할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;비식별 관계의 약점 보완&lt;/h4&gt;
&lt;p&gt;비식별 관계에서 CASCADE를 사용하면 참조하는 부모 테이블이 변경될 때 자식 테이블의 데이터를 자동으로 갱신하여 데이터를 수동으로 관리하는 번거로움을 줄일 수 있으며, 일관성을 유지할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;반드시 CASCADE + 비식별이 식별보다 유리하지 않을까?&lt;/h4&gt;
&lt;p&gt;이 방법을 사용하면 유연성, 무결성 유지, 고아 레코드 방지 등에 있어서 비식별 관계의 약점을 모두 보완하는 것처럼 보이기도 합니다. 따라서 단순히 생각하면 식별 관계를 사용하는 것보다 우월하다고 생각될 수 있습니다. 하지만 데이터 모델의 명확성과 이해도를 유지하는 것 역시 중요한 고려 사항입니다. 따라서, 식별 관계와 비식별 관계의 선택은 각각의 상황에 따라 그 장단점을 잘 이해하고, 프로젝트의 목표와 요구 사항에 가장 잘 맞는 방식을 선택하는 것이 필요합니다.&lt;/p&gt;
&lt;h3&gt;CASCADE 사용시 고려 사항&lt;/h3&gt;
&lt;p&gt;CASCADE도 만능은 아닙니다. 사용시 다음과 같은 점들을 고려해야 합니다. &lt;/p&gt;
&lt;h4&gt;데이터 수정/삭제에서 오는 부작용&lt;/h4&gt;
&lt;p&gt;CASCADE 옵션은 데이터베이스의 무결성을 유지하는 데 유용하지만 데이터를 삭제하거나 업데이트 할 때 예상치 못한 부작용이 발생할 수 있으므로 주의가 필요합니다. &lt;/p&gt;
&lt;p&gt;항상 데이터모델과 비즈니스 로직을 신중하게 고려해야 합니다. 무분별한 사용은 데이터의 실수를 일으킬 수 있습니다. &lt;/p&gt;
&lt;h4&gt;성능 영향&lt;/h4&gt;
&lt;p&gt;대량의 데이터가 관련되어 있는 경우 CASCADE 동작은 데이터베이스의 성능에 영향을 줄 수 있습니다.&lt;/p&gt;
&lt;h2&gt;개인적인 오늘의 결론&lt;/h2&gt;
&lt;p&gt;첫 번째 회사에 오래 있었고, 두 번째 회사에서 일한지는 얼마 되지 않았지만 첫번째 회사에서 “엉망으로 일할 때 발생하는 문제” 들을 몸으로 겪었다면, 두번쨰 회사에서는 그것들을 해결하는 방법들에 대해 고민하는 시간을 많이 가졌던 것 같습니다. &lt;/p&gt;
&lt;p&gt;오늘 살펴본 것도 몸으로는 아는 내용들이었고 자연스럽게 구현하고 중요하게 여기던 내용들입니다. 이런것들을 몰라도 된다고 무심결에 무시하던 때도 있었는데, 이런 내용들을 정리된 이론으로 머릿속에 다시 집어넣는게 중요하다고 요즘에 크게 느낍니다. &lt;/p&gt;
&lt;p&gt;남한테 설명할 때에도 그렇고 결국 내가 꺠달은 것들을 미리 깨달은 사람들이 잘 정리해 둔 것들을 굳이 피해가는 것도 멍청한 일이라는 생각이 듭니다.&lt;/p&gt;
&lt;p&gt;다만, 아예 백지 상태에서 배우는 것보다는 (너무 많은 시간을 고생했지만) 잘못된 반례들을 겪고 공부하니 훨씬 더 잘 다가오는 감이 있습니다. &lt;/p&gt;
&lt;p&gt;앞으로도 여태까지와는 다른 방향으로 더 성장하는 개발자가 되려고 합니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[인앱결제에서 백엔드는 무엇을 준비해야 할까?]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/인앱결제에서-백엔드는-무엇을-준비해야-할까/</link><guid isPermaLink="false">https://sharknia.github.io/인앱결제에서-백엔드는-무엇을-준비해야-할까/</guid><pubDate>Sat, 17 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d7213b66afc65609cb206552845e8289/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVR42k3Q/U8SYRwA8Pun+gv6B/qx5Wq1tenKpGhBK4tYxlJHbCxIZ4KWvTjNFjKK6QXyIsPxYghdRrZWS6Hj3u+5e+61vhesddvt9nyf+3zfCEaQWQkJiippmqrrumGYpmVZ9u//Htu2DdPCuoF0XcJYQAonIYAEKyIeKRCCC2wY4BQVH3XpnfredDTuD0bfZgrffx4qigpe1Q1Z0yQVAwEIWHHKYg2wBveW3f76LUXmJiNxX/CRZ+LBqQvXIrFnW6XKIc1qluVgKK44xQlOcrCMsQI9WyY0Xa41VtfTV+9MgonEloZGroRmFjZzpV3qQDUM5GDNwfIAD9o2bRspqNakEunMOdf106Oes2Oei15f/PlqJl+qffwCZf+NDZsazCyqKqSEiVWMqw1qe6fqHp9w37o36rl9csT94lVyI7tdbbVlrIGHn6GsMzMsDbqHTCLG2DSxpr9Opu+HIkPDl1037nr9U+fHvOG5hXdkvtJqiyoGycvOtnq8TPR4qe8hBFmh/Ga2EJ5dPDPs8k2FL90MHDt+YjwQWktuVJqfeRlxAynRnEjA2/cQgmZgYeRWMfr4SSD4cCa2FJ1/6vVPzy4uk4Vy6QPFiDIjOLLHSb9YgegyPHyc898UCGv11v5K6v06WYwtJ+ZfvllL5xJkcW4lBZgV5X5NIACJI5rt9Dg4QIjmwKMOw9c/HeRrreIuVaxTuUozW2mU9/Z/dGiHcWKXEYB0etwfoP4qM5QCwskAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/d7213b66afc65609cb206552845e8289/ca1dc/image1.png&apos; srcset=&apos;/static/d7213b66afc65609cb206552845e8289/e7570/image1.png 170w,
/static/d7213b66afc65609cb206552845e8289/f46e7/image1.png 340w,
/static/d7213b66afc65609cb206552845e8289/ca1dc/image1.png 680w,
/static/d7213b66afc65609cb206552845e8289/02d09/image1.png 1020w,
/static/d7213b66afc65609cb206552845e8289/9d567/image1.png 1360w,
/static/d7213b66afc65609cb206552845e8289/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;현재 개발을 준비중인 서비스에는 인앱결제가 포함되어있습니다. 여태까지 운이 좋았던 것인지, 운이 나빴던 것인지 아무튼 인앱결제를 구현한 적이 없어서 구현 전에 역시 미리 서치해두려고 합니다. &lt;/p&gt;
&lt;hr style=&quot;border: none; height: 1px; background-color: #e0e0e0; margin: 16px 0;&quot; /&gt;
이 과정은 크게 각 플랫폼별 인앱 결제 API 연동, 결제 요청 및 검증, 결제 성공 시 내부 재화 충전, 그리고 결제 실패 및 취소 처리로 나눌 수 있습니다.
&lt;p&gt;개발 예정 서비스에서는 내부 재화를 인앱결제로 구매하고 기타 아이템들은 내부 재화로 구매할 수 있게 만들 예정입니다.&lt;/p&gt;
&lt;h2&gt;내부 재화 구매 프로세스&lt;/h2&gt;
&lt;p&gt;구매는 결국 어떻게 이뤄질까? 앱 사용자가 상품 구매를 한다고 하고 어떤 흐름으로 결제가 이뤄져 어떻게 사용자가 내부 재화를 가지게 되는지를 먼저 그려보겠습니다. &lt;/p&gt;
&lt;h3&gt;1. 사용자가 앱에서 내부 재화 구매를 선택&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;사용자가 앱을 열고, 상점 페이지로 이동해 내부 재화를 구매하고자 하는 상품을 선택합니다. &lt;/p&gt;
&lt;p&gt;앱은 사용자가 선택한 상품의 정보를 보여주고 구매 버튼을 노출합니다. &lt;/p&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;백엔드는 상품 정보를 제공합니다. &lt;/p&gt;
&lt;h3&gt;2. 사용자가 구매 버튼을 누름&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;구매 버튼이 눌러지면 앱은 해당 플랫폼의 인앱 결제 프로세스를 시작합니다. (iOS : StoreKit, Android : Google Play Billing Libarary)&lt;/p&gt;
&lt;p&gt;사용자는 구매 확인, 결제 방법 선택(등록된 결제 수단 사용 등) 등의 단계를 수행합니다. &lt;/p&gt;
&lt;h3&gt;3. 결제 프로세스 진행&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;사용자는 결제 과정을 진행하며 이 과정은 앱스토어세서 직접 관리됩니다. &lt;/p&gt;
&lt;p&gt;과정이 종료된 후, 결제 성공/실패/취소 등의 결과가 어플리케이션으로 전달됩니다.&lt;/p&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;결제가 성공한 경우, 어플리케이션에서 결제 성공 정보와 결제 영수증을 백엔드로 전송합니다. &lt;/p&gt;
&lt;p&gt;백엔드는 영수증 정보를 플랫폼의 서버(애플 혹은 구글)에 검증 요청을 합니다. &lt;/p&gt;
&lt;p&gt;검증이 통과하면 백엔드는 사용자의 계정에 해당하는 내부 재화를 충전하고 충전 결과를 앱에 알립니다. &lt;/p&gt;
&lt;h3&gt;4 구매 완료 및 내부 재화 충전&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;백엔드로부터 내부 재화 충전 성공 응답을 받으면 앱은 사용자 인터페이스를 업데이트하여 새로운 재화 잔액을 표시합니다. &lt;/p&gt;
&lt;p&gt;사용자에게 구매 성공 알림을 제공할수도 있습니다. &lt;/p&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;내부 재화 충전과 관련된 모든 정보를 데이터베이스에 기록합니다. &lt;/p&gt;
&lt;p&gt;구매 내역을 로깅하여 추후 문제 해결이나 사용자 문의에 대응하도록 할 수도 있습니다. &lt;/p&gt;
&lt;h2&gt;어플리케이션 안에서의 환불 요청 프로세스&lt;/h2&gt;
&lt;p&gt;환불에도 대응을 해야 할 것이므로, 환불에 관해서도 프로세스를 미리 서치했습니다. &lt;/p&gt;
&lt;h3&gt;1. 사용자가 환불을 요청&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;사용자는 앱 내에서 환불을 요청할 수 있는 UI를 통해 환불을 신청합니다. 앱은 사용자의 환불 요청 정보를 백엔드로 전송합니다. &lt;/p&gt;
&lt;h3&gt;2. 환불 요청 검증&lt;/h3&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;사용자의 구매 내역과 환불 요청을 검증합니다. 구매 영수증, 환불 정책 준수 등을 검증합니다. &lt;/p&gt;
&lt;p&gt;환불 가능 여부를 결정합니다. &lt;/p&gt;
&lt;h3&gt;3.  환불 처리&lt;/h3&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;환불이 가능할 경우, 백엔드는 환불 처리를 진행합니다. 내부 재화를 차감합니다. &lt;/p&gt;
&lt;p&gt;이후 실제 결제가 이루어진 플랫폼(애플, 구글 등)을 통해 환불을 진행해야 합니다. 결제 플랫폼에 환불 요청을 전송합니다. &lt;/p&gt;
&lt;h3&gt;4. 환불 결과 통지&lt;/h3&gt;
&lt;h4&gt;FE&lt;/h4&gt;
&lt;p&gt;백엔드로부터 환불 처리 결과를 전송받습니다. 사용자에게 이를 통지합니다. &lt;/p&gt;
&lt;h2&gt;앱스토어에서 직접 환불 처리 시 프로세스&lt;/h2&gt;
&lt;p&gt;환불에는 앱 내에서 진행하는 경우와 플랫폼을 통해 환불이 진행되는 경우 두 가지가 있습니다. 위에서 알아본 방법은 첫번째 방법이며, 여기서 알아볼 방법은 두 번째 방법입니다. 두 번째 방법의 경우에는 앱 개발자의 개입이 불가능하게 진행이 됩니다.&lt;/p&gt;
&lt;h3&gt;1. 앱스토어에서 환불 처리&lt;/h3&gt;
&lt;p&gt;사용자가 앱스토어의 고객 지원을 통해 환불을 요청합니다. 앱스토어는 이를 진행합니다. &lt;/p&gt;
&lt;h3&gt;2. 환불 통지 수신&lt;/h3&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;앱스토어는 환불 처리 결과를 앱의 백엔드에 통지합니다. 이는 대부분 웹훅 형태로 제공됩니다. &lt;/p&gt;
&lt;p&gt;백엔드는 앱스토어로부터 환불 통지를 받고 해당 정보를 검증합니다. 검증 과정에는 통지의 유효성 확인, 환불된 결제와 연관된 사용자 및 내부 재화 찾기 등이 포함됩니다. &lt;/p&gt;
&lt;h3&gt;3. 내부 재화 상태 업데이트&lt;/h3&gt;
&lt;h4&gt;BE&lt;/h4&gt;
&lt;p&gt;환불 통지가 검증된다면, 사용자의 내부 재화 상태를 업데이트합니다. &lt;/p&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;길게 적게 되었지만 사실 제가 궁금했던 부분을 “실제 결제 과정을 어디에서 담당하냐” 였습니다. 결제 과정은 앱스토어에서 직접 담당하므로 결국 인앱결제에 있어서 백엔드가 해야 할 가장 핵심 프로세스는 영수증 검증인것으로 보입니다.&lt;/p&gt;
&lt;p&gt;물론, 금전을 직접 다루는 중요한 과정이므로 보안 등의 사항에 특별히 유념해서 더 신경써야 하겟습니다. &lt;/p&gt;
&lt;p&gt;오늘은 이론적인 부분만 미리 살펴봤습니다. 언제나 그렇지만 실재 구현에 들어가면 항상 예외적인 상황이 발생합니다. 나중에 구현을 할 경우에 그 부분에 대해서도 자새히 기록을 해보려고 합니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Sqlalchemy의 index]]></title><description><![CDATA[서론 DB 설계를 하다보면 index를 정의해야 하는 경우가 많습니다. 만약 Sqlalchemy의 create_all() 메소드를 사용해 테이블을 생성하고 있다면 Sqlalchemy에서 동시에 index를 정의할 수 있습니다.  Sqlalchemy…]]></description><link>https://sharknia.github.io/Sqlalchemy의-index/</link><guid isPermaLink="false">https://sharknia.github.io/Sqlalchemy의-index/</guid><pubDate>Tue, 13 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c4d481406cdf76b79bd78dfaaff95aa7/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9AAA4VQdNZhpacCljeDNqfThugUB2h0x5hkt7iWOHkJ2trF2EjU56h0l8jDtvgjJpfSVhdxVWbgRJZgA3VgAHUG4ra4JDe49PhplckKCQr7SMsblojZeHmppfiJJJY2pYe4RujZJuhopllqVRiJxLgpY/d40kZn8ETW0AHGF9R36UWo+jaqCycpehUmhtYoWOiK22d5SZjK2zk7K3iq61gKawb46WfKGpqMrRa6CyU4ugQ3uSF157AC5tiFWMoWqhtJa3v5WsrlJzfXCbqIKkrJy2uOvl2cHLx8zZ1Yy4wYi2womhpnR/gHabpnKnuVSKoS5tiAA6dY9flqyDsL9RZGhBZ3KZvsmGq7VvrbuUu8OQt7ucw8SDr7qCtL+BprBqkJtFaHNuhIh1n65knLI6dZAAQnuUbKS6c5aheI2RpLe2nbe7f6WxtMfKpLy9DImZHay/JIeUzdDLlK6zia24lamqsby4ibXEa6K4Q3yWAER9lm+juIOwwH6SlXB7enuYn6bH0IewtoWWlCVeXhppaz9mZaatqaC7wK/N1XqcpjtLUHCSnnKpvkJ7lAA/eZFroLR/qrpUYmQ0VF6gvcGXtr5Wk6RMeIMXW2kNWWUuW2Zyh4yHn6OTqKyPpqpacHV0maZsobY4c40AM26IX5Gleq3AapKgd5KYTGdufpieo7S3kKmqPYeUOYONU42YgpOUnLK1fJujUVtbbI6ae67BXo+jK2mDAB5eeUt+kmOTpn2svYCquVR5iHGEh297em1/gIabnYKLioujpYSanmd0dYGYm3OVn3ysvmOTp0Z5jxhadQAFR2QlYHdCc4dQgJJejZ11oK93nap2mKJdfolnh45kg4hykppli5cxV2ZpjppplqdRgZM8cIQgXnUERGJyl1KVtMDmNQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/c4d481406cdf76b79bd78dfaaff95aa7/ca1dc/image1.png&apos; srcset=&apos;/static/c4d481406cdf76b79bd78dfaaff95aa7/e7570/image1.png 170w,
/static/c4d481406cdf76b79bd78dfaaff95aa7/f46e7/image1.png 340w,
/static/c4d481406cdf76b79bd78dfaaff95aa7/ca1dc/image1.png 680w,
/static/c4d481406cdf76b79bd78dfaaff95aa7/02d09/image1.png 1020w,
/static/c4d481406cdf76b79bd78dfaaff95aa7/9d567/image1.png 1360w,
/static/c4d481406cdf76b79bd78dfaaff95aa7/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;DB 설계를 하다보면 index를 정의해야 하는 경우가 많습니다.&lt;/p&gt;
&lt;p&gt;만약 Sqlalchemy의 &lt;a href=&quot;https://sharknia.github.io/SQLAlchemy-create_all-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%9E%90%EB%8F%99-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0&quot;&gt;create_all()&lt;/a&gt; 메소드를 사용해 테이블을 생성하고 있다면 Sqlalchemy에서 동시에 index를 정의할 수 있습니다. &lt;/p&gt;
&lt;h2&gt;Sqlalchemy에서의 인덱스 정의&lt;/h2&gt;
&lt;h3&gt;단일 컬럼 인덱스&lt;/h3&gt;
&lt;p&gt;Sqlalchemy의 &lt;code class=&quot;language-text&quot;&gt;Column&lt;/code&gt; 객체를 생성할 때에 &lt;code class=&quot;language-text&quot;&gt;index=True&lt;/code&gt;  플래그를 설정하면 간단하게 단일 컬럼에 대한 인덱스를 생성할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;복합 인덱스&lt;/h3&gt;
&lt;p&gt;두 개 이상의 컬럼을 포함하는 복합 인덱스는 &lt;code class=&quot;language-text&quot;&gt;Index&lt;/code&gt; 객체를 사용하여 생성할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Index
Index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;my_index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MyModel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;column1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MyModel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;column2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기서 &lt;code class=&quot;language-text&quot;&gt;desc()&lt;/code&gt; 메소드는 해당 컬럼을 내림차순으로 정렬하도록 지시합니다. 오름차순은 기본값이므로 &lt;code class=&quot;language-text&quot;&gt;asc()&lt;/code&gt;는 일반적으로 생략됩니다.&lt;/p&gt;
&lt;h3&gt;Unique 인덱스&lt;/h3&gt;
&lt;p&gt;Unique 인덱스는 값의 중복을 방지하고 해당 컬럼의 각 값이 유일하다는 것을 보장합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;email&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unique&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;복합 Unique 인덱스&lt;/h3&gt;
&lt;p&gt;SqlAlchemy에서는 복합 인덱스에 대해서도 유니크 제약 조건을 적용할 수 있습니다. 이를 통해 테이블 내에서 특정 컬럼 조합의 유니크성을 강제할 수 있습니다. &lt;/p&gt;
&lt;p&gt;SqlAlchemy에서 복합 유니크 인덱스를 정의하는 방법은 두 가지입니다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;UniqueConstraint&lt;/code&gt; 사용&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;UniqueConstraint&lt;/code&gt;는 테이블의 컬럼에 대한 유니크 제약 조건을 정의하는 데 사용됩니다. 이는 &lt;code class=&quot;language-text&quot;&gt;__table_args__&lt;/code&gt; 속성 내부에서 사용될 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; create_engine
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;declarative &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; declarative_base
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; UniqueConstraint

Base &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; declarative_base&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    __tablename__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;my_model&apos;&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    column1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    column2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    __table_args__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;UniqueConstraint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;column1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;column2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;my_unique_constraint&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Index&lt;/code&gt; 사용 시 &lt;code class=&quot;language-text&quot;&gt;unique=True&lt;/code&gt; 설정&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Index&lt;/code&gt; 객체를 생성할 때 &lt;code class=&quot;language-text&quot;&gt;unique=True&lt;/code&gt; 플래그를 설정하여 복합 유니크 인덱스를 생성할 수 있습니다. 이 방법은 인덱스 생성과 동시에 컬럼 조합의 유니크성도 보장합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MetaData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Table
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Index

metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MetaData&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Table&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;my_table&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;column1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;column2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 복합 유니크 인덱스 생성&lt;/span&gt;
my_unique_index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;my_unique_index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; my_table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;column1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; my_table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;column2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unique&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;두 방법 모두 데이터베이스에서 해당 컬럼 조합의 유니크성을 강제합니다. &lt;code class=&quot;language-text&quot;&gt;UniqueConstraint&lt;/code&gt;는 주로 제약 조건을 명시적으로 표현할 때 사용되며, &lt;code class=&quot;language-text&quot;&gt;Index&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;unique=True&lt;/code&gt; 설정은 검색 최적화와 유니크 제약 조건을 동시에 적용하고자 할 때 유용합니다.&lt;/p&gt;
&lt;h3&gt;&lt;strong&gt;&lt;em&gt;\&lt;/em&gt;table_args__&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;  &lt;code class=&quot;language-text&quot;&gt;__table_args__&lt;/code&gt; 클래스 속성은 튜플이나 사전 형태로 제공될 수 있으며, 테이블 생성 시 추가적인 SQL 제약 조건이나 인덱스를 정의하는데 사용됩니다.  &lt;/p&gt;
&lt;p&gt;예를 들어 복합 인덱스를 &lt;code class=&quot;language-text&quot;&gt;__table_args__&lt;/code&gt; 클래스 속성을 사용해 모델 내부에서 정의한 예제 코드는 다음과 같습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    __tablename__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;events&apos;&lt;/span&gt;

    &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    timestamp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DateTime&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    user_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    is_active &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Boolean&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 복합 인덱스 정의&lt;/span&gt;
    __table_args__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        Index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;ix_events_user_id_timestamp&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; timestamp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 방식으로 정의된 인덱스는 데이터베이스에 해당 모델을 반영할 때 자동으로 생성됩니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[위치 기반 검색 기능의 구현]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/위치-기반-검색-기능의-구현/</link><guid isPermaLink="false">https://sharknia.github.io/위치-기반-검색-기능의-구현/</guid><pubDate>Tue, 13 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1670a671c6f9439f25c6635d75793c7d/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9ABYXOhQqXxQ9ewlXmAqHuwx5vRWJxxKu3RPJ5xXL6Q294xWr2w2PzQOHxQ6Fuw9Tmw83ehY5dREeUhUTMAAdFjcdKFcfN24QWI0PkLMYfbUchb4To9Qav+UVx+sTsNsRoc8PicUXk8AZiqkXXJgdT4YhNGkbHEkbEi0AIhUxJChSKUFuI1J8JnmbHm6mIoW5H5zJKarOKK7PH6/YHpvDGHuzGnerIHGUImSZJz9wKjZkJBxCIRAnACgXMy0uVixJcC9OdDd1jzJuoD6MwzdfjChbiDyBsCFSf0+WvEV+qjZ0ojN6oyxQfi0vYTJiiylBYykHHQAxDCI0LlU3QW1QPWZRTnZGf69vfqdFTHk1eqlVyfEoRHRpc5xrY4xFbZtPQnBKS3cxYZg6N2A2HDwxCx8AQQcaShU1Uh1COGWIX119b0hujlx8oWyCIEmMClKgU1aFm3KMeE11c1V6XF+ISE58TyxTRChOSQwnPgkZAEwGGk0aOksYOwppkESLsnpKc4Bkk9GGlnCGuQBp0cSXpoOPtW5ilFNjjwx2r0hAZVciQloOKlENJUMKHAA2Fzc+IEU1HjwQR28cgrFIj8Vhg7Z5mcKVyN0v2fadt85xkL1airsjZ6gATY8japQsRW9EMWA+KFI3Gj0AJS9lJ0V4I0t5GFqTGXCqH36wLIu6PcroVun1e/v8PN/xM7fYFW2dIX+1HYK8EViXETtkIlmNHlOTITZzABo3fhZWmB9ppSR3sCF+tRRZhgxahR59ozm81U/Q50S0zi1+pBNOexhxmTebuSqGqxZBXRJTjxpTlRw1cAAVJWQTPIMUUZMiWYwfW4UcbZYWZY8cZY0ZSW0qWHYiWn4raosue5ohgKMpWHYgUG8YRG0YVIgQPHwUJlk4xPXKsEQ3NAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/1670a671c6f9439f25c6635d75793c7d/ca1dc/image1.png&apos; srcset=&apos;/static/1670a671c6f9439f25c6635d75793c7d/e7570/image1.png 170w,
/static/1670a671c6f9439f25c6635d75793c7d/f46e7/image1.png 340w,
/static/1670a671c6f9439f25c6635d75793c7d/ca1dc/image1.png 680w,
/static/1670a671c6f9439f25c6635d75793c7d/02d09/image1.png 1020w,
/static/1670a671c6f9439f25c6635d75793c7d/9d567/image1.png 1360w,
/static/1670a671c6f9439f25c6635d75793c7d/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;새로운 서비스의 개발을 준비하고 있습니다. 그 서비스를 위해서 위치 기반 검색이 가능해야 할 것으로 생각하고 있습니다. &lt;/p&gt;
&lt;p&gt;아직 해당 기능에 대해서 구현 해본 적도 없고, 어떻게 구현 해야 할지 감도 잡히지 않아 아직 개발단계에는 이르지 않았지만 이에 대해 미리 서치한 내용을 기록하려고 합니다. &lt;/p&gt;
&lt;p&gt;Postgresql을 사용하게 될 것이므로, Postgreslql에서의 구현 방법도 미리 기록합니다. &lt;/p&gt;
&lt;p&gt;위치 기반 검색 기능은 사용자의 위치 정보(위도와 경도)를 데이터베이스에 저장하고, 이를 기반으로 특정 거리 내에 있는 다른 사용자나 장소를 찾는 것입니다. &lt;/p&gt;
&lt;h2&gt;위치 기반 검색 기능의 구현&lt;/h2&gt;
&lt;h3&gt;위치 정보의 저장&lt;/h3&gt;
&lt;p&gt;사용자의 위치 정보(위도, 경도)를 저장합니다. 위치 정보는 주소 변환(Geocoding)이나 모바일 기기의 GPS를 통해 직접 얻을 수 있습니다.  또 외부 API를 사용해 위도,경도 정보를 다시 주소로 변환할 수도 있습니다. &lt;/p&gt;
&lt;h3&gt;거리 계산&lt;/h3&gt;
&lt;p&gt;데이터베이스에 저장된 위치 정보를 사용하여 사용자 간의 거리를 계산합니다. 이 때 대표적으로 사용되는 알고리즘은 하버사인 공식 입니다. 하버사인 공식은 두 지점 사이의 거리를 계산할 때 지구의 구형을 고려하여 보다 정확한 결과를 제공합니다. &lt;/p&gt;
&lt;h3&gt;거리 기반 검색&lt;/h3&gt;
&lt;p&gt;사용자의 위치에서 특정 거리 내에 있는 사용자나 장소를 찾기 위해 SQL 쿼리 내에서 거리 계산 로직을 사용합니다. 예를 들어 SQL의 HAVING 절을 사용하여 계산된 거리가 특정 버위 내에 있는 레코드만 선택할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;인덱싱과 최적화&lt;/h3&gt;
&lt;p&gt;위치 기반 검색의 효율을 높이기 위해 공간 데이터를 효율적으로 쿼리할 수 있는 공간 인덱스 (Spatial Index)를 사용할 수 있습니다. &lt;/p&gt;
&lt;h2&gt;공간 인덱스(Spatial Index)&lt;/h2&gt;
&lt;h3&gt;공간 인덱스란?&lt;/h3&gt;
&lt;p&gt;공간 인덱스(Spatial Index)는 공간 데이터(위치 정보를 포함한 데이터)를 효율적으로 쿼리하기 위한 데이터베이스 인덱스입니다. 공간 데이터는 위도와 경도로 표현되는 지점(point), 선(line), 면(area) 등 다양한 형태가 있을 수 있습니다. 이러한 데이터를 빠르게 검색하고, 공간적 관계(예: 교차, 인접, 포함 등)를 효율적으로 분석하기 위해 공간 인덱스를 사용합니다.&lt;/p&gt;
&lt;h3&gt;공간 인덱스의 종류&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;R-트리(R-tree): 계층적 구조를 가진 트리 기반 인덱스로, 사각형 영역을 노드로 사용하여 공간 데이터를 구분합니다. 각 노드는 자식 노드를 포함하는 최소한의 경계 사각형을 가집니다. R-트리는 공간 검색과 범위 쿼리에 효율적입니다.&lt;/li&gt;
&lt;li&gt;쿼드트리(Quadtree): 공간을 사각형 영역으로 재귀적으로 분할하는 트리 기반 인덱스입니다. 각 노드는 최대 네 개의 자식(북동, 북서, 남동, 남서)을 가질 수 있으며, 공간을 균등하게 분할합니다.&lt;/li&gt;
&lt;li&gt;GiST(Generalized Search Tree): 다양한 검색 트리를 일반화한 구조로, R-트리, B-트리 등 여러 종류의 인덱스를 하나의 프레임워크 내에서 지원합니다. PostgreSQL에서 사용됩니다.&lt;/li&gt;
&lt;li&gt;SP-GiST(Space-Partitioned Generalized Search Tree): 공간을 분할하는 기법에 기반한 인덱스로, GiST의 확장형입니다. 공간을 비균등하게 분할하여 더 효율적인 검색을 가능하게 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;공간 인덱스의 사용&lt;/h3&gt;
&lt;p&gt;공간 인덱스는 공간 쿼리를 실행할 때 데이터베이스가 전체 데이터를 순차적으로 검색하는 대신, 인덱스를 활용하여 필요한 데이터를 빠르게 찾아낼 수 있도록 합니다. 예를 들어, 특정 지역 내의 모든 관심 지점을 찾거나, 두 지점 사이의 거리를 계산할 때 공간 인덱스를 활용할 수 있습니다.&lt;/p&gt;
&lt;h3&gt;공간 인덱스의 장점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;쿼리 성능 향상: 공간 데이터에 대한 쿼리를 실행할 때 검색 시간을 크게 줄일 수 있습니다.&lt;/li&gt;
&lt;li&gt;공간 관계 분석 용이: 데이터 간의 공간적 관계를 빠르게 분석할 수 있어, 인접한 데이터 찾기, 영역 내 데이터 검색 등이 용이합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;공간 인덱스를 지원하는 데이터베이스 예&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;PostgreSQL의 PostGIS 확장: 공간 데이터를 위한 강력한 지원과 함께 R-트리 기반의 GiST 인덱스를 제공합니다.&lt;/li&gt;
&lt;li&gt;MySQL: R-트리 기반의 공간 인덱스를 지원합니다.&lt;/li&gt;
&lt;li&gt;SQLite의 SpatiaLite 확장: 공간 데이터를 위한 기능과 함께 R-트리 인덱스를 지원합니다.&lt;/li&gt;
&lt;li&gt;MongoDB: 2D 및 2DSphere 인덱스를 통해 공간 데이터를 위한 인덱싱을 제공합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Postgresql에서의 공간 인덱스&lt;/h2&gt;
&lt;p&gt;Postgresql에는 지리적 객체를 저장, 쿼리 및 조작할 수 있는 기능을 추가하는 PostGIS 확장이 존재합니다. &lt;/p&gt;
&lt;h3&gt;PostGIS 확장 설치&lt;/h3&gt;
&lt;p&gt;다음의 명령어를 통해 PostGIS 확장을 설치할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION &lt;span class=&quot;token keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;EXISTS&lt;/span&gt; postgis&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;공간 데이터 저장을 위한 테이블&lt;/h3&gt;
&lt;p&gt;위치 데이터를 저장할 테이블을 생성하고 공간 정보를 저장할 수 있는 &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt; 타입의 컬럼을 포함시킵니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; places &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  id &lt;span class=&quot;token keyword&quot;&gt;SERIAL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  location GEOGRAPHY&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;POINT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4326&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;-- 위도와 경도를 사용하는 점 타입&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;는 PostgreSQL의 PostGIS 확장에서 제공하는 두 가지 공간 데이터 타입입니다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;목적: 지구의 곡률을 고려하여 실제 지리적 위치를 더 정확하게 모델링합니다.&lt;/li&gt;
&lt;li&gt;사용 케이스: 큰 거리를 다루거나, 극지방 같이 지구의 곡률이 중요한 계산에 영향을 미치는 지역에서 주로 사용됩니다.&lt;/li&gt;
&lt;li&gt;계산 방식: 지구를 타원체로 가정하고, 위도와 경도를 사용하여 거리와 면적을 계산합니다. 이로 인해 &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;에 비해 계산이 더 복잡하고 느릴 수 있습니다.&lt;/li&gt;
&lt;li&gt;좌표 체계: 기본적으로 WGS 84 (EPSG:4326) 좌표 체계를 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;목적: 평면 상의 점들을 사용하여 공간 데이터를 모델링합니다. 지구의 곡률을 고려하지 않고, 모든 계산을 유클리드(평면) 기하학을 사용하여 수행합니다.&lt;/li&gt;
&lt;li&gt;사용 케이스: 소규모 지역 또는 곡률이 중요하지 않은 계산에 주로 사용됩니다. 예를 들어, 도시 또는 건물 내부와 같은 상대적으로 작은 지역에서 사용됩니다.&lt;/li&gt;
&lt;li&gt;계산 방식: 유클리드 기하학을 바탕으로 거리, 면적 등을 계산합니다. 이는 &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;에 비해 계산이 더 간단하고 빠릅니다.&lt;/li&gt;
&lt;li&gt;좌표 체계: 다양한 좌표 체계를 지원하며, 사용자가 필요에 따라 선택할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;주요 차이점&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;계산 정확도와 복잡성: &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;는 지구의 곡률을 고려하기 때문에 더 복잡하고, 대규모 거리 계산에 적합합니다. 반면, &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;는 간단한 평면 계산에 적합합니다.&lt;/li&gt;
&lt;li&gt;성능: &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;는 일반적으로 &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;보다 계산이 더 빠르지만, 이는 계산의 복잡성과 정확도에 따라 달라질 수 있습니다.&lt;/li&gt;
&lt;li&gt;적용 범위: &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;는 전 세계적인 지리적 데이터 처리에 적합하고, &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;는 지역적 또는 평면적 공간 데이터 처리에 더 적합합니다.&lt;/li&gt;
&lt;li&gt;대규모, 정확한 지리적 계산이 필요한 경우 &lt;code class=&quot;language-text&quot;&gt;GEOGRAPHY&lt;/code&gt;를, 소규모 또는 빠른 계산이 필요한 경우 &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;를 사용하는 것이 좋습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;결론&lt;/h4&gt;
&lt;p&gt;제가 개발할 서비스의 경우, 대부분의 상호 작용이 도시 수준에서 일어나고, 성능과 응답 시간이 중요한 요소라고 생각되기 때문에 &lt;code class=&quot;language-text&quot;&gt;GEOMETRY&lt;/code&gt;가 더 유리해 보입니다. &lt;/p&gt;
&lt;h3&gt;공간 인덱스 생성&lt;/h3&gt;
&lt;p&gt;공간 인덱스도 생성할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INDEX&lt;/span&gt; idx_places_location &lt;span class=&quot;token keyword&quot;&gt;ON&lt;/span&gt; places &lt;span class=&quot;token keyword&quot;&gt;USING&lt;/span&gt; GIST &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;location&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;위치 기반 검색 쿼리의 작성법&lt;/h3&gt;
&lt;p&gt;사용자의 위치를 기반으로 가까운 장소를 찾아주는 &lt;code class=&quot;language-text&quot;&gt;ST_DWithin&lt;/code&gt; 같은 공간 함수를 사용하는 쿼리를 작성합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- 사용자 위치 (위도 37, 경도 127) 주변 10km 이내의 장소 검색&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; places
&lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; ST_DWithin&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  location&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  ST_MakePoint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;127&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;::geography&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;10000&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;-- 거리(미터 단위)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;공간함수(Spatial functions)란?&lt;/h4&gt;
&lt;p&gt;공간 함수는 PostGIS, PostgreSQL의 확장 기능 중 하나입니다. 공간 데이터를 처리하기 위한 함수로, 지리적 위치의 관계, 형태, 거리 등을 계산하고 분석하는 데 사용됩니다.&lt;/p&gt;
&lt;h4&gt;PostGIS에서 제공하는 주요 공간 함수&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;기하학적 관계 판단 함수:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Contains(A, B)&lt;/code&gt;: A가 B를 포함하는지 여부를 반환합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Intersects(A, B)&lt;/code&gt;: A와 B가 교차하는지 여부를 반환합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Within(A, B)&lt;/code&gt;: A가 B 내부에 있는지 여부를 반환합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Touches(A, B)&lt;/code&gt;: A와 B가 접하는지 여부를 반환합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_DWithin(A, B, distance)&lt;/code&gt;: A와 B가 지정된 거리 &lt;code class=&quot;language-text&quot;&gt;distance&lt;/code&gt; 이내에 있는지 여부를 반환합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;기하학적 변환 및 생성 함수:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Buffer(geometry, radius)&lt;/code&gt;: 주어진 지오메트리 주변에 지정된 반경의 버퍼를 생성합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Centroid(geometry)&lt;/code&gt;: 지오메트리의 중심점(centroid)을 계산합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_MakePoint(x, y)&lt;/code&gt;: x, y 좌표로 점을 생성합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;거리 및 길이 측정 함수:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Distance(A, B)&lt;/code&gt;: A와 B 사이의 최소 거리를 계산합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Length(geometry)&lt;/code&gt;: 선형 지오메트리의 길이를 계산합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;공간 분석 함수:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Area(geometry)&lt;/code&gt;: 면적을 계산합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Union(A, B)&lt;/code&gt;: 두 지오메트리의 합집합을 생성합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_Intersection(A, B)&lt;/code&gt;: 두 지오메트리의 교집합 영역을 계산합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;공간 색인 및 최적화를 위한 함수:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_GeomFromText(&apos;POINT(0 0)&apos;)&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;ST_GeomFromEWKT(...)&lt;/code&gt;: Well-Known Text(EWKT)로부터 지오메트리를 생성합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ST_SetSRID(geometry, srid)&lt;/code&gt;: 지오메트리에 공간 참조 시스템(Spatial Reference System Identifier, SRID)을 설정합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;같이 보기&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://postgis.net/docs/manual-3.0/postgis-ko_KR.html&quot;&gt;PostGIS 3.0.0 사용자 지침서&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[SQLAlchemy create_all() 메소드로 데이터베이스 테이블 자동 생성하기]]></title><description><![CDATA[서론 현재 회사에서는 Alembic 같은 데이터마이그레이션 도구를 사용하고 있지 않습니다. 따라서 스키마 버전 관리등은 별도로 하고 있지 않으며, 다만 SqlAlchemy의 create_all() 메소드를 이용해 프로덕션 환경이나 dev…]]></description><link>https://sharknia.github.io/SQLAlchemy-create_all-메소드로-데이터베이스-테이블-자동-생성하기/</link><guid isPermaLink="false">https://sharknia.github.io/SQLAlchemy-create_all-메소드로-데이터베이스-테이블-자동-생성하기/</guid><pubDate>Mon, 12 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/adeaa97d904dbe547536564c64470baa/445c6/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACkklEQVR42hXL209SARwA4N8h7SVnpaZrbIYmJQoRwklDLl64KAqKFy5yPYgcODcuwhFNUVHRNC4iWdOlW700c5W9ZWtzvbS59dbWeuh/Cbfv9QPgycoQHlrRhEKjRO8i5eOeB5pRrmZE7qPqtCNPrVirbsw8EzZ6qSqJ+oZICY1S4KHAkwLwO6HlCUesvNmhblYZJFhQzCZ2Pn5w7Of7CtsCihRbXI+n/Na1rW4iWmMw1Sh0cB+9WmUgVIJQBe3yhyNW40K6xjDa6g8ocUrq9JtCcf9ywbWyHs4WYvm33QG6J5JQ+xgQqhGR6iqCTFuGoP31g2Ntjune6YQtvm5n13/8+u3+9JO6+Fv6fiGjFx4OO4TjU55s9u6kE+SDgGoB1QEohkBlhD6TiCAnVjfD6bw5uUbk9z+fn4smgorQ4lyhqE1uSKkFXXzeV3pZMWG/pjGD2gRqIyADFtBbqx3upijp2tld3iqa6WexvVelLyfCYUwTz4SzL/SrhWYs2Rlg8HeHnYuLYPXCoA3KEbFPgxW75QtM7he71pZXtvcs7IZzLevJ7KC9xr4Jb78rIPCE271B3WrS8CYnTKUqfTjYfGDDAKZDZZUzhDy3aTjI4bHU8ExMNmDhtkj4OnuLO3m9uqlO3Ot9fSz2zXUQVNfR7u1wGDAcKUcED8MMXcsw44cH+rklgd6qwGal3nivn1V6Yu6lnczxyerZN//ZpSCU5Q5NPUqnGkiag1OA04CQMQhG6mejrZbAPZmmze7sT+VNudPc6dfLP/9KR+8jz4s9FKsKRaU00cHGJQm2Gic5RBTICAA1W4YQ0UqCaYjO8pMJAROpddJcJ95GMHecWJXdWUeTzfPz/Ey6jmU5JHM1qRhQsf/eQNuGNwq8qwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/adeaa97d904dbe547536564c64470baa/ca1dc/image1.png&apos; srcset=&apos;/static/adeaa97d904dbe547536564c64470baa/e7570/image1.png 170w,
/static/adeaa97d904dbe547536564c64470baa/f46e7/image1.png 340w,
/static/adeaa97d904dbe547536564c64470baa/ca1dc/image1.png 680w,
/static/adeaa97d904dbe547536564c64470baa/02d09/image1.png 1020w,
/static/adeaa97d904dbe547536564c64470baa/9d567/image1.png 1360w,
/static/adeaa97d904dbe547536564c64470baa/445c6/image1.png 1792w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;현재 회사에서는 Alembic 같은 데이터마이그레이션 도구를 사용하고 있지 않습니다. 따라서 스키마 버전 관리등은 별도로 하고 있지 않으며, 다만 SqlAlchemy의 create_all() 메소드를 이용해 프로덕션 환경이나 dev 환경에서의 테이블의 누락은 안생기게끔만 간단하게 관리하고 있습니다. &lt;/p&gt;
&lt;p&gt;이 방법은 테이블의 수정 또는 삭제를 반영할 수는 없는 방법이지만, 아직 RDB 기반으로 옮긴지 얼마 되지 않아 상대적으로 DB의 크기가 작아 현재는 이 방법으로 충분한 상황입니다. &lt;/p&gt;
&lt;p&gt;create_all() 메소드를 사용하면서 알게 된 점을 기록해두려고 합니다. &lt;/p&gt;
&lt;h2&gt;create_all() 메소드란?&lt;/h2&gt;
&lt;p&gt;SqlAlchemy의 create_all() 메소드는 &lt;code class=&quot;language-text&quot;&gt;Metadata&lt;/code&gt; 객체에 등록된 모든 테이블 정의를 바탕으로 해당 데이터베이스 엔진에 테이블을 생성하는데 사용됩니다. 이 메소드는 이미 생성되어있는 테이블은 생성하지 않으며, 새로 정의된(DB에 없는) 테이블만 새롭게 데이터베이스에 생성합니다. &lt;/p&gt;
&lt;p&gt;따라서, 스키마가 달라도 뭔가 수정이 되었어도 DB에 존재만 한다면 생성하거나 덮어쓰지 않으므로 만약 수정 사항을 반영하는걸 해당 메소드로 진행하려면 테이블을 drop한 뒤 생성해야 합니다. 물론 데이터가 많지 않거나 데이터를 날려도 상관없는 dev 환경에서만 유효한 방법입니다. &lt;/p&gt;
&lt;h3&gt;기본적인 사용 방법&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; create_engine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MetaData

&lt;span class=&quot;token comment&quot;&gt;# 데이터베이스 엔진 생성&lt;/span&gt;
engine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sqlite:///example.db&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; echo&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# MetaData 인스턴스 생성&lt;/span&gt;
metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MetaData&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 테이블 정의들...&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 예: users_table = Table(&apos;users&apos;, metadata, Column(&apos;id&apos;, Integer, primary_key=True), ...)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# create_all 호출하여 모든 테이블 생성&lt;/span&gt;
metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_all&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;engine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;create_engine&lt;/code&gt; 함수는 데이터베이스와의 연결을 설정합니다. &lt;code class=&quot;language-text&quot;&gt;echo=True&lt;/code&gt;는 SQLAlchemy가 실행하는 SQL 명령을 콘솔에 출력하도록 설정하는 옵션입니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;create_all()&lt;/code&gt; 메소드는 첫 번째 인자로 &lt;code class=&quot;language-text&quot;&gt;Engine&lt;/code&gt; 객체를 받습니다. 이 &lt;code class=&quot;language-text&quot;&gt;Engine&lt;/code&gt; 객체는 SQLAlchemy가 데이터베이스와 통신하기 위해 사용하는 기본 구성 요소입니다.&lt;/p&gt;
&lt;h3&gt;비슷한 메소드들?&lt;/h3&gt;
&lt;h4&gt;drop_all()&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;drop_all()&lt;/code&gt; 메소드는 &lt;code class=&quot;language-text&quot;&gt;create_all()&lt;/code&gt;과 반대로 작동합니다. &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체에 등록된 모든 테이블을 데이터베이스에서 삭제합니다. 테이블에 데이터가 있을 경우, 데이터도 함께 삭제되므로 사용할 때 주의가 필요합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;drop_all&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;engine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Table.create() 및 Table.drop()&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;create_all()&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;drop_all()&lt;/code&gt; 메소드 대신, 개별 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체에 대해 &lt;code class=&quot;language-text&quot;&gt;create()&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;drop()&lt;/code&gt; 메소드를 호출할 수 있습니다. 이 방법을 사용하면 특정 테이블에 대한 작업을 더 세밀하게 제어할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 개별 테이블 생성&lt;/span&gt;
users_table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;engine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 개별 테이블 삭제&lt;/span&gt;
users_table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;drop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;engine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;reflect()&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;reflect()&lt;/code&gt; 메소드는 데이터베이스의 기존 스키마 정보를 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체로 로드합니다. 이 메소드는 기존 데이터베이스 구조를 SQLAlchemy 모델로 반영할 때 유용합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reflect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;engine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;나는 어떻게 사용하고 있나?&lt;/h2&gt;
&lt;p&gt;dev 또는 로컬 환경에서 테스트를 할 경우 적극적으로 사용하고 있습니다. 주로 처음 테이블을 생성할 때에 굳이 create 쿼리문을 별도로 쓰지 않고 모델만 생성 후 해당 메소드를 이용해 테이블을 생성하거나, 테이블에 수정 사항이 생긴 경우 drop 후 create_all() 메소드를 생성해 다시 DB 테이블을 생성합니다. &lt;/p&gt;
&lt;p&gt;물론, 그때 그때 create 함수를 쓰기는 너무나 귀찮은 일이기 때문에, FastAPI의 lifespan을 활용해서 FastAPI 어플리케이션이 시작될 때에 자동으로 create_all() 메소드를 호출하도록 세팅을 해두었습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orm &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; declarative_base

Base &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; declarative_base&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
_db_connection&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Engine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Engine&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@asynccontextmanager&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lifespan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; supabase_on_startup&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    settings &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Settings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[SERVER_ENVIRONMENT] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;settings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SERVER_ENVIRONMENT&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; supabase_on_shutdown&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;on_startup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;global&lt;/span&gt; _db_connection
    DATABASE_URL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;postgresql+asyncpg://postgres.&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;settings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;postgresql_setting&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;projectid&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;settings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;postgresql_setting&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;password&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;@aws-0-ap-northeast-2.pooler.supabase.com:6543/postgres?prepared_statement_cache_size=0&quot;&lt;/span&gt;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# pool_size와 max_overflow의 초기값 설정&lt;/span&gt;
    pool_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 기본값&lt;/span&gt;
    max_overflow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 기본값&lt;/span&gt;
    echo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;

    _db_connection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_async_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        DATABASE_URL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        pool_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pool_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        max_overflow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;max_overflow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        echo&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;echo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 비동기 엔진을 사용하여 테이블 생성&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; _db_connection&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;begin&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; conn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; conn&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_sync&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_all&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런식으로 구현해두었습니다. 이렇게 하면 어플리케이션이 수정될 때마다 존재하지 않는 테이블을 생성하게 됩니다. 다만, 이렇게 구현했을 때에 주의해야 할 점이 있습니다. &lt;/p&gt;
&lt;h3&gt;주의&lt;/h3&gt;
&lt;p&gt;위에서 언급했듯이, create_all() 메소드는 &lt;code class=&quot;language-text&quot;&gt;Metadata&lt;/code&gt;에 등록된 테이블 정보를 가지고 테이블을 생성합니다. 뒤집어 말하면 &lt;code class=&quot;language-text&quot;&gt;Metadata&lt;/code&gt;에 테이블이 등록되지 않는다면 생성되지 않는 다는 말인데, 따라서  &lt;code class=&quot;language-text&quot;&gt;Metadata&lt;/code&gt;에 테이블 정보가 등록되는 시점을 정확히 아는게 중요합니다. &lt;/p&gt;
&lt;h3&gt;Metadata에 테이블 정보가 등록되는 시점&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체에 테이블 정보가 등록되는 시점은 해당 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체가 생성될 때입니다. SqlAlchemy에서는 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체를 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체에 직접 연결하여 테이블을 정의합니다. 클래스 정의 내에서 &lt;code class=&quot;language-text&quot;&gt;Column&lt;/code&gt;과 같은 필드를 사용하여 &lt;code class=&quot;language-text&quot;&gt;Base&lt;/code&gt; 클래스를 상속받는 모델을 정의하면, 이러한 모델 클래스가 생성될 때 내부적으로 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체가 생성되고 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체에 자동으로 등록됩니다. &lt;code class=&quot;language-text&quot;&gt;declarative_base()&lt;/code&gt;를 호출하여 생성된 &lt;code class=&quot;language-text&quot;&gt;Base&lt;/code&gt; 클래스는 내부적으로 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 인스턴스를 포함하고 있으며, 이 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 인스턴스는 모델 클래스를 통해 정의된 모든 테이블의 메타데이터를 관리합니다.&lt;/p&gt;
&lt;p&gt;따라서, 모델 클래스를 정의하는 순간 해당 클래스에 연결된 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체가 생성되고, 이 객체는 자동으로 &lt;code class=&quot;language-text&quot;&gt;Base&lt;/code&gt; 클래스에 내장된 &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt; 객체에 등록됩니다. 이후 &lt;code class=&quot;language-text&quot;&gt;Base.metadata.create_all(engine)&lt;/code&gt;와 같은 방식으로 호출하면, &lt;code class=&quot;language-text&quot;&gt;MetaData&lt;/code&gt;에 등록된 모든 테이블에 대한 생성 명령이 데이터베이스 엔진으로 전송됩니다.&lt;/p&gt;
&lt;h4&gt;FastAPI에서 모델 클래스가 정의되는 순간은?&lt;/h4&gt;
&lt;p&gt;FastAPI 어플리케이션에서 “모델 클래스가 정의되는 순간”은 Python 스크립트가 실행되어 해당 모델 클래스가 메모리에 로드되는 시점을 의미합니다. &lt;/p&gt;
&lt;p&gt;FastAPI 어플리케이션을 실행하면(예를 들어 &lt;code class=&quot;language-text&quot;&gt;uvicorn main:app&lt;/code&gt; 등의 명령어를 사용하여) Python 인터프리터는 main.py를 로드하고 실행합니다. 이 과정에서 main.py에서 직접적으로, 또는 임포트된 모듈 내에서 다시 임포트된 SqlAlchemy의ㅏ 모델 클래스들도 함께 로드되고 메모리에 생성됩니다. 바로 이 시점에 각 모델 클래스에 해당하는 &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 객체가 &lt;code class=&quot;language-text&quot;&gt;Metadata&lt;/code&gt; 객체에 등록됩니다. &lt;/p&gt;
&lt;p&gt;다시 쉽게 이야기하자면, app.py 또는 main.py 같은 파일과 이 파일에 임포트 된 파일들, 다시 임포트 된 파일들 중에 모델 객체가 있어야만 합니다. 외딴섬처럼 덩그러니 model 파일을 생성해두고 아무곳에도 import 하지 않는다면(메인 py 파일과 연결되어 있지 않다면) 테이블은 생성되지 않습니다. 어떻게 생각하면 당연한 일인데, 이 당연한 부분을 놓쳐 길게 헤맸던 기억이 있습니다. 이 기억 때문에 해당 문서를 작성한 셈입니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Readme]]></title><description><![CDATA[nolog…]]></description><link>https://sharknia.github.io/Readme/</link><guid isPermaLink="false">https://sharknia.github.io/Readme/</guid><pubDate>Thu, 08 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;nolog&lt;/h2&gt;
&lt;h3&gt;소개&lt;/h3&gt;
&lt;p&gt;많은 개발자들이 한 번쯤은 &quot;나만의 블로그를 운영해야지&quot;라고 생각해본 적이 있을 겁니다. 하지만 실제로 블로그를 시작하고 유지하는 일은 상당한 도전과제입니다. 공부하고 개발하는 것만으로도 바쁜데, 여기에 글을 쓰고 관리하는 일은 때때로, 아니 항상 부담스러운 일입니다.&lt;/p&gt;
&lt;p&gt;노션으로 공부를 하는 개발자가 있습니다. 일을 하면서일수도 있고, 따로 짬을 내어 공부를 하면서일수도 있습니다. 그러다가 한 번 쯤은 생각하게 됩니다. 노션으로 한 공부나 작업 기록이 블로그에 자동으로 업로드된다면 좋을텐데!&lt;/p&gt;
&lt;p&gt;저 역시 마찬가지입니다. 저는 귀찮은 일이 너무 귀찮습니다. 공부나 블로그나 어차피 한 번에 할 수 있는거 아닌가? 공부만 하면 포스팅이 되면 안되나? 왜 똑같은 일을 두 번 세 번 해야 하는걸까?&lt;/p&gt;
&lt;h4&gt;그래서 만들었습니다.&lt;/h4&gt;
&lt;p&gt;nolog는 노션에 집중해서 작업하거나 공부해서 기록하는 것만으로도 그 내용이 자동으로 마크다운으로 변환되어 GitHub 기반의 블로그에 포스팅될 수 있도록 해주는 프로그램입니다. 취업 준비, 지식 공유, 개인 브랜딩 등 여러 목적으로 블로그를 운영하고자 하는 분들에게 nolog는 시간과 노력을 크게 절약해 줄 것입니다.&lt;/p&gt;
&lt;h3&gt;시작하기&lt;/h3&gt;
&lt;h4&gt;Notion 준비&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;노션 계정을 준비합니다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://www.notion.so/248d5b9bf2a644b4b25485c828d5b04f&quot;&gt;Base Template&lt;/a&gt;을 내 노션으로 복제합니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/24e5695c45a4177fd1ef50b659afa096/23039/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 71.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwElEQVR42p1S2bKaQBDlEwICgrLNsFwqqHDdReOWpVKpVJ7ymP//jZPpLiFg9D7ch0Mv0930OTPaerFAURSYzWaYTqcoJhOUZYkgCOA4DlzX/Q9xHGOi6jzPQ57n3FdVFfuar5J0YFk2LNuGfYNpmj0MBgNVY7GlobQExePxmPt932eruaMRdN3Aj6+f8fPLFfPlEtvtBrvdjrFQDMiu12usViss1Tn5p9NJ+SseOBwOWzbaSA00TQvHwx6f9ntcr1ecz2fUdY29ig+HAzabDS6XC+bzOftUQzgej7xZVxqNPpQIwhBZlip9JMeGYbRUyeq6zj7ldWOAD4bK3ejTUr2BtHKWvWA6qyBkgljGLHyWZUiSBGma8ibUOFbwQgkvLuDJXF2ez7Sbwe2GUgr8+VXj9/clN3VvlQoJVNfQe/YC2oF0Q+XHBC+x/7Q4VLIIIdqnE0VRW0s/pPifhurdRSJRWgo+aLZq0DQRva7tgnJadwNnaMF17J7IDWizR/mHlN0b5Wr7DXlZc3xf2AzrangvDcUtZbrFfPKKQKRvaiilZJ/svYZ03hsoohBRGDzVkDRqtCNG9zr2NHw04D0a/gW1OHxLHQSjowAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/24e5695c45a4177fd1ef50b659afa096/ca1dc/image1.png&apos; srcset=&apos;/static/24e5695c45a4177fd1ef50b659afa096/e7570/image1.png 170w,
/static/24e5695c45a4177fd1ef50b659afa096/f46e7/image1.png 340w,
/static/24e5695c45a4177fd1ef50b659afa096/ca1dc/image1.png 680w,
/static/24e5695c45a4177fd1ef50b659afa096/02d09/image1.png 1020w,
/static/24e5695c45a4177fd1ef50b659afa096/9d567/image1.png 1360w,
/static/24e5695c45a4177fd1ef50b659afa096/23039/image1.png 1402w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;복제된 페이지에서 공유 - 링크 복사를 눌러 페이지의 주소를 얻습니다. 해당 주소는 &lt;code class=&quot;language-text&quot;&gt;username.notion.site/NOTION_PAGE_ID&lt;/code&gt; 꼴입니다. &lt;code class=&quot;language-text&quot;&gt;NOTION_PAGE_ID&lt;/code&gt;를 기록합니다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.notion.so/my-integrations&quot;&gt;Notion API 관리 페이지&lt;/a&gt;에서 &lt;code class=&quot;language-text&quot;&gt;새 API 통합 만들기&lt;/code&gt; 를 선택해 API를 생성해줍니다. 워크스페이스별로 권한을 관리하므로, 정확한 워크스페이스를 선택하여 진행합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;프라이빗 API 통합 시크릿키&lt;/code&gt;를 기록합니다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;콘텐츠 기능은 읽기/업데이트/입력을 필수로 선택해야 합니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/49440d05852802e113be20a06a93089b/e0a8c/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 114.70588235294117%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAACbklEQVR42pVV2XLbQAzT//9Vnzr5gb60iQ+dtqz7tCQLBWjLOZp65MxwdiXvQiABMs409mjqEpgvAP4X8+33D6veL3e0zpOFc5kGVEWOoe8wErzvGpy5H4aea2vRdS2m8cx9c31u6+v5M8/rzO13Axx5MUtOqMsCRZ4hjiPExwjpKcYpPiBLT0hOR5RljroqCNZYRj1BBgK2TYWeHxgHAuLGcGGiA31Xo22vh3T5fCaTG9v5nu6DlPWgrzd1ZQDvF1Sv+VMt58t4v7jE13fOOI348drBdV3sd28Ifc9SEivFdyCPwtGFsBiQponVKk1iW4siM4Hme1orAScy/LnpEAQ+XDIMfBfbzSvyLGH9Wiu6VMe8jqlzuTEsaR2pKoY1UxaQomJ9Wwq0NnVj+LLr4ZOht98gDDwDFYiAzV/PpGwbXpAAMqxs0jW1hRguhn0KsKJhFRM9effYJ789AShjx4cQhyiA7+5MDL0TM4X2z1jHbDMxXQmi+qnVGrLVKvCS9lFfr2XqTCMZHkOEoUdRtga8tNrAei6th7Uqi+GsOtIeSXJEniecPpkpLXZiqc5ZbRtNiKGv0FDRa2of/y5PC0OGE34FLSoOB6Wu2ilSsn2fIv9OlYed4uWjMYwoypGK+2w/tWCRp0w7tXJo39KbK3zI2mC0QeB7e5w4XCWMAA+RT+VdG7h6lr3UQY9K4MwEVNoa7/KixIgIFFH1VNOHk1vvYvtQdJ9Imt7fCWUqK+22KbF9ezWgwN9j8/YbgRgTRMzl0d3mD1xay3O3yDnuvgVcNvJcSjFkFa2yUFVmrF1yt48stfyPUU3NFV8A/wLUTwBa4khmwAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/49440d05852802e113be20a06a93089b/ca1dc/image2.png&apos; srcset=&apos;/static/49440d05852802e113be20a06a93089b/e7570/image2.png 170w,
/static/49440d05852802e113be20a06a93089b/f46e7/image2.png 340w,
/static/49440d05852802e113be20a06a93089b/ca1dc/image2.png 680w,
/static/49440d05852802e113be20a06a93089b/e0a8c/image2.png 998w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;노션에서 연결된 워크스페이스를 선택하고, 위에서 만든 통합 API를 연결해줍니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d7b9e107ca18b8a921c19ab9fec59ce1/d15a3/image3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 230.58823529411768%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAuCAYAAAAoaDnGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFhUlEQVR42o2XSVIzRxCFdQJvHIDEKDUaAM0S8wxinn4xGQMhO/DG4aUX3jrslTc+gg9gh2/gy6XfVyj1twDxs8ioUnXV65eZL7NLiVQqZaOjozY2NtYbsfHx8fCb58wnJyctmUzaxMREmKc0H9J6W3uOR0asNTxsV9qbSCZTFkUZq1Qqls1mbXZ2Nhi/OTg1NWWfPn2y4+NjG9ah9fV129nZsVEd3js9tZ9KJSsVCjaxvGw3ekEiNTxkgI512bjBDkYYwLAGMIqiYDDMzszYcjpt32nvxeSU/awxMfbjHxbNzFkmPWXR9LSltWFaoxus43PAMplM+J0W+0nNm9ORXenZ9lxVgH/+Z+VG006Ojmx9Y8Pu7++Di9fX18G1arVqzWbTGo1GMOa4vba2Zhvav7W1ZUurq1aan7fx2qIlRn/7x0q1hm1qU1OLZ2dnYSOHlpaWrFarWb1e7xsXFxd7tqTYLSwsWEPPokpTDH//1/JzpeByLp8PGSURuM7o7uVyuV788tqHsYYxn1E80+XGM2BWMdzcWLdisRgYnpyc2OHhoV1eXgb3cQsWZHp7e9sKyqqDxS2qzMtlAeZmi7a1uWlFSYC4cQiX9/f3bW9vz1YVI+LHbyzOzg0vqpv7Avz17wAYZdKW1QMkEjcPAa776C7HDQXUAuAvf1m2MGtLiwuBIQnZFFuYMB4cHPQYw3SQu4HhRkuVUmzoDYUQn3q9EUZAz8/PbWVlJcTzSJICDKkACJt+wPwzYFOySQ59HTaUxA7qLg1Kj7jNzc0FNz3Db7Hzl1RFKJFUmbEIE8AQNNk9v7iwU2V8WTpj81uJwHiGOngeAKlb6LKIwchHbFDMXH+fYxgJsEm3SYa3oDe0Bjvi2Gq17Pb2NiTGxfwWM0qxrtDkgstdQDYTL9+E6t9iMchl9oSkADii5ggAbKhNKuXx8TGwjZfZSwOMREKEJBYKeavUGs8MeUhXobGymdjxkngbAzw+OjP25cmyMwSQDZ1OJ5QZIj5VJ3ZhswZr2hpz1ycvhVm5XA7qyOWy/Ulh87zaF5sYCTZzdwlh+0g48AYwYo5me4Cprg75+CBg2pZ/S7x2vVPjiYvcO3m8o9casSxTqwQZubTb7eAmrsPGqwEmzsqZcYb45/O5z8LmLXRnNgAAOBnHPQ7CmpcCxh7i53PGPkDaEwwAYQONlZ5IgwB0d3c3NFhvCIxxN3tuR91KIbgscIhsxdsVbOkwGPH0OL4W+AthswgjNIXr4aOj7DLSHGCO+8gFFwd3GwFykIWrq6sAQLchGbgK27u7u1DnzKlx2Mb74atu4xXBIu67YD2DLl6vHvYwvmyyvRiSFB6SCGJIhcCK2kY+T09PgTH9kt8kDdH3d6BYDIlZoKvU82bc9wuTfys8s69b/xtJ4VLERmoVmRCrh4eHEE+qIh6rDwESJ1gRK1gx93g5wKAW9uoz2ugCehvisLvtbcznHwbEZYBubm5ClyH4SAiJUM+4Tum9H8eYy8SNNwCGdEiS36wAwwPWGQd/uGKALhtKi0X051ojrozIyXskhfBahzFAf8ghgDhENdCtKbvnG0W91xe/WMu8kR9cNziIwIkdQMyREy+IX5LeBRwaGuoLtruFi34tYc0/D8/fj3cAcSuefkKAuRYZvcZJhstoICDfjzwtCAGLJeOMDhS69hENsp+zVXQYykpWkUTKaE4M0tqQ0ThNn/vSzUE2JYZpPlIw5OZf0mJbcvlGsduTiA8koVONbY3favxenWWQdWSXAqtrLAL4lf4d3SqDPwjwWMAdxfRe1qZqNK6QBG4J3bC8tFnZtrzoCKPFVaSiynjUjxN9QyK1sF2V3qluYKv6rrTUeRYFWhSDcte9vuscN39qWAnr6Dp3W6nZ/+X+f1mfKcLWAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image3&apos; title=&apos;&apos; src=&apos;/static/d7b9e107ca18b8a921c19ab9fec59ce1/d15a3/image3.png&apos; srcset=&apos;/static/d7b9e107ca18b8a921c19ab9fec59ce1/e7570/image3.png 170w,
/static/d7b9e107ca18b8a921c19ab9fec59ce1/f46e7/image3.png 340w,
/static/d7b9e107ca18b8a921c19ab9fec59ce1/d15a3/image3.png 522w&apos; sizes=&apos;(max-width: 522px) 100vw, 522px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h4&gt;프로젝트 준비&lt;/h4&gt;
&lt;/li&gt;
&lt;li&gt;이 저장소의 별표를 누르고 여러분의 프로필로 포크합니다. 그 후 로컬로 클론합니다.&lt;/li&gt;
&lt;li&gt;(Optional) &lt;a href=&quot;http://github.io/&quot;&gt;github.io&lt;/a&gt; 기반의 블로그 저장소를 준비합니다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;.env.example&lt;/code&gt; 파일의 이름을 &lt;code class=&quot;language-text&quot;&gt;.env&lt;/code&gt;로 변경하고 설정값들을 세팅합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NOTION-KEY : 프라이빗 API 통합 시크릿키를 입력합니다.&lt;/li&gt;
&lt;li&gt;NOTION&lt;em&gt;DATABASE&lt;/em&gt;ID : NOTION&lt;em&gt;PAGE&lt;/em&gt;ID를 입력합니다.&lt;/li&gt;
&lt;li&gt;BLOG_URL : 깃허브 블로그의 URL을 입력합니다. 노션 페이지 링크를 실제 블로그 링크로 변경하는데 사용됩니다.&lt;/li&gt;
&lt;li&gt;SAVE_DIR : 콘텐츠들이 저장될 디렉토리입니다. &lt;a href=&quot;http://github.io/&quot;&gt;github.io&lt;/a&gt; 블로그의 저장소에서 포스팅될 마크다운들이 저장될 디렉토리입니다.&lt;/li&gt;
&lt;li&gt;SAVE&lt;em&gt;SUB&lt;/em&gt;DIR (Optional) : 포스트들이 저장될 하위 디렉토리입니다. 노션 페이지의 프로퍼티들로 정의합니다. 예를 들어 date/tag/로 입력한 경우, date와 tag가 노션 페이지의 속성에 존재해야 합니다.&lt;/li&gt;
&lt;li&gt;BLOG_REPO : 블로그 레포지토리의 경로입니다.&lt;/li&gt;
&lt;li&gt;GIT&lt;em&gt;USER&lt;/em&gt;NAME : 깃허브 User Name 입니다.&lt;/li&gt;
&lt;li&gt;GIT&lt;em&gt;USER&lt;/em&gt;EMAIL : 깃허브 User Email 입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;저장소를 내려 받은 곳에서 다음의 명령어를 사용합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nvm use&lt;/li&gt;
&lt;li&gt;npm install&lt;/li&gt;
&lt;li&gt;npm install -g ts-node
여기까지 세팅 후 ts-node index.ts를 실행합니다. 메타데이터 파일이 초기화됩니다. 초기화된 메타데이터를 저장소에 커밋/푸쉬합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;사용법&lt;/h3&gt;
&lt;h4&gt;노션 페이지 마크다운 변환&lt;/h4&gt;
&lt;p&gt;변환은 상태값을 기준으로 작동합니다. 상태값의 정의는 다음과 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Writting : 작성중인 글입니다. 블로그에 반영되지 않습니다.&lt;/li&gt;
&lt;li&gt;Ready : Ready 상태의 글은 프로그램이 실행되면 마크다운으로 변환됩니다. 변환 된 후, updated 상태로 바뀝니다.&lt;/li&gt;
&lt;li&gt;Updated : 마크다운 변환이 완료된 글입니다.&lt;/li&gt;
&lt;li&gt;ToBeDeleted : 삭제할 글입니다. 타겟 디렉토리 안의 해당하는 마크다운 파일을 삭제합니다.&lt;/li&gt;
&lt;li&gt;Deleted : 삭제된 글입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;노션에 원하는대로 글을 작성하고, 적당한 상태값을 설정한 뒤 &lt;code class=&quot;language-text&quot;&gt;ts-node index.ts&lt;/code&gt;로 프로그램을 실행하면 지정한 디렉토리에 마크다운 파일이 저장됩니다.&lt;/p&gt;
&lt;h4&gt;호환 노션 블록&lt;/h4&gt;
&lt;p&gt;노션의 다양한 기본 블록을 모두 지원합니다.
또한, &lt;code class=&quot;language-text&quot;&gt;미디어 - 이미지&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;미디어 - 코드&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;미디어 - 북마크&lt;/code&gt; 블록들을 지원합니다.&lt;/p&gt;
&lt;h4&gt;페이지 링크 기능&lt;/h4&gt;
&lt;p&gt;같은 데이터베이스(블로그 데이터베이스)에 속한 노션 페이지라면 해당 페이지 링크를 걸면 그 페이지에 해당하는 블로그 주소로 링크로 변환되는 기능을 제공합니다.&lt;/p&gt;
&lt;h3&gt;[Optional] 블로그 자동 배포&lt;/h3&gt;
&lt;p&gt;로컬에서만 사용해도 노션 글을 마크다운으로 바꿔주는 기능을 갖고 있지만, &lt;a href=&quot;http://github.io/&quot;&gt;github.io&lt;/a&gt; 기반의 블로그 자동 배포도 가능합니다. 이를 위해서 깃허브 액션을 사용합니다.&lt;/p&gt;
&lt;h4&gt;Git Token 발행&lt;/h4&gt;
&lt;p&gt;깃허브의  &lt;code class=&quot;language-text&quot;&gt;Settings&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;Developer Settings&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;Personal Access Token&lt;/code&gt; 메뉴에서 토큰을 발행해야 합니다.&lt;/p&gt;
&lt;h4&gt;변수 설정&lt;/h4&gt;
&lt;p&gt;레포지토리에 Secrets와 Variables를 설정해줘야 합니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fc6c8449bc5f9741ee6642a2df626c95/d6043/image4.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVR42nVT7XKbQAz07zjxJ1/mODg4jCEmTpuJnZk8SPv+T7LVil5KMs2PHR0naaXVicVyHWO1y7BPLZbrSHGvdynyqoUpPYrKwzraFncPe/FHWEkM45YfNtLz4mGbYpcUqNpHxLlTct5t4wLD5RXt+YaqFwxXuP6K0o9oTqPGu+MZ7fCMuhtRy3kbGyHcJNhEOcqmR+UHPd/L3T4t0I43lP0biv4dxv9A7gZYL0RCZuuT5tAWAlMdsd4fsGAymQvXqWwWYId0MtjWnfhalGKnc4e8bFUViwdQGbkWUzelViVRAAmZnBUNElPrfJaraU46N8mbI+QpIauRMMilI4zB/pXFbxZhJ3PMm/hE2JyecLBeqwdn6OpOwLi86iTuorGuPWuR/xJydo281FaI5+3PEWad5LXAIcrKybcR3ypR8PzxKJwVgxg8rY1BP77A9xdZlUHkfpaokjcZ4s5h+HXD8PsN2csxSLboHn/CixQSM5hyKpGVyjd3cicqvoKKUtvAngbErsbuUAjhWghTqXK5aifskCPgXDnTXPZL1+mbMbBwZhqxZtpDUza6e1xMkoRHYZfcN64O77++7r8/ymhhWpL/AXYtNKhRVx2pAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image4&apos; title=&apos;&apos; src=&apos;/static/fc6c8449bc5f9741ee6642a2df626c95/ca1dc/image4.png&apos; srcset=&apos;/static/fc6c8449bc5f9741ee6642a2df626c95/e7570/image4.png 170w,
/static/fc6c8449bc5f9741ee6642a2df626c95/f46e7/image4.png 340w,
/static/fc6c8449bc5f9741ee6642a2df626c95/ca1dc/image4.png 680w,
/static/fc6c8449bc5f9741ee6642a2df626c95/02d09/image4.png 1020w,
/static/fc6c8449bc5f9741ee6642a2df626c95/9d567/image4.png 1360w,
/static/fc6c8449bc5f9741ee6642a2df626c95/d6043/image4.png 2432w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
저장소의 &lt;code class=&quot;language-text&quot;&gt;Settings&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;Secrets and varaibles&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;Actions&lt;/code&gt;에서 깃허브 액션에 필요한 환경변수를 설정할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Secrtes
GITTOKEN, NOTION&lt;em&gt;DATABASE&lt;/em&gt;ID, NOTION_KEY를 생성 해줍니다. GITTOKEN은 방금 발행한 Git Token 값이며, 나머지는 환경변수에 입력한 것과 동일한 값입니다.&lt;/li&gt;
&lt;li&gt;Varaiables
BLOG&lt;em&gt;REPO, BLOG&lt;/em&gt;URL, GIT&lt;em&gt;USER&lt;/em&gt;EMAIL, GIT&lt;em&gt;USER&lt;/em&gt;NAME, SAVE_DIR를 생성합니다. 환경변수 입력과 동일한 값입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;워크플로우 설정&lt;/h4&gt;
&lt;p&gt;깃허브 기반의 블로그 배포는 사용하는 테마에 따라 방법이 완전히 다릅니다. 따라서 깃허브 액션 워크플로우를 자동 배포까지 하는 경우, 자동 배포는 별도로 구성하여 블로그 저장소에 커밋/푸쉬까지만 하면 되는 케이스별로 구분해두었습니다.&lt;/p&gt;
&lt;p&gt;포크를 한 경우에는 기본적으로 워크플로우가 비활성화 되어있습니다. 원하는 워크플로우 고른 후 활성화 해주면 됩니다.&lt;/p&gt;
&lt;h4&gt;블로그 저장소에 커밋/푸쉬까지만 자동화하는 워크플로우&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;workflow_2.yml.disabled&lt;/code&gt; 워크플로우를 사용하면 됩니다. 파일 이름에서 .disabled를 제거해야 합니다.
노션에서 글을 가져와 깃허브 블로그 레포지토리에 마크다운 파일을 집어넣고 커밋/푸쉬 하는 것까지 자동화 되어있습니다.&lt;/p&gt;
&lt;h4&gt;블로그 배포까지 자동화하는 워크플로우&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main.yml&lt;/code&gt; 파일의 &lt;code class=&quot;language-text&quot;&gt;blog-deploy&lt;/code&gt; Job을 참조해서 워크플로우를 각자 블로그 배포 형식에 맞게 수정하면 됩니다. 해당 파일은 제가 실제로 배포에 사용하는 파일입니다.&lt;/p&gt;
&lt;h3&gt;개발과정&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/series/GitHub-Pages%EC%99%80-Notion-API-%EC%97%B0%EB%8F%99/&quot;&gt;개발과정 몰아보기&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;문의&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;mailto:zel@kakao.com&quot;&gt;zel@kakao.com&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[시맨틱 버전 관리]]></title><description><![CDATA[서론 개인적으로 이것저것 만들려고 시도한 적은 많았는데, 완성한 적은 이번이 처음입니다. (nolog…]]></description><link>https://sharknia.github.io/시맨틱-버전-관리/</link><guid isPermaLink="false">https://sharknia.github.io/시맨틱-버전-관리/</guid><pubDate>Thu, 08 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;개인적으로 이것저것 만들려고 시도한 적은 많았는데, 완성한 적은 이번이 처음입니다. (&lt;a href=&quot;https://sharknia.github.io/series/GitHub-Pages%EC%99%80-Notion-API-%EC%97%B0%EB%8F%99/&quot;&gt;nolog 프로젝트&lt;/a&gt;) 라이센스도 등록해보고 릴리즈도 처음 해봤는데, 릴리즈를 하려다 보니 다음과 같은 문구가 있었습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    If you’re new to releasing software, we highly recommend to learn more about semantic versioning.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;“버전 관리” 에 대해서는 추상적으로 알고 있었지만, 시맨틱 버전 관리라는 개념의 이름에 대해서는 처음 알았습니다. 부끄러운 일이기도 하고, 또 이번 기회에 잘 알아둬야겠다고 생각이 들어서 한 번 정리해두려고 합니다. &lt;/p&gt;
&lt;h2&gt;시맨틱 버전 관리란?&lt;/h2&gt;
&lt;p&gt;시맨틱 버전 관리는 소프트웨어 버전 번호를 할당하고 증가시키는 규칙 시스템입니다. 이 시스템은 소프트웨어의 버전을 명확하게 해줘 개발자가 소프트웨어의 변경 사항을 쉽게 이해할 수 있게 돕습니다. 시맨틱 버전 관리는 주로 세 부분으로 구성된 버전 번호를 사용합니다. &lt;/p&gt;
&lt;h3&gt;Major Version&lt;/h3&gt;
&lt;p&gt;이전 버전과 호환되지 않는 새로운 변경사항을 도입했을 때 증가합니다.&lt;/p&gt;
&lt;h3&gt;Minor Version&lt;/h3&gt;
&lt;p&gt;이전 버전과 호환되면서 새로운 기능이 추가되었을 때 증가합니다. &lt;/p&gt;
&lt;h3&gt;Patch Version&lt;/h3&gt;
&lt;p&gt;이전 버전과 호환되는 버그 수정이 이루어졌을 때 증가합니다. &lt;/p&gt;
&lt;p&gt;버전 번호는 &lt;code class=&quot;language-text&quot;&gt;Major.Minor.Patch&lt;/code&gt; 형식으로 표현됩니다. 예를 들어 &lt;code class=&quot;language-text&quot;&gt;2.3.1&lt;/code&gt; 과 같은 형태로 나타날 수 있습니다. &lt;/p&gt;
&lt;h2&gt;목적&lt;/h2&gt;
&lt;p&gt;소프트웨어 어떤 버전이 다른 버전과 어떻게 다른지를 명확하게 명시하여 소프트웨어를 사용하는 개발자들이 해당 변경사항을 쉽게 파악하고 대응할 수 있도록 합니다. &lt;/p&gt;
&lt;p&gt;예를 들어 어떤 라이브러리의 Major 버전이 변경되었다면 이는 기존 코드와 호환되지 않을 수 있는 중대한 변경이 있었음을 의미합니다. 따라서 개발자는 코드를 업데이트 하기 전에 해당 변경 사항을 주의 깊게 검토할 필요가 있습니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Typescript의 Testcode 맛보기]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/Typescript의-Testcode-맛보기/</link><guid isPermaLink="false">https://sharknia.github.io/Typescript의-Testcode-맛보기/</guid><pubDate>Tue, 06 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;파이썬에서 잠깐 테스트코드를 맛본적이 있습니다. 문법 자체는 조금 복잡했지만(익숙하지 않았지만) 설치 자체는 그다지 어렵지 않았던 것으로 기억합니다. &lt;/p&gt;
&lt;p&gt;그래서 타입스크립트에서도 그럴 줄 알았습니다. &lt;/p&gt;
&lt;h2&gt;설치&lt;/h2&gt;
&lt;p&gt;일단, 설치가 한 두개가 아니었습니다. 또, 설치하는 패키지를 package.json 파일의 devDependencies에 추가했습니다. 이는 개발 시에만 필요한 의존성을 나타냅니다. 처음에는 멋모르고 다음의 패키지 하나만 설치해주었습니다. &lt;/p&gt;
&lt;h3&gt;@types/jest 설치&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; i --save-dev @types/jest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;--save-dev&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;설치하는 패키지를 package.json 파일의 devDependencies에 추가하는 옵션이 바로 이 옵션입니다. 프로덕션에서는 필요하지 않은 테스트 라이브러리, 빌드 도구 등을 설치할 때에 해당 옵션을 붙여 설치합니다. 이 옵션을 붙여 설치할 경우, 다음과 같이 추가됩니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;&quot;devDependencies&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;&quot;@types/jest&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;^26.0.0&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이후 빌드 시스템이나 배포 파이프라인에서 &lt;code class=&quot;language-text&quot;&gt;npm install --production&lt;/code&gt; 명령어를 사용하면 이 곳에 정의된 패키지들은 설치를 건너뛰게 됩니다. &lt;/p&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;@types/jest&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;Jest는 자바스크립트 테스팅 프레임워크입니다. &lt;code class=&quot;language-text&quot;&gt;@types/jest&lt;/code&gt; **** 는 Jest의 타입 정의를 포함하는 타입스크립트 패키지입니다. 타입스크립트 프로젝트에서 Jest를 사용할 때, Jest의 함수와 객체에 대한 자동 완성, 타입 체킹 등의 이점을 제공합니다. &lt;/p&gt;
&lt;p&gt;그렇습니다. Jest는 별도로 설치해야 합니다. &lt;/p&gt;
&lt;h3&gt;Jest 설치&lt;/h3&gt;
&lt;p&gt;Jest 역시 설치해줍니다. 역시 개발 환경에서만 사용할 라이브러리 이므로 —save-dev 옵션을 사용합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; --save-dev jest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Jest 설치 후 &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt;  scripts 섹션에 다음의 내용을 추가합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token property&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;jest&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 하면 &lt;code class=&quot;language-text&quot;&gt;npm test&lt;/code&gt; 명령어가 Jest를 실행합니다. &lt;/p&gt;
&lt;h3&gt;TypeScript를 위한 Jest 설정&lt;/h3&gt;
&lt;p&gt;Jest는 기본적으로 JavaScript 파일을 지원하지만 TypeScript 파일을 처리하기 위해서는 추가적인 설정이 필요합니다. &lt;/p&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;ts-jest&lt;/code&gt; 설치&lt;/h4&gt;
&lt;p&gt;Jest가 TypeScript 파일을 이해할 수 있도록 ts-jest를 설치해야 합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;npm install --save-dev ts-jest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;jest.config.js&lt;/h4&gt;
&lt;p&gt;프로젝트 루트에 jest.config.js 파일을 생성 또는 수정하여 ts-jest를 사용하도록 Jest를 구성합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// jest.config.js&lt;/span&gt;
module.exports = &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  preset&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &apos;ts-jest&apos;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  testEnvironment&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &apos;node&apos;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;npm test&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;모든 설정을 마친 후 npm test를 실행하면 &lt;code class=&quot;language-text&quot;&gt;__test__&lt;/code&gt; 를 자동으로 탐색하여 &lt;code class=&quot;language-text&quot;&gt;.test.js&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;.spec.js&lt;/code&gt; 접미사를 가진 파일의 테스트를 실행합니다. &lt;/p&gt;
&lt;h2&gt;테스트 파일의 경로&lt;/h2&gt;
&lt;p&gt;테스트 파일을 어디에 둘 것인가? 는 몇가지 패턴이 있고, 가장 널리 사용되는 방식은 다음의 두가지입니다. &lt;/p&gt;
&lt;h3&gt;동일 디렉토리 내에 테스트 파일 배치&lt;/h3&gt;
&lt;p&gt;코드 파일과 동일한 디렉토리에 그에 해당하는 테스트 파일을 둡니다. 테스트 파일과 관련된 코드 파일이 가까이에 있어서 관리하기가 쉬운것이 장점입니다. 파일 이름은 대체로 테스트되는 파일의 이름을 따르며, &lt;code class=&quot;language-text&quot;&gt;.test&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;.spec&lt;/code&gt; 접미사를 추가하여 구분합니다. &lt;/p&gt;
&lt;h3&gt;별도의 테스트 디렉토리 사용&lt;/h3&gt;
&lt;p&gt;프로젝트 루트 또는 각 기능별 디렉토리에 &lt;code class=&quot;language-text&quot;&gt;__tests__&lt;/code&gt; 디렉토리를 만들고, 그 안에 관련 테스트 파일을 모으는 것입니다. 이 구조는 테스트 파일을 소스 코드에서 분리하여, 소스 코드 디렉토리를 더 깔끔하게 유지할 수 있게 해줍니다.&lt;/p&gt;
&lt;p&gt;또는 프로젝트 루트에 &lt;code class=&quot;language-text&quot;&gt;tests&lt;/code&gt; 디렉토리를 만들고 그 안에 모든 테스트 파일을 분류하는 방법도 있습니다.&lt;/p&gt;
&lt;h2&gt;오늘의 마무리&lt;/h2&gt;
&lt;p&gt;여기까지 하면 일단 test 코드를 실행할 수는 있습니다. 코파일럿의 도움을 받아 테스트코들 작성하고, 코드를 읽는데까지는 성공했습니다(?)&lt;/p&gt;
&lt;p&gt;예를 들어 완성한 테스트 코드 하나는 다음과 같습니다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;envConfig.test.ts&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; EnvConfig &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;../envConfig&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

describe&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;EnvConfig&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    let envConfig&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    beforeAll&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; 환경 변수 설정
        process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BLOG_URL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;https://example.com/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAVE_DIR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/path/to/save&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAVE_SUB_DIR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;subdir&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; EnvConfig 인스턴스 생성
        envConfig &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    afterAll&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; 환경 변수 정리
        delete process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BLOG_URL&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        delete process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAVE_DIR&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        delete process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAVE_SUB_DIR&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    it&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;should have the correct notionKey value&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        expect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notionKey&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NOTION_KEY &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    it&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;should have the correct databaseid value&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        expect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NOTION_DATABASE_ID &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    it&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;should correctly handle trailing slashes&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        expect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blogUrl&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;https://example.com&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; 끝 슬래시 제거 확인
        expect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;saveDir&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/path/to/save/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; 끝에 슬래시 추가 확인
        expect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;saveSubDir&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;subdir/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; 끝에 슬래시 추가 확인
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;테스트코드를 작성하면서 느낀점은, 역시 테스트코드는 사전에 짜는게 의미가 있는 것 같습니다. 또 역시 문법이 상당히 어색합니다. 추가적인 노력이 많이 필요하다고 느끼고, 가능하면 다음에는 프로젝트 처음부터 테스트 코드를 먼저 짜보려고 합니다. &lt;/p&gt;
&lt;p&gt;오히려 좀 더 필요성을 느끼게 되었습니다. 살짝 고생했지만 좋은 시간이었습니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Github Action Output]]></title><description><![CDATA[목적 깃허브 액션에서 Job들은 서로 다른 독립된 환경을 가집니다. 각 작업은 독립적으로 실행되며, 각기 다른 러너 환경에서 다른 버전의 도구를 사용할 수 있습니다. 이것은 아주 강점이지만, 때로 다른 Job…]]></description><link>https://sharknia.github.io/Github-Action-Output/</link><guid isPermaLink="false">https://sharknia.github.io/Github-Action-Output/</guid><pubDate>Sun, 04 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;목적&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/Github-Actions&quot;&gt;깃허브 액션&lt;/a&gt;에서 Job들은 서로 다른 독립된 환경을 가집니다. 각 작업은 독립적으로 실행되며, 각기 다른 러너 환경에서 다른 버전의 도구를 사용할 수 있습니다. 이것은 아주 강점이지만, 때로 다른 Job끼리 변수를 공유해야 하는 상황이 있을 수 있습니다. &lt;/p&gt;
&lt;p&gt;이때 사용하는 것이 Output 입니다. &lt;/p&gt;
&lt;h2&gt;선언하기&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 다른 job에서 사용하기 위해 선언&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;output1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.step1.outputs.test &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;output2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; steps.step2.outputs.test &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; step1 &lt;span class=&quot;token comment&quot;&gt;# 해당 output을 특정하기 위한 id 선언&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; echo &quot;test=hello&quot; &lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt; &quot;$GITHUB_OUTPUT&quot;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; step2
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; echo &quot;test=world&quot; &lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt; &quot;$GITHUB_OUTPUT&quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;기본적인 선언 방법은 &lt;code class=&quot;language-text&quot;&gt;echo &quot;변수=값&quot; &gt;&gt; &quot;$GITHUB_OUTPUT”&lt;/code&gt; 의 꼴입니다. 예전에는 set_output을 사용했던 것 같은데, 이 방법도 지금 작동은 제대로 하지만 해당 코드로 실행을 해보면 보안상의 문제로 곧 depacreted 될 거라는 warning이 발생합니다. &lt;/p&gt;
&lt;p&gt;반드시 id를 지정해줘야 합니다. 해당 id를 사용해 나중에 원하는 변수를 참조할 수 있습니다. &lt;/p&gt;
&lt;p&gt;output은 동일한 job이 아니라 job2에서 사용을 하고 싶을 경우에 선언해야 합니다. &lt;/p&gt;
&lt;h2&gt;사용하기 - 동일한 job&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; use output same job
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
          echo ${{ steps.step1.outputs.test}}
          echo ${{ steps.step2.outputs.test}}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;같은 job 안에서 사용할때에는 &lt;code class=&quot;language-text&quot;&gt;${{ steps.”id”.outputs.”변수명”}}&lt;/code&gt; 의 꼴로 사용하면 됩니다. &lt;/p&gt;
&lt;h2&gt;사용하기 - 다른 job&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;  &lt;span class=&quot;token key atrule&quot;&gt;job2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;OUTPUT1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;needs.job1.outputs.output1&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;OUTPUT2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;needs.job1.outputs.output2&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; echo &quot;$OUTPUT1 $OUTPUT2&quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다른 job에서 해당 변수를 사용할 경우에도 &lt;a href=&quot;https://sharknia.github.io/Github-Actions-Job---needs&quot;&gt;needs&lt;/a&gt; 종속성 선언을 해줘야 합니다. job1에서 선언한 output을 사용할 것이므로 needs 설정을 해주고 &lt;code class=&quot;language-text&quot;&gt;${{ needs.”job-이름”.outputs.”output변수명”}}&lt;/code&gt; 의 꼴로 참조할 수 있습니다. &lt;/p&gt;
&lt;p&gt;또한, 변수 명의 경우 대소문자는 구분하지 않습니다. &lt;/p&gt;
&lt;h2&gt;참조&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.github.com/ko/actions/using-jobs/defining-outputs-for-jobs#%EC%98%88-%EC%9E%91%EC%97%85-%EC%B6%9C%EB%A0%A5-%EC%A0%95%EC%9D%98&quot;&gt;https://docs.github.com/ko/actions/using-jobs/defining-outputs-for-jobs#예-작업-출력-정의&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Github Actions]]></title><description><![CDATA[소개 Github Actions…]]></description><link>https://sharknia.github.io/Github-Actions/</link><guid isPermaLink="false">https://sharknia.github.io/Github-Actions/</guid><pubDate>Sun, 04 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;소개&lt;/h2&gt;
&lt;p&gt;Github Actions는 깃허브에서 직접 소프트웨어 개발 워크플로우를 자동화할 수 있는 기능입니다. 개발자는 이를 사용해서 소프트웨어 빌드, 테스트, 배포와 같은 과정을 자동화하여 특정 트리거가 발생했을 경우 자동으로 실행되는 워크플로우를 작성할 수 있습니다. &lt;/p&gt;
&lt;h2&gt;강점 및 특징&lt;/h2&gt;
&lt;h3&gt;깃허브와의 통합&lt;/h3&gt;
&lt;p&gt;깃허브와 깊게 통합되어 있어 깃허브 리포지토리 내에서 직접 워크플로우를 관리하고 실행할 수 있습니다. 따라서 코드 변경, PR, 이슈 생성 등 깃허브 이벤트에 기반한 자동화를 간편하게 설정할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;언어와 프레임워크에 대한 광범위한 지원&lt;/h3&gt;
&lt;p&gt;다양한 프레임워크와 프로그래밍 언어를 지원합니다.이로 인해 거의 모든 소프트웨어 프로젝트에 적용할 수 있는 유연성을 제공합니다. &lt;/p&gt;
&lt;h3&gt;재사용 가능한 컴포넌트&lt;/h3&gt;
&lt;p&gt;마켓플레이스에서 다른 개발자가 만든 액션을 재사용하거나 자신의 커스텀 액션을 만들어 공유할 수 있습니다. &lt;/p&gt;
&lt;h3&gt;유연한 트리거 옵션&lt;/h3&gt;
&lt;p&gt;다양한 깃허브 이벤트에 대한 트리거 옵션을 제공합니다. 또한 cron 기반의 스케쥴을 통해서도 실행이 가능합니다. 이를 이용해 자유롭게 필요에 따라 자동화 작업을 실행할 수 있습니다. &lt;/p&gt;
&lt;h2&gt;Github Actions의 이해&lt;/h2&gt;
&lt;h3&gt;Workflow&lt;/h3&gt;
&lt;p&gt;워크플로우는 하나 이상의 작업을 실행하는 자동화된 프로세스입니다. 워크플로우는 리포지토리의 &lt;code class=&quot;language-text&quot;&gt;.github/workflows&lt;/code&gt; 디렉토리 아래 YAML 파일에 의해 정의되며 리포지토리의 이벤트 또는 스케쥴러에 따라 실행됩니다. &lt;/p&gt;
&lt;h3&gt;Jobs&lt;/h3&gt;
&lt;p&gt;크게 뭉뚱그려서 이야기하면 워크플로우는 결국 Job들의 집합입니다.&lt;/p&gt;
&lt;p&gt; Job들은 서로 다른 독립된 환경을 가집니다. 각 작업은 독립적으로 실행되며, 각기 다른 러너 환경에서 다른 버전의 도구를 사용할 수 있습니다. 이 방법을 사용하면, 하나의 워크플로우 안에서 서로 다른 환경, 서로 다른 패키지 세트를 사용하여 작업을 수행할 수 있습니다. &lt;/p&gt;
&lt;h4&gt;여러 Job의 선언&lt;/h4&gt;
&lt;p&gt;예를 들어, 첫번째 잡과 두번째 잡이 각각 다른 node 버전을 사용해야 하는 경우 다음과 같이 구성할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;job2

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Use Node.js (Version for Build)
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;node-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;12&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 첫 번째 작업에 필요한 노드 버전&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install Dependencies for Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm run build

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Additional Build Steps
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 필요한 추가 빌드 스텝&lt;/span&gt;

  &lt;span class=&quot;token key atrule&quot;&gt;job2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Use Node.js (Version for Deploy)
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;node-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;18&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 두 번째 작업에 필요한 노드 버전&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install Dependencies for Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm run build

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Additional Build Steps
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 필요한 추가 빌드 스텝&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Step&lt;/h3&gt;
&lt;p&gt;Job은 Step들의 집합입니다. Step은 실행될 셀 스크립트 또는 실행될 action들이이며, Step들은 정의된 순서대로 실행됩니다.&lt;/p&gt;
&lt;p&gt;각 Step은 동일한 runner에서 실행되므로(Job이 가진 환경을 공유하므로) step 마다 데이터를 공유할 수 있다. 즉 한 job 안에서 빌드하는 step, 이를 테스트 하는 step을 한 번에 가질 수 있습니다.&lt;/p&gt;
&lt;h2&gt;참조&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.github.com/ko/actions/learn-github-actions/understanding-github-actions&quot;&gt;https://docs.github.com/ko/actions/learn-github-actions/understanding-github-actions&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Github Actions Job - needs]]></title><description><![CDATA[개요 기본적으로 아무 설정이 없다면 각 Job들은 병렬적으로 실행됩니다.  예를 들어 job1과 job2를 선언한 경우, 이 두 job은 워크플로우 실행 시 동시에 시작이 됩니다.  이 때,  를 사용해 Job들 사이에 종속성을 주어 Job…]]></description><link>https://sharknia.github.io/Github-Actions-Job---needs/</link><guid isPermaLink="false">https://sharknia.github.io/Github-Actions-Job---needs/</guid><pubDate>Sun, 04 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;개요&lt;/h2&gt;
&lt;p&gt;기본적으로 아무 설정이 없다면 각 Job들은 병렬적으로 실행됩니다.  예를 들어 job1과 job2를 선언한 경우, 이 두 job은 워크플로우 실행 시 동시에 시작이 됩니다. &lt;/p&gt;
&lt;p&gt;이 때, &lt;code class=&quot;language-text&quot;&gt;needs&lt;/code&gt; 를 사용해 Job들 사이에 종속성을 주어 Job 하나가 끝나야 다음 Job이 실행되도록 설정할 수 있습니다.&lt;/p&gt;
&lt;h2&gt;예제&lt;/h2&gt;
&lt;h3&gt;순차적으로 실행하기&lt;/h3&gt;
&lt;p&gt;다음과 같이 needs에 다른 job의 이름을 지정해주면, 해당 job이 끝나야 이 job이 실행되도록 할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;job2

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;token comment&quot;&gt;# 첫번째 작업 실행...&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1 &lt;span class=&quot;token comment&quot;&gt;# &apos;job1&apos; 작업이 성공적으로 완료된 후에 실행&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;token comment&quot;&gt;# 두번째 작업 실행...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 경우에는 job1이 실패할 경우, job2의 작업도 건너뛰게 됩니다. &lt;/p&gt;
&lt;h3&gt;여러개의 needs 선언하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1
  &lt;span class=&quot;token key atrule&quot;&gt;job3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;job1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; job2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 선언되어있다고 할 때에, job1이 반드시 성공해야 job2가 실행이 되며, job1, job2가 모두 성공적으로 완료되어야 job3이 실행됩니다. &lt;/p&gt;
&lt;h3&gt;성공-실패 여부 상관없이 순차적으로 실행하기&lt;/h3&gt;
&lt;p&gt;job의 실행에도 조건문을 걸 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;job2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job1
  &lt;span class=&quot;token key atrule&quot;&gt;job3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; always() &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;job1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; job2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;예를 들어 이 조건문은 job1, job2의 성공 여부와는 상관없이 단지 순차적으로 작업을 실행합니다. 즉, job2가 실패하더라도 job3은 job1, job2 완료 이후에 실행됩니다. &lt;/p&gt;
&lt;h2&gt;참조&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.github.com/ko/actions/using-jobs/using-jobs-in-a-workflow&quot;&gt;https://docs.github.com/ko/actions/using-jobs/using-jobs-in-a-workflow&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Github Actions Workflow 수동으로 실행하기]]></title><description><![CDATA[왜 필요한가? 깃허브 액션 워크플로우를 로컬에서 테스트하기가 쉽지 않습니다. 결국 깃허브 콘솔 또는 깃허브 CLI를 이용해서 테스트 하게 되는 경우가 대부분입니다.  단순히 Re-Run…]]></description><link>https://sharknia.github.io/Github-Actions-Workflow-수동으로-실행하기/</link><guid isPermaLink="false">https://sharknia.github.io/Github-Actions-Workflow-수동으로-실행하기/</guid><pubDate>Sun, 04 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;왜 필요한가?&lt;/h2&gt;
&lt;p&gt;깃허브 액션 워크플로우를 로컬에서 테스트하기가 쉽지 않습니다. 결국 깃허브 콘솔 또는 깃허브 CLI를 이용해서 테스트 하게 되는 경우가 대부분입니다. &lt;/p&gt;
&lt;p&gt;단순히 Re-Run을 실행하면, 레포에 변경된 내용이 반영되지 않고 그 당시 환경에 대해서만 재실행이 되어 정상적인 테스트가 불가능합니다. &lt;/p&gt;
&lt;p&gt;결국 트리거에 Push 조건을 걸어놓고, 변경 사항을 만들어서 Push를 해서 워크플로우를 테스트 하고 있었습니다. &lt;/p&gt;
&lt;p&gt;그런데, 수동으로 깃허브 웹 콘솔에서 수동으로 워크플로우를 테스트 할 수 있게 해주는 방법이 있습니다. &lt;/p&gt;
&lt;h2&gt;워크플로우 파일 수정&lt;/h2&gt;
&lt;p&gt;트리거에 &lt;code class=&quot;language-text&quot;&gt;workflow_dispatch&lt;/code&gt; 이벤트를 추가해줍니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    workflow_dispatch&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;수동으로 워크플로우 수동으로 실행&lt;/h2&gt;
&lt;p&gt;위의 이벤트를 트리거에 추가해주고, 웹 콘솔에서 다음의 화면으로 이동합니다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/52b3ae143f3b94f5c834e6f0b5378b36/16e03/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 22.941176470588236%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9ElEQVR42lXPyVLDMBAEUF+AxIsWrMVClmXHWHG2ghQU//9nzSQOSw6vWnPQ1HSWM4VCWBjb4mwCRhvAlEMlNAquUQoDJi3WVY2HFcPjmt95KsQi51jlAllsBzjj0YcNmibCDzN8HCFpKXu24PVC1A2EunC3XNR0iGoCuH4BI9lnOmB2HZJ2iLZDv/+CH9/Q9CfKd9h4hA77f3Z3s+kO0CT1B3ykMzJF1zGqx6WB0B5+OiFuzzBhhmw2V8IMEPaWLv29KTmldK/o/YRdOyGrqFZJyy6Ysohpxrg9Io4zXBiutSqpfzHV4vLnZy6Fotoekqx4jW+hqX/GKAqeEAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/52b3ae143f3b94f5c834e6f0b5378b36/ca1dc/image1.png&apos; srcset=&apos;/static/52b3ae143f3b94f5c834e6f0b5378b36/e7570/image1.png 170w,
/static/52b3ae143f3b94f5c834e6f0b5378b36/f46e7/image1.png 340w,
/static/52b3ae143f3b94f5c834e6f0b5378b36/ca1dc/image1.png 680w,
/static/52b3ae143f3b94f5c834e6f0b5378b36/02d09/image1.png 1020w,
/static/52b3ae143f3b94f5c834e6f0b5378b36/9d567/image1.png 1360w,
/static/52b3ae143f3b94f5c834e6f0b5378b36/16e03/image1.png 1651w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Actions 탭 - 수정된 워크플로우로 이동하면 Run Workflow 버튼이 생긴 것을 볼 수 있습니다. &lt;/p&gt;
&lt;p&gt;특이사항으로, 혹시 워크플로우를 비활성화 한다면 해당 버튼도 활성화되지 않습니다. &lt;/p&gt;
&lt;h2&gt;참조&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.github.com/ko/actions/using-workflows/manually-running-a-workflow?tool=webui&quot;&gt;https://docs.github.com/ko/actions/using-workflows/manually-running-a-workflow?tool=webui&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(11)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅11/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅11/</guid><pubDate>Sun, 04 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;요약&lt;/h2&gt;
&lt;p&gt;짬짬이 틈을 내서 하는 작업이다 보니 문서화 작업을 제대로 못했습니다. 짜잘짜잘한 오류 수정이 있었으며, 비교적 큰 수정도 있었고 완성이 됐다고 판단해 버전을 정의하고 릴리즈도 해봤습니다. &lt;/p&gt;
&lt;h2&gt;버그 수정&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;코드 블록의 들여쓰기가 제대로 적용되지 않는 문제가 수정되었습니다. &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;코드&lt;/code&gt;  스타일 내에서 언더바가 제대로 인식되지 않는 문제가 수정되었습니다. &lt;/li&gt;
&lt;li&gt;타이틀에 스타일이 포함된 경우(노션에서 확인하기 어려움) 타이틀이 짤리던 문제가 수정되었습니다. &lt;/li&gt;
&lt;li&gt;기타 일부 스타일이 적용되지 않던 문제가 해결됐습니다. &lt;/li&gt;
&lt;li&gt;API 호출 시 타임아웃이 될 경우 대책없이 프로그램이 중단되던 문제가 해결됐습니다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;업데이트&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;이제 토글 블록이 지원됩니다.&lt;/li&gt;
&lt;li&gt;블로그 자동 배포가 워크플로우에 포함되었습니다. 이를 위해 깃허브 계정을 미리 설정할 수 있게 되었습니다. &lt;/li&gt;
&lt;li&gt;메타데이터 초기화 기능이 추가되었습니다. 이제 새로운 계정으로 세팅 시 메타데이터 파일이 초기화됩니다.&lt;/li&gt;
&lt;li&gt;코드 리팩토링의 일부로 일부 코드의 디렉토리가 분리되었습니다. &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;v1.0.0-beta&lt;/code&gt;가 릴리즈 되었습니다. Readme가 완성되었습니다. &lt;/li&gt;
&lt;li&gt;프로젝트 이름이 &lt;code class=&quot;language-text&quot;&gt;nolog&lt;/code&gt;로 확정되었습니다.&lt;/li&gt;
&lt;li&gt;라이센스가 명시되었습니다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;타임아웃 문제의 해결&lt;/h2&gt;
&lt;p&gt;기타 다른 버그는 짜잘짜잘한 수정이었지만 타임아웃 문제 해결은 나름대로 머리를 써서 구현했으므로 해당 과정을 별도로 기록합니다. &lt;/p&gt;
&lt;h3&gt;문제 파악&lt;/h3&gt;
&lt;p&gt;노션 API를 사용하고 있고, 해당 API를 사용하기 위해서 notionClient 라이브러리를 사용하고 있습니다. 그리고 주로 데이터베이스 정보를 읽어올 때, 페이지 안의 내용을 읽어올 때, 블록 안의 내용을 읽어올 때 해당 라이브러리를 사용하여 통신합니다. &lt;/p&gt;
&lt;p&gt;하지만 가끔 가다 간헐적으로 규칙성 없이 timeout이 발생하는 문제가 있었습니다. 이를 해결하기 위해 Notion Client 라이브러리를 상속한 NotionClientWithRetry 클래스를 생성하고, 세가지 메소드에 대해 재시도 로직을 하는 공통 메소드를 생성하고 코드상에서 Client 직접 호출 대신 해당 메소드를 이용해 Client를 호출하도록 수정해주었습니다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;NotionClientWithRetry.ts&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@notionhq/client&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionClientWithRetry&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; maxRetries&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; retryDelay&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        maxRetries&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        retryDelay&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;auth &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;maxRetries &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;maxRetries &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;retryDelay &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;retryDelay &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 기본 1초 대기&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token generic-function&quot;&gt;&lt;span class=&quot;token function&quot;&gt;retryAPI&lt;/span&gt;&lt;span class=&quot;token generic class-name&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token function-variable function&quot;&gt;operation&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        retries&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;maxRetries&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;operation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;retries &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[retryAPI] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;maxRetries &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; retries&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; retrying.....&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;resolve&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt;
                &lt;span class=&quot;token function&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;resolve&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;retryDelay&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retryAPI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; retries &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;blocksRetrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; block_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retryAPI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blocks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;databasesQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        filter&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        sorts&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retryAPI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;pagesRetrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; page_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retryAPI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;따로 사용자가 설정할 수 있지만 기본적으로는 1초에 한 번씩 최대 3번까지 재시도를 하도록 해주었습니다. &lt;/p&gt;
&lt;p&gt;해당 코드를 적용한 이후로는 API 호출에 실패해서 프로그램이 중단되는 일은 겪지 못했습니다. &lt;/p&gt;
&lt;h2&gt;블로그 자동 배포가 포함된 워크플로우 작성&lt;/h2&gt;
&lt;p&gt;블로그 자동 배포 워크플로우는 사실 &lt;a href=&quot;http://github.io/&quot;&gt;github.io&lt;/a&gt; 쪽 레포에 이미 구현이 되어 있어 추가 구현이 필요 없었으며, 깃허브 블로그 테마마다 배포 방식이 다를 수 있어 사실 꼭 구현이 필수인 영역은 아니었습니다. &lt;/p&gt;
&lt;p&gt;하지만 깃허브 액션에 대해 이해도가 깊어질 수 있고, 또 프로젝트의 목적 상 가능하면 하나로 합쳐지는 예시를 제공하는 것도 좋아보여 공부 겸 진행했습니다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(10)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅10/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅10/</guid><pubDate>Sat, 03 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;메타데이터 구조 확정&lt;/h2&gt;
&lt;p&gt;지난시간, &lt;a href=&quot;https://sharknia.github.io/NotionAPI%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%9E%90%EB%8F%99-%ED%8F%AC%EC%8A%A4%ED%8C%859&quot;&gt;메타데이터를 관리하기 위한 클래스 초안&lt;/a&gt;을 작성했다. 시간이 없어서 급하게 만들었는데, 제대로 매개변수 이름을 지어주고 메타데이터 구조를 확정지었다. &lt;/p&gt;
&lt;p&gt;크게 변하지는 않았고, 이름을 정해주는 수준이었다. &lt;/p&gt;
&lt;p&gt;그리고 추가로 저장된 디렉토리 명을 사용해 포스팅된 마크다운 디렉토리를 삭제하는 메소드를 추가해주었다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;수정된 코드 전문&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; promises &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; fs &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;fs&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; join &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;path&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; EnvConfig &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./envConfig&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./pageMetadata.json&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PageMetadata&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    path&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Metadata&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageMetadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MetadataManager&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; instance&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MetadataManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; metadata&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Metadata &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; envConfig&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;envConfig &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 인스턴스를 반환하는 메서드입니다.
     * @returns {MetadataManager} MetadataManager 인스턴스
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;MetadataManager&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MetadataManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;loadMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 로드합니다.
     * @returns {Promise&amp;lt;void&gt;} Promise 객체
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loadMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;readFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;utf8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; Metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;메타데이터 파일 읽기 성공:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;메타데이터 파일 읽기 오류:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 반환합니다.
     * @returns 메타데이터 객체 또는 null
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Metadata &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 페이지 메타데이터를 업데이트합니다.
     *
     * @param pageIdx 페이지 식별자
     * @param pageData 페이지 메타데이터
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;updatePageMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageIdx&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pageData&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageMetadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;메타 데이터 업데이트 [&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pageIdx&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 페이지 메타데이터를 삭제합니다.
     * @param pageIdx 삭제할 페이지의 ID
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deletePageMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageIdx&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 파일에 저장합니다.
     * @returns 메타데이터가 성공적으로 저장될 때 해결되는 Promise입니다.
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;saveMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    &lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;메타데이터 파일 저장 오류:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 지정된 페이지 인덱스에 대한 메타데이터를 삭제합니다.
     * @param pageIdx 삭제할 페이지 인덱스
     * @returns 삭제 작업이 완료된 후에는 아무 값도 반환하지 않습니다.
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deleteFromMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageIdx&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; dir &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;saveDir&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageIdx&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;unlink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dir&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;파일 삭제 성공:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dir&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;파일 삭제 오류:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;Posting 클래스 수정&lt;/h2&gt;
&lt;p&gt;메타데이터 정보는 모아두었다가, 프로그램 종료시에 한 번에 파일에 저장하도록 종료되는 부분에서 saveMetadata 메소드를 호출해주었다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;수정된 Posting 클래스 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;[posting.ts] start!&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadataManager &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; MetadataManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EnvConfig &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notionkey&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notionKey &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; databaseid&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseid &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notionApi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; NotionAPI&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionkey&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dbInstance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; DataBase&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;databaseid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;[posting.ts] page 순회 시작&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dbInstance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageIds&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadataManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;saveMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Error creating database instance:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;Database 클래스 수정&lt;/h2&gt;
&lt;p&gt;기존에는 상태값이 Ready 인 것만 쿼리하고 있었는데, 이제는 삭제도 진행해야 하므로 상태가 ToBeDeleted인 것도 쿼리하도록 수정해주었다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;수정된 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;QueryDatabaseResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;databasesQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    filter&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        or&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;상태&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                select&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                    equals&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Ready&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;상태&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                select&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                    equals&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ToBeDeleted&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// pageId 리스트 업데이트&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageIds &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Error querying the database:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;Page 클래스 수정&lt;/h2&gt;
&lt;h3&gt;init() 메소드 수정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;pageIdx 속성을 추가하고 init() 메소드에서 해당 속성을 초기화해준다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;create() 메소드 수정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;create 메소드에서 상태값에 따른 분기처리를 추가했다. &lt;/p&gt;
&lt;p&gt;기존에는 ready상태만 있었으므로 일관된 처리를 진행하면 됐지만, 이제는 삭제 대기 상태가 추가되었으므로 상태값에 따른 분기처리를 추가하고 각각 다르게 작동하도록 해주었다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ready, ToBeDeleted 두 상태 모두 일단 해당하는 파일을 삭제한다. Ready 인데도 삭제하는 이유는 타이틀이 바뀐 경우에는 파일을 삭제해야 하기 때문이다. &lt;/li&gt;
&lt;li&gt;Ready 상태인 경우에는 기존의 로직을 실행하고, Metadata를 업데이트 해준다. &lt;/li&gt;
&lt;li&gt;ToBeDeleted 상태인 경우에는 메타데이터에서 해당하는 내용을 삭제한다. &lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;create() 메소드 안쪽 수정된 내용 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;```typescript
public static async create(pageId: string) {
        const notionApi: NotionAPI = await NotionAPI.create();
        const page: Page = new Page(pageId, notionApi.client);
        MarkdownConverter.imageCounter = 0;
        await page.init(page);
        const status = page.properties![&apos;상태&apos;];
        console.log(
            `[page.ts] start - pageTitle : (${status})${page.pageTitle}`,
        );
        // 저장하기 전에도 기존 파일을 삭제한다. 타이틀이 달라진 update 일 수 있기 때문이다.
        await page.metadataManager?.deleteFromMetadata(page.pageIdx!);
        if (status === PageStatus.ToBeDeleted) {
            // 페이지가 삭제될 예정인 경우
            await page.metadataManager?.deletePageMetadata(page.pageIdx!);
            await page.updatePageStatus(PageStatus.Deleted);
            return page;
        } else if (status === PageStatus.Ready) {
            // 포스팅이 준비된 경우
            page.contentMarkdown = await page.fetchAndProcessBlocks();
            await page.printMarkDown();
            await page.metadataManager?.updatePageMetadata(page.pageIdx!, {
                path: page.pageUrl!,
            });
            await page.updatePageStatus(PageStatus.Updated);
            return page;
        } else {
            console.error(`[page.ts] start - status : ${status}`);
            throw new Error(`[page.ts] start - status : ${status}`);
        }
    }
```&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;기타 변경 내용&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;열거형 클래스를 새로 만들어 상태값 정의를 미리 해주었다. &lt;/li&gt;
&lt;li&gt;또한, 메타데이터 파일도 레포의 일부인데 깃허브 액션 워크플로우 작동 후 이 파일도 수정될 것이므로 한 번 더 커밋/푸시가 필요하다. 해당 내용을 워크플로우의 Run Script 바로 다음에 추가해주었다. &lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;추가된 워크플로우&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;```yaml
- name: Commit and Push Changes to Current Repository
      run: |
        git config --global user.name &apos;name&apos;
        git config --global user.email &apos;mail&apos;
        git add .
        git commit -m &quot;Update contents&quot; || echo &quot;No changes to commit in current repo&quot;
        git push
```&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;주의할 점&lt;/h2&gt;
&lt;p&gt;일단, 로컬에서 실행 시 권한 문제로 파일 삭제가 제대로 되지 않았다. 그래서 깃허브 액션에서도 파일 권한 문제가 생길 우려가 있어 권한을 조정하는 방법이 있나 찾아보았는데, 깃허브 액션에서는 외부를 컨트롤 하려는게 아닌 이상 별도의 권한 문제가 발생하지 않는다고 한다. &lt;/p&gt;
&lt;p&gt;따라서 로컬에서 발생하는 문제는 따로 수정하지 않았다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Typescript의 열거형]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/Typescript의-열거형/</link><guid isPermaLink="false">https://sharknia.github.io/Typescript의-열거형/</guid><pubDate>Sat, 03 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;타입스크립트에서 &lt;code class=&quot;language-text&quot;&gt;enum&lt;/code&gt; 을 사용해 특정 값들의 집합을 정의하고 각 멤버에 문자열 값을 할당할 수 있다. 이는 열거형이라고 하며 관련된 상수 값들의 집합에 이름을 부여하여 코드의 가독성을 높이고 오류 가능성을 줄여준다. &lt;/p&gt;
&lt;p&gt;임의의 열거형을 정의하면 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; PageStatus &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Deleted &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;deleted&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Writing &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;writing&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 정의하면 PageStatus 타입의 변수를 사용할 때 PageStatus.Deleted 로 사용해서 열거형 멤버게 접근할 수 있다. &lt;/p&gt;
&lt;p&gt;이렇게 얻어진 값은 각각에 할당된 문자열과 같다. &lt;/p&gt;
&lt;p&gt;사용법 예시 코드는 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; currentPageStatus&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageStatus &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; PageStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Writing&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;currentPageStatus &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; PageStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Deleted&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;The page is deleted.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;currentPageStatus &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; PageStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Writing&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;The page is in writing status.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr style=&quot;border: none; height: 1px; background-color: #e0e0e0; margin: 16px 0;&quot; /&gt;
만약, 열거형을 정의할 때 값을 명시하지 않으면 열거형의 값은 기본적으로 0에서 시작해 순차적으로 증가한다.  예를 들어 다음과 같다. 
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; PageStatus &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Deleted&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 0&lt;/span&gt;
    Writing  &lt;span class=&quot;token comment&quot;&gt;// 1&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;물론 임의로 숫자를 지정할 수도 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; StatusCode &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    NotFound &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ServerError &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;500&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또한 숫자 열거형에서 일부 멤버에만 값을 지정하고 다른 멤버에는 값을 지정하지 않는다면 타입스크립트는 자동으로 이전 멤버의 값에서 1을 더해 계산한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; Example &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    Start &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Middle&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 값이 2로 자동 할당됩니다.&lt;/span&gt;
    End &lt;span class=&quot;token comment&quot;&gt;// 값이 3으로 자동 할당됩니다.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(9)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅9/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅9/</guid><pubDate>Fri, 02 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;지난시간&lt;/h2&gt;
&lt;p&gt;지난시간, 신나게 자동 배포를 만들었다. &lt;/p&gt;
&lt;p&gt;이제 새로 생성된 문서들에 대해서 자동으로 한시간마다 배포가 되어 글이 포스팅된다. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;근데, 이런 경우 글을 어떻게 삭제하지?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;현재 타이틀이 키 값인데 타이틀 명이 바뀌면 내용은 똑같은데 제목만 다른 글이 두 개?&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;그렇다, 삭제 및 수정 기능이 구현되어야 하는 것이다. &lt;/p&gt;
&lt;h2&gt;설계&lt;/h2&gt;
&lt;p&gt;어떤걸 키 값으로 해야 하나 고민이 많았는데, 답은 간단했다. 노션에 ID를 추가하는 기능이 있었다. 이렇게 되면, 내 노션 블로그를 위한 필수 속성은 타이틀, 상태, ID 세 가지가 된다. 이런게 너무 많이 생기는걸 원하지 않지만 어쩔 수 없는 부분이라고 생각이 든다. &lt;/p&gt;
&lt;p&gt;계획은 다음과 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;노션 글들에 ID 속성을 추가해 키값으로 삼는다. &lt;/li&gt;
&lt;li&gt;상태값에 ToBeDeleted, Deleted를 추가한다. &lt;/li&gt;
&lt;li&gt;키 값 - 저장된 디렉토리가 매핑된 메타데이터 json 파일을 생성한다. &lt;/li&gt;
&lt;li&gt;ToBeDeleted를 쿼리해와서, 매핑 테이블을 참조해 데이터를 삭제 후 매핑 정보도 삭제하고 Deleted 상태로 바꿔준다. &lt;/li&gt;
&lt;li&gt;Ready를 쿼리해와서 매핑 테이블을 참조해 기존 데이터를 삭제 후 매핑 정보를 갱신하고 마크다운을 다시 저장한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이렇게 하면 수정과 삭제에 모두 대응이 가능해보인다!&lt;/p&gt;
&lt;h2&gt;구현&lt;/h2&gt;
&lt;p&gt;우선, 전역적으로 메타데이터를 읽어오고, 메모리에 데이터를 저장한 다음 프로그램 종료 직전에 메타 데이터를 한 번에 수정해주는 역할을 할 클래스를 생성했다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;metadataManager.ts&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; promises &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; fs &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;fs&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./pageMetadata.json&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PageMetadata&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    url&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Metadata&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageMetadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MetadataManager&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; instance&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MetadataManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; metadata&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Metadata &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 인스턴스를 반환하는 메서드입니다.
     * @returns {MetadataManager} MetadataManager 인스턴스
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MetadataManager &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MetadataManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 로드합니다.
     * @returns {Promise&amp;lt;void&gt;} Promise 객체
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;loadMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;readFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;utf8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; Metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;메타데이터 파일 읽기 오류:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 반환합니다.
     * @returns 메타데이터 객체 또는 null
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Metadata &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 페이지 메타데이터를 업데이트합니다.
     *
     * @param pageId 페이지 식별자
     * @param pageData 페이지 메타데이터
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;updatePageMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pageData&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; PageMetadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 페이지 메타데이터를 삭제합니다.
     * @param pageId 삭제할 페이지의 ID
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deletePageMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * 메타데이터를 파일에 저장합니다.
     * @returns 메타데이터가 성공적으로 저장될 때 해결되는 Promise입니다.
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;saveMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    &lt;span class=&quot;token constant&quot;&gt;METADATA_FILE_PATH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;메타데이터 파일 저장 오류:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;이 클래스는 프로그램 시작과 동시에 초기화되며, 끝날 때 메타데이터 파일을 갱신하는 역할을 할 것이다. &lt;/p&gt;
&lt;p&gt;정확한 매개변수는 아직 정하지 않았으며, 초안만 짜뒀다. &lt;/p&gt;
&lt;p&gt;이제 내일, 이 클래스를 명확히 정의하고 이 클래스를 사용해 수정/삭제를 구현하면 된다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(8)]]></title><description><![CDATA[목표 단계적으로 GitHub Action…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅8/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅8/</guid><pubDate>Thu, 01 Feb 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;목표&lt;/h2&gt;
&lt;p&gt;단계적으로 GitHub Action을 사용해 블로그 자동 배포를 하려고 한다. &lt;/p&gt;
&lt;p&gt;일단, 구상한 깃허브 액션에서 실행할 플로우는 다음과 같다. &lt;/p&gt;
&lt;h2&gt;구상&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;블로그 레포지토리를 받아온다. &lt;/li&gt;
&lt;li&gt;내 프로그램을 돌려 블로그 레포지토리를 업데이트한다. &lt;/li&gt;
&lt;li&gt;블로그 레포지토리를 커밋/푸시한다. &lt;/li&gt;
&lt;li&gt;해당 작업은 특정 시간에, 또는 특정 시간마다 이뤄져야 한다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;구현&lt;/h2&gt;
&lt;h3&gt;Notion to Markdown 프로그램 실행&lt;/h3&gt;
&lt;h4&gt;워크플로우 파일 생성&lt;/h4&gt;
&lt;p&gt;단계적으로 구현해보려고 한다. 일단은 내 프로그램을 돌려보자. &lt;/p&gt;
&lt;p&gt;일단 대충 다음과 같이 초안을 짜주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 이름을 정의한다. &lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run TypeScript
&lt;span class=&quot;token comment&quot;&gt;# 실행 시기입니다. 이번엔 push, pull_request 될 때 이다. &lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pull_request&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 깃허브 액션에서 실행할 작업을 정의하는 섹션이다.&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;# 단일 작업의 이름을 정의합니다. 이 경우에는 이름이 run 이다.&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# 작업이 어떤 환경에서 실행될지 정의한다. &lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
		&lt;span class=&quot;token comment&quot;&gt;# 각 작업에서 실행할 순차적인 단계들을 정의한다. &lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# uses : 특정 액션을 사용할 때 사용한다.&lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# name : step의 이름을 정의한다.&lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# with : user로 지정된 액션에 추가적인 매개변수를 전달한다. &lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# run : 쉘 명령어를 실행한다. &lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# env : 환경변수를 설정한다. &lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# if : 조건문&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Use Node.js
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;node-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;18&apos;&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install Dependencies
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install TypeScript
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;dev typescript

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npx tsc

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run Script
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; node ./index.js&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 파일을 프로젝트의 &lt;code class=&quot;language-text&quot;&gt;.github/workflows/main.yml&lt;/code&gt; 로 저장해준다.&lt;/p&gt;
&lt;p&gt;그리고 커밋-푸시를 하면 &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/5d06e704853408fa3478937cf49cfd67/7a54e/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtklEQVR42qWS2Q6CMBBFK2XrTqEgmhj//yuvMxV8IBExPNxM2qRnzrQVvpvQ6i6nahyKUu/mIhWq1iPNT/TTA76/IQx3KNujpn2hTIQLDI2QtUVRmZ9QDjcvKXxmPVdSFcYNcGSpqWrqcsRyNeVsmxAwIcQ5W9YqHILtWQvjE3y8wvoRDQG3Xf/JMnLKdrw4Y/cBWv8emU0lXewZw2XkAfx1XBjBtvzqp4AtAfQCYmV58Nt8G/kFlfDDUxJD5Q0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/5d06e704853408fa3478937cf49cfd67/ca1dc/image1.png&apos; srcset=&apos;/static/5d06e704853408fa3478937cf49cfd67/e7570/image1.png 170w,
/static/5d06e704853408fa3478937cf49cfd67/f46e7/image1.png 340w,
/static/5d06e704853408fa3478937cf49cfd67/ca1dc/image1.png 680w,
/static/5d06e704853408fa3478937cf49cfd67/02d09/image1.png 1020w,
/static/5d06e704853408fa3478937cf49cfd67/9d567/image1.png 1360w,
/static/5d06e704853408fa3478937cf49cfd67/7a54e/image1.png 2216w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이렇게 실행이 된다. 그리고&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/686dbb0c0704c84fbeb9a7b10c204a35/40851/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAzUlEQVR42m2Q2xKCMAxE8YYUem8pKKAz+uT/f2DclBFvPJzZtslstimu9wf14410OIGetF8BNZPrs/6eGdcOubeQJpGPA3k8COmpFIaq2lKtAonG5fO+lKvswHZff1EcYcBmIY1Z2VzqCFpqoIxoPFUwrzGQ+8tKZ2X+DA8oWkT27UixmyhAtetI2bToAn7TqLik3uzEekKHVG1/ySljd5mTAhvOeJtQP+eBfDf+RBZol3LCX9OC43ORm/i7Bovl3b32N+v7fjiqv1Sfhk9rqoudfkDvqQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/686dbb0c0704c84fbeb9a7b10c204a35/ca1dc/image2.png&apos; srcset=&apos;/static/686dbb0c0704c84fbeb9a7b10c204a35/e7570/image2.png 170w,
/static/686dbb0c0704c84fbeb9a7b10c204a35/f46e7/image2.png 340w,
/static/686dbb0c0704c84fbeb9a7b10c204a35/ca1dc/image2.png 680w,
/static/686dbb0c0704c84fbeb9a7b10c204a35/02d09/image2.png 1020w,
/static/686dbb0c0704c84fbeb9a7b10c204a35/9d567/image2.png 1360w,
/static/686dbb0c0704c84fbeb9a7b10c204a35/40851/image2.png 2218w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
env 파일이 없기 때문에 바로 설정값 오류가 났다. &lt;/p&gt;
&lt;h4&gt;Github secret을 이용한 환경변수 설정&lt;/h4&gt;
&lt;p&gt;환경변수 설정을 워크플로우 파일 내에서 직접 설정하거나, 리포지토리 설정 또는 깃허브 환경에서 설정할 수 있다. 환경변수가 노출되지 않기를 원하지만 깃허브 전체에 적용될 필요는 없으므로 리포지토리 Setting에서 설정해주려고 한다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/042275ebaf7674b515056fe67f8552bd/01d29/image3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 58.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABwElEQVR42nVT2W7bMBD0SwsnkUXdEnWfliIrdRAnKIp+Qx/6/x8z3d2YdNA2D4OlSO7szNDeuX4KhhdqhEkpaxVkBI1Et7IXJhWilFHDp3t53mB/7+PL3sXXvbrhTmHneAkORBJTs0tE5vtA67Kb0U0runFBz5XAg2UgVS/KLVw/o74MO25morweBXyRSfnSvF3Qrj9QLD+Rj6/Q/Rnd/IxpPWN6POO4PmPZXqR200l6hZDRjivG5YyArDGhT4QDNU3bG4YTYb2gn4nwuGGYn6CrAbrskV0R60Z4LCHbCygva5kQErkfsyXONBUFDBPNg4qlGlhCvlARIds0B4rWrGZcvokdPmMCA8eLJTPu/QhL2I4nFM1kCXmPFTP8uJBvfrisGq1NVmvcGFwJtRCW7VGmm8N7N8LdIbSK0qKnHFnxhqp/lCGfENIrkzpWwtZMTkneCqKsvuXm3XJzP7Usr3ySvNi2TOYYKDt+fVb+fo/2nRSOQ7Go9B91N4VhiWF5EuTNQD+d99yMZa6OShBUFZZfb1h/f0dxmeG4FE/wH8IHL0XRTtD1IFZURJavti1InUro7zk3iNYWXl2Is78t/wH+5DFnF5aiqwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image3&apos; title=&apos;&apos; src=&apos;/static/042275ebaf7674b515056fe67f8552bd/ca1dc/image3.png&apos; srcset=&apos;/static/042275ebaf7674b515056fe67f8552bd/e7570/image3.png 170w,
/static/042275ebaf7674b515056fe67f8552bd/f46e7/image3.png 340w,
/static/042275ebaf7674b515056fe67f8552bd/ca1dc/image3.png 680w,
/static/042275ebaf7674b515056fe67f8552bd/02d09/image3.png 1020w,
/static/042275ebaf7674b515056fe67f8552bd/9d567/image3.png 1360w,
/static/042275ebaf7674b515056fe67f8552bd/01d29/image3.png 2536w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Secrets는 로그에도 노출되지 않으며, variables는 로그에서 노출이 된다. 적절하게 선택하자. &lt;/p&gt;
&lt;p&gt;NOTION&lt;em&gt;KEY와 NOTION&lt;/em&gt;DATABASE_ID는 시크릿에, 나머지는 변수들에 저장해주었다. &lt;/p&gt;
&lt;p&gt;다음과 같이 워크플로우 파일을 수정해주면 정상 작동된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run TypeScript

&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pull_request&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest

    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Use Node.js
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;node-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;18&apos;&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install Dependencies
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install TypeScript
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;dev typescript

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npx tsc

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run Script
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; node ./index.js
			&lt;span class=&quot;token comment&quot;&gt;# 환경변수 불러오기 추가 &lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;NOTION_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.NOTION_KEY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.NOTION_DATABASE_ID &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;BLOG_URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.BLOG_URL &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;SAVE_DIR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.SAVE_DIR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;SAVE_SUB_DIR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.SAVE_SUB_DIR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;블로그 Repository 추가&lt;/h3&gt;
&lt;p&gt;1, 3번 작업을 위해 블로그 레포를 체크아웃 하는 과정을 추가하자. &lt;/p&gt;
&lt;p&gt;이 전에 깃 권한을 얻기 위해 토큰을 발급해주었다. Setting - Develper 설정에 가서 토큰을 발급해주자. classic token으로 발행하고, 적당히 권한을 수정해주었다. &lt;/p&gt;
&lt;p&gt;그리고 해당 토큰도 레포의 Secret에 추가해주었다. &lt;/p&gt;
&lt;p&gt;그리고 나서 워크플로우를 아래와 같이 수정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run TypeScript

&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pull_request&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest

    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2
		&lt;span class=&quot;token comment&quot;&gt;# 블로그 레포 체크아웃&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Checkout Blog Repository
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;repository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Sharknia/Sharknia.github.io&apos;&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.GITTOKEN &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;blog-repo&apos;&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Use Node.js
      &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node@v2
      &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;node-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;18&apos;&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install Dependencies
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Install TypeScript
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npm install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;dev typescript

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; npx tsc

    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Run Script
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; node ./index.js
      &lt;span class=&quot;token key atrule&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;NOTION_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.NOTION_KEY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.NOTION_DATABASE_ID &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;BLOG_URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.BLOG_URL &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;SAVE_DIR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.SAVE_DIR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;SAVE_SUB_DIR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; var.SAVE_SUB_DIR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;token comment&quot;&gt;# 블로그 레포 커밋/푸쉬&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Set Git remote URL with token and Commit and Push Changes
			&lt;span class=&quot;token comment&quot;&gt;# 다른 저장소이므로 git remote set-url을 실행한다. &lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
        cd blog-repo
        git remote set-url origin https://${{ secrets.GITTOKEN }}@github.com/name/name.github.io
        git config user.name &apos;name&apos;
        git config user.email &apos;mail&apos;
        git add .
        git commit -m &quot;Update blog contents&quot; || echo &quot;No changes to commit&quot;
        git push&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기까지 해두면, 제대로 깃허브 블로그에 새로운 글이 커밋/푸쉬 되었다!&lt;/p&gt;
&lt;h2&gt;마무리&lt;/h2&gt;
&lt;p&gt;마지막으로, 테스트를 종료하고 자동 배포가 매 시각 되게 하기 위해 on 부분을 다음과 같이 수정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
  &lt;span class=&quot;token key atrule&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;cron&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0 * * * *&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;다음 계획&lt;/h3&gt;
&lt;p&gt;이 방법으로는 삭제가 되지 않는다는 사실을 깨달았다. &lt;/p&gt;
&lt;p&gt;당분간은 수동삭제를 &lt;del&gt;ㅠㅠ&lt;/del&gt; 하기로 하고 삭제를 어떻게 할 것인지에 대해서는 구상을 해두었다. &lt;/p&gt;
&lt;p&gt;다음 시간은 삭제의 구현이다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[vscode-quick Suggestions]]></title><description><![CDATA[editor.quickSuggestions 설정은 VSCode에서 코드를 작성하는 동안 자동완성을 어떻게 표시할지를 결정한다.  다음 세가지의 옵션이 있다.  string 문자열 내에서 자동 완성 제안을 활성화/비활성화 한다.  comments…]]></description><link>https://sharknia.github.io/vscode-quick-Suggestions/</link><guid isPermaLink="false">https://sharknia.github.io/vscode-quick-Suggestions/</guid><pubDate>Wed, 31 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;editor.quickSuggestions 설정은 VSCode에서 코드를 작성하는 동안 자동완성을 어떻게 표시할지를 결정한다. &lt;/p&gt;
&lt;p&gt;다음 세가지의 옵션이 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;string&lt;/p&gt;
&lt;p&gt;문자열 내에서 자동 완성 제안을 활성화/비활성화 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;comments&lt;/p&gt;
&lt;p&gt;주석 내에서 자동 완성 제안을 활성화/비활성화 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;other&lt;/p&gt;
&lt;p&gt;코드(문자열이나 주석이 아닌 부분) 내에서 자동 완성 제안을 활성화/비활성화 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;VSCode의 설정을 json으로 열어 다음의 내용을 입력하면 된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token property&quot;&gt;&quot;editor.quickSuggestions&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;strings&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;comments&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;other&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(7)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅7/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅7/</guid><pubDate>Tue, 30 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;퇴근을 하고 고치다보니 시간이 부족하다.. 어쩔 수 없다. &lt;/p&gt;
&lt;h2&gt;돌아보기&lt;/h2&gt;
&lt;p&gt;어제 상당수의 디버깅을 진행하고 기존 블로그에서 새 블로그로 글을 이전했다. 깃허브 블로그에 업로드까지 마치고, 오늘 다시 보니 짜잘짜잘한 오류가 다시 또(!!) 발견되었다. &lt;/p&gt;
&lt;h2&gt;유지보수&lt;/h2&gt;
&lt;h3&gt;Callout 수정&lt;/h3&gt;
&lt;p&gt;내가 선택한 블로그의 기능인지, 원래 마크다운 기능인지 모르겠다. 굳이 태그를 넣을 필요가 없어서, 태그를 제거해주었다. &lt;/p&gt;
&lt;h3&gt;이미지 캡션 수정&lt;/h3&gt;
&lt;p&gt;이미지 캡션도 마찬가지였다. 혹시 하는 노파심에 따로 p태그를 넣어주고 있었는데, 아무 문제 없이 정상 작동 되었다. 아무래도 깃허브 블로그도 마크다운 기반으로 움직이다보니 마크다운에서 좀 잘 나오면 잘 이쁘게 지원하는 것 같다. &lt;/p&gt;
&lt;h3&gt;넘버링 숫자 안올라감 &amp;#x26; 들여쓰기 문제&lt;/h3&gt;
&lt;p&gt;넘버링이 모두 1로 나오고, 글머리 기호와 넘버링 리스트를 제외한 나머지 부분에 들여쓰기를 넣지 않았다는 사실을 깨달았다. &lt;/p&gt;
&lt;p&gt;넘버링부터 고치려다가 문득 들여쓰기가 제대로 되면 숫자가 제대로 나오지 않을까? 해서 들여쓰기부터 수정했는데, 정답이었다. &lt;/p&gt;
&lt;p&gt;들여쓰기를 고치고 나서 마크다운에 1. 이라고 숫자가 고정되어 있어도 제대로 숫자가 증가되면서 출력된다. &lt;/p&gt;
&lt;h3&gt;일부 부분 [objcet Promise] 출력&lt;/h3&gt;
&lt;p&gt;이건 await을 까먹은거다. 추가해주었다. &lt;/p&gt;
&lt;h3&gt;이미지 깨짐&lt;/h3&gt;
&lt;p&gt;어제 디버깅을 하면서 이미지 카운터를 static에서 인스턴스로 변경해주었는데, 어제 내가 멍청하다고 썼는데 사실은 오늘의 내가 멍청한 것이었다. &lt;/p&gt;
&lt;p&gt;이미지 카운터를 컨버터에 넣어놓을거면 거기서 인스턴스 변수로 선언하면 안됐다. 이미지가 거의 모든 경우에 항상 1번으로 저장된다.. &lt;/p&gt;
&lt;p&gt;페이지에 이미지 카운터 변수를 심고 블록-컨버터까지 내려줄 생각을 하니 아득해졌는데 생각해보니 그냥 컨버터 클래스에 넣어놓고 static 변수로 변경한 다음 페이지를 새로 만들 때마다 해당 값을 초기화 해주면 되지 않나 싶어서 그렇게 구현 해보려고 한다. &lt;/p&gt;
&lt;h3&gt;언더바 또는 *가 포함된 경우 스타일 깨짐&lt;/h3&gt;
&lt;p&gt;예를 들어 &lt;em&gt;db&lt;/em&gt;connection_serializable 라고 입력된 텍스트가 &lt;em&gt;db&lt;/em&gt;connection&lt;em&gt;serializable&lt;/em&gt; 로 마음대로 스타일이 변경되고 있었다. 이를 예방하기 위해 일단 &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 언더스코어 이스케이프 처리 함수&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;escapeMarkdownUnderscores&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; text&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-source language-regex&quot;&gt;(\w)_(\w)&lt;/span&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-flags&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;$1\\_$2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 메소드를 사용해 언더바 앞에 백슬래시를 붙여주었다. &lt;/p&gt;
&lt;p&gt;잘 될지는 배포 후 테스트를 해봐야 한다. &lt;/p&gt;
&lt;h2&gt;신규 기능&lt;/h2&gt;
&lt;h3&gt;테이블 지원&lt;/h3&gt;
&lt;p&gt;이제 테이블을 지원한다.. 지금 고치느라 기록할 시간이 없는데 많은 것을 고쳤다.. &lt;/p&gt;
&lt;p&gt;근본적인 설계가 아쉽다. 굳이 block을 별도의 클래스로 뺄 필요도 없었을 것 같고, MarkdownConverter 클래스가 굳이 인스턴스 메소드가 이렇게 많아야 할 이유도 모르겠다. &lt;/p&gt;
&lt;p&gt;여유가 된다면 전체적으로 코드 리팩토링을 (다시 만드는 수준으로) 진행해야 할 것 같다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[PostgreSQL Advisory Locks 트랜잭션 레벨에서 구현]]></title><description><![CDATA[서론 동시성 제어 문제를 해결하기 위한 여러가지 방법을 고민 끝에 PostgreSQL Advisory Locks를 사용한 방법으로 구현하기로 했다.  구현을 하면서 겪은 과정을 여기에 기록한다.  구현 목표 현재 회사에서는 FastAPI…]]></description><link>https://sharknia.github.io/PostgreSQL-Advisory-Locks-트랜잭션-레벨에서-구현/</link><guid isPermaLink="false">https://sharknia.github.io/PostgreSQL-Advisory-Locks-트랜잭션-레벨에서-구현/</guid><pubDate>Tue, 30 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%A0%9C%EC%96%B4%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0&quot;&gt;동시성 제어 문제를 해결하기 위한 여러가지 방법을 고민&lt;/a&gt; 끝에 PostgreSQL Advisory Locks를 사용한 방법으로 구현하기로 했다. &lt;/p&gt;
&lt;p&gt;구현을 하면서 겪은 과정을 여기에 기록한다. &lt;/p&gt;
&lt;h2&gt;구현 목표&lt;/h2&gt;
&lt;p&gt;현재 회사에서는 FastAPI와 SqlAlchemy 2.0, PostgreSQL을 사용하고 있다. 아주 짧은 텀으로 중복으로 온 API 요청에 대해 중복 구매가 되지 않도록 동시성 제어를 하려고 한다. &lt;/p&gt;
&lt;p&gt;유저의 아이디 값 또는 API 고유의 값 + 유저의 아이디 값을 사용해 트랜잭션 레벨에서 PostgreSQL Advisory Locks를 생성하고, 동일한 유저가 PostgreSQL Advisory Locks에 걸린 경우에는 중복 요청이라고 판단하고 두번째 요청은 중단 하거나, 또는 반드시 유효성 검사를 하도록 해 중복 구매가 되는 일이 없게 사전에 차단하려고 한다. &lt;/p&gt;
&lt;h2&gt;구현 사전단계&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.postgresql.org/docs/9.1/functions-admin.html&quot;&gt;공식문서&lt;/a&gt;를 살펴보니 트랜잭션 레벨에서의 락을 위해 내가 사용할 수 있는 함수는 두 가지가 있었다. 트랜잭션 레벨의 락은 공통적으로 명시적인 언락이 불가능하다. &lt;/p&gt;
&lt;p&gt;아래의 두가지 함수는 모두 트랜잭션 레벨의 함수로 Advisory Lock을 획득할 수 있다는 점은 같지만, Advisory Lock을 바로 획득하지 못했을 때의 반응이 다르다. &lt;/p&gt;
&lt;h3&gt;pg_advisory_xact_lock&lt;/h3&gt;
&lt;p&gt;지정된 키에 대한 Advisory Lock을 획득할 때까지 호출을 블로킹(대기)한다. 만약 다른 세션이 이미 해당 키에 대한 Advisory Lock을 갖고 있다면 그 Advisory Lock이 해제될 때까지 현재 세션에서의 처리가 중단된다. &lt;/p&gt;
&lt;p&gt;Advisory Lock을 반드시 획득해야 해서 대기해야 할 경우에 적합하다.&lt;/p&gt;
&lt;h3&gt;pg_try_advisory_xact_lock&lt;/h3&gt;
&lt;p&gt;이 함수는 즉시 Advisory Lock을 시도하고 성공하면 True, 실패하면 False를 반환한다. 이 함수는 잠금 획득을 위해 대기하지 않으며, 잠금이 이미 다른 세션에 의해 보유되고 있는 경우 즉시 실패한다.&lt;/p&gt;
&lt;p&gt;Advisory Lock을 반드시 획득할 필요가 없고 대기하지 않고 다른 작업을 수행해야 할 경우에 적합하다. &lt;/p&gt;
&lt;h3&gt;결정&lt;/h3&gt;
&lt;p&gt;우리의 경우에는 쿠폰 중복 발급을 막으려고 하는 것이므로 만약 이미 잠금이 걸린 경우에는 굳이 나머지 DB 작업을 실행할 필요가 없다. 따라서 pg_try_advisory_xact_lock를 사용하는 것이 적절해보인다. &lt;/p&gt;
&lt;h2&gt;구현&lt;/h2&gt;
&lt;p&gt;따라서, 서비스 로직의 시작 지점에 다음의 코드를 넣어 락을 얻거나, 락을 얻지 못한 경우 해당 요청은 실행을 중단하려고 한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Advisory Lock 획득&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;SELECT pg_try_advisory_xact_lock(&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;lock&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Advisory Lock을 획득하지 못한 경우에는 이미 선제 작업이 있는 것이므로 DB 작업을 계속할 필요가 없으므로&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 바로 중단한다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; Exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Unable to acquire lock&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;SQL 인젝션과 같은 보안 문제를 줄이고 쿼리 구성과 관련된 오류를 예방하기 위해 다음과 같이 코드를 수정했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Advisory Lock 획득&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pg_try_advisory_xact_lock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lock&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Advisory Lock을 획득하지 못한 경우에는 이미 선제 작업이 있는 것이므로 DB 작업을 계속할 필요가 없으므로&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 바로 중단한다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; Exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Unable to acquire lock&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;잠금 해제 지점은 어떻게 될까?&lt;/h2&gt;
&lt;p&gt;막연히 트랜잭션이 커밋되거나 롤백될 때라고 알아둬도 충분할 것 같다(세션 주입 방식을 통해 에러가 발생하거나 요청이 정상정이 끝나지 않는 경우에 세션을 롤백하며, 정상적으로 요청이 정리된 경우에는 세션을 커밋하는 과정이 포함되어 있을 것이므로 충분할 것이다).&lt;/p&gt;
&lt;p&gt;다만, 트랜잭션 레벨에서의 락은 명시적으로 언락이 불가능하므로 정확한 언락 지점을 알아둬야 할 필요성이 있다고 느꼈다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;트랜잭션 커밋 또는 롤백&lt;/p&gt;
&lt;p&gt;함수 내부에서 명시적으로 await db.commit() 또는 await db.rollback()이 호출되는 경우에 같은 세션이라고 하더라도 언락된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;비동기 세션 컨텍스트 종료&lt;/p&gt;
&lt;p&gt;AsyncSession 인스턴스가 컨텍스트 매니저(async with) 내에서 사용되고, 해당 컨텍스트 블록이 종료되는 경우&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;예외 발생&lt;/p&gt;
&lt;p&gt;함수 실행 중 예외가 발생하여 처리 흐름이 중단되는 경우. SQLAlchemy의 세션 관리는 트랜잭션이 커밋되지 않으면 자동으로 롤백을 수행하므로 사실상 트랜잭션이 롤백되는 시점과 일치한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Sqlalchemy의 func]]></title><description><![CDATA[func란? SQL 함수를 생성하고 호출하는 데 사용되는 기능이다. SQL 표준 함수 뿐 아니라 데이터베이스 별 특정 함수까지 다룰 수 있다.  Sqlalchemy의 유연한 기능으로 다양한 데이터베이스 작업을 보다 Pythonic…]]></description><link>https://sharknia.github.io/Sqlalchemy의-func/</link><guid isPermaLink="false">https://sharknia.github.io/Sqlalchemy의-func/</guid><pubDate>Tue, 30 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;func란?&lt;/h2&gt;
&lt;p&gt;SQL 함수를 생성하고 호출하는 데 사용되는 기능이다. SQL 표준 함수 뿐 아니라 데이터베이스 별 특정 함수까지 다룰 수 있다. &lt;/p&gt;
&lt;p&gt;Sqlalchemy의 유연한 기능으로 다양한 데이터베이스 작업을 보다 Pythonic한 방식으로 작성할 수 있게 해준다. &lt;/p&gt;
&lt;h2&gt;func의 특징&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;함수 생성기&lt;/p&gt;
&lt;p&gt;func는 데이터베이스의 내장 함수나 사용자 정의 함수를 파이썬 코드 내에서 호출하기 위한 함수 생성기이다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;동적 생성&lt;/p&gt;
&lt;p&gt;func 객체에 접근할 때 Python의 속성 접근 매커니즘을 통해 동적으로 SQL 함수 호출을 생성한다. 예를 들어 func.count() 는 SQL의 COUNT() 함수 호출을 생성한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터베이스 독립성&lt;/p&gt;
&lt;p&gt;다양한 데이터베이스 시스템에서 사용할 수 있는 표준 SQL 함수를 추상화한다. 따라서 특정 데이터베이스에 종속적이지 않은 코드를 작성할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다양한 함수 지원&lt;/p&gt;
&lt;p&gt;func는 거의 모든 종류의 SQL 함수를 호출할 수 있도록 지원한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;code class=&quot;language-text&quot;&gt;__getattr__&lt;/code&gt; method&lt;/h2&gt;
&lt;p&gt;func 객체의 &lt;strong&gt;getattr&lt;/strong&gt; 메소드는 특정 속성에 접근할 때 호출된다. 이 메소드는 동적으로 SQL 함수 호출을 생성한다. &lt;/p&gt;
&lt;p&gt;예를 들어, func.pg&lt;em&gt;try&lt;/em&gt;advisory&lt;em&gt;lock에 접근하면 pg&lt;/em&gt;try&lt;em&gt;advisory&lt;/em&gt;lock 이름으로 _FunctionGenerator 객체를 생성한다. 이 객체는 최종적으로 SQL 쿼리 내에서 해당 함수 호출을 나타낸다. &lt;/p&gt;
&lt;h2&gt;사용방법&lt;/h2&gt;
&lt;h3&gt;기본 사용&lt;/h3&gt;
&lt;p&gt;함수 이름을 func 객체의 속성으로 접근하여 사용한다. (&lt;strong&gt;getattr&lt;/strong&gt; 메소드로 연결된다.)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; func

&lt;span class=&quot;token comment&quot;&gt;# COUNT 함수 호출 예시&lt;/span&gt;
query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;select_from&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_table&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;함수 매개변수 전달&lt;/h3&gt;
&lt;p&gt;함수 호출 시 매개변수를 전달할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# LENGTH 함수에 문자열 전달&lt;/span&gt;
query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;some string&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;복잡한 표현식&lt;/h3&gt;
&lt;p&gt;복잡한 SQL 표현식을 만드는 데도 사용할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 조건부 SQL 함수 호출&lt;/span&gt;
query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;coalesce&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;column&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;default value&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[동시성 제어문제 해결]]></title><description><![CDATA[문제 가~끔 네트워크 문제 때문인지 클라이언트에서 같은 요청이 0.0…]]></description><link>https://sharknia.github.io/동시성-제어문제-해결/</link><guid isPermaLink="false">https://sharknia.github.io/동시성-제어문제-해결/</guid><pubDate>Tue, 30 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;문제&lt;/h2&gt;
&lt;p&gt;가~끔 네트워크 문제 때문인지 클라이언트에서 같은 요청이 0.01초 미만의 간격으로 두 번씩 들어오는 경우가 있다. 사실상 요청이 동시에 들어오는 것과 같다. 대부분의 경우에는 문제가 되지 않지만, 쿠폰 구매 같은 민감한 요청에 대해서는 회사의 손해 또는 사용자의 불편과 예민하게 직결되므로 문제가 커질 수 있다. &lt;/p&gt;
&lt;p&gt;따라서 해당 문제를 완벽히 해결하고자 한다. &lt;/p&gt;
&lt;p&gt;현재 별다른 조치가 없는 상황에서 발생하는 문제 상황은 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;1번 요청과 2번 요청이 0.005초 차이이고(사실상 동시),

1번 요청 - 트랜잭션 시작
2번 요청 - 트랜잭션 시작
1번 요청 - 트랜잭션 완료, 커밋. 새로운 구매 내역이 테이블에 추가됨.
2번 요청 - 트랜잭션 완료, 커밋. 새로운 구매 내역이 테이블에 추가됨. 

따라서 동일한 유저가 두 번 쿠폰을 구매한 것 처럼 처리되었다. &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;제약조건 확인&lt;/h3&gt;
&lt;p&gt;현재 테이블의 키값이 user_id가 아니며, 난수 발생을 통해 생성된 값을 키 값으로 하고 있다. 또한 Redis와 같은 외부 라이브러리를 도입할 여유는 없다. 따라서 가능한 한 현재 시스템(Sqlalchemy, Postgresql)내에서 해결책을 찾고자 한다. &lt;/p&gt;
&lt;h2&gt;해결방안 고민&lt;/h2&gt;
&lt;h3&gt;최근 구매 내역 확인(기각)&lt;/h3&gt;
&lt;p&gt;가장 쉽게 생각할 수 있는 방법은 쿠폰 구매 로직에서 이 유저의 최근 구매 로직을 확인하는 것이다. 하지만 현재 이 상황에서는 사실상 요청이 동시에 들어오고 있으므로, 2번 요청이 시작됐을 때에는 해당 유저의 구매 내역이 아직 DB에 없을 것이므로, 이 방법은 사용할 수 없다. &lt;/p&gt;
&lt;h3&gt;Database-Level Optimistic Locking(기각)&lt;/h3&gt;
&lt;p&gt;각 트랜잭션에 버전 번호를 추가하고 트랜잭션이 커밋되기 전에 해당 버전 번호가 여전히 유효한지 확인한다. 하지만 이 방법도 여전히 2번 요청이 1번 요청의 결과를 감지하지 못할 수 있다. &lt;/p&gt;
&lt;h3&gt;Application-Level Locking(기각)&lt;/h3&gt;
&lt;p&gt;코드 내에서 직접 잠금 로직을 구현하는 방법이다. 데이터베이스가 아닌 애플리케이션의 메모리 내에서 잠금을 관리한다. 주로 멀티스레드 환경에서 특정 자원에 대한 동시 접근을 제어하는데 사용된다. 현재 FastAPI를 사용하고 있고, FastAPI는 기본적으로 비동기 방식으로 단일 스레드 환경에서 실행된다는 점을 고려하면 전통적인 스레드 기반의 잠금 매커니즘보다 async 라이브러리에 들어있는 비동기 프로그래밍에 적합한 잠금 메커니즘인 asyncio.Lock을 사용하는 것이 이상적이다.&lt;/p&gt;
&lt;h4&gt;FastAPI에서의 Application-Level Locking&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

locks &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;purchase_coupon&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    lock &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; locks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setdefault&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Lock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; lock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 여기에 쿠폰 구매 로직을 구현합니다.&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 이 블록 내의 코드는 동시에 하나의 요청만 처리합니다.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# FastAPI 엔드포인트에서 이 함수를 호출합니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드는 user_id에 대해 별도의 asyncio.Lock을 생성하고 관리한다. 해당 user_id에 대한 작업이 진행중인 경우 다른 요청들은 해당 블록이 해제될 때까지 대기한다. &lt;/p&gt;
&lt;p&gt;예를 들어 다음 코드를 가정하자. 예를 들기 위해 아주 러프하게 작성했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    lock &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; locks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setdefault&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Lock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; lock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드는 다음과 같이 호출된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;test_function(1, 2) 호출 -&gt; a 값이 1인 잠금 획득 -&gt; 처리 시작
test_function(1, 2) 호출 -&gt; a 값이 1인 동일한 잠금으로 인해 대기
test_function(2, 2) 호출 -&gt; a 값이 2인 새로운 잠금 획득 -&gt; 처리 시작
test_function(2, 2) 처리 완료 -&gt; a 값이 2인 잠금 해제
test_function(1, 2)의 첫 번째 호출 처리 완료 -&gt; a 값이 1인 잠금 해제
test_function(1, 2)의 두 번째 호출이 대기 상태에서 해제 -&gt; 처리 시작

따라서 print는 1, 2, 1의 순서가 된다. &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다만, 비동기 프로그래밍, 특히 Python의 &lt;a href=&quot;https://sharknia.github.io/FastAPI%EC%99%80-asyncio&quot;&gt;asyncio&lt;/a&gt;를 사용할 때 코드의 실행순서는 이벤트 루프에 의해 관리된다. 작업의 일시 중단과 다른 작업의 실행이 이벤트 루프에 의해 어떻게 스케줄링 될지는 여러 요인에 따라 달라질 수 있다. &lt;/p&gt;
&lt;h3&gt;PostgreSQL Advisory Locks(당장 채용)&lt;/h3&gt;
&lt;p&gt;Advisory Locks는 애플리케이션에서 데이터베이스 레벨의 잠금을 관리할 수 있도록 해준다. 이를 통해 특정 user_id 에 대한 동시 요청을 제어할 수 있다. &lt;/p&gt;
&lt;p&gt;Advisory Locks는 테이블이나 행에 대한 접근을 잠그는 개념이 아니다. 특정 값 (정수)에 대한 잠금을 제공한다. 즉, 작업 자체에 1번이라는 이름을 붙이고 1번을 잠근다면, 다시 요청되는 1번 작업은 잠금이 된다. &lt;/p&gt;
&lt;h4&gt;&lt;strong&gt;Advisory Locks의 작동 방식&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;잠금 설정 : 애플리케이션이 pg_advisory_lock(key) 함수를 호출하여 특정 키에 대한 잠금을 요청한다.&lt;/li&gt;
&lt;li&gt;동일 키 사용 시 대기 : 같은 키를 사용하는 다른 데이터베이스 작업이 잠금을 보유하고 있다면, 새로운 잠금 요청은 해당 잠금이 해제될 때까지 대기한다. &lt;/li&gt;
&lt;li&gt;잠금 해제 : 원래의 작업이 완료되면 pg_advisory_unlock(key) 함수를 호출하여 잠금을 해제한다. 이후 대기 중이던 다른 작업이 잠금을 획득하고 진행될 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;&lt;strong&gt;Advisory Locks의 잠금 레벨&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;Advisory Locks는 두 가지 레벨에서 사용할 수 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;세션 레벨 : 이 잠금은 데이터베이스 세션과 연결되어있다. 세션이 종료되면 자동으로 해제된다. 세션 레벨 잠금은 장시간 유지되어야 하는 경우에 유용하다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;use_session_level_lock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lock_key&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 세션 레벨 잠금 획득&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;SELECT pg_advisory_lock(&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;lock_key&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 데이터베이스 작업 수행&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 필요한 경우, 명시적으로 잠금 해제&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# await db.execute(f&quot;SELECT pg_advisory_unlock({lock_key})&quot;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 세션 종료 시 잠금이 자동으로 해제됩니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;트랜잭션 레벨 잠금 : 트랜잭션 레벨 잠금은 현재 트랜잭션과 연결되어 있으며 트랜잭션이 커밋되거나 롤백 될 때 자동으로 해제된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; AsyncSession

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;use_transaction_level_lock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lock_key&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;begin&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 트랜잭션 레벨 잠금 획득&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;SELECT pg_advisory_xact_lock(&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;lock_key&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# 데이터베이스 작업 수행&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 트랜잭션이 종료되면 잠금이 자동으로 해제됩니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;쿠폰 구매 서비스 로직에서 트랜잭션 시작 전에  user_id를 기반으로 Advisory Lock을 요청하면 1번 요청이 처리되는 동안 동일한 user_id 에 대한 다른 요청은 대기하게 된다. 쿠폰 구매 처리가 완료되면, Advisory Lock을 해제하면 된다. &lt;/p&gt;
&lt;h2&gt;결론 - PostgreSQL Advisory Locks 채용&lt;/h2&gt;
&lt;p&gt;이 방법을 사용하면 매우 짧은 간격의 요청도 효과적으로 처리할 수 있다. 특히 트랜잭션 레벨의 잠금은 각 트랜잭션이 커밋되거나 롤백될 때까지만 유지되므로 0.005초와 같은 짧은 간격의 요청을 동기화하는데 매우 적합하다. &lt;/p&gt;
&lt;p&gt;백엔드 팀에서 협의를 거쳐 해당 방법을 사용해 구현하기로 최종 결정하였다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(6)]]></title><description><![CDATA[기능 구현이 거의 다 되었기 때문에, 오늘은 일단 짜잘짜잘한 오류 수정을 진행했다.  유지보수 내역 Front Matter-프로퍼티 연계 수정 프로퍼티가 Front Matter…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅6/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅6/</guid><pubDate>Mon, 29 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;기능 구현이 거의 다 되었기 때문에, 오늘은 일단 짜잘짜잘한 오류 수정을 진행했다. &lt;/p&gt;
&lt;h2&gt;유지보수 내역&lt;/h2&gt;
&lt;h3&gt;Front Matter-프로퍼티 연계 수정&lt;/h3&gt;
&lt;p&gt;프로퍼티가 Front Matter에 추가되는데, 값이 빈 것도 추가되어서 제대로 필터링 되지 않는 문제가 있었다. 값이 존재하는 프로퍼티만 Front Matter에 추가되도록 수정해주었다. &lt;/p&gt;
&lt;p&gt;추가로, 프로퍼티가 고정값이 아니라 커스텀에 따라서 유연하게 대응해 Front Matter에 추가되도록 해주었다. &lt;/p&gt;
&lt;h3&gt;줄바꿈 주의!&lt;/h3&gt;
&lt;p&gt;마크다운은 기본적으로 엔터를 두 번씩 쳐야 줄바꿈이 되는 모양이다. 리스트 컨버터 일부에 줄바꿈이 하나만 들어가있던 것을 두 개가 들어가도록 수정해주었다. &lt;/p&gt;
&lt;h3&gt;이미지 다운로드 안되는 현상&lt;/h3&gt;
&lt;p&gt;분명 동기적으로 작동하게끔 짜놓았는데도 불구하고 이미지가 제대로 들어가지 않는 현상이 있었다.  axios 재시도 패키지를 설치하고, 재시도 로직을 추가하고 타임아웃 10초 설정도 해주었다. 뭐가 문제였는지는 정확히 파악이 안됐는데, (오류 로그조차 없었다) 일단 이 이후로는 이미지 다운로드에 실패하는 현상은 없다. &lt;/p&gt;
&lt;p&gt;추가로, 이미지 다운로드 시에도 디렉토리가 없다면 만들도록 해주었다. &lt;/p&gt;
&lt;h3&gt;스타일이 두 개 적용된 경우&lt;/h3&gt;
&lt;p&gt;스타일이 두 개가 적용된 경우는 더 띄어쓰기에 민감했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;*~~안녕하세요 ~~*&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;처럼 애매하게 띄어쓰기가 들어가면 하나만 적용된다. &lt;/p&gt;
&lt;p&gt;그래서 스타일이 있는 경우에는 공백을 제거 한 후에, 스타일을 붙이고 다시 스타일 뒤로 공백을 붙여서 자연스럽게 포맷이 유지되도록 수정해주었다. &lt;/p&gt;
&lt;h3&gt;ImageCounter 변수 수정&lt;/h3&gt;
&lt;p&gt;이미지가 디렉토리가 변경되어도 숫자가 계속 늘어나는 현상을 겪었는데… 멍청하게 내가 이미지 카운터를 static 변수로 선언해서 모든 인스턴스가 값을 공유하고 있는 것 뿐이었다. 바로 인스턴스 변수로 변경 해주었다. &lt;/p&gt;
&lt;h3&gt;멘션 링크 이후 줄바꿈 문제 해결&lt;/h3&gt;
&lt;p&gt;멘션 링크를 북마크로 바꿔주는 메소드에 줄바꿈이 고정되어있어서, paragraph 안에 들어가 있는 멘션의 경우에도 줄바꿈이 들어가버렸다. 번거롭지만, 메소드를 수정해서 리스트로 처리되는 경우에만 줄바꿈이 들어가도록 수정해주었다. &lt;/p&gt;
&lt;h3&gt;notion url만 주어지는 경우&lt;/h3&gt;
&lt;p&gt;노션의 페이지 링크를 따온 다음에, 아무 글자 또는 문장을 드래그 하고 붙여넣기 하면 해당 글자 또는 문장에 페이지 링크로 연결되는 북마크가 생성된다. &lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 382px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/0981c6ff94ee6b99478b05d66508c51e/29984/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAVElEQVR42k2NSw4AIQhDvYZr/KGB+9+OySPRzKJpSwuUOWe4e5hZnHOS996x1koPA1VNTxfdWksPuDHGiFprFBHJISWCyyyge+9v4f/k5ngyehz8AHh4OntOXZx1AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;이렇게, 이 하이퍼링크는 노션 내부의 모 페이지로 연결된다. /xxxx… 만의 주소를 갖고 있다. &apos; title=&apos;&apos; src=&apos;/static/0981c6ff94ee6b99478b05d66508c51e/29984/image1.png&apos; srcset=&apos;/static/0981c6ff94ee6b99478b05d66508c51e/e7570/image1.png 170w,
/static/0981c6ff94ee6b99478b05d66508c51e/f46e7/image1.png 340w,
/static/0981c6ff94ee6b99478b05d66508c51e/29984/image1.png 382w&apos; sizes=&apos;(max-width: 382px) 100vw, 382px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;이렇게, 이 하이퍼링크는 노션 내부의 모 페이지로 연결된다. /xxxx… 만의 주소를 갖고 있다. &lt;/figcaption&gt;
  &lt;/figure&gt;
근데 애석하게도 이 링크는 단순히 32자리 문자열만 가지고 있다. (페이지의 아이디가 아니다). 따라서 해당 경우에는 북마크를 연결할 수가 없었다… &lt;/p&gt;
&lt;p&gt;인 줄 알았는데, 32자리인게 이상해서 혹시나 해서 UUID 형식으로 변환해봤더니 그게 내부 페이지의 아이디였다. 그러니까, 각 블록의 아이디가 UUID로 주어지는데 거기에서 하이픈만 제외하고 내부 URL로 사용중이었던 것이다. &lt;/p&gt;
&lt;p&gt;얼씨구나~ 하고 바로 해당 케이스도 북마크 기능으로 연결해주었다. &lt;/p&gt;
&lt;h3&gt;URL 형식 변경&lt;/h3&gt;
&lt;p&gt;예를 들어 &lt;code class=&quot;language-text&quot;&gt;노션 소개 페이지&lt;/code&gt; 라는 타이틀을 &lt;code class=&quot;language-text&quot;&gt;노션소개페이지&lt;/code&gt; 로 변환해서 URL로 사용하고 있었는데, 공백을 완전히 제거하는 대신 하이픈을 넣도록 수정해주었다. &lt;/p&gt;
&lt;h2&gt;다음 단계는?&lt;/h2&gt;
&lt;p&gt;이제 다음 단계는 자동화가 목적이다. 어느정도 기능 구현은 90프로 이상 됐다고 생각하고, 당장 내가 블로그 글을 쓰는데 큰 문제가 없어보인다. 이제 github.io와 합쳐서 실질적인 사용이 가능하도록 해보려고 한다!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Sqlalchemy에서의 트랜잭션 격리 수준 구현]]></title><description><![CDATA[구현 목적 상품 구매에 관련된 API를 구현하려고 한다. DynamoDB를 사용할 때에 동시성 이슈로 쿠폰 중복 구매 이슈가 있었으므로 이번에 RDS…]]></description><link>https://sharknia.github.io/Sqlalchemy에서의-트랜잭션-격리-수준-구현/</link><guid isPermaLink="false">https://sharknia.github.io/Sqlalchemy에서의-트랜잭션-격리-수준-구현/</guid><pubDate>Mon, 29 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;구현 목적&lt;/h2&gt;
&lt;p&gt;상품 구매에 관련된 API를 구현하려고 한다. DynamoDB를 사용할 때에 동시성 이슈로 쿠폰 중복 구매 이슈가 있었으므로 이번에 RDS로 옮긴 김에 해당 문제를 완벽하게 해결하기 위해 다각도로 방법을 고민했다. &lt;/p&gt;
&lt;p&gt;그 방안 중 하나가 &lt;a href=&quot;https://sharknia.github.io/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80Transaction-Isolation-Level&quot;&gt;트랜잭션 격리 수준(Transaction Isolation Level)&lt;/a&gt; 을 이용한 것이다. &lt;/p&gt;
&lt;p&gt;SqlAlchemy - Postgresql을 사용하고 있는데, 이 라이브러리에서 트랜잭션 격리 수준을 어떻게 구현했는지 기록한다. &lt;/p&gt;
&lt;h2&gt;현재&lt;/h2&gt;
&lt;p&gt;현재에는 기본 격리 수준을 사용한(별다른 옵션값이 없는) 엔진만 사용하고 있다. API 별로 별도의 세션을 사용하기 위해 의존성 주입 방식을 사용하며, 이를 위해 &lt;code class=&quot;language-text&quot;&gt;AsyncIterable[AsyncSession]&lt;/code&gt;을 생성한다. 대략적인 코드는 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;_db_connection&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncEngine

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;on_startup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    _db_connection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_async_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        DATABASE_URL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        pool_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pool_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        max_overflow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;max_overflow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        echo&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;echo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_connection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncEngine&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; _db_connection &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; _db_connection

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    db_conn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncEngine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;get_db_connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncIterable&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; sessionmaker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            db_conn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            class_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            expire_on_commit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; session
    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[get_db_session] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 각 API의 엔드포인트에서 get&lt;em&gt;db&lt;/em&gt;session을 주입받아 사용한다. &lt;/p&gt;
&lt;p&gt;이 엔진은 기본적으로 Read Committed 격리수준만 지원한다. &lt;/p&gt;
&lt;h2&gt;모험&lt;/h2&gt;
&lt;h3&gt;sessionmaker 레벨에서 트랜잭션 격리 수준 설정?&lt;/h3&gt;
&lt;p&gt;이렇게 내용이 조금만 깊어져도 챗지피티는 믿을 놈이 못된다. 챗지피티에서는 sessionmaker 레벨에서 트랜잭션 격리 수준 설정이 가능하다며, sessionmaker의 매개변수에 &lt;code class=&quot;language-text&quot;&gt;isolation_level=&quot;SERIALIZABLE”&lt;/code&gt; 를 추가해주면 된다고 주장한다. &lt;/p&gt;
&lt;p&gt;하지만 sessionmaker의 생성자에는 &lt;code class=&quot;language-text&quot;&gt;isolation_level&lt;/code&gt; 매개 변수가 없어 해당 설정은 바로 오류를 낸다. 이럴 경우 답은 스스로 해결하는 것 밖에 없다. &lt;/p&gt;
&lt;h3&gt;트랜잭션 별 엔진 별도 생성?&lt;/h3&gt;
&lt;p&gt;첫 구현은 단순하게 생각해서 엔진을 여러개를 만들었다. 즉, &lt;code class=&quot;language-text&quot;&gt;isolation_level&lt;/code&gt; 옵션을 각각 다르게 준create&lt;em&gt;async&lt;/em&gt;engine을 여러번 하는 것이다. 이러면 간단하게 해결이 된다. 하지만 이렇게 할 경우에는 문제가 있다. 각각의 엔진이 모두 별도의 풀을 생성하면서 의도치 않게 커넥션이 증가할 위험이 있는 것이다. 안그래도 &lt;a href=&quot;https://sharknia.github.io/SqlAlchemy%EC%9D%98-QueuePool&quot;&gt;SqlAlchemy의 QueuePool&lt;/a&gt; 를 겪었었기 때문에 해당 이슈는 꼭 피하고 싶었다. &lt;/p&gt;
&lt;h2&gt;개선(해결)&lt;/h2&gt;
&lt;p&gt;코드를 짜다보면 “이건 있어야 하는데?”라고 느낄때가 있다. 그런것들은 대부분, 너무 미완성인 라이브러리나 프레임워크가 아니라면 반드시 나온다. 구현 가능한데 필요성을 느끼는 것은 반드시 누군가 만들어둔 것이다. &lt;/p&gt;
&lt;p&gt;명확하게 다른 엔진이면서 풀을 공유하는 방법이 존재한다. &lt;code class=&quot;language-text&quot;&gt;execution_options()&lt;/code&gt; 를 사용하면 된다. &lt;/p&gt;
&lt;h3&gt;execution_options()&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;AsyncEngine&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;execution_options()&lt;/code&gt; 메소드를 사용하면 반환되는 엔진도 &lt;code class=&quot;language-text&quot;&gt;AsyncEngine&lt;/code&gt; 타입이 된다. 이 메소드는 Engine, Connection, Session 객체에서도 사용할 수 있으며, 특정 실행 옵션을 동적으로 설정하거나 변경하기 위해 사용된다. &lt;/p&gt;
&lt;p&gt;이 메소드를 사용하면 동일한 연결 풀을 공유하면서도 다른 실행 옵션을 가진 엔진을 생성할 수 있다. &lt;/p&gt;
&lt;p&gt;개선된 코드는 다음과 같다. &lt;/p&gt;
&lt;p&gt;&lt;em&gt;db&lt;/em&gt;connection 설정 후, &lt;em&gt;db&lt;/em&gt;connection&lt;em&gt;serializable를 `execution&lt;/em&gt;options()` 를 사용해 정의한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;_db_connection_serializable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; _db_connection&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execution_options&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        isolation_level&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SERIALIZABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 값을 사용한 의존성 주입용 메소드를 선언한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_connection_serializable&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncEngine&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; _db_connection_serializable &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; _db_connection_serializable

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_serializable_db_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    db_conn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncEngine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;get_db_connection_serializable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncIterable&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; sessionmaker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            db_conn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            class_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            expire_on_commit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; session
    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[get_serializable_db_session] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 엔드포인트에서 기존 get&lt;em&gt;db&lt;/em&gt;session 대신 이 메소드를 사용하면 다른 옵션의 격리 레벨을 사용할 수 있다!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[트랜잭션 격리 수준(Transaction Isolation Level)]]></title><description><![CDATA[트랜잭션 격리 수준(Transaction Isolation Level…]]></description><link>https://sharknia.github.io/트랜잭션-격리-수준Transaction-Isolation-Level/</link><guid isPermaLink="false">https://sharknia.github.io/트랜잭션-격리-수준Transaction-Isolation-Level/</guid><pubDate>Mon, 29 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;트랜잭션 격리 수준(Transaction Isolation Level)이란?&lt;/h2&gt;
&lt;p&gt;트랜잭션 격리 수준은 데이터베이스 시스템에서 동시에 여러 트랜잭션이 실행될 때, 트랜잭션 간에 데이터를 어떻게 고립시킬지를 결정하는 설정이다. 이 설정은 트랜잭션이 다른 트랜잭션의 작업에 영향을 받지 않도록 보장하는 동시에 여러 트랜잭션이 데이터베이스의 동일한 데이터에 접근할 때 발생하는 문제들을 관리하는데 중요한 역할을 한다. &lt;/p&gt;
&lt;p&gt;격리 수준이 높을 수록 트랜잭션 간의 고립 정도가 증가하지만, 그만큼 데이터베이스의 처리량(throughput)과 동시성(concurrency)이 감소할 수 있다. 반대로 격리 수준이 낮으면 처리량과 동시성은 증가하지만 데이터 무결성 문제가 발생할 위험이 높아진다. 따라서 적절한 격리 수준을 선택해야 한다. &lt;/p&gt;
&lt;p&gt;데이터베이스의 동일한 데이터에 접근할 때 발생할 수 있는 문제들은 다음과 같다. &lt;/p&gt;
&lt;h3&gt;Dirty Read&lt;/h3&gt;
&lt;p&gt;한 트랜잭션이 아직 커밋되지 않은 데이터를 읽는 경우&lt;/p&gt;
&lt;h3&gt;Non-repeatable Read&lt;/h3&gt;
&lt;p&gt;한 트랜잭션이 동일한 쿼리를 여러 번 실행할 떄마다 다른 결과를 얻는 경우. 이는 다른 트랜잭션이 데이터를 변경하거나 삭제했기 때문이다. &lt;/p&gt;
&lt;h3&gt;Phantom Read&lt;/h3&gt;
&lt;p&gt;한 트랜잭션이 동일한 쿼리를 여러 번 실행할 때, 새로 삽입된 행이 결과에 나타나는 현상이다. &lt;/p&gt;
&lt;h3&gt;Serialization Anomaly&lt;/h3&gt;
&lt;p&gt;트랜잭션들이 서로 다른 순서로 실행될 때 발생할 수 있는 일관성 없는 결과를 말한다. &lt;/p&gt;
&lt;h2&gt;격리 수준의 종류&lt;/h2&gt;
&lt;p&gt;각 데이터베이스 시스템은 아래의 격리 수준을 제공하며, 이는 ANSI SQL 표준에 의해 정의된다. &lt;/p&gt;
&lt;h3&gt;Read Uncommitted&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;가장 낮은 격리 수준이다. &lt;/li&gt;
&lt;li&gt;다른 트랜잭션에서 아직 커밋되지 않은 변경 사항을 조회할 수 있다. (Dirty Read)&lt;/li&gt;
&lt;li&gt;Postgreql에서는 구현되지 있지 않아 Read Committed로 자동 처리된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;p&gt;높은 동시성과 성능을 보여준다. &lt;/p&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;p&gt;데이터 무결성 문제가 발생할 수 있다. &lt;/p&gt;
&lt;h4&gt;고려사항&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;데이터의 정확성보다 동시성이 중요한 경우에 고려될 수 있으나, 일반적으로 권장되지 않는다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Read Committed&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;각 쿼리가 실행될 때 커밋된 데이터만 읽는다. &lt;/li&gt;
&lt;li&gt;다른 트랜잭션에서 커밋된 변경 사항을 쿼리 시점에 볼 수 있다. (Non-repeatable Read이 발생할 수 있다. )&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;p&gt;적당한 수준의 동시성과 성능을 보여준다. &lt;/p&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;p&gt;같은 트랜잭션 내에서 같은 데이터를 두 번 읽을 때 다른 결과가 나올 수 있다. &lt;/p&gt;
&lt;h4&gt;고려사항&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;일반적인 응용 프로그램에서 광범위하게 사용된다. &lt;/li&gt;
&lt;li&gt;대부분의 경우에 적합한 격리 수준이다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Repeatable Read&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;트랜잭션이 시작될 때의 데이터 상태를 유지한다. &lt;/li&gt;
&lt;li&gt;트랜잭션 중에 다른 트랜잭션이 커밋한 변경 사항이 보이지 않음(Phantom Read이 발생할 수 있다.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;p&gt;하나의 트랜잭션 내에서 일관된 조회 결과를 보장한다. &lt;/p&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;p&gt;트랜잭션이 길어질수록 다른 트랜잭션과의 충돌 가능성이 증가한다. &lt;/p&gt;
&lt;h4&gt;고려사항&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;일관된 데이터 읽기가 필요할 때 사용한다. &lt;/li&gt;
&lt;li&gt;데이터 무결정이 중요한 경우 적합하지만, 긴 트랜잭션은 피해야 한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Serializable&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;데이터베이스 트랜잭션에서 가장 높은 격리 수준이다. &lt;/li&gt;
&lt;li&gt;트랜잭션이 서로 독립적으로 작동하며, 동시에 여러 트랜잭션이 수행되는 경우에도 하나의 트랜잭션이 완료된 것 처럼 작동한다. &lt;/li&gt;
&lt;li&gt;다른 트랜잭션이 동시에 같은 데이터를 수정하지 못하도록 하여 데이터의 일관성을 보장한다. &lt;/li&gt;
&lt;li&gt;하나의 트랜잭션 동안 새로 삽입되거나 삭제된 행이 다른 트랜잭션에 의해 보이지 않도록 해서 Phantom Read를 방지한다. &lt;/li&gt;
&lt;li&gt;각 트랜잭션이 독립적인 환경에서 실행되며 다른 트랜잭션의 중간 결과를 볼 수 없다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;p&gt;높은 수준의 데이터 무결성을 제공한다. 데이터베이스 내의 데이터는 모든 트랜잭션에 대해 완전히 일관된 상태를 유지한다. &lt;/p&gt;
&lt;p&gt;따라서 동시성 문제도 최소화된다. 동시에 여러 트랜잭션이 실행되는 환경에서 발생할 수 있는 대부분의 동시성 문제를 예방한다. &lt;/p&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;p&gt;트랜잭션의 격리 수준이 높을 수록 데이터베이스의 처리량이 감소할 수 있다. 락 경합(lock contention)이 증가하고, 이는 성능저하로 이어질 가능성이 높다. &lt;/p&gt;
&lt;p&gt;서로 다른 트랜잭션이 같은 자원을 기다리는 상황이 발생할 수 있으며, 이는 데드락으로 이어질 수 있다. &lt;/p&gt;
&lt;h4&gt;고려사항&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;데이터 무결성이 중요한 경우에 적합하지만 성능상의 영향을 고려해야 한다. &lt;/li&gt;
&lt;li&gt;데드락을 방지하기 위해 트랜잭션 설계 시 주의가 필요하다. &lt;/li&gt;
&lt;li&gt;읽기만 수행하는 트랜잭션의 경우 더 낮은 격리 수준을 고려하는 것이 성능상 이점이 있을 수 있다. &lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(5)]]></title><description><![CDATA[열정 추가로 더 진행해버렸다. 정말로 여기까지만 하려고 한다. 오랜만에 탄력 받으니 계속 하게 되어버렸다.  구현 내용 콜아웃, 디바이더, 인용문, 코드, 번호 매기기 , 글머리 기호 목록 컨버터를 추가했다.  콜아웃, 디바이더 html…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅5/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅5/</guid><pubDate>Sun, 28 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;열정&lt;/h2&gt;
&lt;p&gt;추가로 더 진행해버렸다. 정말로 여기까지만 하려고 한다. 오랜만에 탄력 받으니 계속 하게 되어버렸다. &lt;/p&gt;
&lt;h2&gt;구현 내용&lt;/h2&gt;
&lt;p&gt;콜아웃, 디바이더, 인용문, 코드, 번호 매기기 , 글머리 기호 목록 컨버터를 추가했다. &lt;/p&gt;
&lt;h3&gt;콜아웃, 디바이더&lt;/h3&gt;
&lt;p&gt;html로 구현했다. 인용문은 hr 태그로 처리했으며, 콜아웃은 div 태그를 사용했다. 다만 콜아웃은 스타일 처리가 필요하다. 지금은 대충 태그만 만들어놨다. 따라서 이건 미완성이나 다름없다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertCallout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;calloutBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calloutBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; icon &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calloutBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;icon &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; calloutBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;icon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;emoji &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; color &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calloutBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color
            &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; calloutBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color
            &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;gray_background&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;
    &amp;lt;div class=&quot;callout &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;color&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;icon&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &amp;lt;span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/span&gt;
    &amp;lt;/div&gt;\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertDivider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;hr style=&quot;border: none; height: 1px; background-color: #e0e0e0; margin: 16px 0;&quot; /&gt;\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;인용문&lt;/h3&gt;
&lt;p&gt;인용문은 있을 줄 몰랐는데, 마크다운에서 지원을 해서 쉽게 구현했다. &lt;/p&gt;
&lt;p&gt;무엇은 지원하고 무엇은 지원안하고, 기준을 명확히 모르겠긴하다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertQuote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;quoteBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; quoteText &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; quoteBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&gt; &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;quoteText&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;번호 매기기, 글머리 기호&lt;/h3&gt;
&lt;p&gt;둘은 구현이 상당히 비슷했다. 마치 세트와 같다. 이걸 구현할 때에, 들여쓰기를 하려면 계층 개념이 필요해서 전체적인 코드 수정이 한 번 이뤄졌다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;formatListItemContent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;listItemBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; listItemBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertNumberedList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;listItemBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; listItemContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatListItemContent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;listItemBlock&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; indent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;indentLevel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;indent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;1. &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;listItemContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertBulletedList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;listItemBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; listItemContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatListItemContent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;listItemBlock&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; indent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;indentLevel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;indent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;- &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;listItemContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;띄어쓰기 네 번으로 계층을 구분한다. &lt;/p&gt;
&lt;h3&gt;코드&lt;/h3&gt;
&lt;p&gt;코드도 쉬웠다. 마크다운에서 지원하는 것은 기본적으로 구현이 쉽다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;codeBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; codeText &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; codeBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plain_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; language &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; codeBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;language &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\`\`\`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;language&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;codeText&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n\`\`\`\n\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;to_do&lt;/h3&gt;
&lt;p&gt;to_do도 간단하게 구현했다. 마크다운에서는 체크박스인데, 노션에서는 할 일 목록이다.. 그래서 체크박스를 체크하면 스타일이 추가되는데.. 이것까진 따로 구현하지 않았다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertToDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toDoBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; quoteText &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; toDoBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; pre &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;- [ ]&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toDoBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;checked &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            pre &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;- [x]&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pre&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;quoteText&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;h3&gt;작업 완료 블록&lt;/h3&gt;
&lt;p&gt;일단 1차적으로 작업이 완료되었으며, 완료된 지원하는 블록 타입은 다음과 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;paragraph&lt;/li&gt;
&lt;li&gt;heading&lt;em&gt;1, heading&lt;/em&gt;2, heading_3&lt;/li&gt;
&lt;li&gt;bookmark&lt;/li&gt;
&lt;li&gt;link&lt;em&gt;to&lt;/em&gt;page&lt;/li&gt;
&lt;li&gt;image&lt;/li&gt;
&lt;li&gt;callout&lt;/li&gt;
&lt;li&gt;divider&lt;/li&gt;
&lt;li&gt;quote&lt;/li&gt;
&lt;li&gt;code&lt;/li&gt;
&lt;li&gt;numbered&lt;em&gt;list&lt;/em&gt;item&lt;/li&gt;
&lt;li&gt;bulleted&lt;em&gt;list&lt;/em&gt;item&lt;/li&gt;
&lt;li&gt;to_do&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;작업 예정 블록&lt;/h3&gt;
&lt;h4&gt;table, table-row&lt;/h4&gt;
&lt;p&gt;꼭 필요해보이지만, 구현을 위해서는 현재 구현된 블록의 재귀 호출 구조를 바꿔야 한다. 상대적으로 까다로워 오늘 작업하진 않겠다. &lt;/p&gt;
&lt;h3&gt;작업 미정 블록&lt;/h3&gt;
&lt;h4&gt;column (n개의 열로 구성된 블록 생성)&lt;/h4&gt;
&lt;p&gt;가로로 여러 블록을 놓는 기능이다. 굳이 필요한가? 싶기도 하고 또 구현이 꽤나 까다로워 보인다. 다만 table, table-row를 작업할 때에 호출 구조를 잘 짜놓는다면 또 별 노력 없이 잘 될 것 같기도 한데, 마크다운에 원래 가로를 나누는 기능이 있는지는 또 모르겠다. 그래서 미정이다. &lt;/p&gt;
&lt;h4&gt;미디어 관련 블록&lt;/h4&gt;
&lt;p&gt;미디어 관련 기능도 지금보니 노션에 있다. 이건.. 할만하지 않을까? 고려해보겠다. 아직 자세히 살펴보지 못했다. &lt;/p&gt;
&lt;h3&gt;미구현 확정 블록&lt;/h3&gt;
&lt;h4&gt;토글&lt;/h4&gt;
&lt;p&gt;토글은 미구현 확정이다. 토글은 마크다운에서 지원하지 않고, 만약 하려면 부트스트랩의 collapse 같은 기능을 직접 구현해야 할 것 같다. 이건 쉽지 않다. &lt;/p&gt;
&lt;h4&gt;임베드 관련 블록&lt;/h4&gt;
&lt;p&gt;기각이다. 블로그 글에 임베드는 쓰지 말자. &lt;/p&gt;
&lt;h4&gt;고급 블록&lt;/h4&gt;
&lt;p&gt;지금보니 토글도 고급에 들어있다. 마크다운 기본 기능이 아닌 것들은 기본적으로 구현에 한계가 있다. 다시 보니 column도 고급에 있다. &lt;/p&gt;
&lt;p&gt;나중에 추후 시간이 되면 만들만한 것들은 한 번 고려해보겠다. &lt;/p&gt;
&lt;h4&gt;데이터베이스 관련 블록&lt;/h4&gt;
&lt;p&gt;웹사이트에 넣을 수 있는 기능이 (아마도) 아니다. 기각이다. &lt;/p&gt;
&lt;h2&gt;다음 작업 예정은?&lt;/h2&gt;
&lt;p&gt;이제 배포 자동화를 목표로 해야 한다. 자동화까지 해둬야, 이 프로젝트를 만든 목적 달성이 아닐까? 얼른 자동화도 하고 싶다..&lt;/p&gt;
&lt;p&gt;자동화의 자세한 로직은 다음번에 설계 하도록 하겠다.. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Union Type]]></title><description><![CDATA[타입스크립트의 Union Type 타입스크립트에는 유니언 타입이라는게 있다. 쉽게 말해 값이 여러 타입을 or…]]></description><link>https://sharknia.github.io/Union-Type/</link><guid isPermaLink="false">https://sharknia.github.io/Union-Type/</guid><pubDate>Sun, 28 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;타입스크립트의 Union Type&lt;/h2&gt;
&lt;p&gt;타입스크립트에는 유니언 타입이라는게 있다. 쉽게 말해 값이 여러 타입을 or 로 가질 수 있는 것이다. &lt;del&gt;&lt;em&gt;막나간다.&lt;/em&gt;&lt;/del&gt; &lt;/p&gt;
&lt;p&gt;두 개의 이상의 타입을 &lt;code class=&quot;language-text&quot;&gt;|&lt;/code&gt; 기호를 사용해 결합하면 유니언 타입이 된다. 이를 통해 변수가 함수 매개변수가 여러 타입 중 하나의 타입을 가질 수 있음을 나타낼 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StringOrNumber&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; StringOrNumber&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 유효함&lt;/span&gt;
value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;// 유효함&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;장점&lt;/h3&gt;
&lt;h4&gt;유연성&lt;/h4&gt;
&lt;p&gt;다양한 타입을 하나의 변수에 할당할 수 있어 다양한 시나리오에 대응할 수 있다. &lt;/p&gt;
&lt;h4&gt;타입 안정성 보장&lt;/h4&gt;
&lt;p&gt;유니언 타입을 사용하면 타입스크립트 컴파일러가 타입 안정성을 체크해준다. 즉, 할당된 값이 유니언 타입에 명시된 타입 중 하나와 일치하지 않으면 오류를 발생시킨다. &lt;/p&gt;
&lt;h4&gt;코드 간결성&lt;/h4&gt;
&lt;p&gt;복잡한 조건에 대한 타입을 간결하게 표현할 수 있다. &lt;/p&gt;
&lt;h3&gt;유니언 타입 사용 시 고려할 사항&lt;/h3&gt;
&lt;h4&gt;타입 가드&lt;/h4&gt;
&lt;p&gt;유니언 타입은 여러 타입을 허용하기 때문에 실행 시점에 정확한 타입을 확인하기 위해 타입 가드를 사용해야 한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; StringOrNumber&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;typeof&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;string&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// value는 여기서 string 타입입니다.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// value는 여기서 number 타입입니다.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;공통 필드 사용&lt;/h4&gt;
&lt;p&gt;유니언 타입의 모든 구성원이 공통으로 가진 필드나 메소드에만 접근할 수 있다. 공통되지 않은 필드에 접근하려면 타입 가드를 사용해야 한다. &lt;/p&gt;
&lt;h4&gt;복잡한 유니언 타입&lt;/h4&gt;
&lt;p&gt;유니언 타입이 복잡해질 수록 그 타입을 사용하는 코드는 더 복잡해질 수 있다. 따라서 타입을 너무 복잡하게 만들지 않도록 주의해야 한다. &lt;/p&gt;
&lt;h2&gt;파이썬의 Union Type&lt;/h2&gt;
&lt;p&gt;여기까지 알아보다가 파이썬에서도 왠지 비슷한게 있을 것 같다는 생각이 들어서 찾아봤고, 역시 있음을 알게 됐다. &lt;/p&gt;
&lt;p&gt;파이썬은 타입스크립트와 다르게 동적 타이핑 언어이지만 3.5 이상에서는 타입 힌팅을 사용하여 비슷한 기능을 구현할 수 있고, 3.10 이상에서는 &lt;code class=&quot;language-text&quot;&gt;Union&lt;/code&gt; 대신 &lt;code class=&quot;language-text&quot;&gt;|&lt;/code&gt; 연산자를 이용하여 유니언 타입을 정의할 수 있다. &lt;/p&gt;
&lt;h3&gt;파이썬 3.9 이전&lt;/h3&gt;
&lt;p&gt;typing 모듈의 Union 을 사용하여 나타낼 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Union

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;파이썬 3.10 이상&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;타입스크립트의 Union Type과 다른 점&lt;/h3&gt;
&lt;p&gt;파이썬은 동적 타이핑 언어이므로 이 제약은 파이썬의 실행에 영향을 미치지 않는다. 즉 런타임에서 타입 안전을 강제하지 않는다. &lt;/p&gt;
&lt;p&gt;단순히 개발자의 가독성 향상, IDE의 자동완성 지원, mypy등 정적 타입 체킹 도구를 위한 것이다. &lt;/p&gt;
&lt;p&gt;저렇게 해두어도 런타임에서 다른 타입의 값이 할당될 수 있음을 주의해야 한다. &lt;/p&gt;
&lt;h2&gt;사담&lt;/h2&gt;
&lt;p&gt;노션 API를 활용한 블로그 쉽게 하는걸 만들다가 타입이 복잡하게 선언되어있는걸 보고 혹시나 해서 찾아봤더니 내 예상이 맞았다. &lt;/p&gt;
&lt;p&gt;C로 개발을 시작했어서 그런지 처음에 자바스크립트를 접하고 아주 재미있고 자유도가 높다고 생각했는데, 갈 수록 나 자신에게 쇠사슬이 묶여있는게 오히려 편하다고 느낀다. &lt;/p&gt;
&lt;p&gt;프로젝트 크기가 커질수록 더 그렇게 느끼는 것 같다. &lt;/p&gt;
&lt;p&gt;물론 이런 기능을 잘 활용하면 더 편할때도 많긴 하다. 코드가 짧아지는 것도 맞고..&lt;/p&gt;
&lt;p&gt;결국 내 자신이 잘하면 아무일도 안생길거라는 생각도 든다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[우분투 용량 관리]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/우분투-용량-관리/</link><guid isPermaLink="false">https://sharknia.github.io/우분투-용량-관리/</guid><pubDate>Sun, 28 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;개인적으로 나스를 하나 운영하고 있다. &lt;/p&gt;
&lt;p&gt;이것저것 설정해서 쓰고 있는데, 어느 날 갑자기 토렌트 다운로드가 용량이 없다고 작동하지 않았다. &lt;/p&gt;
&lt;p&gt;용량은 다음의 명령어를 통해 확인할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;furychick@odroid:/HDD2/myHomePage$ &lt;span class=&quot;token function&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-h&lt;/span&gt;
Filesystem      Size  Used Avail Use% Mounted on
tmpfs           200M   29M  171M  &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;% /run
/dev/mmcblk1p2   15G   15G     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;% /
tmpfs           996M     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;  996M   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;% /dev/shm
tmpfs           &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;.0M     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;.0M   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;% /run/lock
/dev/mmcblk1p1  128M   14M  114M  &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;% /media/boot
/dev/sdb1       &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.7T  656G  &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.0T  &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt;% /HDD2
/dev/sda1        11T  &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;.3T  &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.1T  &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;% /HDD
tmpfs           200M     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;  200M   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;% /run/user/1000&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;외장하든 왕 큰 놈을 달아서 사용하고 있는데, 오드로이드다보니 메인 OS가 깔리는 드라이브는 15gb짜리 작은 용량이다.. 그 드라이브가 100퍼센트 꽉 차 있었다. &lt;/p&gt;
&lt;p&gt;다음의 명령어를 사용해 용량이 큰 디렉토리를 검색했다. 외장하드 경로는 제외하고 검색했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;furychick@odroid:/$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-h&lt;/span&gt; / &lt;span class=&quot;token parameter variable&quot;&gt;--exclude&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/HDD2 &lt;span class=&quot;token parameter variable&quot;&gt;--exclude&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/HDD &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-hr&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
du: cannot &lt;span class=&quot;token builtin class-name&quot;&gt;read&lt;/span&gt; directory &lt;span class=&quot;token string&quot;&gt;&apos;/proc/sys/fs/binfmt_misc&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; No such device
du: cannot access &lt;span class=&quot;token string&quot;&gt;&apos;/proc/19035/task/19035/fd/3&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
du: cannot access &lt;span class=&quot;token string&quot;&gt;&apos;/proc/19035/task/19035/fdinfo/3&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
du: cannot access &lt;span class=&quot;token string&quot;&gt;&apos;/proc/19035/fd/4&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
du: cannot access &lt;span class=&quot;token string&quot;&gt;&apos;/proc/19035/fdinfo/4&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
15G     /
11G     /home/furychick
11G     /home
&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;.7G    /home/furychick/.forever
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.2G    /var
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.7G    /usr
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.6G    /var/log
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.5G    /var/log/journal/dc87f36fc06c441a85ff7269ba4d50fb
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.5G    /var/log/journal
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.3G    /usr/lib&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아~ 개인 홈페이지를 돌리는 로그가.. 몇 년 째 사이트를 그냥 켜둔채로 방치하다 보니 9기가에 달하게 크게 자라 내 서버를 억누르고 있었다. &lt;/p&gt;
&lt;p&gt;당장 로그를 삭제해주었다. &lt;/p&gt;
&lt;p&gt;해피엔딩~&lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(4)]]></title><description><![CDATA[지난 이야기 NotionAPI를 활용한 자동 포스팅(3) 간만에 복귀를 했다. 별건 아니고.. 그냥 복습을 했다.  오늘의 작업 block.ts 나머지 작업 지난번에 block.ts…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅4/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅4/</guid><pubDate>Sat, 27 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;지난 이야기&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/NotionAPI%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%9E%90%EB%8F%99-%ED%8F%AC%EC%8A%A4%ED%8C%853&quot;&gt;NotionAPI를 활용한 자동 포스팅(3)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;간만에 복귀를 했다. 별건 아니고.. 그냥 복습을 했다. &lt;/p&gt;
&lt;h2&gt;오늘의 작업&lt;/h2&gt;
&lt;h3&gt;block.ts 나머지 작업&lt;/h3&gt;
&lt;p&gt;지난번에 block.ts를 미완성 된 상태로 두었다. 타입 검사에서 걸린 상태로 일단 두었고,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GetBlockResponse&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; PartialBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Union Type이라는 것이 있다는 것을 알게 되었다. 해당 내용에 대해서는 따로 정리 해두었다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/Union-Type&quot;&gt;Union Type&lt;/a&gt;  &lt;/p&gt;
&lt;h3&gt;로그 강화&lt;/h3&gt;
&lt;p&gt;로그도 작업 순서에 맞게 찍히도록 강화했다. json 형태의 데이터여서 [object Object] 와 같이 찍히던 것도 제대로 내용물이 출력되도록 수정했다. 다음과 같은 코드로 json 형태의 데이터도 이쁘게 출력할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;convertParagraph - paragraph : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                paragraph&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;ConvertParagraph 완성&lt;/h3&gt;
&lt;p&gt;paragraph는 노션 블록 타입 주으이 하나로, 텍스트의 기본 단위이다. 텍스트를 입력할 때 기본적으로 생성되는 블록 유형이다. &lt;/p&gt;
&lt;p&gt;이 블록 안에 들어있는 내용을 마크다운으로 바꿔주는 메소드를 완성했다. &lt;/p&gt;
&lt;p&gt;원본 노션의 내용은 다음과 같다. 일부러 여러가지 케이스를 집어넣었다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 182px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c37e9a2ed8f76a7f64abfe844e3b2069/7d08f/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABi0lEQVR42m2RW2/aQBCF+RsFX9bGxsYYYxMDruNQwFHrtlHjtCBVSi9cFKnKE///5evgJlIleDh7dnZnz8ycbem6jmEYnLjT6TQ4xZqm0W63z85eoZS6iFaSJHiex1WaslitWC6XRKMR8/mcuq7J85yiKIiiiMViQVmWTXwqcFFwJQ8/396yfXzkabvl+PxMfXdH/fDA8Xhkt9ux3++pqorD4cBWcjabDbZtXxasgoAfScz3OGYdDvjqupzOHOFAuC/wfb9Jdnu9hofDIY7jYJrmuaAhiy7QlIluKd5YFu2XS93QMQ0TTcYz5F6ZCktZdMRDQ8QsyT0TDAZ91tmUb7MJ9SRlPZ1QpWN0WxE5fZ5mXyjDjE/DG96HOR+jgpkfkwk+SJx7iRTUmkKNYBgG/Mzf8ivP+HNzzW/Z309TonHCyB+wiUtSL6LoX1EOMu5H74jdAdf9MdOefFScEYhVr+O3ul0bT/xyXUd8c+iKN47TbTxS1svokqyZhnShsKUT3fxnwYmVjP3/B/0FwLz0WbdFeN8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/c37e9a2ed8f76a7f64abfe844e3b2069/7d08f/image1.png&apos; srcset=&apos;/static/c37e9a2ed8f76a7f64abfe844e3b2069/e7570/image1.png 170w,
/static/c37e9a2ed8f76a7f64abfe844e3b2069/7d08f/image1.png 182w&apos; sizes=&apos;(max-width: 182px) 100vw, 182px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이 paragraph블록의 데이터 형태는 다음과 같다. &lt;/p&gt;
&lt;h4&gt;&lt;u&gt;노&lt;/u&gt;&lt;u&gt;&lt;del&gt;션이&lt;/del&gt;&lt;/u&gt;  &lt;strong&gt;좋습***&lt;/strong&gt;니다***..&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;rich_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;노&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;노&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;션이&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;션이&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;좋습&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;좋습&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;니다&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;니다&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;..&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;..&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;정말로&lt;/code&gt;.. &lt;span style=&quot;color: pink;&quot;&gt;좋아합니다&lt;/span&gt;..&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;rich_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;정말로&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;정말로&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.. &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.. &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;좋아합니다&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pink&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;좋아합니다&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.. &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.. &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 중에서 밑줄과 색상은 기본적으로 마크다운에서 지원하지 않는 기능이므로 html 태그를 사용했다. 코드는 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textElement &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plain_text&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 텍스트 스타일링 처리&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bold&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;italic&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strikethrough&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;~~&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;~~&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\`&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;underline&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// 마크다운은 기본적으로 밑줄을 지원하지 않으므로, HTML 태그 사용&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;u&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/u&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 색상 처리 (HTML 스타일을 사용)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;default&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;span style=&quot;color: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;href&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;href&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; textContent&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;convertParagraph - paragraph : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                paragraph&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;\n\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;convertParagraph - markdown : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;markdown&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 문단 끝에 줄바꿈 추가&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;각 문장은 각각 다음과 같이 변환된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;convertParagraph - markdown &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;u&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;노&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;/u&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;u&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;~~션이~~&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;/u&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; **좋습*****니다***&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;
convertParagraph - markdown &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;정말로&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;span &lt;span class=&quot;token assign-left variable&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;color: pink;&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;좋아합니다&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;/span&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이를 vscode의 마크다운 편집 기능을 통해서 확인하면 다음과 같이 정상적으로 출력되는 것을 확인할 수 있다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 388px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e2c499b18f033781be6c338bb4de1ad2/5bbd5/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 17.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvElEQVR42j1QywqEMBDz///K23rV9abiCxUUpZa6tj6yzYAeQjqvTKaBcw77vmPbNlhrwZh8nieO45Aa4yd3XdfbxxljjMRk1oKu61CWJeq6Fs7zXLCuK8ZxRFEUqKpK8OTSNEWWZUiSBJ8oQuZ7ku9XFgTDMIhY0zRo21beHNZaY5qmdxlBF33fIwxDxHEM691De2dK414NYH4IuHVZFhGY51lEyM8ZfCulpIdnso+uKcwvgfOwDreHT+APdpIuAlwaOU4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/e2c499b18f033781be6c338bb4de1ad2/5bbd5/image2.png&apos; srcset=&apos;/static/e2c499b18f033781be6c338bb4de1ad2/e7570/image2.png 170w,
/static/e2c499b18f033781be6c338bb4de1ad2/f46e7/image2.png 340w,
/static/e2c499b18f033781be6c338bb4de1ad2/5bbd5/image2.png 388w&apos; sizes=&apos;(max-width: 388px) 100vw, 388px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;마크다운 파일 저장 기능 추가&lt;/h3&gt;
&lt;p&gt;page.ts에 block들로부터 받아온 마크다운 내용과 properties에 저장된 내용들을 합해 마크다운 파일로 저장하는 메소드를 완성했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;printMarkDown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//contentMarkdown과 properties의 내용을 마크다운 파일로 저장한다.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 파일 이름 설정 (페이지 제목으로)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; filename &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageTitle&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;.md&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 마크다운 메타데이터 생성&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; markdownMetadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatMarkdownMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 마크다운 메타데이터와 contentMarkdown을 결합&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fullMarkdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;markdownMetadata&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contentMarkdown&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 디렉토리 생성 (이미 존재하는 경우 오류를 무시함)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; recursive&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; filePath &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;index.md&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 결합된 내용을 파일에 쓰기 (이미 존재하는 경우 덮어쓰기)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filePath&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fullMarkdown&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[page.ts] Markdown 파일 저장됨: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;filePath&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[page.ts] 파일 저장 중 오류 발생: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;error&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;formatMarkdownMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// properties를 마크다운 메타데이터로 변환&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; metadata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;---&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;title: &quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;description: &quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;description &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;date: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;date &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;update: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;update &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// tags가 배열인 경우에만 join 메소드를 호출&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;tags:\n  - &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isArray&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;tags&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tags&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\n  - &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;
            &lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;series: &quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;series &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;---&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;github.io의 블로그 형식에 맞춰서 properties를 바꿔주고, 블로그 형식에 맞는 위치에 일단 마크다운 파일을 저장하게끔 해주었다. 아마, 추후 배포 방식에 따라 해당 위치는 바뀔 수 있을 것이다. 아직 정확하게 어떤 방식으로 블로그를 배포할 것인지까지는 고려하지 않았다. &lt;/p&gt;
&lt;p&gt;위 코드를 포함해서 실행하면, &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 190px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/bd60ee265b49dce0e87e516a1d70d48a/08678/image3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACAElEQVR42oVSy3LaQBDkGzCSVg/0RhICgZC0CBTAvKFsXK5UXDmmUpWbLz75mFvyP/nDzqyo+IKJD32Qdqanp3sacT9BlmWI0gK9u29IywrJYIis4Mg5xyjPUYxL9OnfIB1hOMrorUDc76Pb612gkaQZVsslomKO299/8PD9GdPqE7bHIza7PWGL9e4APqmw2h+w2++wWK6QEHkyTC/QME0TbQHDgO/aCLtx/e163hmuC8dx0QkCeJ4L07Lh+z5E33toyLIMy3YQRxHy8QQvP3/Bj3qYLRaYz2fI0hRx3ENVTZGNUnTJokk5hsoYFEW5QIPRg67r0DQNOqkMwoiKZVLlUIEMSZIghjLRwBRoqgqVagUhewdvhLpuQJFbMMIhbH6AR4SL2zWO5NlsPgUvp9isNvBodZmGqER8lVCoY1QgtW7QlBQwO6w9LfgYJa3HeY5hmqPMCti2fVZ8XaFSh2BZJsXex/p4B6tt1AEwGvTPbBGMrmtXid4IhZEiuYhWGdAJ/Xh5RRCEGAwSuH5AKjmKIqd75KimE9imAZl62P88FCsLwyWphWbzBkw368TqAFQGSZZq3/R2Gxr5rXxEaJBfAgo1WjH5NDkh7HRw//CIr09fcH86YLU94PPpEQGdl9RqfRzKORjxk6bTuQh1FgUgzsdxnfpWHbLmvM11D/8C58BWiDU8hLUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image3&apos; title=&apos;&apos; src=&apos;/static/bd60ee265b49dce0e87e516a1d70d48a/08678/image3.png&apos; srcset=&apos;/static/bd60ee265b49dce0e87e516a1d70d48a/e7570/image3.png 170w,
/static/bd60ee265b49dce0e87e516a1d70d48a/08678/image3.png 190w&apos; sizes=&apos;(max-width: 190px) 100vw, 190px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이렇게 저장이 되고, &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/0d515458e22973fa572822c3536f30db/86467/image4.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAq0lEQVR42q2PWwqDQAxFZyHWeSQ+Oo/N220orkBQtyFyOzOlIAVLCwYOST5yuBFU39E2LcgYKKkglYSUEmWaYy+KAsEHPLoO4zii73sMw3CKqFsLax2IDDhKTUQbAmkFJnoJQ8CyLEi17zu+lTDEIK7QVAxmjgkVVEQntM5C7z3mec4H27Zl6Rkiv1eWuEVST/ubJP474VHwyVG4rut1wuPLlwidc5im6SfhE9Elb1W+TBl+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image4&apos; title=&apos;&apos; src=&apos;/static/0d515458e22973fa572822c3536f30db/ca1dc/image4.png&apos; srcset=&apos;/static/0d515458e22973fa572822c3536f30db/e7570/image4.png 170w,
/static/0d515458e22973fa572822c3536f30db/f46e7/image4.png 340w,
/static/0d515458e22973fa572822c3536f30db/ca1dc/image4.png 680w,
/static/0d515458e22973fa572822c3536f30db/02d09/image4.png 1020w,
/static/0d515458e22973fa572822c3536f30db/9d567/image4.png 1360w,
/static/0d515458e22973fa572822c3536f30db/86467/image4.png 2233w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이렇게 깔끔하게 저장이 된다. 이제 앞으로는 각 블록 타입들에 대한 변환을 추가하면 된다!&lt;/p&gt;
&lt;h3&gt;BlockObjectResponse 분석&lt;/h3&gt;
&lt;p&gt;실질적으로 컨텐츠들은 BlockObjectResponse 타입들로 이루어져있다. BlockObjectResponse는 다음의 Union Type이다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BlockObjectResponse&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ParagraphBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; Heading1BlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; Heading2BlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; Heading3BlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; BulletedListItemBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; NumberedListItemBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; QuoteBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ToDoBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ToggleBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; TemplateBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; SyncedBlockBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ChildPageBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ChildDatabaseBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; EquationBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; CodeBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; CalloutBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; DividerBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; BreadcrumbBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; TableOfContentsBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ColumnListBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ColumnBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; LinkToPageBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; TableBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; TableRowBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; EmbedBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; BookmarkBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ImageBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; VideoBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; PdfBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; FileBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; AudioBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; LinkPreviewBlockObjectResponse &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; UnsupportedBlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;del&gt;너무 많다&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;일단, 많이 쓸 것 같은 블록들을 예제 파일로 만들고 해당 노션 파일들을 불러와보고 어떤 타입들을 사용하는지 살펴보기로 했다. 나머지는 모르겠다 아직은 그냥 미지원이다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/2af61caa2c35f58e15a78afe1588f244/f7121/image5.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 92.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByklEQVR42qWUy27UMBSG/QoMI7GguTh2HDsTJ5P7NCO1IITUFRUS8A4seP/lzzmmQVUl0HSy+BM7Uj6fy38spmHAx/s7ZFmGJEmQpukmibnrcDfPyKTcDAvAZZqwjCOiKLoKIOUL4D1Ft/Q9ojgOKQddAJGU0U0UI6b/eB/FCa0TiPZ4xHJ7i6IooJSC1hqa6vk/IEM4o/FYoq4OuEkNWm9wKA2EyQ36rkff/9FI6XdlCa008jwPhxhjwprffPCb3VvIdzs8zg5f+gNOSuLXtxFfHyYIVVu0pwG196iqCnVdo24adNQsBnBEDGUX8Ju13+/g5R5H/R4fbIyfPx7w/fOCR5JQRsM6C2ddOL2wFgWBLK05qlCCJ63AXEv4A6WvMspEoT1/gqs7CqaC4J8aiogjW1NaZQn+LxWFg3MurI3OKAATDhX84I/h5KeavV76b1nEWjfu2kxT42nPFrra2Gt9mO4p5Yqjpf0mINvlRAYfyDLL+Ry6fe1cC34wlP3HYJ6AeEvK3Aiu4UQzPVAN5cZLQnCHx7bFTEDu1JboArCiMVtoStILLoWLgIUhY/sKJYHZ2M8n47XiDIWh0WsaT3VsyODPbpwrgb8BKZ0dd/NVeLkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image5&apos; title=&apos;&apos; src=&apos;/static/2af61caa2c35f58e15a78afe1588f244/ca1dc/image5.png&apos; srcset=&apos;/static/2af61caa2c35f58e15a78afe1588f244/e7570/image5.png 170w,
/static/2af61caa2c35f58e15a78afe1588f244/f46e7/image5.png 340w,
/static/2af61caa2c35f58e15a78afe1588f244/ca1dc/image5.png 680w,
/static/2af61caa2c35f58e15a78afe1588f244/f7121/image5.png 899w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이것들을 넘는것은 내가 아직은 노션에 쓸 것 같지가 않다. 따라서 위의 블록들을 중점적으로 먼저 변환하기로 하자. &lt;/p&gt;
&lt;p&gt;다음의 녀석들이 그 녀석들이다. &lt;/p&gt;
&lt;h4&gt;heading_ 시리즈&lt;/h4&gt;
&lt;p&gt;제목1, 제목2, 제목3 들이다. heading&lt;em&gt;1부터 heading&lt;/em&gt;3까지를 노션에서는 사용할 수 있는데, 각각 h2, h3, h4로 변환하면 될 것 같다. 이건 쉬울 것 같은 예감이 든다. &lt;/p&gt;
&lt;h4&gt;bookmark&lt;/h4&gt;
&lt;p&gt;북마크는 간단할 것 같지만, 간단하지 않은 점이 있다. 노션에는 페이지 링크 기능이 있는데, 이것도 가능하면 (페이지 링크도 어차피 내 블로그 글 일테니까, 아니 사용자가 그렇게 사용해야 한다. ) 블로그 글의 링크로 변환하고 싶다. 이게 가능할까? 이건 쉽지 않을 수도 있을 것 같은 생각이 지금은 든다. 생성된 페이지 링크와 페이지 아이디가 다르다면 근본적으로 불가능한 일이다. &lt;/p&gt;
&lt;h4&gt;code&lt;/h4&gt;
&lt;p&gt;코드 블록이다. 이건 쉬울 것 같다. &lt;/p&gt;
&lt;h4&gt;table, table_row&lt;/h4&gt;
&lt;p&gt;마크다운은 표 그리기가 까다롭다. 그래도 어떻게든 할 수 있지 않을까? &lt;/p&gt;
&lt;h4&gt;bulleted&lt;em&gt;list&lt;/em&gt;item&lt;/h4&gt;
&lt;p&gt;글머리 기호이다. 이건.. 이건 쉽지 않을까? &lt;/p&gt;
&lt;h4&gt;numbered&lt;em&gt;list&lt;/em&gt;item&lt;/h4&gt;
&lt;p&gt;번호 이것도 쉽지 않을까?? &lt;/p&gt;
&lt;h4&gt;toggle&lt;/h4&gt;
&lt;p&gt;토글도 어떻게든 되지 않을까? 다른것보단 복잡하겠지만 특별한 건 없을 것 같다. &lt;/p&gt;
&lt;h4&gt;quote, divider, callout&lt;/h4&gt;
&lt;p&gt;이 놈들도 특별한 어려움은 예상되지 않는다. 그냥 스타일이나 이쁘게 주면 될 것 같다. &lt;/p&gt;
&lt;p&gt;결국, 표나 북마크를 제외하면 나머지는 그냥 단순 노가다로 예상이 된다. &lt;/p&gt;
&lt;h3&gt;heading 시리즈 컨버터 생성&lt;/h3&gt;
&lt;p&gt;이건 간단했다. 다만, 컨버팅 관련 내용이 길어질 것 같아 해당 역할을 하는 클래스 MarkdownConverter을 만들어서 이걸 이용하기로 했다. 이 클래스는 블록의 내용을 받아 markdown 문자열로 변환해서 리턴하는 역할을 한다. &lt;/p&gt;
&lt;p&gt;paragraph와 heading 시리즈에 겹치는 내용이 많다. 사실상 pre 태그만 다르다. 따라서 중복되는 내용을 formatTextElement 메소드로 분리했다. 아마 다른 타입에 대해서도 사용할 수 있을 것 같은 예감이 든다. &lt;/p&gt;
&lt;p&gt;완성된 코드는 다음과 같다. &lt;/p&gt;
&lt;h4&gt;코드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; BlockObjectResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@notionhq/client/build/src/api-endpoints&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MarkdownConverter&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; block&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;block &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; converter&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MarkdownConverter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MarkdownConverter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; converter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;makeMarkDown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;makeMarkDown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; block &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[markdownConverter.ts] makeMarkDown : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;
                block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt;
            &lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 텍스트의 기본 단위,텍스트를 입력할 때 기본적으로 생성되는 블록 유형&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;paragraph&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;heading_1&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertHeading&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;heading_1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;heading_2&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertHeading&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;heading_2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;heading_3&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertHeading&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;heading_3&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 다른 블록 유형에 대한 처리를 여기에 추가...&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;warn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[markdownConverter.ts] makeMarkDown : Unsupported block type - &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textElement &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;\n\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertHeading&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;heading&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; level&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; prefix &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;repeat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;level &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textElement &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; heading&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; prefix &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;\n\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plain_text&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// 텍스트 스타일링 처리&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bold&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;italic&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strikethrough&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;~~&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;~~&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\`&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;underline&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;u&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/u&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;default&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;span style=&quot;color: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;annotations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;href&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textContent&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;href&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; textContent&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;convertLinkToPage 생성&lt;/h3&gt;
&lt;p&gt;아까 북마크에 대해서 고려할 때, 페이지 링크가 어렵지 않을까? 고민했었는데 해당 문제는 해결이 가능했다. link&lt;em&gt;to&lt;/em&gt;page 타입에서 페이지 아이디를 제공하고 있었고, 페이지 아이디를 API를 통해서 호출을 하면 해당 데이터를 가져오는 것이 가능했다. 이 경우에는 마크다운 파일은 필요없고 URL만 필요하므로, Page 클래스에 간단한 정보만 가져오는 메소드를 만들고 해당 메소드를 활용해 북마크를 생성해주었다. 또, 설정 파일에 블로그의 주소를 설정하도록 했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; properties&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Record&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; PropertyValue&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; pageTitle&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; pageUrl&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; contentMarkdown&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;extractDataFromProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;properties&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;
            page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageTitle
                &lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;trim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-source language-regex&quot;&gt;[^가-힣\w\-_~]&lt;/span&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-flags&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 한글, 영어, 숫자, &apos;-&apos;, &apos;_&apos;, &apos;.&apos;, &apos;~&apos;를 제외한 모든 문자 제거&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-source language-regex&quot;&gt;\s+&lt;/span&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-flags&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 공백을 하이픈으로 치환&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;
        &lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; 생략 &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getSimpleData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notionApi&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; NotionAPI &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; NotionAPI&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; notionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            pageTitle&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageTitle &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            pageUrl&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl &lt;span class=&quot;token operator&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

		&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; 생략 &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;기존의 생성자 create 메소드와 중복되는 부분을 init 메소드로 분리하고, getSimpleData에서는 title, url만 리턴하도록 수정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertLinkToPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;linkToPage&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; envConfig &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// EnvConfig 인스턴스 생성&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blogUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blogUrl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// blogUrl 가져오기&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; linkToPage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;page_id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getSimpleData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageTitle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageTitle&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pageTitle&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;blogUrl&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pageUrl&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)\n\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Error converting link_to_page:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 이렇게 해당 값과 설정값을 이용해 북마크를 연결할 주소를 만들었다. &lt;/p&gt;
&lt;h3&gt;Page 멘션 기능 대응&lt;/h3&gt;
&lt;p&gt;Page Mention의 경우에는 특이하게 paragraph에 링크 관련 정보가 담겨서 온다. 해당 경우에 대응하기 위해 convertParagraph를 다음과 같이 수정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textElement &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;mention&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
                textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mention&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;page&apos;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// mention 타입이고, page를 참조하는 경우&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertMentionToPageLink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    textElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mention&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// 기타 텍스트 요소&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatTextElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;textElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;\n\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertMentionToPageLink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; envConfig &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EnvConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// EnvConfig 인스턴스 생성&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blogUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; envConfig&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blogUrl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// blogUrl 가져오기&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getSimpleData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageTitle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageTitle&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pageTitle&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;blogUrl&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;pageUrl&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Error converting mention to page link:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이로써 까다로울 것 같았던 두 가지에 대한 대응이 끝났고, 나머지는 노가다만 남은 것 같다!&lt;/p&gt;
&lt;h3&gt;imageConverter 구현&lt;/h3&gt;
&lt;p&gt;이미지도 구현이 쉬웠다. 마크다운과 같은 폴더에 이미지를 다운로드 받고(amazone 저장소 주소가 API에서 제공된다. ) 캡션 형식으로 넣어주면 된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertImage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageBlock&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; imageBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageCaption &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
                imageBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;caption&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
                    &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;formatRichText&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageBlock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;caption&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 이미지 이름을 순서대로 할당 (image1, image2, ...)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;MarkdownConverter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;imageCounter&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;.png&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageDownDir &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageUrl&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;imageName&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imagePath &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;contents/post&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; imageDownDir&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 이미지 다운로드 및 로컬에 저장&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; axios&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageUrl&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                responseType&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;arraybuffer&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imagePath&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// 마크다운 이미지 문자열 생성&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdownImage &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;![&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;imageCaption&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;imageName&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageCaption&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                markdownImage &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;p style=&quot;text-align:center;&quot;&gt;&amp;lt;small&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;imageCaption&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/small&gt;&amp;lt;/p&gt;\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdownImage&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Error converting image:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;단, 이 클래스는 상당히 분리되어있는 클래스여서 따로 저장될 곳의 디렉토리 명을 알 수 있는 방법이 없었다.. 어쩔 수 없이 Page클래스부터 계속해서 디렉토리 명을 던져줬다.. 깔끔하지 않다.. &lt;/p&gt;
&lt;p&gt;또, 저장될 디렉토리 (contents/post) 도 설정의 영역에 넣어야 할 것 같다. &lt;/p&gt;
&lt;h2&gt;오늘의 마무리&lt;/h2&gt;
&lt;p&gt;오늘은 이 정도면 될 것 같다. 이미 핵심 부분은 모두 진행이 됐고, 앞으로는&lt;/p&gt;
&lt;h3&gt;남은 타입별 구현&lt;/h3&gt;
&lt;p&gt;콜아웃, devider, quote는 html, css의 영역으로 생각된다. 이건 추후 따로 정적 파일에 html, css를 추가하거나 해야 할 것 같다. 자세한 방법은 나중에 생각해보려고 한다. 오늘 다섯시간? 정도를 쉬지 않고 했더니 집중력이 많이 떨어진 게 느껴진다. &lt;/p&gt;
&lt;p&gt;토글도 의외로 까다로울지도? 뭐 초반엔 내가 그냥 토글을 노션에 안쓰면 되는거 아닐까? &lt;/p&gt;
&lt;p&gt;까다로운 부분은 많이 구현된 것 같다. 빠르면 내일, 열심히 한다면 이번주 안에 직접 사용을 해볼 수 있을 것 같다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(3)]]></title><description><![CDATA[지난시간 https://sharknia.github.io/Notion-Api-2/ 문제점 아무것도.. 기억이 나지 않는다.. 지난날의 나는 무엇이었나?…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅3/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅3/</guid><pubDate>Fri, 26 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;지난시간&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/Notion-Api-2/&quot;&gt;https://sharknia.github.io/Notion-Api-2/&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;문제점&lt;/h2&gt;
&lt;p&gt;아무것도.. 기억이 나지 않는다.. 지난날의 나는 무엇이었나? 5개월만의 복귀가 이렇게 어렵다. 이래서 사람은 꾸준해야 한다. &lt;/p&gt;
&lt;h2&gt;잡설&lt;/h2&gt;
&lt;p&gt;최근 업무에 약~간의 여유가 생기면서 IDE를 파이참에서 vs code로 갈아탔다. 파이썬만 할 때에는 파이참이 유리한 것이 사실이지만(심지어 속도도 파이참이 더 빠르다고 느꼈다. ) 추후 여러 언어를 다루게 될 경우 vs code가 유리한 점이 있다고 생각되어 갈아탔고, 환경 세팅을 다시 했다. &lt;/p&gt;
&lt;p&gt;formatter나 기타 여러가지 등등.. 그리고 타입스크립트 코드를 오랜만에 보면서 여기에도 formatter 설정을 추가해주었다. &lt;/p&gt;
&lt;h2&gt;설계 되새김질&lt;/h2&gt;
&lt;p&gt;코드를 다시 읽는데에만 시간을 꽤 투자했다. 예전의 나는 코드를 꽤 잘 짠 것 같다. &lt;/p&gt;
&lt;p&gt;블로그 글을 복습하지 않고 코드를 읽고 설계를 다시 했는데 오늘의 나는 예전의 나와 의견이 똑같다. &lt;del&gt;(진작 복습할걸)&lt;/del&gt;&lt;/p&gt;
&lt;h3&gt;그래서 어떻게 할 것이냐?&lt;/h3&gt;
&lt;p&gt;노션은 블록 기반의 구조로 이루어져있다. 그래서 나는 노션의 메인 데이터베이스를 블로그 홈이라고 가정하고, 그 안에 있는 블록들의 리스트는 페이지라고 정의하여, 페이지의 양식이나 속성은 고정해두려고 한다. 그리고 비로소 페이지안의 컨텐츠, 블록들을 마크다운으로 변환하려고 한다. &lt;/p&gt;
&lt;p&gt;그래서, Page.ts에서 페이지 들을 관리하고, Block.ts에서 블록들을 관리하려고 한다. 블록들은 각자 하위 블록을 다시 가질 수 있는 재귀적 형태를 가진다. &lt;/p&gt;
&lt;p&gt;콘텐츠들은 문단, 이미지, 리스트 등 여러 타입을 가지므로 경우에 따라서 block 클래스를 상속한 하위 클래스가 생길수도 있겠다. &lt;/p&gt;
&lt;p&gt;각자 블록들은 자신의 내용들을 마크다운으로 변환해서 상위 블록에게 전달하는 메소드를 갖는다. 가장 하위 블록부터 전달된 변경된 마크다운 내용들은 상위로 타고 올라가 결국 페이지 클래스에 전달된다. &lt;/p&gt;
&lt;p&gt;페이지 클래스는 이 마크다운들을 모아 파일로 저장한다. &lt;/p&gt;
&lt;p&gt;계획은 완벽해 보인다. &lt;/p&gt;
&lt;p&gt;하지만, 타입이 아주 많고 이걸 마크다운으로 변환하는 작업은 노가다 그 자체일것이다.. &lt;/p&gt;
&lt;p&gt;그래서 일단은 제한된 타입들에 대해서만 변환을 지원하려고 한다. &lt;/p&gt;
&lt;h2&gt;그래서 오늘 작업은?&lt;/h2&gt;
&lt;p&gt;일단 코드를 읽었고, 분석했고, 설계를 굳이 다시 하고 예전의 나와 의견이 같다는 점을 뒤늦게 확인했으며, &lt;/p&gt;
&lt;p&gt;block.ts의 초안을 작성했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@notionhq/client&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; BlockObjectResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@notionhq/client/build/src/api-endpoints&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; GetBlockResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@notionhq/client/build/src/api-endpoints&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Block&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; blockId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; blockData&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; GetBlockResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; blockId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blockId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; blockId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getMarkdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blockData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fetchBlockData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;processBlock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blockData&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetchBlockData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;GetBlockResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blocks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; block_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blockId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;processBlock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;paragraph&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;heading_1&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;# &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;heading_1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plain_text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 다른 블록 유형에 대한 처리를 여기에 추가...&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;warn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;Unsupported block type: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// 하위 블록 처리 (재귀적)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;has_children&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;processChildBlocks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;processChildBlocks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blockId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; children &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blocks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            block_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; blockId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; markdown &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; child &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            markdown &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;processBlock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;child &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; BlockObjectResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; markdown&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertParagraph&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;paragraph:&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rich_text&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// return paragraph.text.map((t) =&gt; t.plain_text).join(&apos;&apos;) + &apos;\n\n&apos;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// 기타 블록 유형에 대한 변환 함수를 여기에 추가...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;완전히 지극히 초안 그 자체이다. 기초적인 형태만 잡았다. 아직 리턴값에 대한 이해가 충분하지 않아, 해당 부분에 대한 조정이 필요하다. (심지어 오류가 나는 상태이다)&lt;/p&gt;
&lt;p&gt;블록의 타입이 모두 정의가 되어있으므로, 해당 타입에 따른 각 클래스를 따로 생성할 필요도 느낀다. 모두 여기에 집중된다면 코드가 너무 길어질 것 같다. &lt;/p&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;결국 오늘은 한 일이 별로 없다.. 복귀에 의의를 두자. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Pydantic Model의 응용]]></title><description><![CDATA[문제 기존에는 프론트와 주고 받을 데이터 모델을 정의하는데에 dataclass를 사용하고 있었다. 그러다가 FastAPI로 넘어오면서 Pydantic model을 도입했다.  dataclass…]]></description><link>https://sharknia.github.io/Pydantic-Model의-응용/</link><guid isPermaLink="false">https://sharknia.github.io/Pydantic-Model의-응용/</guid><pubDate>Fri, 26 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;문제&lt;/h2&gt;
&lt;p&gt;기존에는 프론트와 주고 받을 데이터 모델을 정의하는데에 &lt;a href=&quot;https://sharknia.github.io/dataclass&quot;&gt;dataclass&lt;/a&gt;를 사용하고 있었다. 그러다가 FastAPI로 넘어오면서 &lt;a href=&quot;https://sharknia.github.io/Pydantic-%EB%AA%A8%EB%8D%B8&quot;&gt;Pydantic model&lt;/a&gt;을 도입했다. &lt;/p&gt;
&lt;p&gt;dataclass로는 해결할 수 없는 문제가 있었다. 프론트엔드 개발에서는 주로 카멜케이스를 사용하기 때문에, 파이썬에서는 주로 스네이크 케이스를 사용하는데 (&lt;a href=&quot;https://sharknia.github.io/%EB%84%A4%EC%9D%B4%EB%B0%8D-%EA%B7%9C%EC%B9%99naming-conventions&quot;&gt;네이밍 규칙(naming conventions)&lt;/a&gt;), 프론트로 나갈 변수 명을 카멜케이스로 통일 하기 위해 어쩔 수 없이 백엔드의 코드 컨벤션을 해치면서 Response로 나갈 모델의 속성만 Camel 케이스로 선언하고 있었다. &lt;/p&gt;
&lt;p&gt;하지만 난 이런게 너무 싫다. &lt;/p&gt;
&lt;h2&gt;해결&lt;/h2&gt;
&lt;p&gt;Pydantic Model을 이를 해결하기 위한 옵션이 있다. &lt;/p&gt;
&lt;h3&gt;alias_generator&lt;/h3&gt;
&lt;p&gt;필드에 대한 별칭을 자동으로 생성하는 함수를 지정한다. 주로 모델 필드 이름을 snake 케이스에서 camel케이스로 매핑할 때 사용된다. &lt;/p&gt;
&lt;h3&gt;populator&lt;em&gt;by&lt;/em&gt;name&lt;/h3&gt;
&lt;p&gt;이 옵션을 True로 설정하면 Pydantic은 별칭 대신 모델 필드의 원래 이름을 사용하여 인스턴스를 생성하고 할당한다. 이는 필드의 별칭과 원래 이름을 혼용하여 사용할 수 있게 한다. 기본적으로는 False로 되어있어 만약 이 설정을 수정하지 않는다면 속성을 snake case로 정의했어도 인스턴스 생성시 변수를 camelCase로 넣어줘야 하는 불상사가 일어난다. &lt;/p&gt;
&lt;p&gt;이 설정을 True로 해두면 모델 인스턴스가 직렬화, 역직렬화 되는 과정에서만 별칭을 이용하게 된다. &lt;/p&gt;
&lt;h3&gt;두 옵션을 엮어서..&lt;/h3&gt;
&lt;p&gt;이 두 옵션을 엮어서 Request로 받을 경우, Response로 내려갈 경우에만 별칭을 사용하고, 별칭은 camelCase에 따라 생성되도록 설정을 할 수 있다. &lt;/p&gt;
&lt;p&gt;그리고 이 설정값을 넣은 BastDtoModel 클래스를 생성해서 앞으로 우리가 데이터 통신에 사용할 PydanticModel은 모두 이 클래스를 상속받아 구현하기로 했다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;base_dto_model.py&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; pydantic &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; BaseModel


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;to_camel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;string&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    components &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; string&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;_&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; components&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; components&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseDtoModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseModel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        alias_generator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; to_camel
        populate_by_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;alias&lt;em&gt;generator에는 to&lt;/em&gt;camel 메소드를 정의해주었다. to&lt;em&gt;camel 메소드는 snake&lt;/em&gt;case로 작성된 문자열을 camelCase로 변환해주는 함수이다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[SqlAlchemy의 QueuePool]]></title><description><![CDATA[개발중인 서비스에서 Postgresql을 적용한지 이제 한달 조금 더 지났다.  아직 DB 마이그레이션 작업은 거의 되지 않았으므로, 실제로 Postgresql DB…]]></description><link>https://sharknia.github.io/SqlAlchemy의-QueuePool/</link><guid isPermaLink="false">https://sharknia.github.io/SqlAlchemy의-QueuePool/</guid><pubDate>Thu, 18 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;개발중인 서비스에서 Postgresql을 적용한지 이제 한달 조금 더 지났다. &lt;/p&gt;
&lt;p&gt;아직 DB 마이그레이션 작업은 거의 되지 않았으므로, 실제로 Postgresql DB를 이용하는 서비스는 그다지 많지 않았다. &lt;/p&gt;
&lt;p&gt;새로 업데이트 하는 기능들에 대해서는 적극적으로 Postgresql을 이용하기로 했고, 이번에 새로 퀴즈 기능을 개발하면서 이 기능은 전부 RDB 기반으로 만들어졌다. &lt;/p&gt;
&lt;p&gt;퀴즈 기능의 개발은 유저의 접속률을 늘리기 위한 것으로, 모든 테스트를 마친 후 실서버에 배포가 되고 클라이언트까지 패치가 된 후 당당하게 퀴즈 풀러 오시라고 사용자들에게 푸시를 날렸다. &lt;/p&gt;
&lt;p&gt;그리고 펑! 서버가 터졌다. &lt;/p&gt;
&lt;h2&gt;현상&lt;/h2&gt;
&lt;p&gt;실제 서비스가 엄청나게 느리거나 거의 작동하지 않았다. &lt;/p&gt;
&lt;p&gt;Postgresql DB와 연결된 API들이 작동하지 않았다. &lt;/p&gt;
&lt;p&gt;서버에서는 &lt;code class=&quot;language-text&quot;&gt;QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00&lt;/code&gt; 오류가 대량으로 발생했다. &lt;/p&gt;
&lt;p&gt;서버 모니터링 결과 푸쉬 직후 대량의 트래픽이 집중적으로 발생했다. &lt;/p&gt;
&lt;p&gt;Flarelane을 통해 확인한 결과, 2000명 정도가 동시 접속을 시도했다. &lt;/p&gt;
&lt;p&gt;Supabase의 DB 커넥션이 순간적으로 크게 늘어났다. (풀러를 사용중인데도 불구하고)&lt;/p&gt;
&lt;p&gt;시간이 지나면서 (약 10분이 안되는 짧은 시간) 트래픽이 줄어들고 자연스럽게 오류가 줄고, 서비스가 정상화되었다. &lt;/p&gt;
&lt;h2&gt;원인 파악 및 해결&lt;/h2&gt;
&lt;p&gt;Sqlalchemy의 QueuePool을 현재 지금 pool size 5, max overflow 10으로 맞춰놓았었는데, 트래픽이 증가하면서 QueuePool의 한도가 다 차고, 대다수 요청이 최대 대기 시간 30초를 꽉 채워 대기하다가 오류가 발생했다. &lt;/p&gt;
&lt;p&gt;조사 결과, 대다수 많은 실제 서비스에서 해당 설정값은 대체적으로 너무 적어 값을 늘려서 사용한다고 한다. 정확한 값을 찾기 위해서는 여러번의 테스트가 필요하며, 점진적으로 늘려가면서 적당한 값을 찾아야 한다고 한다. &lt;/p&gt;
&lt;p&gt;supabase 기반의 postgresql을 사용하고 있는데, 일단 postgresql의 connection 여유는 충분한 상황이었으므로 일단 설정값을 pool size 10, max overflow 20으로 각각 두배로 늘려주었다. &lt;/p&gt;
&lt;p&gt;이벤트나, 푸쉬가 있을 경우 추가적인 모니터링이 필요할 것이다. &lt;/p&gt;
&lt;h2&gt;Sqlalchemy의 QueuePool&lt;/h2&gt;
&lt;p&gt;데이터베이스 Connection은 리소스가 많이 필요하다. QueuePool은 이런 Connection을 효율적으로 관리하여 성능을 향상시키기 위해 만들어졌다. Connection을 빠르게 재사용함으로써, 애플리케이션의 반응 시간을 단축 시키고 부하 상황에서도 안정적으로 동작하도록 한다. &lt;/p&gt;
&lt;p&gt;Quepool은 내부적으로 Connection 객체들을 큐로 관리한다. 동시성을 고려하여 설계되어 여러 스레드 또는 프로세스에서 안전하게 사용될 수 있다. &lt;/p&gt;
&lt;h3&gt;QueuePool의 생명주기&lt;/h3&gt;
&lt;h4&gt;생성&lt;/h4&gt;
&lt;p&gt;QueuePool은 Sqlalchemy 엔진이 생성될 때 함께 생성된다. 이 때 데이터베이스와의 Connection 설정이 정의된다. &lt;/p&gt;
&lt;h4&gt;Connection 관리&lt;/h4&gt;
&lt;p&gt;애플리케이션에서 데이터베이스 Connection이 필요할 때, QueuePool이 Connection을 제공한다. 사용 가능한 Connection이 없으면 새 Connection을 생성하거나 대기열에서 Connection을 기다린다. &lt;/p&gt;
&lt;h4&gt;Connection 반환&lt;/h4&gt;
&lt;p&gt;작업이 완료되면 Connection은 Pool에 반환되어 재사용된다. &lt;/p&gt;
&lt;h4&gt;종료&lt;/h4&gt;
&lt;p&gt;애플리케이션 종료와 함께 Pool에 있는 모든 Connection이 안전하게 종료된다. &lt;/p&gt;
&lt;h3&gt;작동&lt;/h3&gt;
&lt;p&gt;QueuePool은 기본적으로 미리 설정된 &lt;code class=&quot;language-text&quot;&gt;pool_size&lt;/code&gt; 내에서 Connection을 관리한다. 사용 가능한 Connection이 있다면 그 연결을 제공하고, 없으면 새로은 Connection을 생성한다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pool_size&lt;/code&gt;는 동시에 활성화 할 수 있는 최대 연결수이다. 만약 이 한계를 초과한다면, &lt;code class=&quot;language-text&quot;&gt;max_overflow&lt;/code&gt; 에 설정된 값에 따라 추가 Connection을 생성한다. &lt;code class=&quot;language-text&quot;&gt;max_overflow&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;pool_size&lt;/code&gt; 를 초과하여 생성할 수 있는 추가 연결의 최대 수이다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;max_overflow&lt;/code&gt; 까지 초과한다면 추가 Connection 연결 요청은 대기열에 들어가며 사용 가능한 Connection 이 생길때까지 대기한다. 이 때, 연결 대기 시간이 &lt;code class=&quot;language-text&quot;&gt;timeout&lt;/code&gt; 설정을 초과하면 연결 요청은 실패한다. &lt;/p&gt;
&lt;h4&gt;pool_size&lt;/h4&gt;
&lt;p&gt;이 설정은 가능한 최대 연결의 최대 수를 정의 하는 것이므로, 5로 설정했다고 해서 실제 연결이 5개가 유지되는 것은 아니다. 사용되지 않는 Connection은 pool에 반환되며, 유휴 상태로 남아있다가 &lt;code class=&quot;language-text&quot;&gt;recycle&lt;/code&gt; 설정 시간을 넘어서면 끊어진다. &lt;/p&gt;
&lt;h4&gt;max_overflow&lt;/h4&gt;
&lt;p&gt;pool&lt;em&gt;size를 초과하는 최대 개수를 정의한다. pool&lt;/em&gt;size 가 5이고, max&lt;em&gt;overflowrk 10이라면 동시에 최대 5+10 = 15개의 연결을 허용하는 것이다. max&lt;/em&gt;overflow에 해당되어 생성된 Connection이라 할지라도 사용 후에 풀에 반환된다(바로 끊어지는 것이 아니다). 다만, 해당 Connection은 pool_size의 기본 한계를 넘어선 것이므로 풀에서 더 높은 우선 순위로 종료될 수 있다. &lt;/p&gt;
&lt;h3&gt;Sqlalchemy의 풀링 전략&lt;/h3&gt;
&lt;p&gt;Sqlalchemy의 기본 풀링 전략은 Queuepool이지만, 이외에도 다른 전략들이 있다. &lt;/p&gt;
&lt;h3&gt;StaticPool&lt;/h3&gt;
&lt;p&gt;연결의 고정된 집합을 유지한다. 모든 Connection 요청은 이 고정된 집합에서 제공된다. 단일 사용자 또는 단일 프로세스 어플리케이션에 적합하다. &lt;/p&gt;
&lt;h3&gt;NullPool&lt;/h3&gt;
&lt;p&gt;Connection Pooling을 사용하지 않는다. 매 요청마다 새로운 DB Connection이 열리고 작업 종료 후 Connection이 닫힌다. &lt;/p&gt;
&lt;p&gt;매우 드문 요청이 있는 어플리케이션에 적합하다. &lt;/p&gt;
&lt;h3&gt;Singleton ThreadPool&lt;/h3&gt;
&lt;p&gt;각 스레드에 대해 하나의 Connection을 유지한다. 스레드마다 고유한 Connection을 사용한다. &lt;/p&gt;
&lt;p&gt;멀티 스레드 환경에서 각 스레드가 자체 Connection을 가질 필요가 있을 때 유용하다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI의 Pagenation]]></title><description><![CDATA[서론 FatAPI에는 페이징을 위한 공식 라이브러리가 존재한다. 하지만 예제대로 진행해도 코드는 오류를 내뿜었다. 왜냐하면, FastAPI의 페이지네이션 라이브러리는 SqlAlchemy 2.…]]></description><link>https://sharknia.github.io/FastAPI의-Pagenation/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI의-Pagenation/</guid><pubDate>Wed, 17 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;서론&lt;/h2&gt;
&lt;p&gt;FatAPI에는 페이징을 위한 &lt;a href=&quot;https://uriyyo-fastapi-pagination.netlify.app/&quot;&gt;공식 라이브러리&lt;/a&gt;가 존재한다. 하지만 예제대로 진행해도 코드는 오류를 내뿜었다. 왜냐하면, FastAPI의 페이지네이션 라이브러리는 SqlAlchemy 2.0의 비동기 엔진을 지원하지 않기 때문이다. &lt;/p&gt;
&lt;p&gt;그래서 직접 구현했다. &lt;/p&gt;
&lt;p&gt;&lt;del&gt;(이&lt;/del&gt; &lt;a href=&quot;https://pypi.org/project/fastapi-sqla/&quot;&gt;&lt;del&gt;라이브러리&lt;/del&gt;&lt;/a&gt;&lt;del&gt;를 쓰면 Async pagination 지원합니다. 여러분은 이거 쓰세요.)&lt;/del&gt;&lt;/p&gt;
&lt;h2&gt;목적&lt;/h2&gt;
&lt;h3&gt;응답값 고정&lt;/h3&gt;
&lt;p&gt;모든 페이징 쿼리에 대해 동일한 응답값을 제공하기 위해 Response에 사용할 Pydantic Model도 함께 정의한다. &lt;/p&gt;
&lt;h3&gt;가능한 한 간단한 사용 방법&lt;/h3&gt;
&lt;p&gt;Sqlalchemy의 Select 객체를 받아 바로 처리할 수 있도록 한다. 즉, 개발자는 쿼리문만 생성하고 사이즈/페이지만 정해주면 바로 고정된 응답값을 받을 수 있다. &lt;/p&gt;
&lt;h3&gt;현재 서버에 필요한 사양에 맞춘 기능&lt;/h3&gt;
&lt;p&gt;복잡한 쿼리나 여러 층의 정렬을 현재는 필요로 하지 않는다. 이에 발맞춰 기본적인 relationship을 활용한 조인, 단일 컬럼 sort만 지원하여 사용법을 간략화 한다. &lt;/p&gt;
&lt;h2&gt;구현&lt;/h2&gt;
&lt;h3&gt;PaginationReturn Class 구현&lt;/h3&gt;
&lt;p&gt;페이지네이션의 결과의 데이터 모델을 미리 정의해 둔 클래스이다. &lt;/p&gt;
&lt;p&gt;응답값은 다음의 내용들로 고정된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;itemList : 페이지에 포함된 Row의 리스트&lt;/li&gt;
&lt;li&gt;totalCount : 전체 항목의 개수&lt;/li&gt;
&lt;li&gt;totalPage : 전체 페이지의 개수 &lt;/li&gt;
&lt;li&gt;nowPage : 현재 페이지 번호&lt;/li&gt;
&lt;li&gt;nowSize : 현재 설정한 사이즈 &lt;/li&gt;
&lt;li&gt;prevPage : 이전 페이지 번호&lt;/li&gt;
&lt;li&gt;nextPage : 다음 페이지 번호&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;전체 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;class PaginationReturn(BaseModel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Generic&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;)&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &quot;&quot;&quot;
    PaginationReturn 클래스는 페이지네이션 결과를 나타내는 모델입니다.

    &lt;span class=&quot;token key atrule&quot;&gt;Attributes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        itemList (List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;)&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 페이지에 포함된 항목의 리스트입니다.
        &lt;span class=&quot;token key atrule&quot;&gt;totalCount (int)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 전체 항목의 개수입니다.
        &lt;span class=&quot;token key atrule&quot;&gt;totalPages (int)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 전체 페이지의 개수입니다.
        &lt;span class=&quot;token key atrule&quot;&gt;nowPage (int)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 현재 페이지 번호입니다.
        &lt;span class=&quot;token key atrule&quot;&gt;nowSize (int)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 현재 페이지에 포함된 항목의 개수입니다.
        prevPage (Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;int&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;optional)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 이전 페이지 번호입니다. 기본값은 None입니다.
        nextPage (Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;int&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;optional)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 다음 페이지 번호입니다. 기본값은 None입니다.
    &quot;&quot;&quot;
    &lt;span class=&quot;token key atrule&quot;&gt;itemList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;totalCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; int
    &lt;span class=&quot;token key atrule&quot;&gt;totalPages&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; int
    &lt;span class=&quot;token key atrule&quot;&gt;nowPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; int
    &lt;span class=&quot;token key atrule&quot;&gt;nowSize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; int
    &lt;span class=&quot;token key atrule&quot;&gt;prevPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;int&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; = None
    &lt;span class=&quot;token key atrule&quot;&gt;nextPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;int&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; = None&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h3&gt;Pagination Class 구현&lt;/h3&gt;
&lt;p&gt;pagination은 static 메소드로 만들어서 필요한 값을 넣으면 바로 PaginationReturn을 받을 수 있게 만들었다. static method로 만든것은 FastAPI의 Pagination 라이브러리를 본딴것이다. 이 방법이 가장 사용하기 편해보이기도 했다. &lt;/p&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;get_paginated_list&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;처음 구현한 메소드이다. 모델을 파라미터로 받아 페이징을 한다. 따로 select문을 만들 필요 없이 모델과 where절만 만들어서 넣어줘도 정의된 응답값 데이터 모델에 리스트를 담아 반환해준다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;전체 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_paginated_list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        cls&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        model&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; T&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;BinaryExpression&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        order_column&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        order_direction&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;desc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        size&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        page&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; PaginationReturn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# page 와 size 기본 유효성 검증&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; size &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Page and size parameters must be greater than 0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 기본 쿼리 생성&lt;/span&gt;
        query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# fileter 처리&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 정렬 처리&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; order_direction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lower&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;asc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 페이징&lt;/span&gt;
            offset_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; size
            query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offset&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;offset_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;limit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[Pagination Query] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# total_count 계산&lt;/span&gt;
            total_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;select_from&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                total_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; total_query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; total_result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; SQLAlchemyError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An error occurred while fetching data from the database : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An unexpected error occurred : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next_page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calculate_pagination&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 응답값 생성&lt;/span&gt;
        items_dict &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;serialize_sqlalchemy_obj&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

        res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; PaginationReturn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            itemList&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;items_dict&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalCount&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalPages&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowSize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            prevPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nextPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;next_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; res&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;BaseModel 객체는 직렬화 기능이 없으므로, Response로 응답을 내려보낼때에 귀찮아지는 문제가 있다. 모델의 키값과 밸류를 사용해 dictionary로 바꾸면 해당 문제를 해결할 수 있는데, 만약 리스트에 들어있는 값들에 대해 커스텀이 필요하다면 dictionary를 그대로 다루는 것은 아무래도 모델을 커스텀 하는 것보다 불편한 문제가 발생한다. &lt;/p&gt;
&lt;p&gt;이 문제를 해결하기 위해 모델 객체를 기반으로 Pydantic Model 객체를 동적으로 생성하여 Pydantic model의 리스트를 결과값에 담아 리턴하기로 했다. 이렇게 하면 응답값을 바로 Response로 내려보내도 직렬화가 가능해 문제가 발생하지 않으며, 혹시 아이템 내용을 커스텀 해야 할 때에도 모델을 다룰 때와 같은 방법으로 사용할 수 있으므로 훨씬 간편하다. 개선된 코드는 아래와 같다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;개선된 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_paginated_list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        cls&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        model&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; T&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;BinaryExpression&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        order_column&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        order_direction&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;desc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        size&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        page&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; PaginationReturn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        페이징을 해서 아이템을 뽑아내서 결과를 반환한다.
        Args:
            db: AsyncSession
            model: 데이터를 가져올 모델
            filters: [InitQuizList.is_deleted == False, InitQuizList.is_active == True] 의 꼴 where절
            order_column: 정렬할 컬럼
            order_direction: &apos;asc&apos; or &apos;desc&apos;
            size: 페이지에 나타낼 아이템의 개수 (기본값 10)
            page: page 번호 (기본값 1)
        Returns:
            PaginationReturn
        &quot;&quot;&quot;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# page 와 size 기본 유효성 검증&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; size &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Page and size parameters must be greater than 0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 기본 쿼리 생성&lt;/span&gt;
        query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# fileter 처리&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 정렬 처리&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; order_direction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lower&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;asc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order_column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 페이징&lt;/span&gt;
            offset_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; size
            query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offset&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;offset_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;limit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[Pagination Query] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# total_count 계산&lt;/span&gt;
            total_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;select_from&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                total_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; total_query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; total_result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; SQLAlchemyError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An error occurred while fetching data from the database : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An unexpected error occurred : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next_page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calculate_pagination&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 응답값 생성&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 동적 Pydantic 모델 생성&lt;/span&gt;
        PydanticModel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sqlalchemy_to_pydantic&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 페이징 처리된 쿼리 결과를 Pydantic 모델 리스트로 변환&lt;/span&gt;
        pydantic_items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;PydanticModel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;model_validate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

        res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; PaginationReturn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            itemList&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pydantic_items&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalCount&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalPages&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowSize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            prevPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nextPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;next_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; res

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sqlalchemy_to_pydantic&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_model&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Type&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;DeclarativeMeta&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Type&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;BaseModel&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
    SQLAlchemy 모델을 동적으로 생성된 동일한 스키마의 Pydantic 모델로 변환합니다.
    :param db_model: SQLAlchemy 모델 클래스
    :return: 생성된 Pydantic 모델 클래스
    &quot;&quot;&quot;&lt;/span&gt;
    fields &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; column &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; inspect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        python_type &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;python_type
        default &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;default &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;default&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;arg
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;nullable&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            python_type &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;python_type&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        fields&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;column&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;python_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; default&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    pydantic_model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__name__ &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Pydantic&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;fields&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; pydantic_model&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;모델의 컬럼값으로 동적으로 pydantic model을 생성하는 sqlalchemy&lt;em&gt;to&lt;/em&gt;pydantic 메소드를 생성하고 해당 메소드를 활용해 응답값에 담도록 해주었다. &lt;/p&gt;
&lt;/details&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;get_paginated_list_by_query&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;처음에 신나서 만들었는데, 기존  &lt;code class=&quot;language-text&quot;&gt;get_paginated_list&lt;/code&gt; 메소드는 치명적인 문제가 있다. 쿼리가 복잡한 경우를 전혀 생각하지 않았다. 말 그대로 단일 테이블에서만 값을 가져올 수 있는 것이다. 그래서 이 점을 개선해야했다. 그래서 개발자가 조금 더 귀찮아지지만 쿼리문은 이 메소드를 이용할 작업자가 직접 구현을 하고, 그 쿼리문을 넣으면 리스트를 담아서 돌려주는 형식으로 다시 만들기로 했다. &lt;/p&gt;
&lt;p&gt;기존 메소드에서는 모델만을 조회하는 것이므로 모델을 기반으로 Pydantic model을 생성하면 문제가 없었는데, 이번에는 모델에서 컬럼값을 추출해서 사용할 수 없으므로 키 값을 동적으로 정의하는 코드를 따로 작성해주었다. &lt;/p&gt;
&lt;p&gt;쿼리된 내용에서 컬럼값을 조회해서 사용하였으며, 쿼리된 내용에는 시스템에서 사용하는 속성값도 존재하는데 해당 속성값들은 &lt;code class=&quot;language-text&quot;&gt;_&lt;/code&gt;로 시작하므로 해당 내용은 제거하고 동적으로 Pydantic model에 추가해주었다. relationship도 대응할 수 있게 별도의 예외처리를 추가해주었다. relationship 속성은 Select 객체의 컬럼에는 포함이 되지 않는데 조회된 결과물의 속성에는 들어있으므로 해당 값이 relationship 속성이라고 가정하고 따로 예외처리를 해주었다. &lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;전체 코드&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_paginated_list_by_query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        cls&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        query&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Select&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Any&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        size&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        page&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        Query에 대한 paging 생성
        Args:
            db: AsyncSession
            query: sqlalchemy의 Select의 리턴값
            size: 한 번에 보여줄 아이템의 개수(기본값 10)
            page: 페이지(기본값 1)
        Returns:
            PaginationReturn
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 매개변수 검증&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; size &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Page and size parameters must be greater than 0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 페이징 적용&lt;/span&gt;
        offset_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; size
        paginated_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offset&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;offset_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;limit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 쿼리 실행&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paginated_query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; SQLAlchemyError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An error occurred while fetching data from the database : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; PagingException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;An unexpected error occurred : &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        pydantic_items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 컬럼과 데이터 타입 파악&lt;/span&gt;
            columns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;columns
            fields &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;col&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;col&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;python_type&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; col &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; columns&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;# relationship 처리&lt;/span&gt;
            relationship_keys &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            sample_item &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            item_dict &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sample_item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; item_dict&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keys&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; key &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; fields &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;startswith&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;_&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;token comment&quot;&gt;# 관계형 속성의 키를 저장&lt;/span&gt;
                    relationship_keys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;# 관계형 속성에 대한 필드 정의 추가&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; relationship_keys&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                fields&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Any&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 관계형 속성을 포함한 동적 Pydantic 모델 생성&lt;/span&gt;
            DynamicPydanticModel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;DynamicPydanticModel&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;fields&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                item_dict &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; v &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;startswith&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;_&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;# 관계형 속성을 딕셔너리로 변환&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; relationship_keys&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                    relation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; relation&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                        &lt;span class=&quot;token comment&quot;&gt;# SQLAlchemy 내부 상태 정보를 제외하고 변환&lt;/span&gt;
                        item_dict&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                            k&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; v &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; relation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;startswith&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;_&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                        item_dict&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;

                pydantic_items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DynamicPydanticModel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;model_validate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item_dict&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;# 총 개수 계산&lt;/span&gt;
            total_count_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;select_from&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subquery&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_count_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_count_query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            total_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; total_count_result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 결과 반환&lt;/span&gt;
        total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; next_page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calculate_pagination&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; PaginationReturn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            itemList&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pydantic_items&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalCount&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            totalPages&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;total_pages&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nowSize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            prevPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;prev_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            nextPage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;next_page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;아직 기능이 많이 부족하지만, 현재 회사에서 사용을 하면서 필요한 기능은 대부분 구현을 했다고 생각이 든다. 그래서 일단 개발은 여기서 멈추었다. &lt;/p&gt;
&lt;p&gt;개발에 아주 오랜 시간이 걸리지는 않았다. 집중도와 실제 사용 시간을 따지면 이틀 좀 안되게 썼다고 생각이 든다. &lt;/p&gt;
&lt;p&gt;만드는것은 재미있는 과정이었고, 필요한 것이 잘 만들어져 뿌듯함도 있었지만 역시 있는 라이브러리를 쓰는게 시간 최적화에서는 더 좋았던 것 같다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Sqlalchemy 비동기 엔진에서의 Postgresql Pooler]]></title><description><![CDATA[결론 supabase 기준, Sqlalchemy의 비동기 엔진에서 Postgresql pooler (supavisor)에 오류 없이 연결하기 위해서는  을 다음과 같이 구성해주면 된다.  statementcachesize…]]></description><link>https://sharknia.github.io/Sqlalchemy-비동기-엔진에서의-Postgresql-Pooler/</link><guid isPermaLink="false">https://sharknia.github.io/Sqlalchemy-비동기-엔진에서의-Postgresql-Pooler/</guid><pubDate>Tue, 09 Jan 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;supabase 기준, Sqlalchemy의 비동기 엔진에서 Postgresql pooler (supavisor)에 오류 없이 연결하기 위해서는 &lt;code class=&quot;language-text&quot;&gt;create_async_engine&lt;/code&gt; 을 다음과 같이 구성해주면 된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; uuid &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid4
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; asyncpg &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Connection

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CConnection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get_unique_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prefix&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        캐싱을 만들 시에 캐싱 아이디가 중복으로 생성되어서 오류가 발생하는 경우가 있다.
        statement_cache_size를 0으로 해도 일단 캐싱을 만들고 오류를 낸다.
        따라서 캐싱을 사용하지 않을 것이므로, 아예 중복되지 않게 UUID로 생성해버린다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;__asyncpg_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;prefix&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;__&apos;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

DATABASE_URL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;postgresql+asyncpg://postgres.[Project ID]:[Password]@aws-0-[Region].pooler.supabase.com:6543/postgres?prepared_statement_cache_size=0&quot;&lt;/span&gt;&lt;/span&gt;
    _db_connection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_async_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        DATABASE_URL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        connect_args&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;statement_cache_size&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;connection_class&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CConnection&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;statement&lt;em&gt;cache&lt;/em&gt;size, prepared&lt;em&gt;statement&lt;/em&gt;cache_size를 둘 다 모두 0으로 줘야 한다.&lt;/p&gt;
&lt;p&gt;그리고 왜 발생하는지 모르겠는 간헐적인 오류(캐싱 ID를 중복되게 생성하려고 시도함)를 해결하기 위해 Connection 클래스를 상속받아 &lt;em&gt;get&lt;/em&gt;unique&lt;em&gt;id 메소드를 오버라이딩 해주고, 해당 클래스를 connection&lt;/em&gt;class로 사용하도록 했다. 이렇게 하면 id 중복 생성 오류를 방지할 수 있다. &lt;/p&gt;
&lt;p&gt;일반적인 글이라면 결론이 서두에 나온다면 너무나 시시하겠지만 기술 블로그이니 괜찮다. &lt;/p&gt;
&lt;h2&gt;문제 해결에 관한 글&lt;/h2&gt;
&lt;h3&gt;발단&lt;/h3&gt;
&lt;p&gt;supabase에서 메일이 왔다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/754811dd5daabc41fab8df2eb32a001e/af70e/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 128.82352941176472%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAABYlAAAWJQFJUiTwAAADAElEQVR42p1V23LiMAzN/38SD52h0z7yAJT7fdMkTkLuIeGu1ZETCrPp7lJmNJZtRT46OjaGaZo0mUxos9mITadTGo/HZFkWrddr6vV6sg9/sVjQfD6X+WAwoOFwKN9cr1eqfwYCWq0Wvb29UbvdppeXF7HX11d6f3+nTqcjhyBuNpsRACBZt9uVcblcPia0bVsQfXx8UL/fp9FoRKvVSoKBbr/f0zM/418BOP3evlu7Jcx3Ozqfz38ENQX/F8Lj6SQJYSf2Yfdrl8uFmmJOlX+/jtGI44Qs26FtEFIYxRSEIfsBRbyOeZKmpFyPIvaxFoSRxEZxTP42oJDncZKwH1KW5WTsioI/jOhwODTy1+Q3c12VjC4CBVAhMU6Jk1TQYD1JM0qSVHyNJhVE2MeY8j5QH49HnRBl2UpJWa7n02q9oS7LZzqb05DlNGAZTViHn5Yt+5ajyGQfNGFu89zzt+KDRyNlRFjAaUColMtBjnyQ8BpORhXn80XKRpO0Xb/mPNZKMfI8Jz/YCsllWRI4LTkB5IRESAh+i6KU8SBzPoT9stzLGpDdZONwuYPhmO+kKd1zXFcQO1yKw2iV61elOTIX4xibR9AAHxwWDASHGyAZnAChBHIiJFCeTlQnUZ4njchy3TSMaZbJiEZiD6ily1hESXXJxb6UklFSwWvYw7wu7bvrKCVDDigR5YpQIy1cXa4n5YjxGtDXlMCwjzgP3beVFra+KepWHoLQYfgYkcR2wJtHm18mmZ+W3pPkntCFOTQKCgwgQkJwVAcLEuU9CDvNtLjBFcRc8we5gZJbl8vqpoAjbCAIfsIfHCr1P/Xa4GPcFm2aL/j6wgfCJ64lKAFv/lYbZONXj4iLi8GjJAQiBKBUvDQwXDtoc7Fc0XDE/y/8qjc9EE3dNqCdLNvdShVeUq03UAG+4IucIB/2cT3xnDWWDA7vSU6q16QWsKyzHOTAfCeHoNs+l/mj/5Snm4ImQHufliOI7l+SR6PK/v5/w10upFtoiu5oyHyVP0b4G9LzywBICL9oAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/754811dd5daabc41fab8df2eb32a001e/ca1dc/image1.png&apos; srcset=&apos;/static/754811dd5daabc41fab8df2eb32a001e/e7570/image1.png 170w,
/static/754811dd5daabc41fab8df2eb32a001e/f46e7/image1.png 340w,
/static/754811dd5daabc41fab8df2eb32a001e/ca1dc/image1.png 680w,
/static/754811dd5daabc41fab8df2eb32a001e/02d09/image1.png 1020w,
/static/754811dd5daabc41fab8df2eb32a001e/af70e/image1.png 1184w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
여태 본 기억이 없었는데, Final reminder라도 되어있는걸 보니 이미 여러번 고지했던 모양이다. &lt;/p&gt;
&lt;p&gt;읽어보니 Pgbouncer 지원이 종료된다는 내용이다. 지원이 종료되는건 알고 있었는데, 아예 Connection string을 죽여버리는 모양이다. 잔인하다는 생각이 들었지만 어차피 우리는 Pooler는 진작에 포기했으므로 상관이 없었다. &lt;/p&gt;
&lt;p&gt;문제는 다음이었는데, DB Direct access에 대한 IPv4 주소 지원도 끝난다니 이건 좀 문제의 소지가 있었다. &lt;/p&gt;
&lt;p&gt;마침 어제 지난번 DB 세팅에 대한 회고를 끝내서 다행이었다. &lt;/p&gt;
&lt;h3&gt;전개&lt;/h3&gt;
&lt;p&gt;선택지는 두가지이다. Supavisor 도입, 네트워크가 IPv6를 지원하도록 설정하고 Direct 연결 방법을 계속해서 사용. &lt;/p&gt;
&lt;p&gt;개인적으로 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;네트워크 설정에 상대적으로 약함&lt;/li&gt;
&lt;li&gt;WebRTC를 하던 때의 기억 때문에 IPv6에 안좋은 감정이 있음 &lt;/li&gt;
&lt;li&gt;현재 백엔드의 네트워크 설정을 직접 진행하지 않았었음 &lt;/li&gt;
&lt;li&gt;혼자 출근한 백엔드는 나 혼자임&lt;/li&gt;
&lt;li&gt;Pooler와 씨름을 한 기억이 최근이고, 회고는 더더욱 최근임&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;의 이유로 Supavisor 도입에 대해 다른 백엔드가 출근하기 전 잠깐 살펴보기로 했다.&lt;/p&gt;
&lt;p&gt;그런데 왠걸? 직접 설치부터 해야 하나라고 막연히 생각을 했었는데(supabase의 공식 문서에는 아직 supavisor에 대한 내용이 적어도 찾기 쉬운 곳에 있지는 않다. ) 그렇지 않았다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/orgs/supabase/discussions/17817&quot;&gt;https://github.com/orgs/supabase/discussions/17817&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;해당 링크를 보아하니 이미 꽤 지원이 진행된 상태였는지, connection string만 바꾸면 간단하게 Pgbouncer가 아니라 Supavisor를 사용하여 연결할 수 있다고 적혀 있었다. &lt;/p&gt;
&lt;p&gt;그래서 해당 링크를 참조해 Connection string은 약간 수정을 해야 했지만, 어쨌든 Supavisor 연결에 간단하게 성공해버렸다. &lt;/p&gt;
&lt;h3&gt;위기&lt;/h3&gt;
&lt;p&gt;곧장 과거 겪었던 것과 같은 문제가 발생했다. Sqlalchemy 입장에서는 Pgbouncer와 Supavisor를 따로 구분하지 못하는지 Transaction 또는 Session 풀 모드에서는 캐싱이 지원되지 않는다는 에러 문구가 발생했다. &lt;/p&gt;
&lt;p&gt;여기서 잠깐, 포기하고 얌전히 IPv6 설정을 보러 갈까 했는데, 아직 다른 백엔드가 아무도 출근하지 않았다. &lt;/p&gt;
&lt;p&gt;일단 Pool mode를 바꿔야 다음 단계의 설정을 진행할 수 있었는데, Pgbouncer의 Pool mode는 supabase 콘솔에서 세팅을 지원하지만 supavisor는 어떻게 바꿔야 할지 의문이었다. &lt;/p&gt;
&lt;p&gt;해당 의문은 말도 못하게 간단하게 풀렸다. 콘솔에 들어가보니 어느새 쥐도 새도 모르게 Pgbouncer 관련 섹션이 supavisor 관련 섹션으로 바뀌어있었다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7c5279045f32fb30cbeb9d1c39351ce2/98f2e/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAoUlEQVR42pWQbQ6EIAxEuQogn6Lc/3Q1rwmGqOvu/ngBtDOd1vTeZd93iTGKc06898p8/xU0Jucsy7LcftAghCDWWn1/4zRE+NRp2zYhfa1VKaXcWNdV4U4NWkMKuJqmlIT0Q3ydAviGlhM0IcVPKTGbk42kJGqtnclGUzxYj/m0fAoRzUacmLGO0WwkRKOGT+PCXPjGGJsmusO3wn9gIgwPE/TlErXrnBgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/7c5279045f32fb30cbeb9d1c39351ce2/ca1dc/image2.png&apos; srcset=&apos;/static/7c5279045f32fb30cbeb9d1c39351ce2/e7570/image2.png 170w,
/static/7c5279045f32fb30cbeb9d1c39351ce2/f46e7/image2.png 340w,
/static/7c5279045f32fb30cbeb9d1c39351ce2/ca1dc/image2.png 680w,
/static/7c5279045f32fb30cbeb9d1c39351ce2/02d09/image2.png 1020w,
/static/7c5279045f32fb30cbeb9d1c39351ce2/9d567/image2.png 1360w,
/static/7c5279045f32fb30cbeb9d1c39351ce2/98f2e/image2.png 2012w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
위 이슈에서 설명된 supavisor 관련 connection string은 &lt;code class=&quot;language-text&quot;&gt;user&lt;/code&gt; 로 시작하는 부분이 옳지 않아서 수정이 필요했는데, 콘솔의 pgbouncer 관련 연결 connection string 에는 제대로 적혀있었다. 아무래도 메일에 적어보낸 이슈이지만 따로 수정을 하지는 않은 모양이다.. &lt;/p&gt;
&lt;p&gt;아무튼간 pool mode를 변경 후 테스트를 할 수 있었다. &lt;/p&gt;
&lt;h3&gt;절정1&lt;/h3&gt;
&lt;p&gt;Pool mode를 바꿨다고 해서 바로 연결이 가능하지는 않다. 서버 인스턴스를 실행하면 짜잔! 성공적인 DB 연결 대신 다음과 같은 문구를 볼 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &apos;asyncpg.exceptions.InvalidSQLStatementNameError&apos;&gt;: prepared statement &quot;__asyncpg_stmt_b__&quot; does not exist
HINT:  
NOTE: pgbouncer with pool_mode set to &quot;transaction&quot; or
&quot;statement&quot; does not support prepared statements properly.
You have two options:
* if you are using pgbouncer for connection pooling to a
  single server, switch to the connection pool functionality
  provided by asyncpg, it is a much better option for this
  purpose;
* if you have no option of avoiding the use of pgbouncer,
  then you can set statement_cache_size to 0 when creating
  the asyncpg connection object.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Sqlalchemy를 사용중이기 때문에 첫번째 방법은 자연스럽게 더 고려할것도 없이 기각이며, statement&lt;em&gt;cache&lt;/em&gt;size를 0으로 수정하는 것이 현재 내 인프라에서 선택할 수 있는 방법이었다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/20/dialects/postgresql.html&quot;&gt;https://docs.sqlalchemy.org/en/20/dialects/postgresql.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;지난번 기나긴 고생 이후 공식 문서를 항상 참조하는 습관을 들이게 됐다. 아주 긍정적인 방향이라고 생각한다. &lt;/p&gt;
&lt;p&gt;공식 문서를 참조하면,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;engine = create_async_engine(&quot;postgresql+asyncpg://user:pass@hostname/dbname?prepared_statement_cache_size=0&quot;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;의 방식으로 statement&lt;em&gt;cache&lt;/em&gt;size를 0으로 설정할 수 있는 것을 알 수 있다. &lt;/p&gt;
&lt;p&gt;이 설정을 해준 후, 다시 서버 인스턴스를 실행하면 짜잔! DB 연결이 아주 잘 된다. 쿼리도 잘 날리고, 결과도 잘 받아온다.&lt;/p&gt;
&lt;p&gt;이 와중에 Cache 생성 시에 같은 인덱스로 중복 생성되어서 오류가 발생하기도 했다. 그래서 SqlAlchemy의 Connection 클래스를 상속받아 캐시의 아이디를 생성하는 메소드를 수정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; asyncpg &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Connection
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; uuid &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid4

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CConnection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get_unique_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prefix&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        캐싱을 만들 시에 캐싱 아이디가 중복으로 생성되어서 오류가 발생하는 경우가 있다.
        statement_cache_size를 0으로 해도 일단 캐싱을 만들고 오류를 낸다.
        따라서 캐싱을 사용하지 않을 것이므로, 아예 중복되지 않게 UUID로 생성해버린다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;__asyncpg_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;prefix&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;__&apos;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이후 DB 커넥션을 만들 때에 해당 클래스를 기본 Connection 클래스 대신 사용하도록 설정해주면 된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;DATABASE_URL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;postgresql+asyncpg://postgres.[Project ID]:[Password]@aws-0-[Region].pooler.supabase.com:6543/postgres?prepared_statement_cache_size=0&quot;&lt;/span&gt;&lt;/span&gt;
    _db_connection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_async_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        DATABASE_URL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        connect_args&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;connection_class&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CConnection&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기까지 작업을 해줘서 오류를 해결하고 같은 쿼리를 연속으로 날리면? &lt;/p&gt;
&lt;p&gt;짜잔! 다음과 같은 오류를 볼 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &apos;asyncpg.exceptions.InvalidSQLStatementNameError&apos;&gt;: prepared statement &quot;__asyncpg_stmt_9462b5fe-88dc-46f5-98fb-57981ea56de0__&quot; does not exist
HINT:  
NOTE: pgbouncer with pool_mode set to &quot;transaction&quot; or
&quot;statement&quot; does not support prepared statements properly.
You have two options:
* if you are using pgbouncer for connection pooling to a
  single server, switch to the connection pool functionality
  provided by asyncpg, it is a much better option for this
  purpose;
* if you have no option of avoiding the use of pgbouncer,
  then you can set statement_cache_size to 0 when creating
  the asyncpg connection object.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그렇다, 오류는 반복된다. &lt;/p&gt;
&lt;h3&gt;절정2&lt;/h3&gt;
&lt;p&gt;이미 여기까지 시간을 꽤 쓴 상태였기 때문에 조금만 더 무언가를 해보기로 했다. &lt;/p&gt;
&lt;p&gt;캐시 사용을 아무리 꺼도, 도대체가 캐시를 계속 만들고 거기서 오류를 내는 이 상황. &lt;/p&gt;
&lt;p&gt;다행히 비슷한 오류를 겪는 사람들을 깃허브 이슈에서 찾을 수 있었다. &lt;/p&gt;
&lt;p&gt;이미 나의 신뢰를 많이 잃어버린 챗지피티에게 이 문제를 상담하면 &lt;code class=&quot;language-text&quot;&gt;statement_cache_size&lt;/code&gt; 옵션을 0으로 설정해서 connect_args에 넣으라고 한다. PgBouncer로 붙이려고 애써봤었을 때에 해당 옵션을 넣어도 아무런 변화가 없이 그대로 오류가 발생했었고, 공식문서에는 존재하지 않는 옵션이어서 이번에는 무시하고 넘어갔었다. &lt;/p&gt;
&lt;p&gt;근데 충격적이게도 한가지 옵션을 썼을 땐 되지 않고 두 옵션을 동시에 사용하면 된다고 한다.. 이게 무슨 일일까? 나는 왜 두 옵션을 동시에 쓸 생각을 못했을까?(이 생각을 어떻게 하나요?)&lt;/p&gt;
&lt;p&gt;최종적으로 DB Connection String을 다음과 같이 설정해주었다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; uuid &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid4
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; asyncpg &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Connection

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CConnection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get_unique_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; prefix&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        캐싱을 만들 시에 캐싱 아이디가 중복으로 생성되어서 오류가 발생하는 경우가 있다.
        statement_cache_size를 0으로 해도 일단 캐싱을 만들고 오류를 낸다.
        따라서 캐싱을 사용하지 않을 것이므로, 아예 중복되지 않게 UUID로 생성해버린다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;__asyncpg_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;prefix&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;__&apos;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

DATABASE_URL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;postgresql+asyncpg://postgres.[Project ID]:[Password]@aws-0-[Region].pooler.supabase.com:6543/postgres?prepared_statement_cache_size=0&quot;&lt;/span&gt;&lt;/span&gt;
    _db_connection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_async_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        DATABASE_URL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        connect_args&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;statement_cache_size&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;connection_class&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CConnection&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;결말 &amp;#x26; 에필로그&lt;/h3&gt;
&lt;p&gt;지난번 기나긴 고생과 삽질을 통해서 챗지피티에 대한 신뢰를 덜고 공식문서를 신뢰해야 한다는 사실을 깨달았다. &lt;/p&gt;
&lt;p&gt;그리고 이번 짧은(반나절 정도) 삽질을 통해서 공식문서도 100% 정답은 아니라는 사실을 깨달았다. (나는 무엇을 믿어야 할까?)&lt;/p&gt;
&lt;p&gt;생각해보면, Database url 에다가 옵션을 넣는다고 해서 내부적으로 뭔가 변경되는 것일리가 없다. 결국 엔진을 만들 때에 옵션값을 넣어줘야 내부적으로 뭔가 알고 다른 작동을 하지 않을까? 이 생각을 막바지에 와서 떠올렸다. &lt;/p&gt;
&lt;p&gt;항상 시야를 넓게 하고, 의심하면서 만들어야 한다는 것을 다시 한 번 깨달았다. 남들이 시키는대로 해서는 되는것이 없는 것이다. &lt;/p&gt;
&lt;p&gt;별개로, 내가 잘못을 한 것인지 뭔지 Sqlalchemy도 FastAPI도 Postgresql도 모두 유명한 것들인데 어째서 이렇게까지 불완전하게 작동하는지 의문이 든다. 역사가 길진 않지만 그래도 수년의 시간은 지난 것들인데, 가장 기본적인 부분이 이렇게 불안정할지는 예상을 못했다. FastAPI의 메모리 누수 문제도 뒤늦게 알게 되었는데, 메모리 누수 문제에 이어서 비동기 엔진에서의 DB Pooler 연결에 이렇게 문제가 있을 줄 알았다면 FastAPI와 SqlAlchemy를 절대 선택하지 않았을 것 같다. &lt;/p&gt;
&lt;p&gt;고찰, 의심, 경험.. 등등이 중요하다고 다시 한 번 느꼈다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI에서 Postgresql의 커넥션 관리]]></title><description><![CDATA[현재 회사의 서비스에서 RDB를 사용하지 않고 NoSQL(DynamoDB)만 사용해서 어플리케이션 서비스를 하고 있었다.  필연적으로 RDB를 도입하게 되었고, supabase를 사용해보고 싶어서 DB…]]></description><link>https://sharknia.github.io/FastAPI에서-Postgresql의-커넥션-관리/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI에서-Postgresql의-커넥션-관리/</guid><pubDate>Fri, 15 Dec 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;현재 회사의 서비스에서 RDB를 사용하지 않고 NoSQL(DynamoDB)만 사용해서 어플리케이션 서비스를 하고 있었다. &lt;/p&gt;
&lt;p&gt;필연적으로 RDB를 도입하게 되었고, supabase를 사용해보고 싶어서 DB는 깊은 고찰 없이 아무도 사용해본 적이 없었던 Postgresql을 고르게 되었다.&lt;/p&gt;
&lt;p&gt;이것이 고생의 시작이었다. &lt;/p&gt;
&lt;p&gt;그 고생을 기록해둔다. &lt;/p&gt;
&lt;h3&gt;1. 커넥션 직접 연결&lt;/h3&gt;
&lt;p&gt;MySQL, Oracle, MsSQL등을 사용해봤지만 Postgresql은 처음이었다. 아무 생각없이 커넥션을 바로 연결했고 곧장 문제가 발생했다. &lt;/p&gt;
&lt;p&gt;supabase에서 사용하는 요금제에서 커넥션을 65개까지 만들 수 있게끔 되어있었는데, 수시로 이 수치를 넘어버렸다. 작업 시작 당시 테스트 서버에서는 인스턴스를 5개를 사용하고 있었고, 기본값으로 인스턴스 하나 당 연결 5개를 사용하고 있었서 단순히 산술적으로는 65개를 넘어서는 안되는데 계속해서 65개를 넘겨서 DB 서버가 지속적으로 죽고 있었다. &lt;/p&gt;
&lt;h3&gt;2. 커넥션 폭증, 첫번째 추측&lt;/h3&gt;
&lt;p&gt;첫번째 추측으로는 세션의 생명주기를 관리하는 코드가 정상적으로 작동하는지 여부를 의심했다. 비동기에서의 세션 관리를 위해 의존성 주입 방식을 통한 세션 관리 방법을 선택하고 있었는데, 해당 코드를 다음과 같이 강화해주었다. &lt;/p&gt;
&lt;h4&gt;수정 전 코드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_conn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Engine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;get_db_connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncIterable&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Session&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; sessionmaker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_conn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; class_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expire_on_commit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; session&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;수정 후 코드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_conn&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Engine &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;get_db_connection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; AsyncIterable&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Session&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; sessionmaker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db_conn&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; class_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expire_on_commit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; session
    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[get_db_session] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이론적으로는 위 코드만 사용해도 정상적으로 세션의 생명주기가 관리가 되어야 하는데, 해외에도 나와 같은 이슈를 겪는 사람이 있는 것으로 보였다. 아래처럼 수정 후에 눈에 띄게 커넥션 숫자가 줄었지만 여전히 DB 서버는 개복치 그 자체였다. 조금 나아지긴 했지만 숨만 쉬면 죽어나가는 상황이 반복되었고 여전히 실사용이 불가능한 심각한 상태의 환자였다. &lt;/p&gt;
&lt;h3&gt;3. 커넥션 폭증, 두번째 추측&lt;/h3&gt;
&lt;p&gt;두번째 추측으로는 dev는 테스트를 위해서 인스턴스 재생성이 꽤 잦았는데, 이 과정에서 Connection이 계속해서 다시 만들어지면서 연결이 폭증하는 것으로 보였다. &lt;/p&gt;
&lt;p&gt;Postgresql 설정에서 IDLE 상태로 들어간지 오래된 커넥션은 강제로 죽이는 옵션도 찾았는데, supabase에서는 해당 옵션값 설정은 지원하지 않았다. 아무래도 일반적인 대응 방법은 아닌것으로 보였다.
인스턴스가 재생성 될때마다 연결이 안끊긴다면? 애초에 연결을 많이 안만들면 되는게 아닌가? 라는 결론에 다다랐다. 따라서 자연스럽게 Pooler를 사용하기로 했다. Supabase에서도 공식적으로 Pooler를 (당연히) 지원하므로 이는 완벽한 해결책으로 생각됐다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    Pooler란?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;데이터베이스 서버와 클라이언트 애플리케이션 간의 연결을 관리하는 소프트웨어이다. 이는 데이터베이스 서버에 대한 연결 요청을 효율적으로 처리하고 성능을 최적화하는 데 도움을 준다. &lt;/p&gt;
&lt;h4&gt;연결 재사용&lt;/h4&gt;
&lt;p&gt;풀러는 데이터베이스 서버에 대한 연결을 재사용 할 수 있게 함으로써 매번 새로운 연결을 생성하는 오버헤드를 감소시킨다. &lt;/p&gt;
&lt;h4&gt;부하 관리&lt;/h4&gt;
&lt;p&gt;동시에 많은 클라이언트 요청을 처리할 수 있도록 도와주며 데이터베이스 서버에 가해지는 부하를 분산시킨다. &lt;/p&gt;
&lt;h4&gt;성능 최적화&lt;/h4&gt;
&lt;p&gt;연결 설정과 해제에 소요되는 시간을 줄임으로써 전반적인 애플리케이션 성능을 향상시킨다. &lt;/p&gt;
&lt;h4&gt;자원 관리&lt;/h4&gt;
&lt;p&gt;데이터베이스 연결에 사용되는 리소스를 효율적으로 관리한다. &lt;/p&gt;
&lt;h4&gt;스케일링&lt;/h4&gt;
&lt;p&gt;애플리케이션 확장성을 지원하며 사용자 요청 증가 시에도 안정적인 서비스 제공을 돕는다. &lt;/p&gt;
&lt;p&gt;풀러의 사용은 특히 많은 수의 동시 사용자와 트랜잭션이 있는 대규모 시스템에서 매우 중요하다. 데이터베이스에 대한 연결을 효과적으로 관리함으로써 시스템의 안정성, 성능, 그리고 확장성을 향상시킬 수 있다. &lt;/p&gt;
&lt;h3&gt;4. Pooler 도입&lt;/h3&gt;
&lt;p&gt;supabase의 pooler는 PgBouncer를 제공하며, 사용법이 매우 간단했다. 기존에 사용하던 5432번 포트 대신 6543 포트로 바꿔서 연결해주기만 하면 됐다. &lt;/p&gt;
&lt;p&gt;또 다시 곧장 문제가 발생했다. Supabase의 PgBouncer  Poolmode는 기본적으로 Transation 모드였는데, 해당 모드에서는 SqlAlchemy의 비동기 엔진의 캐싱 기능을 지원하지 않았다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    Pgbouncer의 Pool Mode&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Session&lt;/h4&gt;
&lt;p&gt;가장 기본적인 풀링 모드로 클라이언트가 연결을 끊을 때까지 PgBouncer는 해당 클라이언트 연결을 데이터베이스 서버에 계속 연결 상태로 유지한다. &lt;/p&gt;
&lt;h4&gt;Transaction&lt;/h4&gt;
&lt;p&gt;이 모드에서 PgBouncer는 각 SQL 트랜잭션이 완료될 때마다 연결을 풀로 반환한다. 이는 트랜잭션간에 서버 세션 상태를 유지하지 않아므로 세션 수준의 상태 설정이 트랜잭션간에 유지되지 않는다. Supabase의 Postgresql의 Pool mode는 기본적으로 Transacion 모드로 설정되어있다. &lt;/p&gt;
&lt;h4&gt;Statement&lt;/h4&gt;
&lt;p&gt;가장 제한적인 풀링 모드로 각 SQL 문(statement)이 완료될 때마다 연결을 풀로 반환한다. Supabase의 Postgresql은 해당 모드를 지원하지 않는다. &lt;/p&gt;
&lt;h3&gt;5. Pooler 사용시 인스턴스 생성 에러 발생&lt;/h3&gt;
&lt;p&gt;이번엔 문제가 바로 발생하지는 않았다. 당일은 지나갔으나 다음날이 되어서야 발견했다. 인스턴스 오류가 발생해서 항사 연결이 끊기는 것도 아니고 간헐적으로 연결이 끊기고 있었다. &lt;/p&gt;
&lt;h4&gt;당시 발생한 인스턴스 생성 에러&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;plaintext&quot;&gt;&lt;pre class=&quot;language-plaintext&quot;&gt;&lt;code class=&quot;language-plaintext&quot;&gt;Log ID
5c0963cf-d16a-4cf3-b3fe-33c99147f879
Log Timestamp (UTC)
2023-12-11T02:36:52.732Z
Log Event Message
password authentication failed for user &quot;postgres&quot;
Log Metadata
[
  {
    &quot;file&quot;: null,
    &quot;host&quot;: &quot;db-fskkusemekciragirqyd&quot;,
    &quot;metadata&quot;: [],
    &quot;parsed&quot;: [
      {
        &quot;application_name&quot;: null,
        &quot;backend_type&quot;: &quot;client backend&quot;,
        &quot;command_tag&quot;: &quot;authentication&quot;,
        &quot;connection_from&quot;: &quot;61.1.172.3:56746&quot;,
        &quot;context&quot;: null,
        &quot;database_name&quot;: &quot;postgres&quot;,
        &quot;detail&quot;: &quot;Connection matched pg_hba.conf line 91: \&quot;host  all  all  0.0.0.0/0     scram-sha-256\&quot;&quot;,
        &quot;error_severity&quot;: &quot;FATAL&quot;,
        &quot;hint&quot;: null,
        &quot;internal_query&quot;: null,
        &quot;internal_query_pos&quot;: null,
        &quot;leader_pid&quot;: null,
        &quot;location&quot;: null,
        &quot;process_id&quot;: 89111,
        &quot;query&quot;: null,
        &quot;query_id&quot;: 0,
        &quot;query_pos&quot;: null,
        &quot;session_id&quot;: &quot;657675c4.15c17&quot;,
        &quot;session_line_num&quot;: 2,
        &quot;session_start_time&quot;: &quot;2023-12-11 02:36:52 UTC&quot;,
        &quot;sql_state_code&quot;: &quot;28P01&quot;,
        &quot;timestamp&quot;: &quot;2023-12-11 02:36:52.732 UTC&quot;,
        &quot;transaction_id&quot;: 0,
        &quot;user_name&quot;: &quot;postgres&quot;,
        &quot;virtual_transaction_id&quot;: &quot;47/2627&quot;
      }
    ],
    &quot;parsed_from&quot;: null,
    &quot;project&quot;: null,
    &quot;source_type&quot;: null
  }
]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;같은 설정에 같은 서버인데 뜬금없이 간헐적으로 패스워드 에러가 발생하니 죽을맛이었다. &lt;/p&gt;
&lt;p&gt;그러면 안되지만, 오류의 빈도수라도 적다면 그냥 무시하고 넘어갈텐데 무시하기엔 높은 빈도로 에러가 발생했다. PgBouncer의 지원이 2024년 1월로 끝난다고 하니 애초에 비동기와의 호환성 자체가 좋지 않아보였다. 이 시점에서 Pooler 사용을 포기하고 다른 방법을 찾기로 했다. &lt;/p&gt;
&lt;p&gt;PgBouncer 지원이 끊기고 대안으로 Superbase에서는 &lt;a href=&quot;https://github.com/supabase/supavisor&quot;&gt;https://github.com/supabase/supavisor&lt;/a&gt;를 제시하고 있었는데, 아직 그다지 완성도가 높지 않아보였으며(본인들의 공식 문서에도 없으므로) 시간이 넉넉하지 않아 도입이 망설여졌다. 그래서 다시 커넥션 직접 연결을 선택하고, 커넥션이 폭증하는 문제 자체를 해결하기로 했다. &lt;/p&gt;
&lt;h3&gt;6. 커넥션 직접 연결로 회귀&lt;/h3&gt;
&lt;p&gt;여담으로, 일을 하면서 챗지피티의 도움을 참 많이 받는다. 그런데 이번 업무를 처리하면서 Deep한 업무일수록 챗지피티가 4.0이라도 헛소리를 많이 한다는 사실을 알게됐다. 어떻게 알았냐고? 나도 알고 싶지 않았다. &lt;/p&gt;
&lt;p&gt;아예 처음으로 돌아와서 커넥션 폭증에 대해서 다시 한 번 알아보기로 했다. 이쯤에서 이미 실서버는 오픈을 해야 했기 때문에, 커넥션 직접 연결로 바꾸고 추가 결제를 해서 커넥션 총 개수를 200여개로 늘려버렸다. 실서버에서는 인스턴스가 바뀌는 일이 자주 있는 일이 아니었으므로, 모니터링 결과 IDLE 상태로 접어든 죽은 커넥션도 12시간 안에 종료가 되는 것을 경험적으로 확인했으므로 실서버에서는 200개 정도로 커넥션 연결 가능 개수를 늘려두면 어쨌건 서비스가 가능했다. &lt;/p&gt;
&lt;p&gt;이렇게 실서버를 열어두고 문제를 해결하기 위해 시간을 녹이기 시작했다. &lt;/p&gt;
&lt;p&gt;커넥션 자체의 관리는 이론적으로는 아주 간단했다. 앱을 시작할 때에 커넥션을 열며, 앱을 종료할 때 커넥션을 닫는다. 이를 위해서 FastAPI의 &lt;code class=&quot;language-text&quot;&gt;on_event(”startup”)&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;on_event(”shutdown”)&lt;/code&gt; 을 사용했다. 챗지피티도 이 코드를 알려줬고, 어느 블로그를 봐도 모두 이 코드를 사용하고 있었다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://fastapi.tiangolo.com/advanced/events/#alternative-events-deprecated&quot;&gt;https://fastapi.tiangolo.com/advanced/events/#alternative-events-deprecated&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;근데 충격적이게도 이 방법은 이미 지원이 중단된 방법이었다.  이 방법 대신 lifespan 방법을 선택해야 했는데, 이 방법에 대해서 챗지피티는 알고 있음에도 불구하고 여전히 지원 중단된 방법을 추천하는 것을 보고  이 시점에서 챗지피티에 대한 신뢰를 상당 부분 잃어버리고 사용 빈도가 확 줄게 되었다. 나중에 알게 되지만 이 코드의 문제는 아니었지만! 아무튼 신뢰가 엄청나게 없어져버렸다. &lt;/p&gt;
&lt;p&gt;해당 코드를 lifespan을 활용한 코드로도 변경하고도 여전히 문제는 반복됐다. 앱이 시작될 때는 코드가 정상적으로 작동했지만, 컨테이너 안에서 앱이 종료될 때에는 종료 코드가 정상적으로 작동하지 않았다. &lt;/p&gt;
&lt;p&gt;이를 위해서 sigterm을 활용해 직접 종료 코드를 잡아서 실행하는 방법도 고려했지만 이 방법 역시 작동하지 않았다. &lt;/p&gt;
&lt;p&gt;하지만 아주 삽질은 아니어서, 로컬에서 실행한 경우에는 정상적으로 종료 코드가 작동하고 커넥션이 끊어지는 것을 확인해버렸다. &lt;/p&gt;
&lt;h3&gt;7. 문제 해결&lt;/h3&gt;
&lt;p&gt;힞;민 모드를 바꿨음에도 캐싱은 여전히 작동하지 않아서 캐싱을 강제로 꺼야 했고 잘 꺼지지도 않았는지 이후에도 Sqlalchemy의 캐싱 과정에서 키값이 중복되게 생성되는 문제가 있어 해당 부분을 오버라이드 해서 키 값이 중복되지 않게 만들게 해주는 등 문제가 있었지만 일단은 연결이 끊기거나 커넥션이 폭증하지 않아 해결이 된 것으로 보였다. &lt;/p&gt;
&lt;p&gt;사실 이 전에 종료 신호가 정상적으로 어플리케이션에 도달하지 못하는 것이 아닌가? 에 대해서 인지를 하고 있었다. 도커 컨테이너를 강제 종료 하면 기본적으로 docker는 1번 프로세스에만 종료 명령을 정상적으로 전달하고 나머지 프로세스에게는 종료 명령을 정상 전달하지 않는다. 도커 작업은 다른 개발자가 진행했는데, 컨테이너 안에서 실행되는 작업이라곤 Uvicorn 하나이므로 당연히 1번 프로세스일것이다 라는 말을 들어서 이 부분을 점검해볼 생각을 못하고 있었다. &lt;/p&gt;
&lt;p&gt;근데, 로컬에서 실행했을때에는 정상적으로 커넥션이 끊어지는데 도커 컨테이너를 통해서 실행한 경우에는 정상 종료가 되지 않는다? 이 문제를 확인하고 나서야 이 부분을 점검해볼 생각이 들었고, 점검 결과 충격적이게도 Uvicorn이 1번 프로세스로 실행되지 않고 있었다. &lt;/p&gt;
&lt;p&gt;Dumb-init이라는 Docker 컨테이너의 모든 프로세스에게 종료 신호를 보내주는 소프트웨어도 잠깐 고려했지만, 간단하게 Docker exec 부분을 수정해 Uvicorn이 1번 프로세스로 컨테이너 안에서 실행되게끔 하자 거짓말처럼 모든 문제가 해결되었다. &lt;/p&gt;
&lt;h3&gt;8. 회고&lt;/h3&gt;
&lt;p&gt;전 회사에서도 이미 만들어진 커넥션을 쓰거나, 그냥 가이드대로 연결하면 대충 됐기 때문에 DB와 서버의 연결에 관해서 깊게 고찰해본 적이 없었다. 이번 일을 겪으면서 일단 DB와 서버의 연결에 대해.. 대충 알고 있던 부분들에 대해서 깊은 학습이 되었다. &lt;/p&gt;
&lt;p&gt;문제해결 방법을 가장 마지막에 발견했지만, 사실 꼼꼼히 살폈다면 초장에 해결할 수 있던 간단한 문제였다. 돌고 돌아 삥 돌아 해결을 했지만 최종적인 코드 수정은 굉장히 적었다. 공부 했으니 한잔해~ 하고 넘어가기에는 무보수 야근이 너무 잦았기 때문에 (덕분인지 시원하게 A형 독감도 걸렸다. 아무튼 야근 탓이다. ) 억울한 부분이 크다. &lt;/p&gt;
&lt;p&gt;챗지피티에 대한 신뢰가 컸는데, 이번 일을 진행하면서는 챗지피티 때문에 뱅뱅 돌아가게 된 부분이 많았다. 확실히 겉핥기 부분만 챗지피티에게 기대야 하며(또는 반복적인 일) 딥 한 문제나 조금이라도 인터넷에 자료가 적은 문제들에 대해서는 공식문서를 신뢰해야 한다는 사실을 다시 한 번 뼈저리게 느꼈다. 이후로 나는 예전처럼 챗지피티를 많이 쓰지는 않는다.. 쓰더라도 조심히 사용한다. &lt;/p&gt;
&lt;p&gt;한편으로, 커넥션 직접 연결 방법을 선택해 문제를 해결했지만 이게 완벽히 올바른 방법이라고는 생각이 들지 않는다. 아직은 서비스의 크기가 완벽하게 크지는 않기 때문에 이 방법으로도 가능하지만, Pooler를 사용하는 것이 올바른 해결 방법이 아닐까? 지금도 단순히 문제를 피해 도망친 것이라고밖에 생각이 들지 않는다. 특히 Pooler로 인해 발생한 문제들은 풀리지 않은 미스테리가 너무 많이 남았다. &lt;/p&gt;
&lt;p&gt;추후 기회가 있다면 supavisor를 기반으로 다시 만들어보고 싶은 생각이 있다. 아니, 반드시 그래야 한다고 생각이 든다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[PynamoDB와 boto3, PynamoDB의 커넥션]]></title><description><![CDATA[회사에서 DynamoDB를 사용할 때에, PynamoDB ORM을 사용하여 연결을 하고 있다.  Postgresql을 도입했을 때에 커넥션 문제가 지속적으로 발생해 (연결이.. 끊어지지 않는다!) 이를 처리하던 도중 PynamoDB…]]></description><link>https://sharknia.github.io/PynamoDB와-boto3-PynamoDB의-커넥션/</link><guid isPermaLink="false">https://sharknia.github.io/PynamoDB와-boto3-PynamoDB의-커넥션/</guid><pubDate>Fri, 08 Dec 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;회사에서 DynamoDB를 사용할 때에, PynamoDB ORM을 사용하여 연결을 하고 있다. &lt;/p&gt;
&lt;p&gt;Postgresql을 도입했을 때에 커넥션 문제가 지속적으로 발생해 (연결이.. 끊어지지 않는다!) 이를 처리하던 도중 PynamoDB는 어떻게 커넥션을 관리하는지 궁금해서 찾아보게 되었다. &lt;/p&gt;
&lt;h3&gt;PynamoDB란?&lt;/h3&gt;
&lt;p&gt;PynamoDB는 DynamoDB를 위한 Python 라이브러리이다. &lt;/p&gt;
&lt;h4&gt;Pythonic Interface&lt;/h4&gt;
&lt;p&gt;파이썬 개발자들이 익숙한 객체 지향 접근 방식을 제공한다. &lt;/p&gt;
&lt;h4&gt;간편한 데이터 모델링&lt;/h4&gt;
&lt;p&gt;PynamoDB를 사용하면 DynamoDB 테이블과 항목을 Python 클래스로 모델링 할 수 있다. &lt;/p&gt;
&lt;h4&gt;CRUD Operation&lt;/h4&gt;
&lt;p&gt;PynamoDB는 Create, Read, Update, Delete 작업을 간편하게 수행할 수 있는 메소드를 제공한다. &lt;/p&gt;
&lt;h3&gt;PynamoDB의 커넥션 관리&lt;/h3&gt;
&lt;p&gt;PynamoDB에서 커넥션은 boto3를 사용해서 관리하며, Low Level의 API를 사용하면 커넥션을 직접 연결할 수 있지만 기본적으로는 자동으로 관리를 한다. 설정 몇가지만 해주면(또는 하지 않아도) 필요에 따라서 알아서 커넥션을 맺고 끊는다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pynamodb.readthedocs.io/en/stable/settings.html&quot;&gt;https://pynamodb.readthedocs.io/en/stable/settings.html&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;boto3란?&lt;/h3&gt;
&lt;p&gt;AWS를 위한 AWS 공식 Python SDK이다. 이 라이브러리를 통해 Python 어플리케이션에서 AWS를 쉽게 사용 및 관리 할 수 있다. &lt;/p&gt;
&lt;h4&gt;광범위한 AWS 서비스 지원&lt;/h4&gt;
&lt;p&gt;S3, EC2, DynamoDB, IAM 등 AWS에서 제공하는 대부분의 서비스를 지원한다. &lt;/p&gt;
&lt;h4&gt;높은 수준의 객체 지향 API와 low level API 제공&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Resource API&lt;/code&gt;는 높은 수준의 객체 지향 인터페이스를 제공하여 사용자가 AWS 리소스를 직관적으로 다룰 수 있게 해준다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Client API&lt;/code&gt; 는 낮은 수준, 서비스 중심의 인터페이스를 제공하여 더 세밀한 제어가 필요할 때 사용할 수 있다. &lt;/p&gt;
&lt;h4&gt;자격 증명 관리와 보안&lt;/h4&gt;
&lt;p&gt;AWS의 자격 증명을 효과적으로 관리할 수 잇는 기능을 제공한다.    &lt;/p&gt;</content:encoded></item><item><title><![CDATA[단축어로 SLACK 프로필 변경하기]]></title><description><![CDATA[소개 애플 단축어를 활용해 간단하게 슬랙 상태를 원클릭으로 변경할 수 있습니다. 슬랙의 API를 이용합니다.  저는 개인적으로 raycast…]]></description><link>https://sharknia.github.io/단축어로-SLACK-프로필-변경하기/</link><guid isPermaLink="false">https://sharknia.github.io/단축어로-SLACK-프로필-변경하기/</guid><pubDate>Fri, 17 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;소개&lt;/h2&gt;
&lt;p&gt;애플 단축어를 활용해 간단하게 슬랙 상태를 원클릭으로 변경할 수 있습니다. 슬랙의 API를 이용합니다. &lt;/p&gt;
&lt;p&gt;저는 개인적으로 raycast의 뽀모도로 익스텐션과 함께 다음과 같이 사용하고 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/adb71f64d5a742c08b823d384bf9761f/f97d7/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 44.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/0lEQVR42oXPy06EMBQGYN7AqFwEWpBC6QVKKVBwhpgw48zOxJ1rNy6ML8JjW0eNJmYg+Vbn5O/5a83z/Piw2w/tpJuTduqNbtVu0NaG0y5Dd7Rqc9Yz2hHa4txMVqkktvLLC2pfHcd3QcYNLyWWxS2pQaAW1aHPnWuLu7bxnKVTnsok6xDakrSJgMkvkCbs2p/hwrXfGH1qhGL1wIpjW2uU1DBUETjHbAvP+b78SvIuoZrQKitEcHoehucoGEoQ/IZfKO4R1RirlEiw0vnLT9hzOn5/qBom9qIcD0q2MTTf/s/c1Em8JVj9rS0iJAEUAJYAmkoiuFlQhb7wPe7aH35KU9czxti3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/adb71f64d5a742c08b823d384bf9761f/ca1dc/image1.png&apos; srcset=&apos;/static/adb71f64d5a742c08b823d384bf9761f/e7570/image1.png 170w,
/static/adb71f64d5a742c08b823d384bf9761f/f46e7/image1.png 340w,
/static/adb71f64d5a742c08b823d384bf9761f/ca1dc/image1.png 680w,
/static/adb71f64d5a742c08b823d384bf9761f/02d09/image1.png 1020w,
/static/adb71f64d5a742c08b823d384bf9761f/9d567/image1.png 1360w,
/static/adb71f64d5a742c08b823d384bf9761f/f97d7/image1.png 2000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
집중을 시작할 때에 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;집중 모드 킴&lt;/li&gt;
&lt;li&gt;음량 조절&lt;/li&gt;
&lt;li&gt;노래 재생&lt;/li&gt;
&lt;li&gt;슬랙 방해금지 상태 변경&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e1c21d95548582669bcbdbcb01977ed2/f97d7/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 27.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVR42o3OSw6CMBgEYHYuRRHQFqyALbY8+tNCI3EBXsC41Z2nIPH01gNgTL7MZjLJOO9pej0fYweDrsdWjZ2l/2K0o1ICBPVcGq6AMn1MdXbQqUXmfVsgkcM3K+YurnA7w50nWRPjBgc12kKE5ki8syn8tSMCj/uuIXTIhWQlZ6picOF5EyOYYbKk2eMi9L5j4S9lVvQnqGkpqKxo2ef0x7i1n2NUhN4HSRUw45IM1g4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/e1c21d95548582669bcbdbcb01977ed2/ca1dc/image2.png&apos; srcset=&apos;/static/e1c21d95548582669bcbdbcb01977ed2/e7570/image2.png 170w,
/static/e1c21d95548582669bcbdbcb01977ed2/f46e7/image2.png 340w,
/static/e1c21d95548582669bcbdbcb01977ed2/ca1dc/image2.png 680w,
/static/e1c21d95548582669bcbdbcb01977ed2/02d09/image2.png 1020w,
/static/e1c21d95548582669bcbdbcb01977ed2/9d567/image2.png 1360w,
/static/e1c21d95548582669bcbdbcb01977ed2/f97d7/image2.png 2000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
집중을 끝낼 때에&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;집중 모드 끔&lt;/li&gt;
&lt;li&gt;슬랙 방해금지 상태 해제&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;집중 모드에서는 다른 알림을 모두 꺼두고 슬랙 알림만 켜서 업무 흐름은 놓치지 않게 해두었습니다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/20ce3a7a0ec6e93c498938387b6e31e6/f97d7/image3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 36.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVR42mNol+PpUJeol+ZrV5FYFeI71cFyjpt9taJMpZ52o7XVguKiPA2NYnOLRl//VC29bDPrZH3TWG3DZAv7CD1ThlUJKSsT05fFpc0Ni+3x82lwcay2sS00syywtiuwc64MDEs3s04xs023dUkwtUuxdU2wco4wtkmy925PrmJ4d+3/26t/v9z5f3DtuYbknpbUmWUZRcUpeVmRyRmhCan+0Rkh8RnB8emBMZnBcWmBMelBMakBUdnhyWtnbmV4f/v/u1t/vz78v2/d0Y7Yyb3RC+sLSysyc9PDotOCI1MCw5P9w5L8Q5P8QhIhyDckwScowSe4KCmT4dGjxw8fPnr24uWe9ZuDeluc5/SWpWflJySnhUUkh4QlBoTE+wfH+wXF+wJRYLxPYJx3QJyXP5BbW1DG8OLFy+fPX7z98GHfhs3u/Y2WC3rK0jOyYmJD3dyCXVwDHZwC7R0D7BwDbB0CbMDI2t7f2g4okpucyvD///9///4ByadPnmxYtmzdosUrFi2aM3Xq5J6eSd3dEzu7JnZ2TgCijs6JMDShvWNqb++KxYsBAPO+WPH/dMMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image3&apos; title=&apos;&apos; src=&apos;/static/20ce3a7a0ec6e93c498938387b6e31e6/ca1dc/image3.png&apos; srcset=&apos;/static/20ce3a7a0ec6e93c498938387b6e31e6/e7570/image3.png 170w,
/static/20ce3a7a0ec6e93c498938387b6e31e6/f46e7/image3.png 340w,
/static/20ce3a7a0ec6e93c498938387b6e31e6/ca1dc/image3.png 680w,
/static/20ce3a7a0ec6e93c498938387b6e31e6/02d09/image3.png 1020w,
/static/20ce3a7a0ec6e93c498938387b6e31e6/9d567/image3.png 1360w,
/static/20ce3a7a0ec6e93c498938387b6e31e6/f97d7/image3.png 2000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
메뉴바에서 원클릭으로 설정할 수 있어 편리합니다. &lt;/p&gt;
&lt;h2&gt;설정법&lt;/h2&gt;
&lt;h3&gt;슬랙의 API App 생성&lt;/h3&gt;
&lt;p&gt;먼저 슬랙의 API App을 만들어야 합니다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://api.slack.com/&quot;&gt;https://api.slack.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;해당 페이지로 이동 후, 우측 상단의 Your apps으로 이동합니다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Create New App&lt;/code&gt; 을 클릭합니다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;From an app manifest&lt;/code&gt; 를 선택 후, workspace를 고르고 Next 합니다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;YAML&lt;/code&gt;을 고르고, 다음의 내용을 입력합니다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;display_information&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Apple 상태변경 단축어
&lt;span class=&quot;token key atrule&quot;&gt;oauth_config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;scopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; users.profile&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;write
&lt;span class=&quot;token key atrule&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;org_deploy_enabled&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;socket_mode_enabled&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;token_rotation_enabled&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;권한을 더 원한다면 더 많이 입력해주셔도 됩니다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Create&lt;/code&gt;를 눌러 앱을 생성합니다. &lt;/p&gt;
&lt;p&gt;그 후 바로 그 화면에서 &lt;code class=&quot;language-text&quot;&gt;Install to Workspace&lt;/code&gt;를 클릭해 앱을 인스톨합니다. &lt;/p&gt;
&lt;p&gt;그리고, 좌측 메뉴에서 &lt;code class=&quot;language-text&quot;&gt;OAuth &amp;amp; Permissions&lt;/code&gt; 메뉴로 이동합니다. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OAuth Token&lt;/strong&gt; 값을 복사해줍니다. 슬랙 페이지에서 할 일은 여기까지입니다. &lt;/p&gt;
&lt;h3&gt;단축어 설정&lt;/h3&gt;
&lt;p&gt;단축어 앱을 열고 새로운 단축어를 추가합니다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;URL 콘텐츠 가져오기&lt;/code&gt; 를 검색해서 다음과 같이 설정합니다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c5bf66afaf9308636696df7659cbc53d/f97d7/image4.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 40.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABgElEQVR42kWQjU6rMBTH9wY6p4yxMT4LK7SUwoCWj4IwZBoWE030JvcFfP8nsLs30eSX5qQ5v/Z/zmJI/D+czk3W5klFYgnHWMRRn0YNhpKWhA2CAgdtFPZZcm6by/A4Vvyp5gu8XgW3NzhSaQpTj+SIlgmvSfKIvMLWC2vXBiA3tWh9h+5v2AFMreiyozimp6pakM2KqHfpTq09K7c24mA9FwmDQaqrUmbOvsMH7hpEXeGHZYWd96n5bMtLHp8QWMhbSbJVhhhNGRWh3yFfQKdDh8q3S8/iwMoMjWzu0cNth+Hf+fwxiNe6GGl4lWWkdLfuoHum4Yj9uTgOGA6hKzyzAYY8r7JsU5bcNV9r9pLFYxxIfmWZrXD0Ewmeq5oBh9l6CUyJDP8jM9ecy+zC0ylBJwJ/ZRGA2rNL16iBUTr7kaKXnPbY584+M7eyDSnLHjhfl/lz7CaKJP9mXq/oVmGmVto6N7Urhva/YMZG1vLp68KUZePZbzWT3/bIG7D/DQP6VaAwkXntAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image4&apos; title=&apos;&apos; src=&apos;/static/c5bf66afaf9308636696df7659cbc53d/ca1dc/image4.png&apos; srcset=&apos;/static/c5bf66afaf9308636696df7659cbc53d/e7570/image4.png 170w,
/static/c5bf66afaf9308636696df7659cbc53d/f46e7/image4.png 340w,
/static/c5bf66afaf9308636696df7659cbc53d/ca1dc/image4.png 680w,
/static/c5bf66afaf9308636696df7659cbc53d/02d09/image4.png 1020w,
/static/c5bf66afaf9308636696df7659cbc53d/9d567/image4.png 1360w,
/static/c5bf66afaf9308636696df7659cbc53d/f97d7/image4.png 2000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
입력해야 하는 값은 다음과 같습니다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;헤더&lt;/p&gt;
&lt;p&gt;키 : Authorization&lt;/p&gt;
&lt;p&gt;값 : Bearer xoxp-xxxxx-xxxx…&lt;/p&gt;
&lt;p&gt;키 : Content-Type&lt;/p&gt;
&lt;p&gt;값 : application/json; charset=UTF-8&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;바디&lt;/p&gt;
&lt;p&gt;키 : profile&lt;/p&gt;
&lt;p&gt;값 : &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;status_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;방해금지&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;token property&quot;&gt;&quot;status_emoji&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;:no_entry_sign:&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;원하는 이모지와 텍스트를 넣어주시면 됩니다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이렇게 하면 단축어가 완성됩니다. &lt;/p&gt;
&lt;h2&gt;참고&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://api.slack.com/apps?deleted=1&quot;&gt;https://api.slack.com/apps?deleted=1&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[aiohttp]]></title><description><![CDATA[aiohttp는 파이썬의 비동기 HTTP 네트워킹 라이브러리이다. 이 라이브러리는 asyncio를 사용하여 비동기 I/O를 수행하고 클라이언트와 서버 양쪽 모두에 대한 HTTP 지원을 제공한다.  즉 aiohttp를 사용하면 비동기적으로 HTTP…]]></description><link>https://sharknia.github.io/aiohttp/</link><guid isPermaLink="false">https://sharknia.github.io/aiohttp/</guid><pubDate>Wed, 08 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;aiohttp는 파이썬의 비동기 HTTP 네트워킹 라이브러리이다. 이 라이브러리는 asyncio를 사용하여 비동기 I/O를 수행하고 클라이언트와 서버 양쪽 모두에 대한 HTTP 지원을 제공한다. &lt;/p&gt;
&lt;p&gt;즉 aiohttp를 사용하면 비동기적으로 HTTP 요청을 보내고 응답을 받을 수 있다. &lt;/p&gt;
&lt;h2&gt;주요 특징&lt;/h2&gt;
&lt;h4&gt;비동기/동시성 지원&lt;/h4&gt;
&lt;p&gt;async, await를 사용하여 동시에 여러 HTTP 요청을 비동기적으로 처리할 수 있다. &lt;/p&gt;
&lt;h4&gt;서버와 클라이언트 사이드 지원&lt;/h4&gt;
&lt;p&gt;HTTP 클라이언트 기능과 HTTP 서버 기능을 모두 제공한다. &lt;/p&gt;
&lt;h4&gt;웹소켓 지원&lt;/h4&gt;
&lt;p&gt;웹소켓 연결 및 통신을 지원한다. &lt;/p&gt;
&lt;h4&gt;신호 및 슬롯 매커니즘&lt;/h4&gt;
&lt;p&gt;요청 처리 과정에서 다양한 이벤트에 대응할 수 있게 해준다. &lt;/p&gt;
&lt;h2&gt;설치&lt;/h2&gt;
&lt;p&gt;파이썬 설치에 기본적으로 포함되지 않은 외부 라이브러리이다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; aiohttp&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;pip를 이용해 간단하게 설치할 수 있다. &lt;/p&gt;
&lt;h2&gt;예제&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        html &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;http://python.org&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;html&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

loop &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_event_loop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
loop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_until_complete&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;python 공식 홈페이지에서 HTML을 비동기적으로 가져오고 출력하는 간단한 예제이다. &lt;/p&gt;
&lt;h2&gt;세션 관리&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ClientSession 객체를 사용하여 HTTP 클라이언트 세션을 관리할 수 있다.&lt;/strong&gt; &lt;/p&gt;
&lt;h4&gt;연결 재사용&lt;/h4&gt;
&lt;p&gt;여러 요청을 수행할 때, 세션은 자동으로 재연결을 사용한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/get&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/get&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;쿠키 관리&lt;/h4&gt;
&lt;p&gt;세션은 자동으로 쿠키를 관리한다. 첫 번째 요청에서 서버로부터 받은 쿠키는 자동으로 저장되고 다음 요청에 사용된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 첫 번째 요청&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/cookies/set?cookie_name=cookie_value&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 두 번째 요청 - 첫 번째 요청에서 설정된 쿠키가 포함됩니다.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/cookies&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;헤더의 기본값 설정&lt;/h4&gt;
&lt;p&gt;세션은 생성할 때 기본 헤더를 설정할 수 있으며 이후의 모든 요청에 이 헤더가 포함된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Authorization&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Bearer your_token&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;headers&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/headers&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;타임아웃 관리&lt;/h4&gt;
&lt;p&gt;세션 또는 개별 요청에 대한 타임아웃을 설정할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; aiohttp &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ClientTimeout

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    timeout &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ClientTimeout&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;total&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 전체 요청에 대한 타임아웃을 5초로 설정&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;timeout&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/delay/10&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;커스텀 설정&lt;/h4&gt;
&lt;p&gt;SSL 검증 비활성화, 프록시 설정 등의 커스텀 설정을 할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;https://self-signed.badssl.com/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ssl&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# SSL 검증 비활성화&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;자원 해제&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;async with&lt;/code&gt; 문을 사용하면 세션 사용이 끝날 때 자동으로 자원을 해제한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 세션 생성 및 자동 자원 해제&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    html &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://python.org&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;html&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;에러 핸들링&lt;/h2&gt;
&lt;h4&gt;HTTP 응답 에러&lt;/h4&gt;
&lt;p&gt;서버가 4XX 클라이언트 에러 또는 5XX 서버 에러를 반환하는 경우, &lt;code class=&quot;language-text&quot;&gt;ClientResponseError&lt;/code&gt; 가 발생할 수 있다. 이는 &lt;code class=&quot;language-text&quot;&gt;raise_for_status()&lt;/code&gt; 메서드를 사용하여 처리할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raise_for_status&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientResponseError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;HTTP Response Error: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;HTTP Client Error: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Unexpected Error: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/status/400&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 이 URL은 400 Bad Request를 반환합니다.&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;연결 에러&lt;/h4&gt;
&lt;p&gt;네트워크 문제 또는 DNS 문제로 인해 연결을 설정할 수 없는 경우 &lt;code class=&quot;language-text&quot;&gt;ClientConnectError&lt;/code&gt; 예외가 발생할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientConnectorError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Connection Error: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://nonexistent.url&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 존재하지 않는 URL&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;타임아웃 에러&lt;/h4&gt;
&lt;p&gt;지정된 타임아웃 내에 서버로부터 응답을 받지 못하는 경우 &lt;code class=&quot;language-text&quot;&gt;asyncio.TimeoutError&lt;/code&gt; 예외가 발생한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; timeout&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1초 타임아웃 설정&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TimeoutError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Timeout Error: The request timed out&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/delay/10&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 응답 지연 URL&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;일반 HTTP 클라이언트 에러&lt;/h4&gt;
&lt;p&gt;aiohttp가 발생시킬 수 있는 다른 클라이언트 에러를 처리한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Client Error: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fetch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/status/500&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 서버 에러 URL&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;스트리밍 응답&lt;/h2&gt;
&lt;p&gt;스트리밍 응답을 처리하는 것은 큰 데이터를 다룰 때 특히 유용하다. 스트리밍을 사용하여 응답의 전체 내용을 메모리에 한 번에 로드하지 않고 데이터를 조각으로 나누어 처리할 수 있다. 이 방법은 메모리 사용량을 최적화하고 대용량 응답을 효율적으로 처리할 수 있도록 한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;stream_response&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 스트리밍 응답 처리&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; data &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;iter_any&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;# 데이터 조각을 처리 (예: 파일에 쓰기, 출력 등)&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; stream_response&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://httpbin.org/stream/20&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 예제에서는 &lt;code class=&quot;language-text&quot;&gt;response.content.iter_any()&lt;/code&gt; 를 사용하여 응답 스트림에서 데이터를 순차적으로 읽는다. &lt;/p&gt;
&lt;p&gt;스트리밍 응답을 사용할 때는 데이터의 양이 많거나 응답을 받는 동안 다른 처리를 동시에 해야 하는 경우에 매우 효과적이다. 예를 들어 다운로드한 데이터를 파일에 쓰면서 동시에 다음 데이터 청크를 받거나 데이터를 받아서 실시간으로 사용자에게 전송하는 경우 등에 유용하다. &lt;/p&gt;
&lt;p&gt;스트리밍을 사용할 때에는 네트워크 상황이나 서버의 응답 특성에 따라 데이터를 받는 속도가 일정하지 않을 수 있음을 인지하고 있어야 한다. 데이터를 처리하는 로직이 블로킹되지 않도록 주의해야 하며, 가능하면 각 청크를 처리하는데 시간이 너무 오래 걸리지 않도록 설계해야 한다.&lt;/p&gt;
&lt;h2&gt;테스트&lt;/h2&gt;
&lt;p&gt;aiohttp의 비동기적인 특성 때문에 전통적인 동기 테스트 방식을 그대로 사용할 수 없다. 대신 aiohttp는 비동기 테스트를 지원하기 위해 pytest와 함께 사용할 수 있는 &lt;code class=&quot;language-text&quot;&gt;aitohttp.test_utils&lt;/code&gt; 모듈을 제공한다. 이를 통해 웹서버와 클라이언트 코드를 테스트 할 수 있다. &lt;/p&gt;
&lt;h4&gt;클라이언트 코드 테스트&lt;/h4&gt;
&lt;p&gt;클라이언트 코드를 테스트 하기 위해서는 일반적으로 pytest와 pytest-aiohttp 플러그인을 사용한다. 이를 통해 aiohttp 클라이언트 세션을 비동기적으로 테스트 할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; aiohttp
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; aiohttp &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; web

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_example_client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;aiohttp_client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; web&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Response&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Hello, world&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; web&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Application&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add_get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hello&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    client &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; aiohttp_client&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    resp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
    text &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; text &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello, world&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;aiohttp_client는 pytest-aiohttp 플러그인에서 제공하는 fixture로, 테스트용 애플리케이션 서버와 상호작용하는 데 사용할 수 있는 aiohttp.ClientSession 객체를 생성한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    fixture란?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트를 실행하기 전에 필요한 준비 작업과 설정을 의미한다. 일반적으로 fixture는 테스트 환경을 설정하고 테스트가 실행되는 동안 필요한 리소스나 상태를 생성하며, 테스트가 완료된 후에 정리 작업을 수행한다. &lt;/p&gt;
&lt;h4&gt;서버 코드 테스트&lt;/h4&gt;
&lt;p&gt;aiohttp 웹서버를 테스트 할 때에는 aiohttp.test_utils.TestClient를 사용하여 요청을 보내고 응답을 검사한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; aiohttp &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; web
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;test_utils &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; AioHTTPTestCase&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unittest_run_loop
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; myapp &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; create_app  &lt;span class=&quot;token comment&quot;&gt;# 가정: myapp 모듈에서 앱을 생성하는 함수&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyAppTestCase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AioHTTPTestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_application&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
        AioHTTPTestCase에서 애플리케이션 인스턴스를 생성하기 위해 오버라이드
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; create_app&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@unittest_run_loop&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        resp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
        text &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello, world&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; text&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;AioHTTPTestCase는 aiohttp.test&lt;em&gt;utils에서 제공하는 기본 테스트 케이스 클래스이며, unittest&lt;/em&gt;run_loop 데코레이터는 테스트 코루틴을 이벤트 루프에서 실행할 수 있게 해준다.&lt;/p&gt;
&lt;p&gt;aiohttp를 테스트할 때 주의해야 할 점은 테스트 환경에서도 비동기 코드를 올바르게 실행하기 위해 적절한 테스트 실행기를 설정해야 한다는 것이다. pytest는 비동기 테스트를 위한 좋은 선택이며, pytest-asyncio 플러그인을 사용하면 pytest에서 async def 테스트 함수를 직접 사용할 수 있다.&lt;/p&gt;
&lt;p&gt;또한, 실제 HTTP 호출을 모킹하기 위해 aiohttp의 pytest_plugin이 제공하는 aioresponses와 같은 도구를 사용할 수도 있다. 이를 통해 실제 외부 서비스와의 통신 없이 HTTP 요청과 응답을 시뮬레이션할 수 있어, 테스트의 견고성을 높이고 실행 시간을 단축시킬 수 있다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI에서 데코레이터와 Dependency]]></title><description><![CDATA[Dependency Injection…]]></description><link>https://sharknia.github.io/FastAPI에서-데코레이터와-Dependency/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI에서-데코레이터와-Dependency/</guid><pubDate>Tue, 07 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Dependency Injection 시스템과 데코레이터 시스템은 유사한 목적을 가질 수 있다. 하지만 구현과 사용법에서 몇 가지 차이점이 있다. &lt;/p&gt;
&lt;h2&gt;공통점&lt;/h2&gt;
&lt;h4&gt;명시적인 인증 체크&lt;/h4&gt;
&lt;p&gt;인증 로직을 명시적으로 라우트에 적용하여 추가 기능이 필요한 지점을 쉽게 식별할 수 있다. &lt;/p&gt;
&lt;h4&gt;중앙 집중식 관리&lt;/h4&gt;
&lt;p&gt;로직을 한 곳에서 관리함으로써 코드의 중복을 줄이고 일관성을 유지할 수 있다. &lt;/p&gt;
&lt;h2&gt;각 기능 별 장점&lt;/h2&gt;
&lt;h3&gt;Dependency Injection (의존성 주입)&lt;/h3&gt;
&lt;h4&gt;재사용성&lt;/h4&gt;
&lt;p&gt;Dependency는 여러 라우트에서 재사용 될 수 있으며 필요에 따라 다양한 파라미터와 함께 주입될 수 있다. &lt;/p&gt;
&lt;h4&gt;자동문서화&lt;/h4&gt;
&lt;p&gt;FastAPI의 스웨거 UI에서 Dependency가 자동으로 문서화된다. &lt;/p&gt;
&lt;h4&gt;형식 안정성&lt;/h4&gt;
&lt;p&gt;FastAPI의 형식 추론을 사용하여 파라미터의 유효성 검사와 변환을 자동으로 수행할 수 있다. &lt;/p&gt;
&lt;h3&gt;Decorator (데코레이터)&lt;/h3&gt;
&lt;h4&gt;간결성&lt;/h4&gt;
&lt;p&gt;데코레이터는 종종 코드를 더 간결하게 만들어주며, 의도를 명확히 표현하는 경우가 많다. &lt;/p&gt;
&lt;h4&gt;융통성&lt;/h4&gt;
&lt;p&gt;데코레이터는 함수를 감싸는 방식으로 작동하므로 더 복잡한 로직을 내부에 포함할 수 있다. &lt;/p&gt;
&lt;h2&gt;사용 시 고려 사항&lt;/h2&gt;
&lt;h4&gt;비즈니스 로직의 분리&lt;/h4&gt;
&lt;p&gt;데코레이터는 추가를 원하는 로직과 비즈니스 로직을 물리적으로 분리하는데 유용할 수 있다. &lt;/p&gt;
&lt;h4&gt;코드의 명확성&lt;/h4&gt;
&lt;p&gt;Dependency는 의존성이 명시적이므로 코드를 읽고 이해하기 쉬워진다. &lt;/p&gt;
&lt;h4&gt;비동기 지원&lt;/h4&gt;
&lt;p&gt;비동기 코드를 사용할 때에는 데코레이터 내부에서 async 함수를 올바르게 처리할 수 있는지 확인해야 한다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI와 asyncio]]></title><description><![CDATA[asyncio란? 소개 파이썬에서 비동기 프로그래밍을 위한 표준 라이브러리이다. 이 라이브러리는  을 사용하여 동시성 코드를 작성하는 데 필요한 구조를 제공한다. 단일 스레드 내에서도 여러 I/O…]]></description><link>https://sharknia.github.io/FastAPI와-asyncio/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI와-asyncio/</guid><pubDate>Tue, 07 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;asyncio란?&lt;/h2&gt;
&lt;h3&gt;소개&lt;/h3&gt;
&lt;p&gt;파이썬에서 비동기 프로그래밍을 위한 표준 라이브러리이다. 이 라이브러리는 &lt;code class=&quot;language-text&quot;&gt;coroutine&lt;/code&gt; 을 사용하여 동시성 코드를 작성하는 데 필요한 구조를 제공한다. 단일 스레드 내에서도 여러 I/O 바운드 작업과 고수준의 구조화된 네트워크 코드를 동시에 실행할 수 있으며, 이는 효율성과 속도에서 큰 이점을 제공한다. &lt;/p&gt;
&lt;h3&gt;주요 컴포넌트&lt;/h3&gt;
&lt;h4&gt;Event Loop&lt;/h4&gt;
&lt;p&gt;프로그램의 진입점으로써, 비동기적으로 실행될 다양한 작업들을 관리한다. 작업이 실행 준비가 되면 이벤트 루프는 해당 작업을 실행하고 완료되기를 기다리는 다른 작업으로 제어를 전환한다. &lt;/p&gt;
&lt;h4&gt;Coroutine&lt;/h4&gt;
&lt;p&gt;코루틴은 &lt;code class=&quot;language-text&quot;&gt;async def&lt;/code&gt; 로 정의되는 비동기 함수이다. 코루틴은 &lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt;  키워드를 사용하여 실행을 일시 중지하고 이벤트 루프에 제어를 반환할 수 있어 다른 코루틴이 실행될 수 있게 한다. &lt;/p&gt;
&lt;h4&gt;Future&lt;/h4&gt;
&lt;p&gt;아직 완료되지 않은 작업을 의미한다. 코루틴이 완료될 때 결과를 저장하거나 예외를 전달할 수 있는데 이를 통해 비동기 작업의 최종 상태를 알 수 있다. &lt;/p&gt;
&lt;h4&gt;Task&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Future&lt;/code&gt; 를 상속한다. 이는 이벤트 루프에서 코루틴의 실행을 가능하게 한다. Task는 코루틴을 스케줄링하고 실행 결과를 추적한다. &lt;/p&gt;
&lt;h3&gt;사용 예시&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Hello, World!&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이벤트 루프 실행&lt;/span&gt;
asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 예제에서 &lt;code class=&quot;language-text&quot;&gt;asyncio.run()&lt;/code&gt; 함수는 &lt;code class=&quot;language-text&quot;&gt;main()&lt;/code&gt; 코루틴을 이벤트 루프에서 실행한다. &lt;code class=&quot;language-text&quot;&gt;main()&lt;/code&gt; 내부에서 &lt;code class=&quot;language-text&quot;&gt;asyncio.sleep(1)&lt;/code&gt; 은 비동기적으로 1초간 대기하도록 한다. 이 대기 시간동안 이벤트 루프는 다른 코루틴을 실행할 수 있다. &lt;/p&gt;
&lt;h3&gt;동기화 기능&lt;/h3&gt;
&lt;p&gt;asyncio는 비동기 프로그래밍 환경에서 동기화를 위한 여러 도구를 제공한다. asyncio.Lock은 공유 리소스에 대한 동시 액세스를 방지하고 asyncio.Event, asyncio.Condition, asyncio.Semaphore와 같은 다른 동기화 기본 요소도 사용할 수 있다. &lt;/p&gt;
&lt;h3&gt;네트워킹 지원&lt;/h3&gt;
&lt;p&gt;TCP, UDP, SSL, TLS 등을 비롯한 다양한 네트워크 프로토콜에 대한 지원을 제공한다. asyncio 스트림을 사용하여 비동기적으로 네트워크 I/O 작업을 할 수 있으며 이를 통해 서버와 클라이언트 양쪽 모두에서 비동기 네트워크 어플리케이션을 만들 수 있다. &lt;/p&gt;
&lt;h3&gt;성능과 제한 사항&lt;/h3&gt;
&lt;p&gt;입출력 바운드 작업과 고수준 구조화된 네트워크 코드를 실행하는데 효율적이다. 입출력 작업이 블로킹 되는 것을 피하면서 동시에 여러 입출력 작업을 관리할 수 있기 때문이다. &lt;/p&gt;
&lt;p&gt;예를 들어 웹서버는 많은 수의 동시 http 요청을 처리해야 하며 각 요청은 네트워크 입출력에 의존적이다. asyncio는 각 네트워크 연산이 완료되기를 기다리는 동안 다른 연산으로 전환하여 리소스를 효율적으로 사용할 수 있다. &lt;/p&gt;
&lt;p&gt;그러나 계산을 많이 요구 하는 작업(CPU 바운드 작업)에는 적압하지 않다. 이 작업은 병렬 처리가 필요한데, 이는 프로세스나 스레드를 여러개 사용해야 함을 의미한다. asyncio는 싱글 스레드, 싱글 프로세스 디자인이므로 병렬 CPU 작업을 위해서는 별도의 모듈이나 멀티 스레딩을 사용해야 한다. &lt;/p&gt;
&lt;h3&gt;생명 주기&lt;/h3&gt;
&lt;h4&gt;이벤트 루프 생성&lt;/h4&gt;
&lt;p&gt;asyncio 프로그램은 이벤트 루프라는 중앙 실행기를 사용하여 실행된다. 이벤트 루프는 프로그램의 진입점에서 생성된다. 특히 아래의 함수를 사용하면 적절한 이벤트 루프를 설정하고 프로그램을 실행할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;코루틴 실행&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;async def&lt;/code&gt; 를 통해 코루틴을 생성하고 &lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt; 를 사용하여 실행을 스케줄한다. 코루틴은 이벤트 루프에 의해 실행될 태스크로 변환된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 코루틴 실행&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; some_async_function&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;태스크 스케쥴링&lt;/h4&gt;
&lt;p&gt;이벤트 루프는 &lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt; 표현식을 만날 때마다 실행을 일시 중지하고 다른 태스크로 제어를 전환한다. 이를 통해 CPU가 I/O 작업으로 인해 차단되는 것을 방지하고 다른 태스크의 실행을 계속할 수 있다. &lt;/p&gt;
&lt;h4&gt;비동기 I/O 처리&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio&lt;/code&gt;는 네트워크 I/O, 파일 I/O와 같은 비동기 작업을 효율적으로 관리한다. 이벤트 루프는 모든 I/O 이벤트에 대해 비블로킹 소켓과 파일 디스크립터를 사용한다. &lt;/p&gt;
&lt;h4&gt;이벤트와 콜백 처리&lt;/h4&gt;
&lt;p&gt;이벤트 루프는 등록된 이벤트가 발생했을 때 적절한 콜백 함수를 실행한다. 콜백은 완료된 I/O 작업의 결과를 다루거나 타이머 이벤트 같은 다른 유형의 이벤트를 처리하기 위해 사용된다. &lt;/p&gt;
&lt;h4&gt;종료 처리&lt;/h4&gt;
&lt;p&gt;모든 태스크가 완료되거나 특정 조건을 만족하면 이벤트 루프는 종료될 수 있다. 이벤트 루프를 종료하기 전에 &lt;code class=&quot;language-text&quot;&gt;close()&lt;/code&gt; 함수를 호출하여 자원을 정리할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;loop &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_event_loop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    loop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_until_complete&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    loop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio.run()&lt;/code&gt; 을 사용하는 경우에는 이벤트 루프의 생성과 종료가 자동으로 관리된다. &lt;/p&gt;
&lt;h4&gt;예외 처리&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio&lt;/code&gt; 는 예외가 발생할 경우 적절한 예외 처리를 위한 매커니즘을 제공한다. 코루틴 내부에서 발생한 예외는 해당 코루틴을 호출한 곳으로 전파되고 이벤트 루프는 처리되지 않은 예외를 포착하여 프로그래머에게 알린다. &lt;/p&gt;
&lt;h2&gt;FastAPI와 Async 함수&lt;/h2&gt;
&lt;p&gt;FastAP의 가장 큰 특징 중 하나는 asyncio 라이브러리를 기반으로 한 비동기 프로그래밍 지원이다. 이를 통해 개발자는 비동기 파이썬 코드를 작성할 수 있으며 이는 특히 I/O 바운드 작업(네트워크 요청 처리, 디스크에서의 데이터 읽기 /쓰기 등)을 비동기적으로 처리하는데 유리하다. &lt;/p&gt;
&lt;h3&gt;비동기 함수의 장점&lt;/h3&gt;
&lt;h4&gt;성능 향상&lt;/h4&gt;
&lt;p&gt;I/O 작업이 완료되기를 기다리는 동안 다른 코드를 실행할 수 있으므로 I/O 바운드 시스템에서 동시성을 크게 향상시킬 수 있다. &lt;/p&gt;
&lt;h4&gt;스케일성&lt;/h4&gt;
&lt;p&gt;적은 수의 워커로 많은 수의 요청을 처리할 수 있으므로 더 효율적으로 리소스를 사용하고 스케일링 할 수 있다. &lt;/p&gt;
&lt;h4&gt;비용 효율성&lt;/h4&gt;
&lt;p&gt;리소스 사용의 효율성은 특히 클라우드 환경에서 환경 절감으로 이어질 수 있다. &lt;/p&gt;
&lt;h4&gt;응답성 향상&lt;/h4&gt;
&lt;p&gt;서버가 요청에 더 빨리 응답할 수 있기 때문에 사용자 경험이 향상된다. &lt;/p&gt;
&lt;h3&gt;언제 비동기 함수를 쓰는 것이 더 유리할까?&lt;/h3&gt;
&lt;h4&gt;네트워크 요청 처리&lt;/h4&gt;
&lt;p&gt;웹 API 호출, 원격 데이터베이스 쿼리 등 네트워크 I/O 관련 작업을 처리할 때&lt;/p&gt;
&lt;h4&gt;고비용 I/O 작업&lt;/h4&gt;
&lt;p&gt;디스크 작업이나 네트워크를 통한 파일 전송과 같은 I/O 집중적인 작업을 비동기적으로 실행할 때 &lt;/p&gt;
&lt;h4&gt;동시성이 필요한 작업&lt;/h4&gt;
&lt;p&gt;다수의 클라이언트나 서비스로부터 오는 동시 요청을 효과적으로 처리해야 할 때&lt;/p&gt;
&lt;h4&gt;WebSocket을 사용할 때&lt;/h4&gt;
&lt;p&gt;실시간 통신을 위해 WebSocket 연결을 관리하는 경우 &lt;/p&gt;
&lt;h3&gt;비동기 함수 사용 시 주의할 점&lt;/h3&gt;
&lt;h4&gt;데드락&lt;/h4&gt;
&lt;p&gt;비동기 프로그래밍은 데드락에 빠질 위험이 있으므로 올바른 &lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt; 사용과 태스크 관리가 필요하다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    데드락이란?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;두 개 이상의 프로세스나 스레드가 서로의 작업 완료를 무한히 기다리게 되는 상태&lt;/p&gt;
&lt;h4&gt;에러 핸들링&lt;/h4&gt;
&lt;p&gt;비동기 코드에서는 예외 처리가 더 복잡해질 수 있으므로 주의가 필요하다. &lt;/p&gt;
&lt;h4&gt;디버깅의 복잡성&lt;/h4&gt;
&lt;p&gt;비동기 코드는 디버깅이 더 어려울 수 있다. &lt;/p&gt;
&lt;h4&gt;블로킹 코드와의 혼용&lt;/h4&gt;
&lt;p&gt;비동기 코드 내에서 블로킹 동기 코드를 호출하면 성능이 저하될 수 있으므로 주의해야 한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;async&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;이 키워드는 두 가지 주요 상황에서 사용된다. &lt;/p&gt;
&lt;h4&gt;코루틴 함수를 정의할 때&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch_data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 비동기 작업을 수행하는 코드&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;async def&lt;/code&gt; 는 이 함수가 코루틴 함수임을 나타낸다. 코루틴 함수는 호출될 때 즉시 실행되지 않고 대신에 코루틴 객체를 반환한다. 이 객체는 나중에 이벤트 루프에 의해 실행된다. &lt;/p&gt;
&lt;h4&gt;async with와 async for를 사용할 때&lt;/h4&gt;
&lt;p&gt;비동기 컨텍스트 매니저와 비동기 이터레이터를 사용할 때 필요하다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;이 키워드는 코루틴의 실행을 일시 중지하고 코루틴의 결과가 준비될 때까지 기다린다. 코루틴, 태스크, 미래 객체 등이 뒤에 올 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch_data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; some_async_function&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; data&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기서 await는 some&lt;em&gt;async&lt;/em&gt;function이 완료될 때까지 fetch_data 코루틴의 실행을 중지시킨다. 완료되면 그 결과값을 data에 할당하고 실행을 계속한다. &lt;/p&gt;
&lt;p&gt;이러한 비동기 프로그래밍 방식의 장점은 I/O 작업이 완료되기를 기다리는 동안 프로그램이 다른 작업을 계속할 수 있어 프로그램의 전반적인 실행 효율을 개선한다는 것이다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI의 데코레이터]]></title><description><![CDATA[개요 FastAPI의 데코레이터는 파이썬 데코레이터 패턴을 활용하여 FastAPI 프레임워크에서 제공하는 여러 기능을 함수나 클래스에 적용하는 구문이다. 이 데코레이터들은 FastAPI…]]></description><link>https://sharknia.github.io/FastAPI의-데코레이터/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI의-데코레이터/</guid><pubDate>Fri, 03 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;개요&lt;/h2&gt;
&lt;p&gt;FastAPI의 데코레이터는 파이썬 데코레이터 패턴을 활용하여 FastAPI 프레임워크에서 제공하는 여러 기능을 함수나 클래스에 적용하는 구문이다. 이 데코레이터들은 FastAPI에서 매우 중요한 역할을 한다. &lt;/p&gt;
&lt;p&gt;데코레이터는 &lt;code class=&quot;language-text&quot;&gt;@&lt;/code&gt; 기호를 사용하여 함수나 클래스의 위에 선언된다. 데코레이터는 그 아래에 정의된 함수에 추가적인 기능을 부여하거나 특정 작업을 수행하도록 지시한다. &lt;/p&gt;
&lt;p&gt;데코레이터를 사용하여 개발자는 복잡한 로직을 함수에 직접 쓰지 않고 프레임워크가 제공하는 데코레이터를 사용하여 빠르고 쉽게 웹 애플리케이션을 구현할 수 있다. &lt;/p&gt;
&lt;h2&gt;주요 데코레이터&lt;/h2&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.middleware(&quot;http&quot;)&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;HTTP 요청-응답 사이클에 관여하는 미들웨어를 등록하는데 사용된다.  이 데코레이터 아래에 정의된 함수는 애플리케이션으로 들어오는 모든 http 요청에 대해 처리되고 그리고 해당 요청에 대한 응답을 반환하기 전에 호출된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    미들웨어란?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;요청과 응답을 처리하는 과정 사이에 위치하여 들어오는 요청을 가로채 그 요청에 대해 특정 작업을 수행하거나 응답을 조작하는 구성 요소이다. &lt;/p&gt;
&lt;h4&gt;예제&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;middleware&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;http&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;custom_middleware&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; call_next&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 요청 전에 실행할 코드&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; call_next&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 응답 전에 실행할 코드&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;크게 두 부분으로 나눠진다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;요청 전에 실행할 코드 : &lt;code class=&quot;language-text&quot;&gt;call_next&lt;/code&gt; 함수에 요청을 전달하기 전에 실행할 코드를 작성한다. &lt;/li&gt;
&lt;li&gt;응답 전에 실행할 코드 : &lt;code class=&quot;language-text&quot;&gt;await call_next(request)&lt;/code&gt; 는 다음 미들웨어나 실제 요청을 처리하는 엔드포인트를 호출한다. 이후 응답이 반환되면 그 응답에 추가적인 처리를 하고 싶을 때 사용할 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;미들웨어 체인&lt;/h4&gt;
&lt;p&gt;만약 &lt;code class=&quot;language-text&quot;&gt;@app.middleware(&quot;http&quot;)&lt;/code&gt; 가 여러개 정의되어 있다면 FastAPI는 그것을 선언된 순서대로 실행한다. 각 미들웨어는 이전 미들웨어에서 &lt;code class=&quot;language-text&quot;&gt;await call_next(request)&lt;/code&gt; 를 호출한 후의 응답을 받아 처리한다. 이를 미들웨어 체인이라고 하며, 요청이 엔드포인트에 도달하기 전에 여러 미들웨어를 통과한다. &lt;/p&gt;
&lt;p&gt;따라서 미들웨어는 가벼운 로직을 수행하는 것이 좋으며, 무거운 작업은 미들웨어에서 피해야 한다. 또한 각 미들웨어는 만드시 &lt;code class=&quot;language-text&quot;&gt;await call_next(request)&lt;/code&gt; 를 호출하여 체인을 계속 진행할 수 있도록 해야 한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.get&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@app.post&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@app.put&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@app.delete&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@app.options&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@app.head&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;HTTP 메소드에 맞게 라우트를 설정하는 데코레이터이다. &lt;/p&gt;
&lt;p&gt;각각의 데코레이터는 해당 함수가 지정된 HTTP 메서드의 요청을 처리하는 엔드포인트임을 알려준다. 엔드포인트 함수 내부에서는 파라미터 검증, 비즈니스 로직, 데이터 반환 등의 작업을 수행할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/items/{item_id}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read_item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;item_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; item_id&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.api_route&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;모든 http 메소드를 하나의 함수로 라우트 할 수 있게 해주는 데코레이터이다. &lt;/p&gt;
&lt;p&gt;하나의 엔드포인트에 여러 http 메소드를 지정할 수 있도록 한다. 예를 들어 같은 경로에 대해 Get과 Post 요청을 모두 처리하고 싶은 경우에 사용할 수 있다. 이 데코레이터를 사용하면 각 메서드에 대한 처리 로직을 한 함수에서 정의할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api_route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/items/{item_id}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; methods&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 여기에 GET과 POST를 처리하는 로직을 구현&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.websocket&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;웹소켓 연결을 처리하는 엔드포인트를 선언하는 데코레이터이다. 클라이언트가 해당 경로로 웹소켓 연결을 시도하면 FastAPI는 해당 함수를 실행해 웹소켓 핸드셰이크를 처리하고 연결을 유지한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.on_event(&quot;startup&quot; | &quot;shutdown&quot;)&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;애플리케이션의 시작 시 또는 종료 시 실행할 함수를 등록하는 데코레이터이다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.exception_handler(Exc)&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;특정 예외를 처리하는 핸들러를 등록하는 데코레이터이다. 특정 예외 유형이 발생했을 때 실행될 커스텀 핸들러를 등록하는 데 사용된다. 표준 예외 로직을 오버라이드 하거나 특정 예외 유형에 대해 특별한 처리를 구현할 수 있다. &lt;/p&gt;
&lt;p&gt;예를 들어 ValueError가 발생했을 때, 표준 HTTP 500 Error 대신 더 구체적인 오류 메세지와 HTTP 400 코드를 반환할 수 있다. &lt;/p&gt;
&lt;h4&gt;예제&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; HTTPException
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;responses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; JSONResponse
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; starlette&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;requests &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Request

app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exception_handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ValueError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value_error_exception_handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ValueError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; JSONResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        content&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/items/{item_id}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read_item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; item_id &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; ValueError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Item ID must be positive&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;item_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; item_id&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이를 이용해 다음과 같은 이점을 얻을 수 있다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;유저 친화적인 오류 메시지 제공&lt;/li&gt;
&lt;li&gt;로그 이록&lt;/li&gt;
&lt;li&gt;오류 리포팅&lt;/li&gt;
&lt;li&gt;커스텀 http 상태 코드 반환 : 기본적으로 변경된 메시지 대신 사용자에게 안내를 줄 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러한 예외 핸들러는 API 의 로버스트성을 늘려준다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    로버스트성이란?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;소프트웨어가 예기치않은 입력이나 사용 상황에서도 안정적으로 작동하는 성질을 의미한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@app.dependency&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;함수가 종속성으로 작동하게 하며 해당 함수가 다른 경로 작업에서 호출될 때마다 실행되게 한다. 이를 이용해 공통 기능을 중앙에서 관리하고 경로 작업에서 필요한 데이터를 제공하거나 사전 처리를 수행할 수 있다. &lt;/p&gt;
&lt;h4&gt;예제&lt;/h4&gt;
&lt;p&gt;모든 경로에서 공통으로 사용되는 데이터베이스 세션을 생성하는 경우를 가정하자. 아래는 해당 데코레이터를 사용하여 데이터베이스 세션을 경로에 주입하는 예제이다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Depends

app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DBSession&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# DBSession 클래스는 데이터베이스 세션을 관리합니다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;DB Connection&quot;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;DB Connection Closed&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 종속성으로 사용될 함수&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dependency&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_db_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    db_session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DBSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; db_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        db_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 경로 작업에서 종속성 사용&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/items/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read_items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;get_db_session&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;db_session&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;get&lt;em&gt;db&lt;/em&gt;session 함수가 @app.dependency 데코레이터로 마크되어있다. 이 함수는 호출될 때마다 새로운 DBSession 인스턴스를 생성하고 요청 처리가 완료된 후 세션을 정리한다. &lt;/p&gt;
&lt;p&gt;이 함수는 경로 작업 함수 read_items에 Depends를 사용하여 주입된다. 경로 작업에서는 반환된 데이터베이스 세션을 db라는 변수로 받아 사용할 수 있다. &lt;/p&gt;
&lt;p&gt;Depends를 사용함으로써 FastAPI는 get&lt;em&gt;db&lt;/em&gt;session 함수를 실행하고 그 반환값을 read_items 경로 작업의 매개변수로 전달한다. 이 패턴은 서비스 계층, 데이터 접근 계층 등에서 특히 유용하며 코드 중복을 줄이고 테스트 용이성을 높여준다. &lt;/p&gt;
&lt;p&gt;FastAPI에서 해당 데코레이터를 사용해 정의된 함수는 생성기(generator) 패턴을 사용한다. yield 키워드를 사용해 이 함수는 값을 반환하기 전과 후에 코드를 실행할 수 있다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;yield를 만날 때까지 함수를 실행한다. 이 때, DBSession 인스턴스가 생성되고, 세션이 초기화된다. &lt;/li&gt;
&lt;li&gt;yield에서 함수는 호출한 측에 db_session.session 값을 넘겨주고 실행을 일시 중지(pause) 한다. &lt;/li&gt;
&lt;li&gt;이제 read_items 경로 함수의 본문을 실행한다. 이 때, db 매개변수로 전달된 값을 사용한다. &lt;/li&gt;
&lt;li&gt;read_items 함수가 완료되고 응답이 반환되면 yield문 이후의 코드가 실행된다. 이 코드에서는 finally 블록이다. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;즉 finally 블록은 http 요청 처리가 완전히 끝나고 응답이 클라이언트에게 전송된 후에 실행된다. 이는 DBSession 객체의 리소스를 안전하게 정리할 수 있게 해준다. yield를 사용하는 이 패턴은 파이썬의 컨텍스트 매니저와 유사한 방식으로 자원의 정리를 보장한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@Query&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@Path&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@Header&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@Cookie&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@Body&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@Form&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;엔드포인트의 각 파라미터를 특정 데이터 위치(쿼리 파라미터, 경로 파라미터, 헤더, 쿠키, 요청 본문, 폼 데이터)에 연결한다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;@Response&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@JSONResponse&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@HTMLResponse&lt;/code&gt;&lt;strong&gt;,&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;@FileResponse&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;특정 응답 클래스를 사용하여 응답을 반환한다. 예를 들어 &lt;code class=&quot;language-text&quot;&gt;@JSONResponse&lt;/code&gt;는 JSON 형식의 응답을 반환할 때 사용된다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[생성기(generate) 패턴]]></title><description><![CDATA[소개 파이썬의 중요한 특징 중 하나로 이터레이터 프로토콜을 사용하여 데이터의 시퀀스를 느긋하게(lazily) 생성하는데 사용된다. 즉, 생성기는 시퀀스의 전체 항목을 메모리에 한 번에 로드하지 않고 반복(iteration…]]></description><link>https://sharknia.github.io/생성기generate-패턴/</link><guid isPermaLink="false">https://sharknia.github.io/생성기generate-패턴/</guid><pubDate>Fri, 03 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;소개&lt;/h2&gt;
&lt;p&gt;파이썬의 중요한 특징 중 하나로 이터레이터 프로토콜을 사용하여 데이터의 시퀀스를 느긋하게(lazily) 생성하는데 사용된다. 즉, 생성기는 시퀀스의 전체 항목을 메모리에 한 번에 로드하지 않고 반복(iteration) 할 때마다 하나씩 항목을 생성한다. &lt;/p&gt;
&lt;p&gt;이를 통해 메모리 사용을 줄이고 대용량 또는 무한한 시퀀스를 다룰 수 있다. &lt;/p&gt;
&lt;h2&gt;이터레이터 프로토콜&lt;/h2&gt;
&lt;p&gt;파이썬에서 반복 가능한 객체(컬렉션)를 순회하기 위한 규약이다. 이 프로토콜은 반복(iteration) 동작을 정의하며 일련의 요소들에 대해 순차적으로 접근할 수 있게 해준다. 파이썬의 모든 반복 가능한 객체는 이 이터레이터 프로토콜을 구현해야 하며 이는 주로 두 가지 매직 매소드(magic method)로 구성된다. &lt;/p&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;__iter__()&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;이터레이터 객체를 반환해야 하며, 보통 self를 반환하여 객체 자체가 이터레이터인 경우를 처리한다. 이 메소드는 for 루프와 같은 반복 연산이 시작될 때 호출된다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;__next__()&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;컬렉션의 다음 요소를 반환해야 한다. 만약 더 이상 요소가 없으면 &lt;code class=&quot;language-text&quot;&gt;StopIteration&lt;/code&gt; 예외를 발생시켜 반복을 종료해야 한다. &lt;/p&gt;
&lt;h2&gt;생성기 만드는 방법&lt;/h2&gt;
&lt;h3&gt;생성기 함수 (Generator function)&lt;/h3&gt;
&lt;p&gt;일반 함수와 비슷하지만 &lt;code class=&quot;language-text&quot;&gt;return&lt;/code&gt; 대신 &lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt; 문을 사용하여 값을 하나씩 반환한다. &lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt; 를 사용하면 함수는 해당 상태에서 실행을 일시 정지하고 다음 값이 요청될 때까지 대기 상태가 된다. &lt;/p&gt;
&lt;h3&gt;생성기 표현식 (Generator expression)&lt;/h3&gt;
&lt;p&gt;리스트 컴프리헨션과 유사하지만 괄호를 사용하여 정의한다. 이 방식은 단순한 경우에 대한 생성기를 간결하게 작성할 수 있게 해준다. &lt;/p&gt;
&lt;h2&gt;예제&lt;/h2&gt;
&lt;h3&gt;생성기 함수 예제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;countdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Starting to count from&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; n
        n &lt;span class=&quot;token operator&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Done!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 생성기 객체를 생성&lt;/span&gt;
cd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; countdown&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 생성기를 사용&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; count &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cd&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드를 실행하면 3, 2, 1이 출력되고 각 숫자 사이에 다른 코드를 실행할 수 있는 기회가 주어진다. 각 yield 문마다 함수의 상태는 일시 중단되고 다음 반복에서 계속된다. &lt;/p&gt;
&lt;h3&gt;생성기 표현식 예제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;squares &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;x &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 생성기를 사용&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; square &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; squares&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;square&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드는 0부터 9까지의 숫자에 대한 제곱을 출력한다. 반복(iteration)할 때마다 다음 제곱값이 생성되고 모든 값이 한 번에 메모리에 저장되지 않는다. &lt;/p&gt;
&lt;h2&gt;yield&lt;/h2&gt;
&lt;p&gt;yield는 함수가 값을 반환(return)하면서도 그 상태를 기억하고 일시 중지(pause)되는 것을 가능하게 한다. 이는 함수의 실행을 중단시키지만 함수의 로컬 변수와 실행 상태가 유지되어 나중에 이 함수가 다시 호출될 때 이전 상태에서부터 실행을 재개할 수 있다. &lt;/p&gt;
&lt;p&gt;일반적인 return은 함수의 실행을 완전히 종료하고 해당 함수의 모든 상태(로컬 변수, 실행 컨텍스트)를 버리지만 yeild는 함수가 여전히 살아있다는 점에서 return과 다르다. yeild를 통해 반환된 함수(즉 생성기)는 &lt;code class=&quot;language-text&quot;&gt;__next__()&lt;/code&gt; 메소드를 호출함으로써 (또는 &lt;code class=&quot;language-text&quot;&gt;next()&lt;/code&gt; 함수를 사용하여) 다시 실행될 수 있으며, yield문 바로 다음부터 실행이 이어진다. &lt;/p&gt;
&lt;h2&gt;이터러블(iterable) 객체&lt;/h2&gt;
&lt;h3&gt;소개&lt;/h3&gt;
&lt;p&gt;멤버를 한 번에 하나씩 반환할 수 있는 객체로, 파이썬에선 주로 순회 가능한 모든 객체를 의미한다. 이터러블 객체는 for 루프와 같은 반복문을 사용해 순회할 수 있으며 이는 그 객체가 반복 가능한(iterable) 인터페이스를 구현하고 있기 때문이다. &lt;/p&gt;
&lt;p&gt;이터러블 객체가 되기 위해서는 객체 내에 &lt;code class=&quot;language-text&quot;&gt;__iterm__()&lt;/code&gt; 메소드를 구현해야 한다. 이 메소드는 이터레이터를 반환하고 이터레이터는 &lt;code class=&quot;language-text&quot;&gt;__next__()&lt;/code&gt; 메소드를 구현하여 순차적으로 값을 반환할 수 있어야 한다. &lt;code class=&quot;language-text&quot;&gt;topIteration&lt;/code&gt; 예외는 이터레이터가 더 이상 반환할 값이 없을 때 발생시켜 반복이 끝났음을 알린다.  &lt;/p&gt;
&lt;h3&gt;파이썬의 이터러블 객체&lt;/h3&gt;
&lt;p&gt;리스트, 튜플, 문자열, 딕셔너리, 집합 등이 있다. 또한 파일(file) 객체도 이러터블하며 파일의 각 줄을 순회할 수 있다. &lt;/p&gt;
&lt;h3&gt;예제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;my_list &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 리스트는 이터러블 객체입니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; my_list&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1, 2, 3, 4가 순차적으로 출력됩니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;직접 이터러블 객체를 만들고 싶다면 &lt;code class=&quot;language-text&quot;&gt;__iter__()&lt;/code&gt; 메소드를 포함하는 클래스를 정의할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; low&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; high&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; low
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;high &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; high

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__iter__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self  &lt;span class=&quot;token comment&quot;&gt;# self.__next__()를 호출할 이터레이터로 자신을 반환합니다.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__next__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;high&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            num &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; num
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; StopIteration

&lt;span class=&quot;token comment&quot;&gt;# Counter 인스턴스는 이터러블 객체입니다.&lt;/span&gt;
counter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Counter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; num &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; counter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1, 2, 3이 출력됩니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위는 사용자 정의 이터러블 객체이다. &lt;/p&gt;
&lt;p&gt;위의 &lt;code class=&quot;language-text&quot;&gt;Counter&lt;/code&gt; 클래스는 &lt;code class=&quot;language-text&quot;&gt;__iter__()&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;__next__()&lt;/code&gt; 메소드를 정의하여 이터러블 인터페이스를 구현한다. &lt;code class=&quot;language-text&quot;&gt;Counter&lt;/code&gt; 인스턴스를 순회할 때마다 &lt;code class=&quot;language-text&quot;&gt;__next__()&lt;/code&gt; 메소드가 호출되어 숫자를 하나씩 반환하고, 더 이상 반환할 숫자가 없을 때 &lt;code class=&quot;language-text&quot;&gt;StopIteration&lt;/code&gt; 예외가 발생한다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI]]></title><description><![CDATA[특징 및 장점 타입 힌트를 활용한 API 선언 Python 3.6 이상의 타입 힌트를 활용하여 API 매개변수 및 응답 모델을 선언한다. 이를 통해 데이터 검증, 직렬화, 문서화를 자동화한다. 이러한 방식은 깔끔한 코드 작성과 함께 명확한 API…]]></description><link>https://sharknia.github.io/FastAPI/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI/</guid><pubDate>Thu, 02 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;특징 및 장점&lt;/h2&gt;
&lt;h3&gt;타입 힌트를 활용한 API 선언&lt;/h3&gt;
&lt;p&gt;Python 3.6 이상의 타입 힌트를 활용하여 API 매개변수 및 응답 모델을 선언한다. 이를 통해 데이터 검증, 직렬화, 문서화를 자동화한다. 이러한 방식은 깔끔한 코드 작성과 함께 명확한 API 명세를 제공한다. &lt;/p&gt;
&lt;h3&gt;속도&lt;/h3&gt;
&lt;p&gt;Starlette(ASGI 기반) 및 Pydanic의 결합으로 다른 파이썬 프레임워크에 비해 월등히 높은 성능을 자랑한다. &lt;/p&gt;
&lt;h3&gt;자동화된 문서&lt;/h3&gt;
&lt;p&gt;타입 힌트와 함께 추가된 FateAPI 데코레이터를 사용하여 자동으로 실시간 API 문서(Swagger UI 및 ReCod)를 생성한다. &lt;/p&gt;
&lt;h3&gt;데이터 검증&lt;/h3&gt;
&lt;p&gt;Pydantic을 이용하여 입력 데이터의 유효성을 자동으로 검사하고 오류에 대한 명확한 정보를 반환한다. 유효하지 않은 데이터에 대한 명확하고 읽기 쉬운 오류 메시지를 자동으로 제공한다. &lt;/p&gt;
&lt;h3&gt;비동기 지원&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;async/await&lt;/code&gt; 문법을 사용하여 DB 작업, 파일 작업 및 네트워크 작업 등의 비동기 코드를 쉽게 통합할 수 있다. &lt;/p&gt;
&lt;h3&gt;보안 기능&lt;/h3&gt;
&lt;p&gt;OAuth2, 비밀번호 해싱, JWT 토큰 생성 및 검증, CORS 등 웹 API 보안에 필요한 기능들이 아웃 오브 더 박스에서 제공된다. &lt;/p&gt;
&lt;h3&gt;확장성&lt;/h3&gt;
&lt;p&gt;사용자의 요구에 따라 쉽게 확장할 수 있으며 다양한 서드파티 라이브러리와 통합이 용이하다. &lt;/p&gt;
&lt;h3&gt;의존성 주입 시스템&lt;/h3&gt;
&lt;p&gt;요청 처리 함수의 매개변수로 의존성을 선언하면 이를 자동으로 처리하고 제공한다. 이를 통해 공통적인 기능(데이터베이스 세션, 토큰 검증 등)을 재사용할 수 있다. &lt;/p&gt;
&lt;h2&gt;다른 웹 프레임워크와의 비교&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Flask : 가볍고 간단하며 확장 가능하다. 하지만 기본적으로 동기식이며 ASGI를 사용한 비동기 처리를 지원하지 않는다. 데이터 검증이나 자동 문서화 같은 기능을 위해서는 추가 확장 또는 라이브러리가 필요하다. &lt;/li&gt;
&lt;li&gt;Django : 많은 기능(관리자 인터페이스, ORM, 인증..)등이 내장되어 있다. 큰 커뮤니티와 문서화가 잘 되어있다. 그렇지만 무거울 수 있으며 프로젝트의 구조나 방식이 명확하게 정해져있어 높은 수준의 커스터마이제이션을 원하는 개발자는 제약이 될 수 있다. 기본적으로 동기식이다.&lt;/li&gt;
&lt;li&gt;Tornado : 비동기 네트워크 라이브러로 시작하여 웹 프레임워크로 발전했다. WenSocket과 같은 비동기 작업에 적합하다. 다만 최신 ASGI 프레임워크보다는 성능면에서 뒤쳐질 수 있다. 자동 문서화나 타입 힌트 기반의 데이터 검증과 같은 기능이 없다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;단점&lt;/h2&gt;
&lt;h3&gt;상대적으로 작은 커뮤니티의 크기&lt;/h3&gt;
&lt;p&gt;Flask나 Django처럼 오랜 기간 사용된 프레임워크에 비해 커뮤니티가 상대적으로 작아 확장 기능, 플러그인, 해결책을 찾는데 어려움을 겪을 수 있다. &lt;/p&gt;
&lt;h3&gt;기술 부채&lt;/h3&gt;
&lt;p&gt;비교적 최근에 개발되어 예전의 기존 시스템과 통합하거나 레거시 코드와 병합할 때 어려움을 겪을 수 있다. &lt;/p&gt;
&lt;h3&gt;학습 곡선&lt;/h3&gt;
&lt;p&gt;타입 힌트, Pydantix, ASGI 등 다양한 기능들이 초기 사용자에게는 약간의 학습 곡선을 만들 수 있다. 특히 비동기 프로그래밍에 익숙하지 않다면 어려움을 겪을 수 있다. &lt;/p&gt;
&lt;h3&gt;완전한 ORM의 부재&lt;/h3&gt;
&lt;p&gt;데이터베이스 통합을 위해 SQLAlchemy나 Tortoise-ORM과 같은 외부 라이브러리를 사용한다. 프레임워크 자체의 통합된 ORM을 제공하지 않는다. &lt;/p&gt;
&lt;h3&gt;제한된 동기 지원&lt;/h3&gt;
&lt;p&gt;주로 비동기 환경을 위해 설계되어 동기 코드를 사용하는 라이브러리 또는 시스템과 통합할 때 추가적인 노력이 필요할 수 있다. &lt;/p&gt;
&lt;h2&gt;WSGI와 ASGI&lt;/h2&gt;
&lt;p&gt;WSGI와 ASGI는 모두 웹서버와 파이썬 웹 어플리케이션 사이의 표준 인터페이스를 정의하는 규격이다. &lt;/p&gt;
&lt;h3&gt;WSGI (Web Server Gateway Interface)&lt;/h3&gt;
&lt;p&gt;동기적인 웹 어플리케이션을 위한 표준 인터페이스를 제공하며, 전통적인 웹 어플리케이션 개발에 널리 사용된다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;목적 : 웹서버와 파이썬 웹 어플리케이션 혹은 프레임워크가 서로 통신할 수 있도록 하는 간단한 호출 규약을 정의한다. &lt;/li&gt;
&lt;li&gt;동작 방식 : 동기적이며, 한 번에 하나의 요청만 처리할 수 있다. 이로 인해 여러 동시 요청을 처리하기 위해서는 다중 프로세스나 다중 스레드 방식을 사용해야 한다. &lt;/li&gt;
&lt;li&gt;대표적인 서버 및 미들웨어 : uWSGI, gunicorn, mod_wsgi&lt;/li&gt;
&lt;li&gt;사용되는 프레임워크 : Flask, Django 등 대부분의 전통적인 파이썬 웹 프레임워크&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ASGI (Asynchronous Server Gateway Interface)&lt;/h3&gt;
&lt;p&gt;비동기 웹 어플리케이션과 다양한 웹 프로토콜을 위한 확장된 인터페이스를 제공한다. 최근의 웹 트렌드에 맞게 설계되었다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;목적 : WSGI의 확장 버전으로 웹소켓과 같은 비동기 프로토콜의 지원과 더 빠른 성능을 목표로 한다. &lt;/li&gt;
&lt;li&gt;동작 방식 : 비동기이며, 이를 통해 한 번에 여러 요청을 처리할 수 있다. 주로 &lt;code class=&quot;language-text&quot;&gt;async/awit&lt;/code&gt; 구문을 활용한 비동기 프로그래밍을 가능하게 한다. &lt;/li&gt;
&lt;li&gt;대표적인 서버 : Daphne, Uvicorn, Hypercorn 등&lt;/li&gt;
&lt;li&gt;사용되는 프레임 워크 : FastAPI, Starlette 등&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;FastAPI의 작동 플로우&lt;/h2&gt;
&lt;h3&gt;1. API 선언&lt;/h3&gt;
&lt;p&gt;API 엔드포인트를 선언하기 위해 파이썬 함수를 사용한다. 타입 힌트와 함께 Pydantic 모델을 사용하여 요청 및 응답 객체를 선언한다. &lt;/p&gt;
&lt;p&gt;이렇게 선언된 엔드포인트는 HTTP 메서드에 맞게 데코레이터로 데코레이트 된다. &lt;/p&gt;
&lt;h3&gt;2. 데이터 검증 및 직렬화&lt;/h3&gt;
&lt;p&gt;요청이 들어오면 Pydantic 모델을 사용하여 들어온 데이터를 검증한다. &lt;/p&gt;
&lt;p&gt;유효하지 않은 요청 데이터가 감지되면 자동으로 오류 응답을 생성하여 클라이언트에 반환한다. &lt;/p&gt;
&lt;h3&gt;3. 의존성 해결&lt;/h3&gt;
&lt;p&gt;각 엔드포인트에 선언된 의존성(예: 데이터베이스 세션, 인증 토큰 확인)을 자동으로 해결한다. &lt;/p&gt;
&lt;p&gt;이를 통해 반복적인 작업 없이 재사용 가능한 컴포넌트들을 생성할 수 있다. &lt;/p&gt;
&lt;h3&gt;4. 요청 처리&lt;/h3&gt;
&lt;p&gt;데이터 검증 및 의존성 해결이 완료되면 해당 엔드포인트 함수를 호출하고 처리한다. &lt;/p&gt;
&lt;p&gt;이 때, 비동기 함수(&lt;code class=&quot;language-text&quot;&gt;async def&lt;/code&gt;)를 사용하면 비동기 방식으로 요청을 처리할 수 있다. &lt;/p&gt;
&lt;h3&gt;5. 응답 생성&lt;/h3&gt;
&lt;p&gt;엔드포인트 함수의 반환값은 자동으로 JSON으로 직렬화된다. &lt;/p&gt;
&lt;p&gt;반환값이 Pydantic 모델 인스턴스라면 해당 모델을 사용하여 데이터 직렬화 및 검증이 이루어진다. &lt;/p&gt;
&lt;h3&gt;6. 자동 문서화&lt;/h3&gt;
&lt;p&gt;타입 힌트와 함께 선언된 엔드포인트를 기반으로 자동으로 API 문서를 생성한다. &lt;/p&gt;
&lt;p&gt;이 때 Swagger UI 및 ReDoc와 같은 도구를 사용하여 실시간 API 문서를 제공한다. &lt;/p&gt;
&lt;h3&gt;7. 응답 반환&lt;/h3&gt;
&lt;p&gt;최종적으로 처리된 응답이 클라이언트에 반환된다. 이 때 HTTP 상태 코드, 헤더, 쿠키 등도 함께 설정할 수 있다. &lt;/p&gt;
&lt;h2&gt;Uvicorn&lt;/h2&gt;
&lt;p&gt;Uvicorn은 ASGI(Asynchronous Server Gateway Interface)를 기반으로 한 빠르고 경량화된 웹 서버이다. Uvicorn은 주로 파이썬으로 작성된 비동기 웹 애플리케이션과 프레임워크의 서빙에 사용된다. &lt;/p&gt;
&lt;h3&gt;특징 및 장점&lt;/h3&gt;
&lt;h4&gt;비동기&lt;/h4&gt;
&lt;p&gt;Uvicorn은 비동기 I/O를 지원하며 이를 통해 동시에 여러 요청을 효율적으로 처리할 수 있다. 파이썬 3.6 이상에서 &lt;code class=&quot;language-text&quot;&gt;async/await&lt;/code&gt; 문법을 활용한다. &lt;/p&gt;
&lt;h4&gt;성능&lt;/h4&gt;
&lt;p&gt;uvloop와 httptools를 사용하여 성능을 최적화한다. uvloop는 파이썬의 asyncio 모듈을 대체하는 빠른 이벤트 루프 구현이며 httptools는 http 파싱을 위한 라이브러리이다. &lt;/p&gt;
&lt;h4&gt;ASGI 호환성&lt;/h4&gt;
&lt;p&gt;ASGI 3.0 사양을 구현하여 다양한 ASGI 호환 웹 애플리케이션 및 프레임워크와 함께 작동할 수 있다. &lt;/p&gt;
&lt;h4&gt;단순성&lt;/h4&gt;
&lt;p&gt;코드 기반이 단순하며 웹 서버의 기본 기능에 집중한다. 보다 복잡한 배포나 튜닝이 필요한 경우 Uvicorn을 Gunicorn과 같은 다른 웹 서버 래퍼와 함께 사용하는 것이 일반적이다. &lt;/p&gt;
&lt;h3&gt;단점&lt;/h3&gt;
&lt;h4&gt;기능 제한&lt;/h4&gt;
&lt;p&gt;핵심적인 웹 서버 기능에 중점을 둬 복잡한 배포 또는 다양한 설정, 최적화 옵션과 같은 기능이 제한적이다. &lt;/p&gt;
&lt;h4&gt;비동기 환경의 복잡성&lt;/h4&gt;
&lt;p&gt;비동기 애플리케이션을 위한 웹 서버로 설계되어 비동기 코드와 동기 코드의 혼합 사용, 특히 데이터베이스와의 연결과 같은 경우 문제가 발생할 수 있다. 모든 코드를 비동기적으로 작성하거나 동기 코드가 올바르게 스레드 또는 프로세스에서 실행되도록 관리되어야 한다.&lt;/p&gt;
&lt;h2&gt;FastAPI 시작하기&lt;/h2&gt;
&lt;h3&gt;1. 설치&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;pip install fastapi&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; uvicorn&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2. 기본 애플리케이션 생성&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# main.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; FastAPI

app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read_root&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;3. 애플리케이션 실행&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;uvicorn main:app &lt;span class=&quot;token parameter variable&quot;&gt;--reload&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;—reload&lt;/code&gt; : 개발 중 코드 변경을 자동으로 반영하기 위해 사용한다. &lt;/p&gt;
&lt;h3&gt;4. 자동 문서화&lt;/h3&gt;
&lt;p&gt;FastAPI는 자동으로 API 문서를 생성해준다. 애플리케이션을 실행 후 브라우저에서 다음 URL을 방문하여 문서를 확인할 수 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Swagger UI: &lt;code class=&quot;language-text&quot;&gt;http://127.0.0.1:8000/docs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ReDoc: &lt;code class=&quot;language-text&quot;&gt;http://127.0.0.1:8000/redoc&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Pydantic 모델]]></title><description><![CDATA[은 파이썬의 타입 힌트 시스템을 기반으로 데이터 검증 및 설정 관리를 제공하는 라이브러리이다. 특히 FastAPI에서는 Pydantic…]]></description><link>https://sharknia.github.io/Pydantic-모델/</link><guid isPermaLink="false">https://sharknia.github.io/Pydantic-모델/</guid><pubDate>Thu, 02 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Pydantic&lt;/code&gt; 은 파이썬의 타입 힌트 시스템을 기반으로 데이터 검증 및 설정 관리를 제공하는 라이브러리이다. 특히 FastAPI에서는 Pydantic을 주로 요청 및 응답 객체의 데이터 검증, 직렬화 및 역직렬화에 사용한다. &lt;/p&gt;
&lt;h2&gt;주요 특징&lt;/h2&gt;
&lt;h3&gt;타입 힌트 기반&lt;/h3&gt;
&lt;p&gt;Pydantic 모델은 파이썬의 타입 힌트를 활용하여 선언된다. 이를 통해 코드 내에서 명확하게 데이터의 구조와 타입을 지정할 수 있다. &lt;/p&gt;
&lt;h3&gt;자동 데이터 검증&lt;/h3&gt;
&lt;p&gt;모델에 데이터를 할당할 때에 자동으로 데이터 검증이 수행된다. 유효하지 않은 데이터는 오류를 발생시킨다. &lt;/p&gt;
&lt;h3&gt;데이터 변환&lt;/h3&gt;
&lt;p&gt;입력 데이터를 적절한 타입으로 자동 변환한다. 예를 들어 문자열로 들어온 숫자 데이터를 정수로 변환할 수 있다. &lt;/p&gt;
&lt;h3&gt;기본값 및 유효성 검사&lt;/h3&gt;
&lt;p&gt;모델 필드에 기본값을 제공하거나 유효성 검사 규칙을 추가할 수 있다. &lt;/p&gt;
&lt;h3&gt;JSON 직렬화 및 역직렬화&lt;/h3&gt;
&lt;p&gt;자동으로 JSON 형태로 직렬화되며 JSON 데이터를 역직렬화 하여 모델 객체로 변환할 수 있다. &lt;/p&gt;
&lt;h2&gt;예시&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; pydantic &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; BaseModel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ValidationError

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseModel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
    name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    age&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
    email&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 사용 예&lt;/span&gt;
user_data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;John Doe&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;email&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;johndoe@example.com&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; User&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;user_data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;json&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 모델 객체를 JSON 형태로 출력&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    invalid_data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;invalid&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;John&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;invalid&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;email&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;johndoe&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    User&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;invalid_data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; ValidationError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;errors&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 데이터 검증 오류 출력&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[DynamoDB의 동시성 제어(Concurrency Control)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/DynamoDB의-동시성-제어Concurrency-Control/</link><guid isPermaLink="false">https://sharknia.github.io/DynamoDB의-동시성-제어Concurrency-Control/</guid><pubDate>Wed, 01 Nov 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;데이터베이스의 동시성 제어란?&lt;/h2&gt;
&lt;p&gt;여러 트랜잭션 또는 연산이 동시에 수행될 때 데이터의 일관성을 유지하고 충돌을 방지하기 위한 매커니즘을 말한다. 잘못된 동시성 제어는 데이터의 무결성을 해치고 시스템의 성능을 저하시키며 예측할 수 없는 결과를 초래할 수 있다. &lt;/p&gt;
&lt;h3&gt;동시성 제어의 주요 개념&lt;/h3&gt;
&lt;h4&gt;락 (Locking)&lt;/h4&gt;
&lt;p&gt;데이터베이스 항목에 대한 동시 액세스를 제어하기 위해 사용된다. 트랜잭션은 데이터에 액세스 하기 전에 락을 획득해야 하며, 작업이 완료되면 락을 해제해야 한다. &lt;/p&gt;
&lt;p&gt;일반적으로 비관적 잠금과 낙관적 잠금의 두 형태로 구분된다. &lt;/p&gt;
&lt;h4&gt;트랜잭션 (Transaction)&lt;/h4&gt;
&lt;p&gt;일련의 데이터베이스 작업을 하나의 논리적 단위로 묶는 것이다. 트랜잭션은 모두 성공하거나 모두 실패해야 하며, 중단 상태에서 중단되어서는 안된다. &lt;/p&gt;
&lt;h4&gt;일관성 (Consistency)&lt;/h4&gt;
&lt;p&gt;데이터베이스의 모든 트랜잭션이 데이터를 올바른 상태에서 유지하도록 보장하는 속성이다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;강력한 일관성 (Strong Consistency)&lt;/p&gt;
&lt;p&gt;데이터베이스의 모든 노드가 항상 동일한 데이터를 보게 됨을 보장한다. &lt;/p&gt;
&lt;p&gt;데이터베이스에 쓰기 작업이 수행된 후 모든 후속 읽기 작업이 그 쓰기 작업의 결과를 반영해야 한다. &lt;/p&gt;
&lt;p&gt;실시간 시스템, 금융 시스템 또는 기타 높은 무결성이 필요한 시스템에서 중요하다. &lt;/p&gt;
&lt;p&gt;일반적으로 높은 네트워크 지연과 함께 오며, 시스템의 전반적인 성능과 확장성에 영향을 미칠 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;최종 일관성 (Eventual Consistency)&lt;/p&gt;
&lt;p&gt;시간이 지나면서 데이터베이스의 모든 노드가 동일한 데이터를 볼 수 있게 됨을 보장한다. &lt;/p&gt;
&lt;p&gt;쓰기 작업이 수행된 후 일정 시간이 지나면 모든 읽기 작업이 쓰기 작업의 결과를 반영한다. &lt;/p&gt;
&lt;p&gt;일반적으로 높은 확장성과 낮은 지연 시간을 제공하며 분산 시스템에서 높은 성능을 달성하는데 유리하다. &lt;/p&gt;
&lt;p&gt;일시적인 데이터 불일치를 허용하므로 애플리케이션의 로직이 이러한 불일치를 처리할 수 있도록 설계되어야 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;분리성 (Isolation)&lt;/h4&gt;
&lt;p&gt;각 트랜잭션이 독립적으로 실행되도록 보장하는 속성이다. 트랜잭션들 사이에 어떤 중간 상태도 다른 트랜잭션에게 보여져셔는 안된다. &lt;/p&gt;
&lt;h4&gt;지속성 (Durability)&lt;/h4&gt;
&lt;p&gt;트랜잭션이 성공적으로 완료된 후에는 시스템의 어떤 실패에도 영향 받지 않고 데이터베이스 변경이 유지되도록 보장하는 속성이다. &lt;/p&gt;
&lt;h2&gt;DynamoDB의 동시성 제어 매커니즘&lt;/h2&gt;
&lt;p&gt;DynamoDB는 동시성 제어와 데이터 일관성을 관리하기 위한 여러 매커니즘을 제공한다. &lt;/p&gt;
&lt;h3&gt;조건식 사용 (Conditional Writes)&lt;/h3&gt;
&lt;p&gt;항목을 작성하거나 업데이트 할 때 조건식을 사용하여 해당 항목이 변경되지 않았음을 확인할 수 있다. 이것은 항목이 기존에 있던 상태에 따라 연산을 수행하도록 할 때 유용하다. 예를 들어 항목이 특정값에 해당하지 않으면 업데이트 하지 않도록 요청할 수 있다. &lt;/p&gt;
&lt;h3&gt;컨설턴트 (Consistent Reads)&lt;/h3&gt;
&lt;p&gt;기본적으로 최종적으로 일관성 있는 읽기를 제공한다. 이것은 약간의 지연을 허용하면서 빠른 응답 시간을 제공한다. 하지만 바로 이전의 쓰기 작업 이후에 항목의 최신 상태를 확인하려면 Strongly Consistent Read 옵션을 사용할 수 있다. 이 옵션은 데이터의 최신 상태를 보장한다.&lt;/p&gt;
&lt;hr style=&quot;border: none; height: 1px; background-color: #e0e0e0; margin: 16px 0;&quot; /&gt;
하지만 Dynamo DB에서 동시성은 주로 다음의 두 가지 방법을 사용하여 수행된다. 
&lt;h2&gt;낙관적 잠금 (Optimistic Locking)&lt;/h2&gt;
&lt;p&gt;낙관적 잠금은 클라이언트가 업데이트(또는 삭제) 하려는 항목이 DynamoDB의 항목과 동일한지 확인하는 전략이다. 이 전략을 사용하면 데이터베이스 쓰기는 다른 사용자의 쓰기에 의해 덮여지는 일을 방지할 수 있다. &lt;/p&gt;
&lt;p&gt;이 전략은 DynamoDB의 테이블에 &lt;code class=&quot;language-text&quot;&gt;버전 번호&lt;/code&gt; 라는 속성을 사용하여 구현된다. 클라이언트가 데이터 항목을 수정할 때 클라이언트 측의 버전 번호가 테이블 항목의 버전 번호와 동일해야 한다. 버전 번호가 동일하면 다른 사용자가 레코드를 변경하지 않았음을 의미하며 쓰기를 수행할 수 있다. &lt;/p&gt;
&lt;p&gt;그러나 버전 번호가 다르면 다른 사용자가 이미 레코드를 업데이트 했을 가능성이 있으며, 이 경우 DynamoDB는 &lt;code class=&quot;language-text&quot;&gt;ConditionalCheckFailedException&lt;/code&gt; 예외를 발생시켜 쓰기를 거부한다. &lt;/p&gt;
&lt;p&gt;낙관적 잠금을 사용하기 위해서는 코드에서 &lt;code class=&quot;language-text&quot;&gt;ConditionalCheckFailedException&lt;/code&gt; 을 포함하여 &lt;code class=&quot;language-text&quot;&gt;put&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; 작업에 대한 조건부 쓰기를 구현해야 한다. &lt;/p&gt;
&lt;h2&gt;비관적 잠금 (Pessimistic Locking)&lt;/h2&gt;
&lt;p&gt;비관적 잠금은 동시 업데이트를 방지하기 위해 사용하는 또 다른 전략이다. 낙관적 잠금이 버전 번호를 클라이언트에 전송하는 반면, 비관적 잠금은 버전 번호를 유지하지 않고 동시 업데이트를 방지하려고 한다. &lt;/p&gt;
&lt;p&gt;대부분의 데이터베이스 서버는 트랜잭션 시작 시 잠금을 획득하고 트랜잭션이 완료된 후에만 잠금을 해제하지만, DynamoDB는 이를 약간 다르게 처리한다. DynamoDB는 데이터를 잠그지 않고, 대신 트랜잭션을 사용하여 검토 중인 데이터에 대한 다른 스레드의 변경을 식별하며, 변경이 감지되면 DynamoDB는 트랜잭션을 취소하고 오류를 발생시킨다. &lt;/p&gt;
&lt;p&gt;비관적 잠금을 구현하기 위해 &lt;code class=&quot;language-text&quot;&gt;taransacWrite&lt;/code&gt; 라는 메소드를 제공한다. 이를 사용하면 처리 중인 항목을 잠그지 않지만 항목을 모니터링하고, 다른 스레드가 데이터틀 수정하면 전체 트랜잭션이 데이터 변경으로 인해 실패하고 데이터를 롤백한다. &lt;/p&gt;
&lt;h2&gt;RDB 와의 차이점&lt;/h2&gt;
&lt;h3&gt;데이터 모델&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RDB&lt;/p&gt;
&lt;p&gt;관계형 데이터 모델을 사용하여 테이블, 행, 열의 데이터로 형태를 데이터 구조하화며, 테이블 간의 관계를 정의하여 데이터의 무결성을 유지한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DynamoDB&lt;/p&gt;
&lt;p&gt;NoSQL 데이터베이스로 키-값과 문서 데이터 모델을 사용한다. 데이터 무결성 보장을 위해 관계형 데이터베이스와 다른 매커니즘을 사용한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;동시성 제어&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RDB&lt;/p&gt;
&lt;p&gt;트랜잭션을 사용하여 동시성을 제어한다. 트랜잭션을 시작할 때 데이터에 잠금을 걸고, 트랜잭션이 완료될 때까지 잠음을 유지하여 다른 트랜잭션에 의한 동시 수정을 방지한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DynamoDB&lt;/p&gt;
&lt;p&gt;낙관적 잠금과 조건부 업데이트를 사용하여 동시성을 제어하거나 &lt;code class=&quot;language-text&quot;&gt;taransacWrite&lt;/code&gt; API를 사용하여 트랜잭션을 지원한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;일관성&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RDB&lt;/p&gt;
&lt;p&gt;보다 강력한 일관성(Strong Consistency)을 지원한다. 트랜잭션의 모든 변경이 즉시 모든 다른 트랜잭션에 표시된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DynamoDB&lt;/p&gt;
&lt;p&gt;기본적으로 최종 일관성(Eventual Consistency)을 제공한다. 필요한 경우 강력한 일관성(Strong Consistency)을 요청할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;분리성&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RDB&lt;/p&gt;
&lt;p&gt;트랜잭션의 분리성을 보장하여 각 트랜잭션이 독립적으로 실행되도록 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DynamoDB&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;TransactWrite&lt;/code&gt; API를 통해 여러 항목에 대한 트랜잭션을 지원하여 분리성을 제공한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;지속성&lt;/h3&gt;
&lt;p&gt;두 DB 모두 트랜잭션이 성공적으로 완료된 후에는 시스템의 어떤 실패에도 영향을 받지 않고 데이터베이셔 변경이 유지되도록 지속성을 보장한다. &lt;/p&gt;
&lt;h2&gt;참고 문헌&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://dynobase.dev/dynamodb-locking/&quot;&gt;https://dynobase.dev/dynamodb-locking/&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Poetry]]></title><description><![CDATA[개요 Poetry는 파이썬 프로젝트의 의존성 관리와 패키징을 도와주는 도구이다. Poetry…]]></description><link>https://sharknia.github.io/Poetry/</link><guid isPermaLink="false">https://sharknia.github.io/Poetry/</guid><pubDate>Tue, 31 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;개요&lt;/h2&gt;
&lt;p&gt;Poetry는 파이썬 프로젝트의 의존성 관리와 패키징을 도와주는 도구이다. Poetry의 주요 목표는 프로젝트의 설정과 관리를 단순화하고, 이를 위한 통합된 솔루션을 제공하는 것이다. &lt;/p&gt;
&lt;p&gt;파이썬 개발자에게 일관된 개발 환경을 제공하며, 의존성 해결, 버전 관리, 패키징 배포와 같은 일반적인 작업을 처리하는 통합된 도구를 제공하여 파이썬 프로젝트의 생명 주기를 관리하는데 필요한 모든 기능을 제공한다. &lt;/p&gt;
&lt;p&gt;기존의 requirements.txt, venv, setup.py, wheel, twine 등을 모두 통합해 하나의 인터페이스와 프로세스로 간소화하여 제공한다. &lt;/p&gt;
&lt;h2&gt;기능과 이점&lt;/h2&gt;
&lt;h3&gt;의존성 관리&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pyproject.toml&lt;/code&gt; 파일을 사용하여 프로젝트의 의존성을 선언적으로 정의하고 관리한다. &lt;/p&gt;
&lt;p&gt;의존성이 충돌하지 않고 서로 호환되는지 자동으로 확인하여 프로젝트의 의존성 그래프를 안정적으로 유지한다. &lt;/p&gt;
&lt;h3&gt;패키징&lt;/h3&gt;
&lt;p&gt;프로젝트를 패키지화하고 배포할 수 있는 도구를 제공한다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;build&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;publish&lt;/code&gt; 명령을 사용하여 프로젝트를 빌드하고 PyPi와 같은 패키지 저장소에 배포할 수 있다. &lt;/p&gt;
&lt;h3&gt;가상 환경 관리&lt;/h3&gt;
&lt;p&gt;프로젝트에 대한 가상 환경을 자동으로 생성하고 관리하여 프로젝트의 의존성이 시스템 전역의 Python 환경으로부터 격리되도록 한다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;poetry shell&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;poetry run&lt;/code&gt; 명령어를 사용하여 가상 환경 내에서 명령을 실행할 수 있다. &lt;/p&gt;
&lt;h3&gt;버전 관리&lt;/h3&gt;
&lt;p&gt;프로젝트의 버전을 쉽게 관리할 수 있도록 돕는다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;version&lt;/code&gt; 명령어를 사용하여 프로젝트의 버전을 업데이트 할 수 있다. &lt;/p&gt;
&lt;h3&gt;프로젝트 생성과 설정&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;new&lt;/code&gt; 명령을 사용하여 프로젝트를 생성하고 기본 구조와 설정 파일을 자동으로 생성한다. &lt;/p&gt;
&lt;h3&gt;플러그인 시스템&lt;/h3&gt;
&lt;p&gt;사용자 정의 플러그인을 지원하여 기능을 확장하고 사용자 정의 작업을 수행할 수 있다. &lt;/p&gt;
&lt;h3&gt;다양한 설정 옵션&lt;/h3&gt;
&lt;p&gt;다양한 설정 옵션을 제공하여 프로젝트의 특별한 요구 사항에 따라 도구의 동작을 사용자 정의할 수 있다.  &lt;/p&gt;
&lt;h2&gt;requirements.txt 와의 비교&lt;/h2&gt;
&lt;p&gt;requirements.txt는 파이썬 프로젝트에서 아요되는 의존성과 그 버전을 나열하는 텍스트 파일이다. 프로젝트에 필요한 모든 패키지와 버전을 명시하며, 이를 통해 다른 개발자가 다른 환경에서 동일한 의존성을 쉽게 유지할 수 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;requirements.txt는 단순히 프로젝트의 의존성과 해당 버전을 나열하는 데 사용되며, 이를 넘어서는 확장성을 제공하지 않는다.&lt;/li&gt;
&lt;li&gt;의존성 간의 충돌을 자동으로 해결하지 않는다. &lt;/li&gt;
&lt;li&gt;가상 환경을 자동으로 생성하거나 관리하지 않는다. &lt;/li&gt;
&lt;li&gt;프로젝트 패키징, 배포 기능을 제공하지 않는다. &lt;/li&gt;
&lt;li&gt;프로젝트의 구조나 설정에 대한 정보를 제공하지 않는다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;venv와의 비교&lt;/h2&gt;
&lt;p&gt;venv는 파이썬 가상환경을 생성하고 관리하는 기본 도구이다. venv의 주요 목적은 프로젝트의 의존성을 시스템 전역의 파이썬 환경으로부터 격리하는 것이다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;venv는 의존성을 관리하지 않는다. 가상 환경 내에서 pip를 사용하여 수동으로 패키지를 설치하고 관리해야 한다. &lt;/li&gt;
&lt;li&gt;프로젝트 패키징, 배포 기능을 제공하지 않는다. &lt;/li&gt;
&lt;li&gt;프로젝트의 구조나 설정에 대한 정보를 제공하지 않는다. &lt;/li&gt;
&lt;li&gt;poetry는 install 명령을 실행할 때에 자동으로 가상환경을 생성하지만, venv는 별도의 명령어를 사용해 가상환경을 생성해야한다. &lt;/li&gt;
&lt;li&gt;기본적인 명령줄 인터페이스만 제공한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;단점&lt;/h2&gt;
&lt;h3&gt;학습곡선&lt;/h3&gt;
&lt;p&gt;그 자체로 너무 많은 기능이 들어있기 때문에 기존 도구에들에 익숙한 개발자들에게는 적응 시간이 필요할 수 있다. &lt;/p&gt;
&lt;h3&gt;호환성 문제&lt;/h3&gt;
&lt;p&gt;일부 레거시 프로젝트나 특정 시스템에서는 호환성 문제가 발생할 수 있다. &lt;/p&gt;
&lt;h3&gt;성능&lt;/h3&gt;
&lt;p&gt;큰 프로젝트에서 종속성의 해결이 다소 느릴 수 있다. &lt;/p&gt;
&lt;h3&gt;통합 문제&lt;/h3&gt;
&lt;p&gt;아직 모든 플랫폼이나 서비스에 완벽하게 통합되지 않았을 수 있다. CI/CD 도구와의 통합, 또는 특정 클라우드 서비스와의 통합에서 약간의 설정 작업이 필요할 수 있다. &lt;/p&gt;
&lt;h2&gt;주요 사용법 및 명령어&lt;/h2&gt;
&lt;h3&gt;설치&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-sSL&lt;/span&gt; https://install.python-poetry.org &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; python3 -&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;새 프로젝트 시작&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry new project-name&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;기존 프로젝트에서 시작&lt;/h3&gt;
&lt;p&gt;이미 존재하는 프로젝트에서도 poetry를 사용할 수 있다. 프로젝트의 루트 디렉토리에서 다음 명령어를 실행한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry init&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;종속성 추가&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; package-name&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;한편 개발중에만 필요한 패키지를 추가하려면 다음을 실행한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; package-name &lt;span class=&quot;token parameter variable&quot;&gt;--dev&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;종속성 제거&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry remove package-name&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;종속성 설치&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pyproject.toml&lt;/code&gt;에 정의된 종속성을 설치하려면 다음 명령어를 실행한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;스크립트 실행&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry run python your_script.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;빌드 및 배포&lt;/h3&gt;
&lt;p&gt;프로젝트를 패키징 하려면 다음의 명령어를 실행한다. 이렇게 하면 &lt;code class=&quot;language-text&quot;&gt;dist&lt;/code&gt;  디렉토리에 패키지가 생성된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry build&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;가상환경&lt;/h3&gt;
&lt;p&gt;poetry는 자동으로 가상환경을 생성한다. 가상 환경에 들어가기 위해서는 다음의 명령어를 실행한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry shell&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;기능 탐색&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;poetry &lt;span class=&quot;token parameter variable&quot;&gt;--help&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Blue Green Deploy 전략]]></title><description><![CDATA[소개 Blue-Green…]]></description><link>https://sharknia.github.io/Blue-Green-Deploy-전략/</link><guid isPermaLink="false">https://sharknia.github.io/Blue-Green-Deploy-전략/</guid><pubDate>Mon, 30 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;소개&lt;/h2&gt;
&lt;p&gt;Blue-Green 배포 전략은 지속적인 통합 및 지속적인 배포 환경에서 자주 사용되는 소프트웨어 배포 패턴 중 하나이다. 이 전략의 주요 목표는 시스템의 중단 없이 안전하게 애플리케이션을 배포하고 업데이트 하는 것이다. &lt;/p&gt;
&lt;h2&gt;핵심 아이디어&lt;/h2&gt;
&lt;h3&gt;두 개의 독립적인 환경&lt;/h3&gt;
&lt;p&gt;Blue와 Green이라는 두 개의 별도의 환경(또는 색상)이 있다. 일반적으로 한 환경(Blue)은 실제 사용자에게 서비스를 제공하는 라이브 환경이며, 다른 환경(Green)은 새 버전의 애플리케이션을 배포하기 위한 준비 환경이다. &lt;/p&gt;
&lt;h3&gt;스위치 오버&lt;/h3&gt;
&lt;p&gt;새 버전의 애플리케이션을 Green 환경에 배포한 후, 모든 테스트와 검증 절차를 거쳐 문제가 없다고 판단되면 트래픽을 Blue 환경에서 Green 환경으로 빠르게 전환(또는 스위치 오버) 한다. 이렇게 하면 실제 사용자는 서비스 중단 없이 새 버전의 어플리케이션을 사용할 수 있다. &lt;/p&gt;
&lt;h3&gt;롤백 용이&lt;/h3&gt;
&lt;p&gt;만약 Green 환경의 새 버전에 문제가 발생하면, 트래픽을 다시 Blue 환경으로 즉시 전환하여 이전 버전의 애플리케이션을 사용하게 할 수 있다. 이는 문제가 발생했을 때 빠르게 롤백하는데 큰 도움이 된다. &lt;/p&gt;
&lt;h2&gt;개요&lt;/h2&gt;
&lt;p&gt;Blue-Green 배포 전략에서는 실제로 “배포” 하는 작업을 여러번 반복하지 않는다. 대신, 두 개의 독립적인 환경을 유지하고 트래픽을 이 두 환경 사이에서 스위칭한다. 이를 구체적으로 설명하면 다음과 같다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;초기 상태&lt;/p&gt;
&lt;p&gt;Blue 환경이 라이브 상태이고 실제 사용자 트래픽을 처리하고 있다고 가정한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;새 버전 배포&lt;/p&gt;
&lt;p&gt;Green 환경에 새로운 버전의 애플리케이션을 배포한다. 이 시점에서 아직 Blue가 여전히 실제 트래픽을 처리하고 있다. Green은 배포 및 테스트 준비 단계에 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;스위칭&lt;/p&gt;
&lt;p&gt;Green 환경에서의 테스트와 검증이 완료되면 트래픽을 Blue에서 Green으로 스위칭한다. 이제 Green이 라이브 상태가 되어 사용자 트래픽을 처리한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다음 배포&lt;/p&gt;
&lt;p&gt;다음 번 배포 시, Blue 환경을 업데이트하고 검증한 후 트래픽을 다시 Blue로 스위칭한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;장점&lt;/h2&gt;
&lt;h3&gt;빠른 롤백&lt;/h3&gt;
&lt;p&gt;문제가 발생하면 즉시 이전 버전으로 롤백할 수 있다. &lt;/p&gt;
&lt;h3&gt;중단시간 없음&lt;/h3&gt;
&lt;p&gt;사용자에게 서비스 중단 없이 애플리케이션을 배포할 수 있다. &lt;/p&gt;
&lt;h3&gt;통합 테스트&lt;/h3&gt;
&lt;p&gt;Green 환경에서 새 버전의 애플리케이션을 배포하기 전에 광범위한 테스트와 검증을 수행할 수 있다. &lt;/p&gt;
&lt;h2&gt;단점&lt;/h2&gt;
&lt;h3&gt;자원 중복&lt;/h3&gt;
&lt;p&gt;두 개의 독립적인 환경을 유지해야 하므로 추가적인 인프라와 자원이 필요하다. &lt;/p&gt;
&lt;h3&gt;데이터베이스 동기화&lt;/h3&gt;
&lt;p&gt;데이터베이스 스키마나 데이터에 변동이 있는 경우 Blue와 Green 환경 사이의 동기화 문제가 발생할 수 있다. &lt;/p&gt;
&lt;h2&gt;Blue-Green은 테스트 서버일까?&lt;/h2&gt;
&lt;p&gt;배포 과정에서 한 환경이 새 버전의 검증을 위한 임시 테스트 역할을 하게 되는 것은 맞다. 이렇게 설명하면 테스트 서버와 실서버 역할을 그린과 블루가 번갈아가면서 한다고 착각하기 쉽지만 이보다는 둘 다 실서버의 역할을 할 수 있는 독립적인 프로덕션 환경임을 알아야 한다. 몇 가지 중요한 차이점이 있다. &lt;/p&gt;
&lt;h3&gt;프로덕션 준비&lt;/h3&gt;
&lt;p&gt;Blue와 Green 둘 다 프로덕션 트래픽을 처리할 준비가 되어있다. 그러나 일반적인 테스트 서버는 프로덕션 수준의 리소스나 성능을 가지고 있지 않을 수 있다. &lt;/p&gt;
&lt;h3&gt;스케일&lt;/h3&gt;
&lt;p&gt;Blue와 Green은 실제 사용자의 트래픽을 처리할 수 있을 만큼 큰 규모로 구축되어야 한다. 반면 테썹은 보통 작은 규모로 운영된다. &lt;/p&gt;
&lt;h3&gt;데이터&lt;/h3&gt;
&lt;p&gt;Blue와 Green은 실제 데이터를 다룬다. &lt;/p&gt;
&lt;h2&gt;Blue-Green 배포에서 DB 관리&lt;/h2&gt;
&lt;p&gt;Blue-Green 배포 전략에서 데이터베이스의 관리는 중요한 고려사항 중 하나이다. 데이터베이스는 상태를 가지고 있으므로 애플리케이션 코드와는 달리 간단히 스위칭하는게 어렵다. &lt;/p&gt;
&lt;h3&gt;단일 데이터베이스 사용&lt;/h3&gt;
&lt;p&gt;같은 DB를 사용하는 것은 가능하다. 하지만 이렇게 할 때 고려해야 할 몇가지 중요한 문제가 있다. &lt;/p&gt;
&lt;h4&gt;스키마 변경&lt;/h4&gt;
&lt;p&gt;데이터베이스 스키마에 변경이 필요한 새 버전의 애플리케이션을 배포할 때 문제가 발생할 수 있다. 새 버전에서 필요한 스키마 변경이 이전 버전과 호환되지 않으면 Green 환경에서의 배포 동안 Blue 환경의 애플리케이션에 문제가 발생할 수 있다. &lt;/p&gt;
&lt;h4&gt;데이터 무결성&lt;/h4&gt;
&lt;p&gt;두 환경이 동일한 데이터베이스를 공유할 경우, 새 버전의 애플리케이션에서 예상치 못한 데이터 변경이 발생하면 이전 버전의 실행에도 영향을 줄 수 있다. 따라서, 롤백에도 영향을 줄 수 있다. &lt;/p&gt;
&lt;p&gt;이를 극복하기 위한 여러 전략이 있다. 예를 들면,&lt;/p&gt;
&lt;h4&gt;스키마 변경 전략&lt;/h4&gt;
&lt;p&gt;데이터 베이스 스키마 변경을 두 단계로 나누어 수행한다. 먼저 호환성이 있는 스키마 변경을 실시한 후, 새 버전의 애플리케이션을 배포한다. 그 다음 이전 버전과 호환되지 않는 스키마 변경을 실시한다. &lt;/p&gt;
&lt;h4&gt;피쳐 토글&lt;/h4&gt;
&lt;p&gt;데이터베이스에 영향을 주는 새로운 기능이나 변경 사항을 피쳐 토글로 구현하여, 실제로 데이터베이스에 적용되기 전까지는 활성화하지 않을 수 있다. &lt;/p&gt;
&lt;h4&gt;결론&lt;/h4&gt;
&lt;p&gt;만약 이 방법을 선택할 경우, 새로운 버전의 애플리케이션은 데이터베이스 스키마에 대한 변경이 없거나 하위 호환성을 유지해야 한다. &lt;/p&gt;
&lt;h3&gt;데이터베이스 마이그레이션&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;배포 전에 필요한 데이터베이스 마이그레이션을 신중하게 계획하고 실행한다. &lt;/li&gt;
&lt;li&gt;마이그레이션은 트래픽을 Green 환경으로 전환하기 전에 실행되어야 한다. &lt;/li&gt;
&lt;li&gt;롤백 시나리오에 대한 계획도 있어야 한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;데이터 동기화&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;동기화를 위해 DynamoDB Streams와 Lambda를 사용하여 두 테이블 간의 데이터를 동기화 할 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ALB-ECS 환경에서의 Blue-Green 배포 전략 시나리오&lt;/h2&gt;
&lt;h3&gt;1. 초기 환경 설정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ECS 클러스터에서 두 개의 서비스(Blue와 Green)을 생성한다. 초기에는 Blue만 활성 상태(현재 트래픽을 받고 있는 상태)이다. &lt;/li&gt;
&lt;li&gt;ALB 설정: ECS 서비스에 트래픽을 라우팅하기 위해 사용된다. &lt;/li&gt;
&lt;li&gt;Route 53에 도메인 이름을 설정하고 ALB의 DNS 이름을 지정한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;2. CodePipeline 설정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Source: 예를 들면 깃허브 또는 CodeCommit의 소스 변경을 감지하여 파이프라인을 트리거한다. &lt;/li&gt;
&lt;li&gt;Build: CodeBuild를 사용하여 Docker 이미지를 빌드하고 ECR(Elastic Container Registry)에 푸시한다. &lt;/li&gt;
&lt;li&gt;Deploy: CodeDeploy를 사용하여 ECS에 새로운 이미지를 배포한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;3. Blue-Green 배포&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;새로운 코드 변경이 파이프라인을 트리거하면 CodeBuild가 새 Docker 이미지를 빌드하고 ECR에 푸시한다. &lt;/li&gt;
&lt;li&gt;CodeDeploy는 Green ECS 서비스를 대상으로 새 이미지를 사용하여 작업 정의를 업데이트한다. &lt;/li&gt;
&lt;li&gt;Green 서비스의 태스크가 성공적으로 시작되면 Blue-Green 배포 설정에 따라 CodeDeploy는 자동으로 ALB의 대상 그룹을 업데이트하여 Green 서비스로 트래픽을 전환한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4. 검증 및 롤백&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Green 환경에서 서비스의 동작을 검증한다. &lt;/li&gt;
&lt;li&gt;CodeDeploy는 선택적으로 사용자 지정 후크를 사용하여 배포 후 검증 스크립트를 실행할 수 있다. &lt;/li&gt;
&lt;li&gt;문제가 발생한 경우 원래의 Blue 서비스로 빠르게 전환하여 롤백한다. CodeDeploy는 자동 롤백을 지원하여 이전 상태로 되돌릴 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5. 다음 배포 준비&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;다음 배포는 Blue가 새 환경이고 Green이 이전 환경이 된다. 이렇게 두 환경을 번갈아 사용하면서 배포를 진행한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;기타 배포 전략&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;카나리아 배포&lt;/li&gt;
&lt;li&gt;롤링 배포&lt;/li&gt;
&lt;li&gt;기능 토글&lt;/li&gt;
&lt;li&gt;A/B 테스팅&lt;/li&gt;
&lt;li&gt;섀도우 배포&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[CloudFront]]></title><description><![CDATA[Amazon CloudFront 아마존에서 제공하는 CDN(Content Delivery Network) 서비스이다.  CDN…]]></description><link>https://sharknia.github.io/CloudFront/</link><guid isPermaLink="false">https://sharknia.github.io/CloudFront/</guid><pubDate>Mon, 30 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Amazon CloudFront&lt;/h2&gt;
&lt;p&gt;아마존에서 제공하는 CDN(Content Delivery Network) 서비스이다. &lt;/p&gt;
&lt;h4&gt;CDN이란?&lt;/h4&gt;
&lt;p&gt;사용자에게 웹 콘텐츠를 더 빠르게 제공하기 위해 전 세계 여러 위치에 콘텐츠를 분산 및 저장하는 네트워크이다.&lt;/p&gt;
&lt;h2&gt;주요 기능과 특징&lt;/h2&gt;
&lt;h4&gt;글로벌 엣지 네트워크&lt;/h4&gt;
&lt;p&gt;전 세계에 200개가 넘는 엣지 로케이션과 리전을 갖추고 있다. &lt;/p&gt;
&lt;h4&gt;동적 및 정적 콘텐츠 전송&lt;/h4&gt;
&lt;p&gt;정적 콘텐츠와 동적 콘텐츠를 모두 효과적으로 전송한다. &lt;/p&gt;
&lt;h4&gt;오리진 서버&lt;/h4&gt;
&lt;p&gt;배포를 생성할 때 오리진 서버를 지정해야 한다. 이 오리진은 S3 버킷, EC2 인스턴스, ELB, 외부 서버 등이 될 수 있다. 오리진에서 컨텐츠를 가져와 사용자에게 제공한다. &lt;/p&gt;
&lt;h4&gt;성능향상&lt;/h4&gt;
&lt;p&gt;CDN은 사용자에게 가까운 서버에서 콘텐츠를 제공하여 웹 사이트의 로딩시간을 단축시킨다. &lt;/p&gt;
&lt;h4&gt;가용성 및 장애 복구&lt;/h4&gt;
&lt;p&gt;여러 서버에 콘텐츠를 복사하므로, 한 서버에 문제가 발생하더라도 다른 서버에서 콘텐츠를 제공할 수 있다. &lt;/p&gt;
&lt;h4&gt;부하 분산&lt;/h4&gt;
&lt;p&gt;웹 트래픽을 여러 서버에 분산시켜 오리진 서버의 부하를 줄인다. &lt;/p&gt;
&lt;h4&gt;비용 절감&lt;/h4&gt;
&lt;p&gt;캐시된 콘텐츠를 제공함으로써 오리진 서버의 대역폭 사용량과 비용을 줄일 수 있다. &lt;/p&gt;
&lt;h4&gt;보안 향상&lt;/h4&gt;
&lt;p&gt;웹사이트에 대한 DDoS 공격과 같은 일부 보안 위협으로부터 보호할 수 있다. &lt;/p&gt;
&lt;h2&gt;동작 플로우&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;배포 생성&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;사용자는 AWS Management Console, SDK, CLI 등을 사용하여 CloudFront 배포를 생성한다. 이 때, 오리진 서버(S3 버킷, EC2 인스턴스, HTTP 서버 등)와 다양한 배포 설정(예: 캐싱 동작, SSL 인증서, 액세스 제한 등)을 지정한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DNS 등록&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CloudFront는 배포에 대해 고유한 도메인 이름을 제공한다. 사용자는 Route 53 같은 DNS 서비스를 사용해 이 도메인 이름을 웹 사이트나 애플리케이션에 연결할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;사용자 요청&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;사용자가 콘텐츠에 액세스 하기 위해 웹 브라우저나 애플리케이션으로 요청을 보내면 DNS 시스템은 해당 요청을 CloutFront 배포의 도메인 이름으로 Resolve 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;엣지 로케이션 라우팅&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;요청은 사용자게에 가장 가까운 CloudFront 엣지 로케이션으로 라우팅된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;캐시 확인&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;해당 엣지 로케이션의 캐시에서 요청된 콘텐츠를 확인한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;캐시에 콘텐츠가 있는 경우 (Cache Hit) : 캐시된 콘텐츠를 사용자에게 직접 반환한다. &lt;/li&gt;
&lt;li&gt;캐시에 콘텐츠가 없는 경우 (Cache Miss) : CloudFront는 설정된 오리진 서버로 요청을 전달한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;오리진에서 콘텐츠 가져오기&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;오리진 서버에서 요청된 콘텐츠를 가져온다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;콘텐츠 반환 및 캐싱&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;가져온 콘텐츠를 사용자에게 반환하면서 동시에 해당 콘텐츠를 엣지 로케이션의 캐시에 저장한다. 이후 동일한 콘텐츠에 대한 요청이 들어오면 캐시에서 빠르게 제공할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;캐시 만료&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;캐싱 동작은 TTL(Time to Live) 설정에 따라 관리된다. TTL이 만료되면 콘텐츠는 자동으로 캐시에서 제거된다. 다음 요청이 들어오면 다시 오리진에서 콘텐츠를 가져온다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;동적 콘텐츠의 캐싱&lt;/h2&gt;
&lt;p&gt;동적 콘텐츠는 사용자별로 또는 시간에 따라 달라지는 콘텐츠를 의미한다. 예를 들면 사용자 프로필 페이지, 실시간 주식 시세, 뉴스 피드 등이 있을 수 있다. CDN 서비스들은 동적 콘텐츠를 캐싱하기 위해 특별한 전략을 사용한다. &lt;/p&gt;
&lt;p&gt;동적 콘텐츠 캐싱의 핵심 아이디어는 “모든 동적 콘텐츠가 항상 동적인 것은 아니다.”라는 점이다. 즉, 일부 동적 콘텐츠는 짧은 시간 동안에는 변하지 않을 수도 있다. &lt;/p&gt;
&lt;p&gt;캐시의 동작을 잘못 설정하면 데이터 베이스의 변경사항이 반영된 새로운 응답이 캐시에 저장되지 않을 수 있으므로, 그 결과로 사용자는 오래된 또는 기대하지 않은 응답을 받을 수 있다. 이런 문제를 피하기 위해 캐싱은 항상 주의해야 한다. &lt;/p&gt;
&lt;p&gt;캐싱 전략을 변경하거나 새로운 캐싱 매커니즘을 도입할 때에는 항상 테스트 환경에서 먼저 검증하는 것이 좋다. &lt;/p&gt;
&lt;p&gt;동적 콘텐츠를 캐싱하는 방법은 다음과 같다. &lt;/p&gt;
&lt;h3&gt;조정 가능한 TTL&lt;/h3&gt;
&lt;p&gt;동적 콘텐츠에 대한 캐싱 정책의 TTL을 짧게 설정할 수 있다. 이렇게 하면 콘텐츠가 잠시동안만 캐싱되어 그 이후에는 다시 오리진에서 최신 데이터를 가져온다. &lt;/p&gt;
&lt;h3&gt;캐시 키 매개변수&lt;/h3&gt;
&lt;p&gt;쿼리 문자열, 헤더, 쿠키 등의 요청 요소를 기반으로 캐시 버전을 구분할 수 있다. 이를 사용해 동일한 URL에 대한 다양한 버전의 콘텐츠를 캐싱할 수 있다. &lt;/p&gt;
&lt;h3&gt;컨텐츠 기반의 캐싱 정책&lt;/h3&gt;
&lt;p&gt;오리진 서버는 &lt;code class=&quot;language-text&quot;&gt;Cache-Control&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;Expires&lt;/code&gt; 헤더를 사용하여 콘텐츠의 캐싱 동작을 제어할 수 있다. &lt;/p&gt;
&lt;h4&gt;Cache-Control 헤더&lt;/h4&gt;
&lt;p&gt;반환된 응답에 Cache-Control 헤더가 포함되어 있는 경우 이 헤더의 지시어를 따라 캐싱한다. 예를 들어 &lt;code class=&quot;language-text&quot;&gt;Cache-Control: max-age=3600&lt;/code&gt; 은 해당 응답을 1시간 동안 캐싱하라는 의미이다. &lt;/p&gt;
&lt;p&gt;또는 &lt;code class=&quot;language-text&quot;&gt;Cache-Control: no-store&lt;/code&gt; 나 &lt;code class=&quot;language-text&quot;&gt;Cache-Control: private&lt;/code&gt; 헤더를 포함하고 있으면 해당 응답은 캐싱되지 않는다. &lt;/p&gt;
&lt;h4&gt;Expires 헤더&lt;/h4&gt;
&lt;p&gt;반환된 응답이 Expires 헤더를 포함하고 있으면 해당 시간까지 응답을 캐싱한다. &lt;/p&gt;
&lt;h3&gt;Lambda@Edge&lt;/h3&gt;
&lt;p&gt;Lambda@Egde를 이용하여 요청 및 응답을 가로채고 수정하여 캐싱 동작을 더욱 세밀하게 제어할 수 있다. &lt;/p&gt;
&lt;h3&gt;Bypass Cache&lt;/h3&gt;
&lt;p&gt;특정 조건 하에서 캐싱을 우회하고 항상 오리진 서버로 요청을 전달할 수 있다. 이렇게 하면 특정 요청에 대해서는 항상 최신의 동적 콘텐츠를 제공할 수 있다. &lt;/p&gt;
&lt;h3&gt;데이터 변경 시 캐시 무효화&lt;/h3&gt;
&lt;p&gt;특정 콘텐츠의 캐시를 수동으로 무효화 하는 기능을 제공한다. 데이터베이스에 중요한 변경이 발생한 경우, 이 기능을 사용하여 해당 콘텐츠의 캐시를 즉시 제거할 수 있다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[AWS ECS(Elastic Container Service)]]></title><description><![CDATA[개요 AWS ECS는 Docker…]]></description><link>https://sharknia.github.io/AWS-ECSElastic-Container-Service/</link><guid isPermaLink="false">https://sharknia.github.io/AWS-ECSElastic-Container-Service/</guid><pubDate>Wed, 25 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;개요&lt;/h2&gt;
&lt;p&gt;AWS ECS는 Docker 컨테이너를 쉽게 실행, 중지 및 관리할 수 있도록 해주는 컨테이너 오케스트레이션 서비스이다. 컨테이너 배포, 작업 정의, 서비스 정의, 클러스터 관리 등을 지원한다. &lt;/p&gt;
&lt;h3&gt;오케스트레이션 서비스란?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;컨테이너의 배포, 관리, 스케일링, 네트워킹 및 가용성을 자동화하는 프로세스 및 도구의 집합이다. &lt;/li&gt;
&lt;li&gt;즉, 컨테이너화된 애플리케이션의 라이프사이클을 관리하는 것을 의미한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;주요 특징&lt;/h2&gt;
&lt;h3&gt;서비스&lt;/h3&gt;
&lt;p&gt;여러 개의 작업 인스턴스를 관리하며, 로드 밸런싱과 함께 사용하여 트래픽 분산을 지원한다. &lt;/p&gt;
&lt;h3&gt;클러스터&lt;/h3&gt;
&lt;p&gt;컨테이너를 실행하는데 사용되는 논리적인 그룹이다. ECS에서 실행되는 리소스의 집합을 의미한다. 클러스터는 EC2 인스턴스나 Fargate 인스턴스를 포함할 수 있다. &lt;/p&gt;
&lt;p&gt;클러스터를 사용하여 워크로드와 관련된 리소스를 논리적으로 그룹화 할 수 있다. 예를 들면 &lt;strong&gt;“production” 클러스터와 “development” 클러스터를 별도로 운영할 수 있다.&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;기본적으로 단순한 논리적 이름을 지닌 메타 데이터 구조체로, 클러스터 안의 실제 컴퓨팅 리소스와 독립적이다. &lt;/p&gt;
&lt;h3&gt;네임스페이스&lt;/h3&gt;
&lt;p&gt;리소스를 논리적으로 분리하고 관리하기 위한 도구이다. 동일한 도메인 이름 아래에서 운영되는 서비스들의 논리적 그룹의 형성에 사용된다. &lt;/p&gt;
&lt;h3&gt;테스크&lt;/h3&gt;
&lt;p&gt;단일 컨테이너 또는 여러 컨테이너의 그룹이다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;작업 정의&lt;/code&gt; : 컨테이너의 속성을 정의하는 JSON 템플릿이다. CPU, 메모리 할당, 네트워크 모드, 사용할 도커 이미지 등을 포함한다. &lt;/p&gt;
&lt;p&gt;테스크는 작업 정의에 정의된 내용에 따라 실행된다. 예를 들면 웹 서버와 관련된 데이터베이스를 함께 실행하는 테스크를 생성할 수 있다. &lt;/p&gt;
&lt;h2&gt;순서와 구조&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;컨테이너&lt;/p&gt;
&lt;p&gt;독립적으로 실행 가능한 소프트웨어의 최소 단위. AWS ECS에서는 이 컨테이너를 EC2 인스턴스나 Fargate에서 실행할 수 있다.  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;테스크&lt;/p&gt;
&lt;p&gt;ECS의 실행 단위, 하나 이상의 컨테이너로 구성됨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클러스터&lt;/p&gt;
&lt;p&gt;테스크와 서비스를 실행하고 관리하는 논리적 단위&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;네임스페이스&lt;/p&gt;
&lt;p&gt;서비스와 관련된 논리적 그룹을 형성&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;ECS&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;각 단계는 이전 단계의 구성 요소를 더 큰 단위로 그룹화하거나 관리하는 역할을 한다. &lt;/p&gt;
&lt;h2&gt;웹 애플리케이션의 개발 후 ECS 배포&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;웹 애플리케이션 개발&lt;/p&gt;
&lt;p&gt;웹 애플리케이션을 개발한다. &lt;/p&gt;
&lt;p&gt;로컬에서 테스트하여 작동을 확인한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Docker 이미지 생성&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 을 작성하여 웹애플리케이션을 컨테이너화 한다. &lt;/p&gt;
&lt;p&gt;로컬에서 Docker를 사용하여 이미지를 빌드하고 테스트한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Docker 이미지를 ECR(Elastioc Container Registry)에 푸시&lt;/p&gt;
&lt;p&gt;AWS ECR에 저장소를 생성한다. &lt;/p&gt;
&lt;p&gt;로컬에서 빌드한 Docker 이미지를 ECR 저장소에 PUSH 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ECS 클러스터 및 작업 정의 설정&lt;/p&gt;
&lt;p&gt;ECS 클러스터를 생성한다. (Fargate 또는 EC2 인스턴스)&lt;/p&gt;
&lt;p&gt;작업 정의(Task Definition)을 생성한다. 작업 정의에는 ECR에수 푸시한 Docker 이미지, 필요한 CPU와 메모리, 환경 변수, 포트 매핑 등을 지정한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ECS 서비스 생성&lt;/p&gt;
&lt;p&gt;ECS 클러스터 내에서 작업정의를 기반으로 서비스를 생성한다. 서비스를 사용하면 컨테이너의 실행 상태를 유지하거나 원하는 개수의 작업 인스턴스를 실행할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;도메인 및 DNS 설정&lt;/p&gt;
&lt;p&gt;AWS Route 53을 사용하여 도메인을 설정하고 ALB(Application Load Balancer) 의 주소를 해당 도메인에 연결한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;보안 그룹 및 네트워크 설정&lt;/li&gt;
&lt;li&gt;모니터링 및 로깅&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;기존 서비스에서 ECS 기반 서비스로의 전환&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ECS, Fargate 설정&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ALB 설정&lt;/p&gt;
&lt;p&gt;Application Load Balancer를 생성한다. &lt;/p&gt;
&lt;p&gt;리스너와 타겟 그룹을 설정하여 ECS 서비스의 작업에 트래픽을 라우팅 하도록 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Route 53 업데이트&lt;/p&gt;
&lt;p&gt;현재 서비스에 연결된 Route53 레코드를 수정하여 ALB의 DNS 이름을 가리키도록 변경한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;모니터링 및 튜닝&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;주의점&lt;/h3&gt;
&lt;p&gt;기본적으로는 CES, Fargate, ALB를 설정한 후 마지막 단계로 Route 53의 레코드 설정만 변경하면 트래픽은 새로운 ECS-Fargate 기반의 서비스로 라우팅된다. &lt;/p&gt;
&lt;p&gt;그러나 다음과 같은 주의 사항이 있다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;테스트 &lt;/p&gt;
&lt;p&gt;ALB와 ECS가 올바르게 작동하는지 사전에 충분히 테스트 해야 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DNS 전파 지연&lt;/p&gt;
&lt;p&gt;DNS 업데이트는 즉시 전파되지 않을 수 있다. 일부 사용자는 변경 전의 엔드포인트로 트래픽이 라우팅 될 수 있으므로 업데이트 후에도 기존 서비스를 적어도 몇 시간 동안 실행 상태로 유지하는 것이 좋다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;롤백 계획&lt;/p&gt;
&lt;p&gt;문제가 발생할 경우를 대비하여 롤백 계획을 준비해야 한다. 예를 들어 새로운 서비스에 문제가 발생한 경우 Route 53 설정을 원래대로 돌릴 수 있어야 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[vercel 배포 자동화]]></title><description><![CDATA[어느 순간 morethan-log…]]></description><link>https://sharknia.github.io/vercel-배포-자동화/</link><guid isPermaLink="false">https://sharknia.github.io/vercel-배포-자동화/</guid><pubDate>Mon, 23 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;어느 순간 morethan-log에 노션 글 업로드가 잘 되지 않았다. &lt;/p&gt;
&lt;p&gt;글을 그 동안 마구 마구 써버리긴 했다.. 그래서 찔리는 점이 있었는데, 최근 이직 후 일을 하면서 조금 덜 쓰면서, 그리고 잠깐 옵시디언으로 한 눈을 팔면서 고칠 생각을 안하고 있었다. &lt;/p&gt;
&lt;p&gt;그러면서 일도 쪼끔 익숙해지고 옵시디언도 아 별로다 라고 결론을 내고 다시 여기에 글을 썼는데, 업로드가 되지 않는걸 보니 결국은 고쳐야 할 때가 왔음을 알게 됐다. &lt;/p&gt;
&lt;p&gt;morethan-log는 일정 시간마다 특정 api를 호출해서 노션에서 글을 긁어오는 함수를 실행한다. &lt;/p&gt;
&lt;p&gt;그리고 vercel에서는 그 api가 실행한 함수의 실행 로그를 볼 수 있다… &lt;/p&gt;
&lt;p&gt;로그를 봤더니 예상과 같았다. &lt;/p&gt;
&lt;p&gt;무료 플랜에서는 함수 실행 시간을 10초까지만 허용하는데, 10초를 당연한듯이 넘고 있었다. &lt;/p&gt;
&lt;p&gt;notion 비공식 api를 호출하는건데.. &lt;/p&gt;
&lt;p&gt;deploy를 직접 했을땐 제대로 긁어오는 것으로 보아 api가 막힌 것 같진 않고 글이 많아지면서 발생한 것 같다.. &lt;/p&gt;
&lt;p&gt;길게 고민하지 않고 Vercel의 Deploy hooks와 Pipedream의 기능의 무료 기능들만 사용해서 매일 새벽 두시에 자동 배포를 하기로 했다. &lt;/p&gt;
&lt;h3&gt;Vercel Deploy Hooks&lt;/h3&gt;
&lt;p&gt;Vercel의 Deploy Hooks 기능을 이용하면 특정 URL에 HTTP 요청이 이뤄질 때마다 사이트를 다시 빌드하고 배포할 수 있다. &lt;/p&gt;
&lt;p&gt;내 프로젝트를 고르고, Setting를 고른 다음 좌측의 Git을 고른다. &lt;/p&gt;
&lt;p&gt;Deploy Hooks로 이동해서 &lt;code class=&quot;language-text&quot;&gt;Create Hook&lt;/code&gt;을 해 url을 생성한다. 이제 해당 URL로 접속하면 deploy 되는것을 볼 수 있다. &lt;/p&gt;
&lt;h3&gt;Pipedream 설정&lt;/h3&gt;
&lt;p&gt;Pipedream은 서로 다른 애플리케이션, 데이터 및 API를 연결하고 자동화 하는데 사용할 수 있는 서버리스 통합 플랫폼이다. 단적으로, 이번엔 내가 원하는 시간에 Hook을 위한 URL을 호출하도록 스케쥴링 할 수 있다. &lt;/p&gt;
&lt;p&gt;Pipedream 대시보드에서 &lt;code class=&quot;language-text&quot;&gt;New&lt;/code&gt;를 클릭하고 &lt;code class=&quot;language-text&quot;&gt;Workflow&lt;/code&gt;를 선택하여 새 워크플로우를 생성한다. &lt;/p&gt;
&lt;p&gt;트리거로 &lt;code class=&quot;language-text&quot;&gt;Schedule&lt;/code&gt; 을 선택하고 원하는 스케쥴을 설정한다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Send Http Request&lt;/code&gt; 를 선택하고, Vercel Deploy Hooks URL을 입력한다. &lt;/p&gt;
&lt;p&gt;테스트 후, 저장 및 배포한다. &lt;/p&gt;
&lt;p&gt;이로써 매일 사이트를 다시 배포하고 빌드함으로써 블로깅에 아무 문제가 없게 되었다. &lt;/p&gt;
&lt;p&gt;해피~&lt;/p&gt;</content:encoded></item><item><title><![CDATA[FastAPI와 DDD]]></title><description><![CDATA[기본 개념 DDD…]]></description><link>https://sharknia.github.io/FastAPI와-DDD/</link><guid isPermaLink="false">https://sharknia.github.io/FastAPI와-DDD/</guid><pubDate>Fri, 20 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;기본 개념&lt;/h2&gt;
&lt;p&gt;DDD는 복잡한 애플리케이션과 시스템의 개발에 있어서 비즈니스 요구사항을 중심으로 설계하고 구현하는 접근법입니다. 이 방식은 비즈니스 도메인의 복잡성을 이해하고, 그 복잡성을 모델링하여 소프트웨어에 반영하는 것에 중점을 둡니다.&lt;/p&gt;
&lt;h2&gt;핵심 요소&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Ubiquitous Language (모든 곳에서 사용되는 언어)&lt;/strong&gt;: 개발팀과 비즈니스 팀 간에 공통적으로 사용되는 언어. 이를 통해 불필요한 혼동을 줄이고, 의사소통의 효율을 높입니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bounded Context (경계가 정의된 맥락)&lt;/strong&gt;: 특정한 맥락 내에서만 유효한 모델을 정의. 다른 맥락에서는 같은 용어도 다른 의미를 가질 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Entities, Value Objects, Aggregates, Repositories&lt;/strong&gt;: 도메인 모델을 구성하는 주요 요소들입니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Domain Events&lt;/strong&gt;: 도메인 내에서 중요한 비즈니스 이벤트를 나타냅니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;FastAPI에서 DDD의 기본 구조&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;├── api                               &lt;span class=&quot;token comment&quot;&gt;# 첫 번째 API 모듈&lt;/span&gt;
│   ├── domain                        &lt;span class=&quot;token comment&quot;&gt;# 도메인 로직과 엔티티 정의&lt;/span&gt;
│   │   ├── entities                  &lt;span class=&quot;token comment&quot;&gt;# 엔티티 정의 (비즈니스 모델)&lt;/span&gt;
│   │   └── value_objects             &lt;span class=&quot;token comment&quot;&gt;# 값 객체 정의 (데이터 검증 및 전송 용도)&lt;/span&gt;
│   ├── presentation                  &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션의 사용자 인터페이스 레이어&lt;/span&gt;
│   │   ├── dto                       &lt;span class=&quot;token comment&quot;&gt;# 데이터 전송 객체 정의 (Pydantic 모델)&lt;/span&gt;
│   │   └── rest                      &lt;span class=&quot;token comment&quot;&gt;# REST 엔드포인트 정의&lt;/span&gt;
│   │       └── controllers           &lt;span class=&quot;token comment&quot;&gt;# REST 컨트롤러 (FastAPI 경로 작업 처리)&lt;/span&gt;
│   ├── repository                    &lt;span class=&quot;token comment&quot;&gt;# 영속성 관리를 위한 인터페이스 정의&lt;/span&gt;
│   │   └── impl                      &lt;span class=&quot;token comment&quot;&gt;# 리포지토리 구현체 (영속성 레이어)&lt;/span&gt;
│   │       └── sql                   &lt;span class=&quot;token comment&quot;&gt;# SQL 기반 리포지토리 구현체&lt;/span&gt;
│   │           ├── models.py         &lt;span class=&quot;token comment&quot;&gt;# 데이터베이스 모델 (ORM 모델)&lt;/span&gt;
│   │           ├── crud.py           &lt;span class=&quot;token comment&quot;&gt;# CRUD 연산 로직&lt;/span&gt;
│   │           └── database.py       &lt;span class=&quot;token comment&quot;&gt;# 데이터베이스 세션 및 연결 관리&lt;/span&gt;
│   └── &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt;                       &lt;span class=&quot;token comment&quot;&gt;# 도메인 서비스 정의, 도메인 로직 구현&lt;/span&gt;
│       └── impl                      &lt;span class=&quot;token comment&quot;&gt;# 서비스 구현체 (비즈니스 로직의 구현)&lt;/span&gt;
├── api2                              &lt;span class=&quot;token comment&quot;&gt;# 두 번째 API 모듈&lt;/span&gt;
│   └── &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.                           &lt;span class=&quot;token comment&quot;&gt;# 같은 구조를 가져간다&lt;/span&gt;
├── core                              &lt;span class=&quot;token comment&quot;&gt;# 공통 핵심 기능이나 공유 컴포넌트&lt;/span&gt;
└── router                            &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션의 라우팅 로직, URL 라우트 정의&lt;/span&gt;
    └── routes                        &lt;span class=&quot;token comment&quot;&gt;# 개별 라우트 정의 파일&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;DDD의 원칙에 따라 애플리케이션을 조직화하면 각 도메인이 뚜렷하게 분리되고 관리하기 쉬워진다. 위에 제시된 디렉토리 구조는 DDD를 적용한 예시이다. &lt;/p&gt;
&lt;p&gt;도메인 레이어, 애플리케이션 레이어, 인프라 레이어로 분리되어 코드의 응집도를 높이고 결합도를 낮출 수 있다. 또한 각 레이어가 제공하는 인터페이스와 구현체를 분리함으로써 유지보수와 확장성에 유리한 구조를 만들 수 있다. &lt;/p&gt;
&lt;h3&gt;도메인 레이어&lt;/h3&gt;
&lt;h4&gt;domain 디렉토리&lt;/h4&gt;
&lt;p&gt;DDD에서 가장 중요한 부분으로 복잡한 비즈니스 로직과 애플리케이션 핵심 기능을 표현하는 모델을 담고 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;entities&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;비즈니스 도메인의 기본적인 데이터 단위로 고유한 식별자를 가지고 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;비즈니스 규칙을 캡슐화하고 FastAPI 애플리케이션에서 데이터베이스 레코드와 1:1로 매핑되는 경우가 많다. &lt;/li&gt;
&lt;li&gt;FastAPI는 이러한 엔티티에 직접적으로 연관되지능 않지만 ORM 도구를 사용하여 엔티티 클래스를 데이터 모델로 변환하고 데이터베이스와 상호작용을 할 수 있다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;value_objects&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;식별자를 가지지 않는 불변 객체로 엔티티의 속성을 표현한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;FastAPI에서는 값 객체를 표현하기 위해 Pydantic의 기능을 활용할 수 있으며 요청 검증이나 응답 시리얼라이징에 유용하게 사용된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;애플리케이션 레이어(presentation, service)&lt;/h3&gt;
&lt;h4&gt;presentaion 디렉토리&lt;/h4&gt;
&lt;p&gt;이 디렉토리는 사용자 인터페이스와 외부에 노출되는 API 엔드포인트의 정의를 담당한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DTO&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DTO는 클라이언트와 서버간에 데이터를 전달할 때 사용하는 객체이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;FastAPI에서는 Pydantic 모델을 이용해 DTO를 정의한다. 이 모델들은 본문, 쿼리 파라미터, 경로 파라미터, 그리고 응답 모델을 정의하는데 사용된다.&lt;/li&gt;
&lt;li&gt;DTO는 엔드포인트가 받아들이고 반환하는 데이터의 구조와 유효성 검증 규칙을 명시한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;REST&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Restful 원칙을 따르는 API 엔드포인트를 정의한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;FastAPI에서는 각 API 경로에 해당하는 함수를 작성하고 이를 HTTP 메서드에 매핑한다. &lt;/li&gt;
&lt;li&gt;각 함수는 Pydantic DTO를 매개변수로 사용하여 요청 데이터의 유효성을 검사하고 이를 도메인 모델로 변환하거나 서비스 레이어로 전달한다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Controllers&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;API 엔드포인트에 대한 요청을 처리하는 로직을 담당한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;FastAPI에서는 주로 경로 작업 함수로 표현되며 경로 데코레이터를 사용하여 라우트를 설정한다. &lt;/li&gt;
&lt;li&gt;컨트롤러는 요청을 받아 DTO로 파싱하고 필요한 비즈니스 로직을 수행한 후 적절한 HTTP 응답을 반환한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 구성 요소들은 FastAP의 강점인 타입 힌트, 자동 문서화, 요청 검증 등을 활용하여 효율적인 API 인터페이스 레이어를 구성하는데 중요한 역할을 한다. &lt;/p&gt;
&lt;h4&gt;service 디렉토리&lt;/h4&gt;
&lt;p&gt;애플리케이션의 비즈니스 로직을 구현하는 부분을 담당한다. 컨트롤러와 데이터 액세스 계층 사이에서 중간 역할을 한다. 주요 목적은 비즈니스 규칙과 애플리케이션 로직을 캡슐화하여 재사용성을 높이고 애플리케이션의 다룬 부분과의 결합도를 낮추는 것이다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Service Implementations (impl)&lt;/p&gt;
&lt;p&gt;실제 로직을 구현한다. 이 구현체는 데이터베이스 호출, 외부 서비스 호출, 비즈니스 규칙 처리 등을 담당한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;인프라 레이어(repository)&lt;/h3&gt;
&lt;p&gt;도메인 레이어와 애플리케이션 레이어의 기술적 세부 사항을 추상화하는 역할을 한다. 주로 데이터베이스, 메시징 시스템, 파일 시스템와 같은 외부 자원과의 통신을 담당한다. 애플리케이션의 나머지 부분이 기술적인 세부사항에 직접적으로 의존하지 않도록 추상화를 제공한다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Unit Test(단위 테스트)]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/Unit-Test단위-테스트/</link><guid isPermaLink="false">https://sharknia.github.io/Unit-Test단위-테스트/</guid><pubDate>Tue, 17 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;단위 테스트는 소프트웨어 개발의 기본 구성 단위를 테스트하는 것을 말한다. 이 경우 기본 구성 단위는 보통 함수나 메소드, 작은 클래스 등이 될 수 있다. 단위 테스트의 주된 목적은 개별 구성 단위가 예상대로 동작하는지 확인하고, 코드의 특정 부분에 대한 논리적 오류를 식별하는 것이다. &lt;/p&gt;
&lt;h3&gt;특징과 목적&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;독립성 : 각 단위 테스트는 독립적으로 실행되어야 하며, 다른 테스트의 결과에 영향을 받지 않아야 한다. &lt;/li&gt;
&lt;li&gt;작고 빠름 : 단위 테스트는 빠르게 실행되어야 하며, 코드의 작은 부분만을 테스트해야 한다. &lt;/li&gt;
&lt;li&gt;예측 가능함 : 동일한 입력에 대해 항상 동일한 출력을 반환해야 한다. &lt;/li&gt;
&lt;li&gt;자동화 가능 : 단위 테스트는 자동으로 실행되어야 하며 수동 테스트 없이도 결과를 제공해야 한다. &lt;/li&gt;
&lt;li&gt;명확함 : 테스트의 결과는 명확하게 통과 또는 실패로 나타나야 하며 이유를 쉽게 파악할 수 있어야 한다. &lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[__post_init__]]></title><description><![CDATA[메소드는 Python…]]></description><link>https://sharknia.github.io/__post_init__/</link><guid isPermaLink="false">https://sharknia.github.io/__post_init__/</guid><pubDate>Tue, 17 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드는 Python의 &lt;code class=&quot;language-text&quot;&gt;dataclasses&lt;/code&gt; 모듈에 있는 &lt;code class=&quot;language-text&quot;&gt;dataclass&lt;/code&gt; 데코레이터를 사용하여 클래스를 정의할 때 사용된다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드는 객체가 초기화된 직후에 자동으로 호출된다. 즉, &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드가 호출된 후에 &lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드가 호출된다.&lt;/p&gt;
&lt;p&gt;클래스의 인스턴스가 생성될 때 &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드가 호출되어 인스턴스 변수들을 초기화하고, 바로 이어서 &lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드가 호출되어 추가적인 초기화 작업을 수행할 수 있다. 이러한 방식으로, 객체의 초기화 과정 중에 추가적인 로직을 실행할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;dto &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ContentListQueryDto&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ContentListQueryDto&lt;/code&gt; 클래스의 인스턴스를 생성하면서 &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드가 자동으로 호출되고, 이어서 &lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드도 자동으로 호출된다. &lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드는 &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드가 완료된 직후에 실행되므로, &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드에서 설정된 필드 값을 기반으로 추가적인 초기화 작업을 수행할 수 있다.&lt;/p&gt;
&lt;p&gt;이 경우에, &lt;code class=&quot;language-text&quot;&gt;dto = ContentListQueryDto(**payload)&lt;/code&gt; 코드를 실행하면 &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 메소드가 호출되어 &lt;code class=&quot;language-text&quot;&gt;payload&lt;/code&gt; 딕셔너리의 키-값 쌍을 이용하여 인스턴스 변수들을 초기화하고, 이어서 &lt;code class=&quot;language-text&quot;&gt;__post_init__&lt;/code&gt; 메소드가 호출되어 해당 메소드에 정의된 작업들을 수행한다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[dataclass]]></title><description><![CDATA[dataclass는 [파이썬]3.…]]></description><link>https://sharknia.github.io/dataclass/</link><guid isPermaLink="false">https://sharknia.github.io/dataclass/</guid><pubDate>Tue, 17 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;dataclass는 [[파이썬]]3.7부터 표준 라이브러리의 일부로 도입된 데코레이터이다.
주로 클래스를 정의할 때 반복적으로 필요한 특수 메서드들(&lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;__repr__&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;__eq__&lt;/code&gt; 등)을 자동으로 생성해주는 역할을 한다. 이를 통해 데이터를 저장하고 처리하는 클래스를 보다 간결하게 정의할 수 있다.&lt;/p&gt;
&lt;h2&gt;주요 특징&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;자동 생성된 생성자&lt;/li&gt;
&lt;li&gt;자동 생성된 표현 메서드&lt;/li&gt;
&lt;li&gt;자동 생성된 비교 메서드&lt;/li&gt;
&lt;li&gt;불변성 옵션&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;예제&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;
    y&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드는 아래의 코드를 간결하게 표현한 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; y

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Point(x=&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;, y=&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&quot;&lt;/span&gt;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;other&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Point&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; NotImplemented
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;dataclass는 데이터 구조나 간단한 객체를 정의할 때 유용하게 사용된다. 그러나 복잡한 로직이나 특별한 초기화가 필요한 경우에는 일반 클래스를 사용하는 것이 더 나을 수 있다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[브랜치 관리 전략]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/브랜치-관리-전략/</link><guid isPermaLink="false">https://sharknia.github.io/브랜치-관리-전략/</guid><pubDate>Mon, 16 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;개요&lt;/h3&gt;
&lt;p&gt;브랜치 관리 전략은 소프트웨어 개발에서 코드 베이스의 다양한 변경 사항을 조직하고 관리하기 위한 방법이나 원칙이다. 특히 버전관리 시스템을 사용하는 프로젝트에서 브랜치를 효과적으로 활용하면 여러 개발자나 팀이 동시에 다양한 기능, 버그 수정, 실험 등을 독립적으로 처리할 수 있다. &lt;/p&gt;
&lt;h3&gt;목적&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;코드의 안정성 유지&lt;/li&gt;
&lt;li&gt;여러 개발자나 팀 간의 협업 촉진&lt;/li&gt;
&lt;li&gt;배포와 통합을 위한 과정 단순화&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;대표적인 전략&lt;/h3&gt;
&lt;h4&gt;Feature branching&lt;/h4&gt;
&lt;p&gt;각 기능마다 별도의 브랜치를 만들어 개발한다. 기능이 완성되면 메인 브랜치에 병합한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;장점&lt;/p&gt;
&lt;p&gt;각 기능이 독립적으로 개발되므로 다양한 기능과 버그 수정을 동시에 진행할 수 있다. &lt;/p&gt;
&lt;p&gt;충돌이 발생할 경우 해당 기능의 브랜치에서만 처리하면 되므로 메인 브랜치는 상대적으로 안정적이다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단점&lt;/p&gt;
&lt;p&gt;병합 시점에 복잡한 병합 충돌이 발생할 수 있다. &lt;/p&gt;
&lt;p&gt;오랜 시간 분리된 브랜치에서 작업할 경우 메인 브랜치와의 동기화가 어려워질 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;적합한 상황&lt;/p&gt;
&lt;p&gt;개발자들이 독립적으로, 혹은 소규모 팀으로 작업을 진행하는 경우&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Gitflow&lt;/h4&gt;
&lt;p&gt;master, develop, feture/, hotfix/ 등 여러 브랜치를 사용하여 작업의 단계와 종류를 구분한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;장점&lt;/p&gt;
&lt;p&gt;명확한 브랜치 구조를 가지고 있어 프로젝트의 다양한 단계와 상태를 잘 구분한다. &lt;/p&gt;
&lt;p&gt;핫픽스와 기능 개발을 동시에 진행할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단점&lt;/p&gt;
&lt;p&gt;브랜치 관리가 복잡하다. &lt;/p&gt;
&lt;p&gt;많은 규칙과 워크 플로우를 따라야 하므로 초보자에게는 진입 장벽이 될 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;적합한 상황&lt;/p&gt;
&lt;p&gt;큰 규모의 프로젝트나, 여러 단계의 배포 과정을 가진 프로젝트에서 사용&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Github flow&lt;/h4&gt;
&lt;p&gt;간단하게 master와 feature 브랜치만을 사용한다. 기능이 준비되면 master에 PR을 통해 병합 요청한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;장점&lt;/p&gt;
&lt;p&gt;브랜치 관리가 간단하다. &lt;/p&gt;
&lt;p&gt;지속적인 통합 및 배포 환경에 적합하다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단점&lt;/p&gt;
&lt;p&gt;복잡한 프로젝트에서는 세부적인 브랜치 구분이 부족할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;적합한 상황&lt;/p&gt;
&lt;p&gt;중소 규모의 프로젝트나 간단한 배포 과정을 가진 프로젝트에서 사용&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Trunk Based Deveolpment(TBD)&lt;/h4&gt;
&lt;p&gt;모든 개발자가 하나의 trunk 혹은 main 브랜치에서 직접 작업한다. 기능 토글등을 활용하여 미완성 기능을 숨긴다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;장점&lt;/p&gt;
&lt;p&gt;브랜치 관리가 매우 간단하다. &lt;/p&gt;
&lt;p&gt;지속적인 통합 및 배포 환경에 최적화되어 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단점&lt;/p&gt;
&lt;p&gt;안정적인 CI/CD 파이프라인 및 테스트 환경이 필요하다. &lt;/p&gt;
&lt;p&gt;기능 토글 등 추가적인 관리 도두가 필요할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;적합한 상황&lt;/p&gt;
&lt;p&gt;빠른 개발 주기와 지속적인 배포를 원하는 프로젝트에서 사용&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[TypeError: non-default argument 'content' follows default argument]]></title><description><![CDATA[이 오류는 Python…]]></description><link>https://sharknia.github.io/TypeError-non-default-argument-content-follows-default-argument/</link><guid isPermaLink="false">https://sharknia.github.io/TypeError-non-default-argument-content-follows-default-argument/</guid><pubDate>Tue, 10 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;TypeError: non-default argument &apos;content&apos; follows default argument&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;이 오류는 Python 클래스 또는 함수에서 기본값이 설정된 인자 뒤에 기본값이 설정되지 않은 인자가 위치할 때 발생한다. 예를 들어, 나는 다음과 같았다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CsDetailQueryReturnDto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    occurrence_datetime&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    cs_type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CsType
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;occurrence_datetime&lt;/code&gt; 필드에 기본값 &lt;code class=&quot;language-text&quot;&gt;None&lt;/code&gt;이 설정되어 있고, 이 필드 뒤에 기본값이 설정되지 않은 &lt;code class=&quot;language-text&quot;&gt;content&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;cs_type&lt;/code&gt; 필드가 위치하고 있다.&lt;/p&gt;
&lt;h3&gt;해결 방법&lt;/h3&gt;
&lt;p&gt;이 문제가 발생한 이유는 기본값이 설정된 매개변수 뒤에 기본값이 설정되지 않은 매개변수가 올 수 없다는 규칙 때문이다. &lt;/p&gt;
&lt;p&gt;함수를 호출할 때, Python은 매개변수를 위치나 키워드로 판별할 수 있어야 한다. 만약 기본값이 없는 매개변수가 기본값이 있는 매개변수 뒤에 온다면, Python은 어떤 매개변수에 값을 할당해야 하는지 혼동할 수 있다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Dynamo DB]]></title><description><![CDATA[1. 정의 AWS에서 제공하는 완전 관리형 NoSQL 데이터베이스 서비스이다. 높은 트래픽의 웹 스케일 애플리케이션에 적합한 특성을 가지며, 밀리초 단위의 지연 시간으로 대량의 데이터를 처리할 수 있다.
확장 가능하고 높은 성능의 NoSQL…]]></description><link>https://sharknia.github.io/Dynamo-DB/</link><guid isPermaLink="false">https://sharknia.github.io/Dynamo-DB/</guid><pubDate>Wed, 20 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;1. 정의&lt;/h2&gt;
&lt;p&gt;AWS에서 제공하는 완전 관리형 NoSQL 데이터베이스 서비스이다. 높은 트래픽의 웹 스케일 애플리케이션에 적합한 특성을 가지며, 밀리초 단위의 지연 시간으로 대량의 데이터를 처리할 수 있다.
확장 가능하고 높은 성능의 NoSQL 데이터베이스로 다양한 웹 기반 애플리케이션과 서비스에서 데이터 관리를 위한 핵심 선택지이다. AWS의 다른 서비스와 통합이 잘 되어 있어 복잡한 애플리케이션 구축에 적합하다.&lt;/p&gt;
&lt;h2&gt;2. 주요 특징&lt;/h2&gt;
&lt;h3&gt;성능&lt;/h3&gt;
&lt;p&gt;밀리초 미만의 응답 시간을 제공한다.&lt;/p&gt;
&lt;h3&gt;확장성&lt;/h3&gt;
&lt;p&gt;사용자의 요구에 따라 자동으로 확장 및 축소 된다.&lt;/p&gt;
&lt;h3&gt;내구성 및 가용성&lt;/h3&gt;
&lt;p&gt;자동으로 여러 AWS 리전 및 가용 영역에 데이터를 복제하여 데이터 손실과 서비스 중단 없이 운영된다.&lt;/p&gt;
&lt;h3&gt;완전관리형&lt;/h3&gt;
&lt;p&gt;서버 인프라스트럭쳐 또는 관리 작업 없이 실행된다.&lt;/p&gt;
&lt;h3&gt;이벤트 소싱&lt;/h3&gt;
&lt;p&gt;DynamoDB Streams를 통해 테이블의 데이터 변경을 캡쳐할 수 있다.&lt;/p&gt;
&lt;h3&gt;글로벌 테이블&lt;/h3&gt;
&lt;p&gt;여러 AWS 리전에서 동일한 테이블에 액세스 할 수 있다.&lt;/p&gt;
&lt;h3&gt;3. 데이터 모델&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;테이블 : 데이터의 컬렉션. RDBMS와 유사하지만 스키마가 고정되어있지 않다.&lt;/li&gt;
&lt;li&gt;항목 : 테이블 내의 개별 데이터 항목. RDBMS의 Row와 유사하다.&lt;/li&gt;
&lt;li&gt;속성 : 항목의 데이터 요소. RDBMS의 칼럼과 유사하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4. 주요 기능&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;초당 읽기/쓰기 용량 조절 : 요구에 따라 자동으로 조정된다.&lt;/li&gt;
&lt;li&gt;보조 인덱스 : 다양한 쿼리 옵션을 제공한다.&lt;/li&gt;
&lt;li&gt;트랜잭션 : 여러 항목 및 테이블에 걸친 ACID 트랜잭션을 지원한다.&lt;/li&gt;
&lt;li&gt;보안 : IAM을 통해 데이터 액세스 및 암호화를 제어한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5. 사용 사례&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;웹 애플리케이션 : 세션 데이터, 사용자 프로필, 소셜 그래프 등의 저장&lt;/li&gt;
&lt;li&gt;모바일 애플리케이션 : 빠른 액세스와 확장성이 필요한 데이터를 저장&lt;/li&gt;
&lt;li&gt;IoT 애플리케이션 : 대량의 장치 데이터를 실시간으로 수집 및 분석&lt;/li&gt;
&lt;li&gt;게임 : 게임 상태, 플레이어 프로필, 리더보드 등을 저장&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[NoSQL]]></title><description><![CDATA[1. 등장 배경 RDBMS는 정해진 스키마와 트랜잭션의 ACID 속성을 기반으로 설계되었다. 하지만 웹 2.0 시대가 도래하면서 대용량 데이터와 급격한 트래픽 증가, 다양한 데이터 구조의 요구가 생기면서 RDBMS의 한계가 드러나 NoSQL…]]></description><link>https://sharknia.github.io/NoSQL/</link><guid isPermaLink="false">https://sharknia.github.io/NoSQL/</guid><pubDate>Wed, 20 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;1. 등장 배경&lt;/h2&gt;
&lt;p&gt;RDBMS는 정해진 스키마와 트랜잭션의 ACID 속성을 기반으로 설계되었다. 하지만 웹 2.0 시대가 도래하면서 대용량 데이터와 급격한 트래픽 증가, 다양한 데이터 구조의 요구가 생기면서 RDBMS의 한계가 드러나 NoSQL이 등장하게 되었다.&lt;/p&gt;
&lt;h2&gt;2. RDBMS와의 주요 차이점&lt;/h2&gt;
&lt;h3&gt;스키마&lt;/h3&gt;
&lt;p&gt;RDBMS는 고정된 스키마를 가지고 있으나, NoSQL은 동적 스키마를 가진다.&lt;/p&gt;
&lt;h3&gt;확장성&lt;/h3&gt;
&lt;p&gt;RDBMS는 수직 확장을 위해 설계 되었지만 NoSQL은 수평 확장이 가능하다.&lt;/p&gt;
&lt;h3&gt;데이터 모델&lt;/h3&gt;
&lt;p&gt;RDBMS는 테이블 기반의 데이터 모델을 사용하지만 NoSQL은 키-값, 문서, 컬럼, 그래프 등 다양한 데이터 모델을 사용한다.&lt;/p&gt;
&lt;h3&gt;트랜잭션&lt;/h3&gt;
&lt;p&gt;RDMBS는 ACID 트랜잭션을 지원하지만 NoSQL은 일반적으로 이를 지원하지 않거나 부분적으로 지원한다.&lt;/p&gt;
&lt;h2&gt;3. NoSQL의 일관성과 무결성&lt;/h2&gt;
&lt;h3&gt;일관성(Consistency)&lt;/h3&gt;
&lt;p&gt;RDBMS에서는 ACID 트랜잭션 속성을 지원하여 강력한 일관성을 보장한다.
반면, 많은 NoSQL 데이터베이스는 BASE 모델을 채용한다. 이는 즉각적인 일관성보다는 가용성과 복원력을 우선시하며 일시적인 불일관성을 허용하지만 결국 일관된 상태로 수렴한다는 의미이다.
일부 NoSQL 시스템은 일관성 수준을 조정할 수 있도록 설정할 수 있다.&lt;/p&gt;
&lt;h3&gt;무결성(Intergirty)&lt;/h3&gt;
&lt;p&gt;RDBMS는 외래 키 제약 조건, 유니크 제약 조건 등을 통해 데이터 무결성을 보장한다.
NoSQL 데이터베이스는 스키마가 유연하므로 같은 강도의 무결성 제약 조건을 갖지 않을 수 있다. 그러나 일부 NoSQL 시스템은 도큐먼트의 유효성 검사나 스키마 유효성 검사를 지원하여 무결성을 일정 수준 보장하기도 한다.&lt;/p&gt;
&lt;h3&gt;정리&lt;/h3&gt;
&lt;p&gt;NoSQL 데이터베이스는 일관성과 무결성을 &quot;없애는&quot; 것이 아니라 다양한 요구 사항과 환경에 맞게 그 특성과 규칙을 조정하고 최적화 한 것이다. 따라서 특정 응용 프로그램의 요구 사항에 따라 적절한 데이터베이스와 설정을 선택하는 것이 중요하다.&lt;/p&gt;
&lt;h2&gt;4. 주요 특징 및 장점&lt;/h2&gt;
&lt;h3&gt;유연성&lt;/h3&gt;
&lt;p&gt;다양한 데이터 및 동적 스키마를 지원함으로써 다양한 데이터 구조에 유연하게 대응할 수 있다.&lt;/p&gt;
&lt;h3&gt;확장성&lt;/h3&gt;
&lt;p&gt;수평 확장을 통해 대량의 데이터와 트래픽을 처리할 수 있다. NoSQL은 데이터를 여러 노드에 복제하거나 분할하는 매커니즘을 내장하고 있다. 이는 고가용성과 분산 처리를 위한 핵심 요소로 수평 확장을 자연스럽게 지원한다.&lt;/p&gt;
&lt;h3&gt;빠른 성능&lt;/h3&gt;
&lt;p&gt;간단한 쿼리와 특정 작업에 최적화된 데이터베이스 설계로 빠른 성능을 제공한다.&lt;/p&gt;
&lt;h3&gt;다양한 데이터 처리&lt;/h3&gt;
&lt;p&gt;구조화, 반구조화, 비구조화 데이터를 모두 처리할 수 있다.&lt;/p&gt;
&lt;h2&gt;5. 단점&lt;/h2&gt;
&lt;h3&gt;표준 부재&lt;/h3&gt;
&lt;p&gt;다양한 NoSQL 데이터베이스 중 특정 표준이 없어 학습 곡선이 높을 수 있다.&lt;/p&gt;
&lt;h3&gt;일관성&lt;/h3&gt;
&lt;p&gt;ACID 트랜잭션의 일부를 희생하므로 데이터 일관성 문제가 발생할 수 있다.&lt;/p&gt;
&lt;h2&gt;6. NoSQL이 필요한 경우&lt;/h2&gt;
&lt;h3&gt;빠른 개발&lt;/h3&gt;
&lt;p&gt;동적 스키마로 개발과 변화에 빠르게 대응할 수 있다.&lt;/p&gt;
&lt;h3&gt;대량의 데이터 처리&lt;/h3&gt;
&lt;p&gt;수평 확장을 통해 대량의 데이터를 처리하는데 적합하다.&lt;/p&gt;
&lt;h3&gt;다양한 데이터 구조&lt;/h3&gt;
&lt;p&gt;구조화 된 데이터 뿐 아니라 로그, 소셜 미디어 포스트 등 다양한 데이터를 저장하고 처리할 때 유용하다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[REST]]></title><description><![CDATA[1. 정의 REST는 웹서비스를 설계하기 위한 아키텍쳐 스타일이다. 웹의 기본 프로토콜인 HTTP를 최대한 활용하기 위한 일련의 제약사항 및 원칙을 포함한다. 2. 기본 원칙 Stateless…]]></description><link>https://sharknia.github.io/REST/</link><guid isPermaLink="false">https://sharknia.github.io/REST/</guid><pubDate>Wed, 20 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;1. 정의&lt;/h2&gt;
&lt;p&gt;REST는 웹서비스를 설계하기 위한 아키텍쳐 스타일이다. 웹의 기본 프로토콜인 HTTP를 최대한 활용하기 위한 일련의 제약사항 및 원칙을 포함한다.&lt;/p&gt;
&lt;h2&gt;2. 기본 원칙&lt;/h2&gt;
&lt;h3&gt;Stateless&lt;/h3&gt;
&lt;p&gt;각 요청은 모든 정보를 가지고 있어야 한다. 즉, 서버는 클라이언트의 상태 정보를 저장하면 안된다.&lt;/p&gt;
&lt;h3&gt;클라이언트-서버 구조&lt;/h3&gt;
&lt;p&gt;클라이언트와 서버가 별도로 존재하고 각각의 역할이 분리되어 있어야 한다.&lt;/p&gt;
&lt;h3&gt;캐시 가능&lt;/h3&gt;
&lt;p&gt;클라이언트에서 캐시를 사용할 수 있어야 하며, 응답이 캐시 가능한지 아닌지를 명시해야 한다.&lt;/p&gt;
&lt;h3&gt;계층화된 시스템 (Layered System)&lt;/h3&gt;
&lt;p&gt;클라이언트는 중간 계층(서버)을 알 필요 없이, 끝단 서버에만 접속하면 된다.&lt;/p&gt;
&lt;h3&gt;코드 온 디맨드 (optional)&lt;/h3&gt;
&lt;p&gt;서버는 코드를 클라이언트에게 보낼 수 있으며, 클라이언트는 그 코드를 실행할 수 있다.&lt;/p&gt;
&lt;h3&gt;인터페이스 일관성 (Uniform Interface)&lt;/h3&gt;
&lt;p&gt;아키텍쳐의 규칙을 정의하며, 이를 통해 시스템의 분리와 통합이 용이해진다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;자원의 식별 : 각 리소스는 URI로 식별되어야 한다.&lt;/li&gt;
&lt;li&gt;메시지를 통한 자원 조작 : 리소스는 HTTP Method를 통해 조작된다.&lt;/li&gt;
&lt;li&gt;자기 설명적 메시지(Self-descriptive message): 각 메시지는 자신을 어떻게 처리해야 하는지에 대한 충분한 정보를 포함해야 한다.&lt;/li&gt;
&lt;li&gt;HATEOAS(Hypermedia as the Engine of Application State): 응답에 다음 가능한 액션에 대한 정보도 포함되어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;3. HTTP 메서드&lt;/h2&gt;
&lt;h3&gt;GET&lt;/h3&gt;
&lt;p&gt;리소스를 조회하는데 사용된다.&lt;/p&gt;
&lt;h3&gt;POST&lt;/h3&gt;
&lt;p&gt;리소스를 생성한다.&lt;/p&gt;
&lt;h3&gt;PUT&lt;/h3&gt;
&lt;p&gt;리소스를 수정한다.&lt;/p&gt;
&lt;h3&gt;DELETE&lt;/h3&gt;
&lt;p&gt;리소스를 삭제한다.&lt;/p&gt;
&lt;h3&gt;PATCH&lt;/h3&gt;
&lt;p&gt;리소스의 일부를 수정한다.&lt;/p&gt;
&lt;h2&gt;4. 상태코드 (Status Code)&lt;/h2&gt;
&lt;h3&gt;2xx (Successful)&lt;/h3&gt;
&lt;p&gt;요청이 성공적으로 수행됨&lt;/p&gt;
&lt;h3&gt;3xx (Redirection)&lt;/h3&gt;
&lt;p&gt;요청을 완료하기 위해 추가 동작이 필요함&lt;/p&gt;
&lt;h3&gt;4xx (Client Error)&lt;/h3&gt;
&lt;p&gt;클라이언트의 잘못된 요청으로 인한 오류&lt;/p&gt;
&lt;h3&gt;5xx (Server Error)&lt;/h3&gt;
&lt;p&gt;서버 오류&lt;/p&gt;
&lt;h2&gt;5. URI 설계&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;리소스를 명시하며, 명사를 사용해야 한다. (ex) &lt;code class=&quot;language-text&quot;&gt;/users&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;/products&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;리소스의 계층 관계를 나타날 때는 &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt;를 사용한다. (ex) &lt;code class=&quot;language-text&quot;&gt;/users/123/orders&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;6. 미디어 타입&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;JSON, XML등 다양한 미디어 타입을 사용하여 데이터를 표현한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Accept&lt;/code&gt; 헤더를 통해 클라이언트가 원하는 미디어 타입을 서버에게 알릴 수 있다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[AWS API Gateway]]></title><description><![CDATA[AWS API Gateway는 개발자가 간편하게 RESTful API와 WebSocket API를 생성, 배포, 유지 관리 할 수 있도록 지원하는 AWS의 완전 관리형 서비스이다. 클라이언트와 백엔드 서비스 간의 호출을 중개한다.…]]></description><link>https://sharknia.github.io/AWS-API-Gateway/</link><guid isPermaLink="false">https://sharknia.github.io/AWS-API-Gateway/</guid><pubDate>Tue, 19 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;AWS API Gateway는 개발자가 간편하게 RESTful API와 WebSocket API를 생성, 배포, 유지 관리 할 수 있도록 지원하는 AWS의 완전 관리형 서비스이다. 클라이언트와 백엔드 서비스 간의 호출을 중개한다.&lt;/p&gt;
&lt;h2&gt;1. 주요 기능&lt;/h2&gt;
&lt;h3&gt;API 생성 및 배포&lt;/h3&gt;
&lt;p&gt;빠르게 API를 생성하고 배포할 수 있다.&lt;/p&gt;
&lt;h3&gt;호출 중개&lt;/h3&gt;
&lt;p&gt;클라이언트와 백엔드 서비스 간의 호출을 중개한다.&lt;/p&gt;
&lt;h3&gt;요청 및 응답 변환&lt;/h3&gt;
&lt;p&gt;데이터 매핑 템플릿을 사용하여 호출 중 요청 및 응답 데이터를 변환할 수 있다.&lt;/p&gt;
&lt;h3&gt;액세스 제어&lt;/h3&gt;
&lt;p&gt;AWS Identity and Access Management (IAM) 또는 AWS Lambda 권한 기반 접근 제어를 사용하여 API 호출을 보호할 수 있다.&lt;/p&gt;
&lt;h3&gt;API 키 및 요금 제한&lt;/h3&gt;
&lt;p&gt;API키를 생성하고 배포하고 사용량을 추적하여 API 호출에 요금을 부과할 수 있다.&lt;/p&gt;
&lt;h3&gt;API 캐싱&lt;/h3&gt;
&lt;p&gt;API 호출의 성능을 향상시키기 위해 캐시를 사용할 수 있다.&lt;/p&gt;
&lt;h3&gt;API 버전 관리&lt;/h3&gt;
&lt;p&gt;API의 다양한 버전 및 스테이지를 관리할 수 있다.&lt;/p&gt;
&lt;h2&gt;2. 통합&lt;/h2&gt;
&lt;h3&gt;AWS 서비스 통합&lt;/h3&gt;
&lt;p&gt;AWS Lambda, Dynamo DB, Amazone S3등의 AWS 서비스와 손쉽게 통합할 수 있다.&lt;/p&gt;
&lt;h3&gt;모니터 및 로깅&lt;/h3&gt;
&lt;p&gt;Amazone CloudWatch와 통합하여 API 호출 및 오류 데이터를 모니터링 및 로깅할 수 있다.&lt;/p&gt;
&lt;h2&gt;3. 보안&lt;/h2&gt;
&lt;h3&gt;SSL/TLS 인증서&lt;/h3&gt;
&lt;p&gt;커스텀 도메인 이름에 대한 SSL/TLS 인증서를 제공하고 관리한다.&lt;/p&gt;
&lt;h3&gt;사용자 인증 및 인가&lt;/h3&gt;
&lt;p&gt;Amazone Cognito와 통합하여 사용자 인증 및 인가를 수행할 수 있다. 또한, OAuth토큰을 사용하여 API 엑세스를 제어할 수 있다.&lt;/p&gt;
&lt;h2&gt;4. 비용&lt;/h2&gt;
&lt;p&gt;사용한 만큼의 비용만 지불한다. 요청 수 및 데이터 전송량에 따라 비용이 발생한다.&lt;/p&gt;
&lt;h2&gt;5. 사용 사례&lt;/h2&gt;
&lt;h3&gt;Serverless&lt;/h3&gt;
&lt;p&gt;AWS Lambda와 결합하여 서버리스 애플레키션의 백엔드를 구축할 수 있다.&lt;/p&gt;
&lt;h3&gt;모바일 및 웹 애플리케이션&lt;/h3&gt;
&lt;p&gt;다양한 클라이언트에서 사용될 RESTful API를 제공한다.&lt;/p&gt;
&lt;h3&gt;웹사이트의 서드파티 애플리케이션 통합&lt;/h3&gt;
&lt;p&gt;다른 웹 서비스나 데이터 소스와의 통합을 위한 API를 제공한다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ColdStart]]></title><description><![CDATA[먼저 ColdStart를 이해하기 위해서는 Serverless의 동작방식을 이해할 필요가 있다. 간단히 알아보자.
Serverless 컴퓨팅에서 사용자의 요청이 오면 해당 요청을 처리하는 함수(Function…]]></description><link>https://sharknia.github.io/ColdStart/</link><guid isPermaLink="false">https://sharknia.github.io/ColdStart/</guid><pubDate>Tue, 19 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;먼저&lt;/h2&gt;
&lt;p&gt;ColdStart를 이해하기 위해서는 Serverless의 동작방식을 이해할 필요가 있다. 간단히 알아보자.
Serverless 컴퓨팅에서 사용자의 요청이 오면 해당 요청을 처리하는 함수(Function)가 실행된다. 이 함수는 이벤트에 응답하여 실행되는데, 이 함수는 항상 실행 상태를 유지하고 있지 않다. 대신에 요청이 들어오면 새롭게 시작되거나 재사용된다.&lt;/p&gt;
&lt;p&gt;이제 콜드 스타트의 개념에 대해서 알아볼 수 있다.&lt;/p&gt;
&lt;h2&gt;콜드 스타트와 웜 스타트&lt;/h2&gt;
&lt;h3&gt;콜드 스타트&lt;/h3&gt;
&lt;p&gt;함수가 처음 호출될 때, 아직 사용 가능한 인스턴스가 없거나 지나치게 오래된 인스턴스에 대한 요청이 들어왔을 때 함수 인스턴스가 새롭게 생성된다. 이런 상태에서 함수가 실행될 때를 &apos;콜드 스타트&apos; 라고 한다.
콜드 스타트는 초기화에 필요한 시간과 리소스를 요구하기 때문에 함수의 실행 시작까지의 대기 시간이 길어질 수 있다. 이로 인한 지연은 사용자 경험에 영향을 줄 수 있다.&lt;/p&gt;
&lt;h3&gt;웜 스타트&lt;/h3&gt;
&lt;p&gt;이미 실행된 함수 인스턴스가 재사용될 때 발생한다. 초기화 시간이 필요 없기 때문에 대기 시간이 짧다.&lt;/p&gt;
&lt;h2&gt;지연 최소화를 위한 전략&lt;/h2&gt;
&lt;h3&gt;최적의 함수 크기 할당&lt;/h3&gt;
&lt;p&gt;메모리와 CPU를 적절히 할당하여 함수의 시작 시간을 줄일 수 있다.&lt;/p&gt;
&lt;h3&gt;초기화 코드 최적화&lt;/h3&gt;
&lt;p&gt;함수 내에서 필요한 라이브러리나 자원을 로드하는 초기화 코드를 최적화 하여 실행 시간을 줄인다.&lt;/p&gt;
&lt;h3&gt;외부 연결 최소화&lt;/h3&gt;
&lt;p&gt;외부 시스템이나 데이터베이스에 대한 연결을 미리 확립하거나 재사용하는 방식을 고려한다.&lt;/p&gt;
&lt;h3&gt;함수 미리 실행&lt;/h3&gt;
&lt;p&gt;일정 주리고 함수를 호출하여 웜 상태를 유지한다.&lt;/p&gt;
&lt;p&gt;서버리스 제공 업체에 따라 콜드 스타트의 영향도와 대응 전략이 다를 수 있다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Serverless]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/Serverless/</link><guid isPermaLink="false">https://sharknia.github.io/Serverless/</guid><pubDate>Tue, 19 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;서버가 &quot;없는&quot; 것이 아니다.
서버리스는 개발자 또는 운영 팀이 서버의 운영, 관리, 확장 등에 대한 걱정 없이 어플리케이션 코드에만 집중할 수 있게 해주는 컴퓨팅 모델을 의미한다.&lt;/p&gt;
&lt;h2&gt;특징&lt;/h2&gt;
&lt;h3&gt;자동확장&lt;/h3&gt;
&lt;p&gt;사용량에 따라 자동으로 리소스를 확장하거나 축소한다. 따라서 트래픽이 급증하더라도 시스템이 알아서 처리한다.&lt;/p&gt;
&lt;h3&gt;이벤트 주도&lt;/h3&gt;
&lt;p&gt;대부분의 서버리스 어플리케이션은 이벤트에 응답하여 동작한다.&lt;/p&gt;
&lt;h3&gt;비용 효율&lt;/h3&gt;
&lt;p&gt;실제로 사용된 컴퓨팅 리소스만큼만 비용을 지불한다. 즉, 코드가 실행되지 않을 때에는 비용이 발생하지 않는다.&lt;/p&gt;
&lt;h3&gt;서버 관리 불필요&lt;/h3&gt;
&lt;p&gt;인프라의 설정, 관리, 유지보수와 같은 작업들이 서버리스 플랫폼 제공업체에 의해 자동으로 처리된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;대표적인 서버리스 서비스로는 AWS Lambda, Google Cloud Function, Azure Function 등이 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;단점&lt;/h2&gt;
&lt;h3&gt;ColdStart 문제&lt;/h3&gt;
&lt;h3&gt;실행 시간 제한&lt;/h3&gt;
&lt;p&gt;대부분의 서버리스 플랫폼은 함수의 최대 실행 시간에 제한을 두고 있다.&lt;/p&gt;
&lt;h3&gt;상태 관리&lt;/h3&gt;
&lt;p&gt;서버리스 함수는 상태가 없기 때문에 외부 저장소나 캐싱 시스템을 통해 상태를 관리해야 한다.&lt;/p&gt;
&lt;h3&gt;종속성 및 복잡성&lt;/h3&gt;
&lt;p&gt;여러 서버리스 컴포넌트와 서비스의 상호작용은 의존성과 복잡성을 증가시킬 수 있다.&lt;/p&gt;
&lt;h3&gt;보안 및 권한 관리&lt;/h3&gt;
&lt;p&gt;특히 여러 서비스와 컴포넌트가 연동되는 환경에서 권한 설정과 보안 관리가 복잡해질 수 있다.&lt;/p&gt;
&lt;h3&gt;로컬 개발 환경 설정 어려움&lt;/h3&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅(2)]]></title><description><![CDATA[지난 시간 지난시간에는 DataBase를 불러오는 비동기 로직 때문에 Factory Method를 사용해서 노션의 DataBase…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅2/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅2/</guid><pubDate>Mon, 04 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;지난 시간&lt;/h2&gt;
&lt;p&gt;지난시간에는 DataBase를 불러오는 비동기 로직 때문에 Factory Method를 사용해서 노션의 DataBase를 불러오는 코드를 작성했다. &lt;/p&gt;
&lt;p&gt;기능만 점검 후, 전체적인 설계를 다시 하고 프로젝트의 디렉토리 구조도 다시 짰다. &lt;/p&gt;
&lt;h2&gt;새로운 설계&lt;/h2&gt;
&lt;p&gt;일단, 크게 네 가지의 클래스를 만들기로 했다. &lt;/p&gt;
&lt;h3&gt;DataBase 클래스&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;생성시에 날짜를 입력 받아 파라미터마다 다른 조건으로 쿼리 하여 노션 API에서 결과값을 받아오는 필터링 기능을 가진다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Page 클래스&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Page 타입의 Block이다. &lt;/li&gt;
&lt;li&gt;해당 페이지를 마크다운으로 저장(Print)하는 메소드를 가지고 있다. &lt;/li&gt;
&lt;li&gt;Property들을 가지고 있다. (페이지의 속성)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Content 클래스&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Page에 귀속된다. &lt;/li&gt;
&lt;li&gt;종류가 여러가지이다. h1, h2, h3.. 등등 직접적으로 포스팅의 내용이 될 블록이다.&lt;/li&gt;
&lt;li&gt;가장 상위의 Content는 부모가 Page이다. &lt;/li&gt;
&lt;li&gt;자기 자신을 마크다운으로 변환하여 부모에게 리턴하는 method를 가지고 있다. 만약 child가 있다면, 해당 child도 함께 변환하여 부모에게 리턴한다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;일단 기본적으로 다음의 속성을 가진다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;id&lt;/strong&gt; : idx&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;parent&lt;/strong&gt; : 부모 ID&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hasChidren&lt;/strong&gt; : 자식 요소가 있는지 여부 (true, false)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;type&lt;/strong&gt; : &lt;code class=&quot;language-text&quot;&gt;heading_1&lt;/code&gt; 등등 블록의 종류. 종류마다 마크다운 변환 전략이 달라야 하므로 중요하다. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;is_toggleable&lt;/strong&gt; : **** 토글 여부&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Posting 클래스&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;생성자에 날짜를 넣어서 생성하면 해당하는 DataBase를 조회하고, Page → Content 를 돌면서 마크다운으로 페이지를 변환하여 저장하는 클래스들의 메소드를 모두 여기서 실행한다. 메인함수 같은 개념이다. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;위 내용은 언제든지 달라질 수 있다. 실제로 매일매일 하루하루 숨 쉬듯이 달라지고 있다. &lt;/p&gt;
&lt;h2&gt;디렉토리 구조&lt;/h2&gt;
&lt;p&gt;src/models 디렉토리를 새로 만들고 여기에 모든 클래스, 비즈니스 로직을 넣기로 했다. &lt;/p&gt;
&lt;h2&gt;database.ts&lt;/h2&gt;
&lt;p&gt;일단 이번에는 database.ts를 1차적으로 완성했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; QueryDatabaseResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client/build/src/api-endpoints&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; dotenv &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dotenv&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataBase&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; databaseId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; database&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; pageIds&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; databaseId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;DataBase&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        dotenv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; path&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;__dirname&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/../../.env&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notionkey&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; databaseid&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;notionkey &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;databaseid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NOTION_KEY or NOTION_DATABASE_ID is missing in the environment variables.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; notionkey &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataBase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;lastest&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; today &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 현재 날짜와 시간을 가져옵니다.&lt;/span&gt;
            today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 날짜를 하루 전으로 설정합니다.&lt;/span&gt;

            &lt;span class=&quot;token comment&quot;&gt;// YYYY-MM-DD 형식의 문자열로 날짜를 가져옵니다.&lt;/span&gt;
            filterUdate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFullYear&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMonth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;padStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;padStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; instance&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;QueryDatabaseResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                filter&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    and&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                            property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;상태&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            select&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                equals&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                            property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;update&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            date&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; on_or_after&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; filterUdate &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                sorts&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;update&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        direction&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;descending&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// pageId 리스트 업데이트&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageIds &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error querying the database:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;전에 제작한 클래스를 수정하여 만들었으며, 필터 기능을 추가하였다. &lt;/p&gt;
&lt;p&gt;Notion 서버에는 반드시 세계공통시? 로 저장이 되는 문제가 있다. 서울 시간대가 달라서 필터에도 현재 시간을 변환하여 조회하는 로직을 짜야 할 것 같다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pageIds&lt;/code&gt; 속성으로 DataBase에 저장된 페이지들의 ID를 받을 수 있다. &lt;/p&gt;
&lt;h2&gt;코드 작성시 고려한 점&lt;/h2&gt;
&lt;h3&gt;DataBase 클래스가 Page 인스턴스 리스트 관리 책임을 가진다면?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SRP(Single Responsibility Principle) 원칙에 의거해 하나의 클래스는 하나의 책임만을 져야 한다. DataBase 클래스가 Page 인스턴스 리스트 관리 책임도 가진다면 이 원칙에 어긋날 수 있다. &lt;/li&gt;
&lt;li&gt;두 클래스가 강한 연결성을 가지게 되어 유연성이 떨어질 수 있다. &lt;/li&gt;
&lt;li&gt;코드가 더 직관적으로 보일 수 있다. (추적이 쉽다)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;결론적으로, DataBase 클래스와 Page 클래스의 연결을 줄이고(유연성을 늘리고) SRP를 준수하기 위해 현재의 방식을 선택했다. &lt;/p&gt;
&lt;h3&gt;&lt;code class=&quot;language-text&quot;&gt;databaseId&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;notionkey&lt;/code&gt; 를 생성자의 파라미터로 전달한다면?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;해당 값을 생성자의 파라미터로 값을 전달할 경우 코드가 길어지는 단점이 있다. 또한, 다양한 notionkey나 databaseid로 클래스를 생성할 수 있다. &lt;/li&gt;
&lt;li&gt;하지만, 해당 프로젝트에서 Database는 여러개를 생성하거나 값을 바꿔가면서 클래스를 생성할 일이 없으므로 현재의 방법을 택했다. &lt;/li&gt;
&lt;li&gt;다만 지금처럼 할 경우 클래스 내부에서 외부 환경 변수에 직접 접근하므로 캡슐화 원칙에 어긋나기는 한다. 하지만 앞서 언급한대로 해당 변수가 바뀔일은 거의 없다고 여겨지므로 지금의 방법을 택했다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;추가 수정&lt;/h2&gt;
&lt;h3&gt;고려사항&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;DataBase는 여러개일 필요가 없으므로, Singleton 패턴을 고려한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DataBase&lt;/code&gt; 클래스는 Notion과의 통신 뿐만 아니라, 환경 변수의 로딩 및 데이터베이스 ID 및 키의 유효성 검사까지 담당하고 있다. 이러한 기능들을 분리하여 각각의 책임을 명확히 하는 것이 좋다. &lt;/li&gt;
&lt;li&gt;Typings: 현재 코드에서는 TypeScript를 사용하고 있다. 가능한 한 모든 변수, 함수 매개변수 및 반환 타입에 타입 주석을 추가하는 것이 좋다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;완성코드&lt;/h2&gt;
&lt;p&gt;위의 문제를 고려해 Notion과의 통신을 NotionAPI 클래스로 분리했다. Page나 Block 같은 다른 클래스에서도 동일한 Notion Client를 사용해야 하므로, 이는 아주 타당한 선택이었다. 또 하나의 프로젝트에 API는 유일하므로 싱글톤 패턴을 사용했다. 다음은 이를 위해 만들어진 notionapi.ts 코드이다. &lt;/p&gt;
&lt;h3&gt;notionapi.ts&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionAPI&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; instance&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; NotionAPI &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; client&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionKey&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; notionKey &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionKey&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;notionKey&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NOTION_KE is missing&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionAPI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionKey&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;최초 클래스 생성시에만 notionKey가 필요하도록 해두었다. 나중에 이 클래스를 호출할 때에는 번거롭게 환경변수를 조회할 필요가 없다. &lt;/p&gt;
&lt;h3&gt;database.ts&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; QueryDatabaseResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client/build/src/api-endpoints&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; dotenv &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dotenv&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; NotionAPI &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;./notionapi&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataBase&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; instance&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; DataBase &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; databaseId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; database&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; pageIds&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; databaseId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;DataBase&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            dotenv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; path&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;__dirname&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/../../.env&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notionkey&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; databaseid&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;notionkey &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;databaseid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NOTION_KEY or NOTION_DATABASE_ID is missing in the environment variables.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notionApi&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; NotionAPI &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; NotionAPI&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionkey&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataBase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;lastest&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; today&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Date &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                filterUdate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFullYear&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMonth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;padStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;padStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;QueryDatabaseResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                filter&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    and&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                            property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;상태&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            select&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                                equals&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filterUdate &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                            property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;update&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            date&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; on_or_after&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; filterUdate &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                sorts&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        property&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;update&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        direction&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;descending&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// pageId 리스트 업데이트&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageIds &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; pageId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error querying the database:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;타입 주석을 모두 추가해주었고, 싱글톤 패턴으로 변경되었다. Notion Client의 생성부가 다른 곳으로 분리되었다. &lt;/p&gt;
&lt;p&gt;환경변수 역시 분리하는것을 고려중이지만, &lt;/p&gt;
&lt;p&gt;일단은 database.ts를 이 정도로 완성 하려고 한다. &lt;/p&gt;
&lt;p&gt;database.ts 완성!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Sharknia/Notion-to-Markdown/tree/database-class-complete&quot;&gt;https://github.com/Sharknia/Notion-to-Markdown/tree/database-class-complete&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Factory Pattern]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/Factory-Pattern/</link><guid isPermaLink="false">https://sharknia.github.io/Factory-Pattern/</guid><pubDate>Sun, 03 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;팩토리 패턴은 객체 생성에 관련된 로직을 클래스 내부에 포함시키는 대신 별도의 클래스나 메소드에 위임하는 패턴이다. &lt;/p&gt;
&lt;h3&gt;개요&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;팩토리 패턴은 객체를 생성하는 코드와 객체의 사용 코드를 분리하는 역할을 한다. &lt;/li&gt;
&lt;li&gt;객체를 생성하는 로직을 별도의 팩토리 클래스나 팩토리 메소드에 위임하여 객체 생성을 캡슐화 한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;특징&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;유연성 : 객체 생성 과정에 변화가 생겼을 때, 클라이언트 코드는 변경되지 않고 팩토리 코드만 변경하면 된다. &lt;/li&gt;
&lt;li&gt;확장성 : 새로운 타입의 객체를 지원하기 위해 클라이언트 코드를 변경할 필요 없이 팩토리 클래스를 확장하면 된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;장점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;분리 및 재사용&lt;/li&gt;
&lt;li&gt;유지보수&lt;/li&gt;
&lt;li&gt;클라이언트 코드 간소화&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;단점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;복잡도&lt;/li&gt;
&lt;li&gt;학습곡선&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;사용 시나리오&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;객체 생성 로직이 복잡하거나 초기화에 많은 설정이 필요한 경우&lt;/li&gt;
&lt;li&gt;다양한 타입의 객체를 생성해야 하며, 이런 객체들이 공통의 인터페이스나 추상 클래스를 가지고 있는 경우&lt;/li&gt;
&lt;li&gt;시스템에서 아용되는 객체의 구체적인 타입을 시스템에서 분리하고자 할 때&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[NotionAPI를 활용한 자동 포스팅]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅/</link><guid isPermaLink="false">https://sharknia.github.io/NotionAPI를-활용한-자동-포스팅/</guid><pubDate>Sun, 03 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;갑자기 짚고 넘어가는 프로젝트의 목표&lt;/h3&gt;
&lt;p&gt;이번 프로젝트의 목표는 다음과 같다. &lt;/p&gt;
&lt;h4&gt;개발 내적인 목표&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;타입스크립트를 사용한다. &lt;/li&gt;
&lt;li&gt;변경에는 닫혀있고, 확장에는 열린 코드를 작성한다. &lt;/li&gt;
&lt;li&gt;이를 위해 구현에만 집중하지 않고 설계에 신경을 써서 진행해본다.&lt;/li&gt;
&lt;li&gt;이를 위해 디자인 패턴을 가능한 한 적극적으로 활용해본다. &lt;/li&gt;
&lt;li&gt;가능한 한 사용이 쉽도록 만들어본다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;명확한 명명 규칙을 사용한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;PascalCase를 클래스 이름에 사용한다.&lt;/li&gt;
&lt;li&gt;camelCase를 메소드 및 변수에 사용한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;개발 외적인 목표&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;노션으로 공부만 해도 포스팅/풀심기가 모두 되는 꿈의 프로그램을 만든다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;그래서 이번에는?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/Notion-API2&quot;&gt;Notion API(2)&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;지난번에 API 정상 작동을 확인만 한 코드를 타입스크립트로 바꾸고, 하나의 클래스로 만들려고 한다. &lt;/p&gt;
&lt;h4&gt;최초 작성 코드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; dotenv &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dotenv&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; QueryDatabaseResponse &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client/build/src/api-endpoints&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionToMarkdown&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; databaseID&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; database&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        dotenv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Environment variable NOTION_KEY is not defined.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_PAGE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Environment variable NOTION_PAGE_ID is not defined.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseID &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_PAGE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;initializeDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;initializeDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;QueryDatabaseResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseID &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error querying the database:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ... 다른 메소드들 (retrievePage, retrieveBlock, listBlockChildren) ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로 구성을 했는데 위 코드의 문제는 생성자에서 비동기 작업을 직접 실행하는 것에 있다. &lt;/p&gt;
&lt;p&gt;비동기 작업을 생성자에서 실행할 경우 잠재적으로 발생할 수 있는 문제는 다음과 같다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;비동기 로직이 실패할 경우, 객체 생성 자체에 문제가 생길 수 있다. 생성자는 객체 초기화를 수행하는 로직만 포함해야 하며, 부작용(side-effect)이 발생할 수 있는 코드는 포함되어서는 안된다. &lt;/li&gt;
&lt;li&gt;비동기 로직이 포함되면 생성자의 수행 시간이 길어질 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 문제는 Factory 패턴을 사용하여 해결할 수 있다. Factory 메소드를 사용하여 비동기 로직을 수행하고 완료되면 객체를 반환한다. 아래와 같이 Factory 패턴을 사용하여 코드를 수정했다.  &lt;/p&gt;
&lt;h4&gt;Factory Pattern을 활용한 코드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionToMarkdown&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; databaseId&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; database&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseID&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; database&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; databaseID&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; database&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;NotionToMarkdown&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        dotenv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Environment variable is not defined.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; auth&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; databaseId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_DATABASE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionToMarkdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; QueryDatabaseResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotionToMarkdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; databaseId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; database&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;queryDatabase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;QueryDatabaseResponse&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; database_id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databaseId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error querying the database:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// ... 다른 메소드들 (retrievePage, retrieveBlock, listBlockChildren) ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 사용 예제:&lt;/span&gt;
NotionToMarkdown&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handler &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;database&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// database 속성 출력&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 코드에서 create 메소드가 비동기 팩토리 메소드이다. 이 메소드는 &lt;code class=&quot;language-text&quot;&gt;NotionToMarkdown&lt;/code&gt; 객체를 비동기적으로 생성하고 반환한다. 생성자는 private로 선언되어 직접 호출할 수 없고, 반드시 create 메소드를 통해 객체를 생성해야 한다. &lt;/p&gt;
&lt;h3&gt;진행 코드&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Sharknia/Notion-to-Markdown/blob/42911777c0146c4260a5769fe9a7d5b1f9ac4c32/notionApi.ts&quot;&gt;https://github.com/Sharknia/Notion-to-Markdown/blob/42911777c0146c4260a5769fe9a7d5b1f9ac4c32/notionApi.ts&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[네이밍 규칙(naming conventions)]]></title><description><![CDATA[naming conventions는 클래스, 메소드 또는 변수의 이름을 지을 때 사용되는 명명 규칙이다.  camelCase…]]></description><link>https://sharknia.github.io/네이밍-규칙naming-conventions/</link><guid isPermaLink="false">https://sharknia.github.io/네이밍-규칙naming-conventions/</guid><pubDate>Sun, 03 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;naming conventions는 클래스, 메소드 또는 변수의 이름을 지을 때 사용되는 명명 규칙이다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;camelCase&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;첫번째 단어는 소문자로 시작하고 그 후의 단어는 대문자로 시작한다. 변수 또는 함수 명으로 주로 사용된다. &lt;/p&gt;
&lt;p&gt;예 : &lt;code class=&quot;language-text&quot;&gt;variableName&lt;/code&gt;  &lt;code class=&quot;language-text&quot;&gt;printMyName&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PascalCase&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;모든 단어가 대문자로 시작한다. 주로 클래스명으로 사용된다. &lt;/p&gt;
&lt;p&gt;예 : &lt;code class=&quot;language-text&quot;&gt;ClassName&lt;/code&gt;  &lt;code class=&quot;language-text&quot;&gt;PrintMyName&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;snake_case&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;모든 단어를 소문자로 작성하고 단어 사이를 &lt;code class=&quot;language-text&quot;&gt;_&lt;/code&gt; 로 구분한다. 변수나 함수명 또는 데이터베이스 필드명으로 사용된다. &lt;/p&gt;
&lt;p&gt;예 : &lt;code class=&quot;language-text&quot;&gt;variable_name&lt;/code&gt;  &lt;code class=&quot;language-text&quot;&gt;print_my_name&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;kebab-case&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;모든 단어를 소문자로 작성하고 단어 사이를 &lt;code class=&quot;language-text&quot;&gt;-&lt;/code&gt; 로 구분한다. 주로 URL 또는 css 클래스 명에 사용된다. &lt;/p&gt;
&lt;p&gt;예 : &lt;code class=&quot;language-text&quot;&gt;variable-name&lt;/code&gt;  &lt;code class=&quot;language-text&quot;&gt;print-my-name&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UPPER&lt;em&gt;SNAKE&lt;/em&gt;CASE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;모든 단어를 대문자로 작성하고 단어 사이를 &lt;code class=&quot;language-text&quot;&gt;_&lt;/code&gt; 로 구분한다. 주로 상수를 나타낼 때 사용된다. &lt;/p&gt;
&lt;p&gt;예 : &lt;code class=&quot;language-text&quot;&gt;CONSTANT_VALUE&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;물론 이것들은 강제되는 것은 아니다. 하지만 일관된 스타일을 여러 개발자 사이에 유지하면 협업이나 가독성에 도움이 될 것이다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Typescript 시작하기]]></title><description><![CDATA[TypeScript TypeScript란? TypeScript는 Microsoft에서 개발한 오픈 소스 프로그래밍 언어이다. JavaScript의 SuperSet…]]></description><link>https://sharknia.github.io/Typescript-시작하기/</link><guid isPermaLink="false">https://sharknia.github.io/Typescript-시작하기/</guid><pubDate>Sat, 02 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;TypeScript&lt;/h2&gt;
&lt;h3&gt;TypeScript란?&lt;/h3&gt;
&lt;p&gt;TypeScript는 Microsoft에서 개발한 오픈 소스 프로그래밍 언어이다. JavaScript의 SuperSet(상위 집합)이므로, 기존의 자바스크립트 코드도 타입스크립트에서 동작한다. 타입스크립트의 주요 목적은 큰 규모의 어플리케이션 개발을 돕기 위해 정적 타입, 인터페이스, 클래스, 모듈 등의 기능을 자바스크립트에 추가하는 것이다. &lt;/p&gt;
&lt;h3&gt;주요 특징&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;정적 타이핑 : 변수, 함수 매개변수, 함수 반환 값에 대한 타입을 지정할 수 있다. 이를 통해 컴파일 시점에 오류를 발견할 수 있으며, IDE와 에디터는 타입 정보를 사용하여 더 나은 코드 제안과 리팩토링을 제안할 수 있다. &lt;/li&gt;
&lt;li&gt;객체 지향 프로그래밍 : 클래스, 인터페이스, 상속, 제네릭 등과 같은 객체 지향 프로그래밍 기능을 제공하여 코드의 구조와 디자인을 개선한다. &lt;/li&gt;
&lt;li&gt;도구 및 에디터 지원 : 코드 자동완성, 타입검사, 코드 리팩토링과 같은 기능을 지원하는 다양한 도구 및 에디터에 통합된다. &lt;/li&gt;
&lt;li&gt;다운레벨 타겟팅 : 최신 자바스크립트 기능을 사용하여 코드를 작성하고 ES3, ES5, ES6등 이전 버전의 자바스크립트로 컴파일 할 수 있다. 이를 통해 최신 기능을 사용하면서도 구버전 브라우저와의 호환성을 유지할 수 있다. &lt;/li&gt;
&lt;li&gt;확장성 : 모듈화 된 방식으로 동작하여 외부 라이브러리와의 통합을 쉽게 만들어준다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;TypeScript의 설치&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;TypeScript 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; typescript&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;새 프로젝트 시작&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; my-ts-project
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; my-ts-project
&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; init &lt;span class=&quot;token parameter variable&quot;&gt;-y&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TypeScript 설정 파일 생성&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;tsc &lt;span class=&quot;token parameter variable&quot;&gt;--init&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;tsconfig.json&lt;/code&gt; 파일이 생성된다. 이 파일에서 TypeScript의 컴파일 옵션을 설정할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;필요한 TypeScript 타입 정의 설치&lt;/p&gt;
&lt;p&gt;Node.js와 TypeScript를 함 사용하기 위해 해당 타입 정의를 설치한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--save&lt;/span&gt; @types/node&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;첫 TypeScript 파일 작성&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;index.ts&lt;/code&gt; 파일에 다음과 같은 내용을 작성해보자. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; greet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;Hello, &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token builtin&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;TypeScript&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;컴파일 및 실행&lt;/p&gt;
&lt;p&gt;아래 명령어로 컴파일 할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;tsc index.ts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;index.js가 생성되었다. 이제 Node.js로 실행할 수 있다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;node&lt;/span&gt; index.js&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;자동 컴파일 설정(선택사항)&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ts-node&lt;/code&gt; 라는 패키지를 설치하여 TypeScript 코드를 바로 실행할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; ts-node&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;설치 후, 아래 명령어로 TypeScript 코드를 바로 실행할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ts-node index.ts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;TypeScript 설정 파일(&lt;strong&gt;tsconfig.json)&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;tsconfig.json&lt;/code&gt; 은 타입스크립트 프로젝트의 루트 디렉토리에 위치하는 설정 파일이다. 타입스크립트 컴파일러에 대한 구성 옵션을 정의한다. 이 파일을 통해 타입스크립트 코드가 자바스크립트 코드로 변환되는지, 어떤 파일들이 포함되거나 제외되는지 등을 정의할 수 있다. &lt;/p&gt;
&lt;p&gt;주요 옵션들은 다음과 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;files&lt;/strong&gt;: 컴파일에 포함할 파일의 목록이다. 이 옵션을 사용하면 특정 파일만 명시적으로 포함시킬 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;include&lt;/strong&gt;: 컴파일에 포함할 파일이나 디렉토리의 패턴 목록다. Glob 패턴을 사용할 수 있다. 예: &lt;code class=&quot;language-text&quot;&gt;[&quot;src/**/*.ts&quot;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;exclude&lt;/strong&gt;: 컴파일에서 제외할 파일이나 디렉토리의 패턴 목록다. 예: &lt;code class=&quot;language-text&quot;&gt;[&quot;node_modules&quot;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;extends&lt;/strong&gt;: 다른 &lt;code class=&quot;language-text&quot;&gt;tsconfig.json&lt;/code&gt; 파일을 기반으로 현재 설정을 확장하려면 파일 경로를 지정한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;compilerOptions&lt;/strong&gt;: 컴파일러에 대한 다양한 설정을 제공하는 핵심 옵션이다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;typeRoots와 types&lt;/strong&gt;: 사용자 정의 타입 선언의 위치와 포함될 타입 선언 패키지를 지정한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;compilerOptions에 대해 좀 더 자세히 알아보면 다음과 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;target&lt;/strong&gt;: 컴파일된 JavaScript의 버전을 지정한다. 예: ES5, ES6 등&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;module&lt;/strong&gt;: 모듈 시스템을 지정한다. 예: CommonJS, ESNext, UMD 등&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;outDir&lt;/strong&gt;: 컴파일된 JavaScript 파일이 저장될 디렉토리를 지정한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;rootDir&lt;/strong&gt;: 입력 파일의 루트 디렉토리를 지정한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;strict&lt;/strong&gt;: 모든 엄격한 타입 검사 옵션을 활성화한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;noImplicitAny&lt;/strong&gt;: 암시적인 &apos;any&apos; 타입이 없는 경우 오류를 발생시킨다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;esModuleInterop&lt;/strong&gt;: CommonJS와 ES 모듈 간의 상호 운용성을 위한 코드를 생성한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;skipLibCheck&lt;/strong&gt;: 선언 파일의 타입 검사를 건너뛴다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[gitignore]]></title><description><![CDATA[gitignore란?  는 Git에서 프로젝트에 특정 파일 또는 디렉터리를 추적하지 않도록 지시하는 파일이다.  파일에 나열된 패턴과 일치하는 파일/디렉터리는 Git에서 무시된다. 이는 민감한 데이터, 컴파일 된 바이너리, 로그 파일 등 Git…]]></description><link>https://sharknia.github.io/gitignore/</link><guid isPermaLink="false">https://sharknia.github.io/gitignore/</guid><pubDate>Sat, 02 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;gitignore란?&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 는 Git에서 프로젝트에 특정 파일 또는 디렉터리를 추적하지 않도록 지시하는 파일이다. &lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 파일에 나열된 패턴과 일치하는 파일/디렉터리는 Git에서 무시된다. 이는 민감한 데이터, 컴파일 된 바이너리, 로그 파일 등 Git 저장소에 저장할 필요가 없거나 저장해서는 안되는 파일들을 제외하는 데에 유용하다. &lt;/p&gt;
&lt;h2&gt;문법&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 파일에는 여러 패턴을 사용할 수 있는데, 이를 알고 있으면 파일과 디렉터리를 무시하는 데 더 유용하게 사용할 수 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;/code&gt; : 어떤 문자든지 0개 이상을 의미한다. 예를 들어, &lt;code class=&quot;language-text&quot;&gt;.log&lt;/code&gt;는 모든 로그 파일을 무시한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt; : 디렉터리 구분자로 사용된다. &lt;code class=&quot;language-text&quot;&gt;/logs&lt;/code&gt;는 logs라는 이름의 디렉터리만 무시하며, &lt;code class=&quot;language-text&quot;&gt;logs/&lt;/code&gt;는 logs로 시작하는 모든 디렉터리를 무시한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!&lt;/code&gt; : 패턴을 부정한다. 예를 들면, &lt;code class=&quot;language-text&quot;&gt;.log&lt;/code&gt; 아래에 &lt;code class=&quot;language-text&quot;&gt;!important.log&lt;/code&gt;를 추가하면, 모든 로그 파일은 무시되지만 important.log 파일은 예외로 추적된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;#&lt;/code&gt; : 주석을 작성하는 데 사용된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;전역 설정하기&lt;/h2&gt;
&lt;p&gt;프로젝트마다 반복적으로 무시 해야하는 파일이나 디렉터리가 있다면, 전역 &lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 파일을 만들 수 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;전역 &lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 파일 생성: &lt;code class=&quot;language-text&quot;&gt;touch ~/.gitignore_global&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Git 설정에 전역 &lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 파일 추가: &lt;code class=&quot;language-text&quot;&gt;git config --global core.excludesFile ~/.gitignore_global&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;TypeScript 프로젝트에서의 gitignore&lt;/h2&gt;
&lt;p&gt;일반적으로 아래와 같지만, 프로젝트의 상황과 요구에 따라 추가/제외되는 항목이 당연히 있을 수 있다. &lt;/p&gt;
&lt;h3&gt;포함하지 말아야 할 파일들&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/node_modules/&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt;이나 &lt;code class=&quot;language-text&quot;&gt;yarn&lt;/code&gt; 명령으로 설치한 패키지들이 이 디렉터리에 저장된다. 이는 대부분의 경우에 매우 크며, 이를 Git에 저장하는 것은 비효율적이다. 대신, &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt;에 의존성이 기록되므로 다른 개발자들은 동일한 패키지를 쉽게 설치할 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/dist/&lt;/code&gt; &lt;strong&gt;또는&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;/build/&lt;/code&gt;: TypeScript를 JavaScript로 컴파일할 때 생성되는 출력 디렉터리이다. 이것은 원본 코드에서 파생된 것이므로 저장소에 포함할 필요가 없다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.env&lt;/code&gt;: 환경 변수가 포함된 파일이다. 이 파일은 민감한 정보 (API 키, 비밀번호 등)를 포함할 수 있으므로 공개 저장소에 저장되어서는 안된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.DS_Store&lt;/code&gt;: macOS에서 파일 시스템이 생성하는 메타데이터 파일이다. 이는 프로젝트와 관련이 없으므로 무시해야 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;포함되어야 할 파일들&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.js&lt;/code&gt;&lt;strong&gt;와&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;.js.map&lt;/code&gt;: TypeScript를 JavaScript로 컴파일하면, 일반적으로 &lt;code class=&quot;language-text&quot;&gt;.js&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;.js.map&lt;/code&gt; 파일이 생성된다. 이러한 파일은 &lt;code class=&quot;language-text&quot;&gt;/dist/&lt;/code&gt;나 &lt;code class=&quot;language-text&quot;&gt;/build/&lt;/code&gt; 디렉터리에 포함될 수 있지만, 그렇지 않은 경우에도 이러한 파일을 무시하는 것이 좋다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.tsbuildinfo&lt;/code&gt;: TypeScript 3.4 이후로 컴파일러는 프로젝트 빌드 정보를 이 파일에 저장할 수 있다. 이것은 증분 빌드(incremental build)를 빠르게 만들기 위한 것이므로 저장소에 포함시키지 않아도 된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/coverage/&lt;/code&gt;: 테스트 코드의 코드 커버리지를 저장하는 디렉터리이다. 보통 이 디렉터리는 코드 커버리지 도구로 생성된다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;로그 파일&lt;/strong&gt;: 예를 들면, &lt;code class=&quot;language-text&quot;&gt;.log&lt;/code&gt; 확장자를 가진 파일들이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;정의되었는데, 추적되는 경우&lt;/h2&gt;
&lt;p&gt;예를 들어 나의 경우에는 *.js를 정의했는데 특정 js 파일이 계속해서 추적당했다. 이는 몇가지 이유가 있을 수 있다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;이전에 추적되었던 파일&lt;/li&gt;
&lt;li&gt;위치 문제&lt;/li&gt;
&lt;li&gt;다른 &lt;code class=&quot;language-text&quot;&gt;.gitignore&lt;/code&gt; 규칙&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;나의 경우에는 1번의 경우였다. &lt;code class=&quot;language-text&quot;&gt;git rm --cached 파일명.js&lt;/code&gt; 명령어를 사용해 추적에서 따로 제거해줘야 한다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Branch]]></title><description><![CDATA[브랜치란? 브랜치는 코드의 다양한 버전을 동시에 관리하고 작업할 수 있게 해주는 도구이다. 개발자는 브랜치를 통해 작업을 병렬적으로 진행하고 나중에 원하는 시점에 이 작업들을 병합할 수 있다.  브랜치의 핵심 개념 Commit Git…]]></description><link>https://sharknia.github.io/Branch/</link><guid isPermaLink="false">https://sharknia.github.io/Branch/</guid><pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;브랜치란?&lt;/h3&gt;
&lt;p&gt;브랜치는 코드의 다양한 버전을 동시에 관리하고 작업할 수 있게 해주는 도구이다. 개발자는 브랜치를 통해 작업을 병렬적으로 진행하고 나중에 원하는 시점에 이 작업들을 병합할 수 있다. &lt;/p&gt;
&lt;h3&gt;브랜치의 핵심 개념&lt;/h3&gt;
&lt;h4&gt;Commit&lt;/h4&gt;
&lt;p&gt;Git에서 변경점을 나타내는 스냅샷이다. 각 커밋은 이전 커밋에 대한 참조를 가진다. &lt;/p&gt;
&lt;h4&gt;HEAD&lt;/h4&gt;
&lt;p&gt;현재 작업중인 브랜치의 가장 최신 커밋이다. &lt;/p&gt;
&lt;h4&gt;Merge&lt;/h4&gt;
&lt;p&gt;두 브랜치의 변경 내용을 합치는 과정이다. &lt;/p&gt;
&lt;h3&gt;브랜치의 사용목적&lt;/h3&gt;
&lt;p&gt;브랜치를 사용하여 코드의 특정 시점을 백업하자. 이것은 Git의 핵심 기능 중 하나이다. &lt;/p&gt;
&lt;p&gt;브랜치를 사용하는 것은 코드의 특정 상태나 특정 기능을 분리하고, 나중에 필요한 경우 그 상태로 되돌아가거나 다른 브랜치와 병합하는 데 유용하다. &lt;/p&gt;
&lt;p&gt;브랜치를 백업 목적으로 사용하는 것의 장점은 다음과 같다. &lt;/p&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;상태보존 : 특정 코드의 상태를 보존하고 싶을 때 브랜치를 생성하면 그 시점의 코드 상태를 유지할 수 있다. &lt;/li&gt;
&lt;li&gt;안전한 테스트 : 새로운 기능이나 변경 사항을 시도하고 싶을 때 별도의 브랜치에서 작업하면 메인 브랜치를 안전하게 보호할 수 있다. &lt;/li&gt;
&lt;li&gt;히스토리 관리 : 브랜치를 통해 어떤 변경 사항이 이루어졌는지의 히스토리를 명확하게 관리할 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;주의사항&lt;/h4&gt;
&lt;p&gt;많은 수의 브랜치가 생성되면 관리가 복잡해질 수 있다. 정기적으로 더 이상 필요하지 않은 브랜치를 정리하는 습관을 들이는 것이 좋다. &lt;/p&gt;
&lt;p&gt;코드의 모든 작은 변경마다 브랜치를 생성한다면(그럴 리 없겠지만), 과도하게 많은 브랜치가 생성될 수 있다. 백업 목적으로 브랜치를 사용할 때에는 특히 실제로 중요한 시점에서만 브랜치를 생성하는 것이 바람직하다. &lt;/p&gt;
&lt;h3&gt;브랜치 이름 짓기&lt;/h3&gt;
&lt;p&gt;브랜치 이름을 지을 때 고려할 수 있는 일반적인 가이드라인은 다음과 같다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;명확하게&lt;/li&gt;
&lt;li&gt;짧게&lt;/li&gt;
&lt;li&gt;소문자 사용 : 대소문자 구문을 위해 소문자로 통일하는 것이 좋다. &lt;/li&gt;
&lt;li&gt;하이픈 사용 : 띄어쓰기가 안되므로 단어와 단어를 하이픈으로 구분한다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;카테고리/분류 사용 : 작업의 유형 또는 카테고리를 브랜치 이름의 접두사로 사용한다. 예시는 다음과 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;feat/&lt;/code&gt; 새로운 기능 추가&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;fix/&lt;/code&gt; 버그 수정&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;refactor/&lt;/code&gt; 코드 리팩토링&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;docs/&lt;/code&gt; 문서 관련 작업&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;예) &lt;code class=&quot;language-text&quot;&gt;feat/user-authentication&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;티켓 번호 포함 : 이슈 트래커나 프로젝트 관리도구와 연계된 작업의 경우 해당 IDX를 브랜치 이름에 포함시키는기 유용할 수 있다. &lt;/li&gt;
&lt;li&gt;명사보다 동사를 선호 &lt;/li&gt;
&lt;li&gt;확장자 사용 주의 : 브랜치 이름에 txt, md 같은 확장자를 포함하지 않도록 주의한다. &lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[DataTable 클래스]]></title><description><![CDATA[DataTable 개요 DataTable은 .Net 프레임워크와 .Net Core, 그리고 .Net 5 이후 버전에서 제공하는 ADO.Net의 일부이다. 메모리 상에서 데이터의 테이블 형태를 관리하기 위한 .Net의 클래스이다.  DataTable…]]></description><link>https://sharknia.github.io/DataTable-클래스/</link><guid isPermaLink="false">https://sharknia.github.io/DataTable-클래스/</guid><pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;DataTable 개요&lt;/h3&gt;
&lt;p&gt;DataTable은 .Net 프레임워크와 .Net Core, 그리고 .Net 5 이후 버전에서 제공하는 ADO.Net의 일부이다. 메모리 상에서 데이터의 테이블 형태를 관리하기 위한 .Net의 클래스이다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;DataTable은 클래스이다. 객체를 인스턴스화하고 메서드와 속성에 액세스 할 수 있다. &lt;/li&gt;
&lt;li&gt;메모리상에서 데이터의 테이블 형태를 표현한다. 열(DataColumn)과 행(DataRow)로 이루어진다. &lt;/li&gt;
&lt;li&gt;데이터베이스 쿼리 결과 저장, 사용자 인터페이스에 데이터 표시, 데이터 처리 및 변환, XML과 같은 다른 형식으로 데이터 직렬화 등 다양한 곳에 사용될 수 있다. &lt;/li&gt;
&lt;li&gt;DataTable은 DataSet 내에 존재할 수 있다. DataSet은 여러 DataTable 객체를 포함할 수 있으며, 이러한 테이블간에 관계(DataRelation)를 정의할 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;장점과 단점&lt;/h3&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;자유로운 데이터 접근 : 행과 열을 사용하여 데이터에 액세스 할 수 있으므로 데이터를 쉽게 탐색/수정 할 수 있다. &lt;/li&gt;
&lt;li&gt;자체적인 변경 추적 : 데이터 변경 내역을 추적할 수 있다. &lt;/li&gt;
&lt;li&gt;연결 독립성 : 메모리 상의 데이터 구조이므로 데이터베이스 연결이 필요 없다. &lt;/li&gt;
&lt;li&gt;스키마 정보 포함 : 스키마 정보를 포함하므로 데이터의 형식 및 관계를 정의하고 이해하기 쉽다. &lt;/li&gt;
&lt;li&gt;필터 및 계산 기능 : 데이터를 필터링 하거나 계산 할 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;메모리 사용량 : 메모리 기반의 구조이므로 큰 데이터 세트를 로딩할 경우 상당한 양의 메모리를 사용할 수 있다. &lt;/li&gt;
&lt;li&gt;성능 : 엔터티나 객체와 같은 스트림라인된 모델에 비해 처리 및 직렬화에 상대적으로 더 많은 리소스를 요구한다. &lt;/li&gt;
&lt;li&gt;타이핑 : 데이터를 액세스 할 때 타입 캐스팅이 필요할 수 있다. &lt;/li&gt;
&lt;li&gt;학습 곡선 : ORM이나 LINQ 같은 현대적인 접근법에 익숙한 개발자에게는 학습곡선이 필요하다. &lt;/li&gt;
&lt;li&gt;모듈성과 확장성 : 객체지향적인 접근법이나 도메인 주도 설계와 같은 설계 패턴에 직접 통합하기 어려울 수 있다. &lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;DataTable.Compute의 사용 가능한 주요 표현식&lt;/h3&gt;
&lt;h4&gt;집계함수&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Sum&lt;/th&gt;
&lt;th&gt;합계&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Avg&lt;/td&gt;
&lt;td&gt;평균&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Min&lt;/td&gt;
&lt;td&gt;최소값&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Max&lt;/td&gt;
&lt;td&gt;최대값&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Count&lt;/td&gt;
&lt;td&gt;항목의 수&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;StDev&lt;/td&gt;
&lt;td&gt;표준 편차&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Var&lt;/td&gt;
&lt;td&gt;분산&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4&gt;산술 연산자&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;+&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;-&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;*&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;%&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;비교 연산자&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;=&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;&amp;lt;&gt;&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;&gt;&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;&amp;lt;&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;&gt;=&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;&amp;lt;=&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;논리 연산자&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;AND&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;OR&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;NOT&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;문자열 함수&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;LEN&lt;/th&gt;
&lt;th&gt;문자열의 길이&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;SUBSTRING&lt;/td&gt;
&lt;td&gt;부분 문자열&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TRIM&lt;/td&gt;
&lt;td&gt;앞 뒤 공백 제거&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UPPER&lt;/td&gt;
&lt;td&gt;대문자로 변환&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LOWER&lt;/td&gt;
&lt;td&gt;소문자로 변환&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4&gt;기타 함수&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ISNULL&lt;/th&gt;
&lt;th&gt;NULL일 경우 대체할 값 반환&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;CONVERT&lt;/td&gt;
&lt;td&gt;데이터 타입 변환&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;기타 다른 주요 메소드&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Select&lt;/th&gt;
&lt;th&gt;특정 조건을 만족하는 행을 DataRow 배열로 반환&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;NewRow&lt;/td&gt;
&lt;td&gt;새 DataRow를 생성&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Rows.Add&lt;/td&gt;
&lt;td&gt;행을 추가&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Rows.Remove&lt;/td&gt;
&lt;td&gt;행을 삭제&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Rows.RemoveAt&lt;/td&gt;
&lt;td&gt;지정한 위치의 행을 삭제&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clear&lt;/td&gt;
&lt;td&gt;모든 행을 삭제&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Copy&lt;/td&gt;
&lt;td&gt;DataTable의 사본을 생성&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Clone&lt;/td&gt;
&lt;td&gt;구조만 복사한 새 DataTable을 반환&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GetChanges&lt;/td&gt;
&lt;td&gt;변경된 행들만을 포함하는 새 DataTable을 반환&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AcceptChanges&lt;/td&gt;
&lt;td&gt;변경 내용을 확정&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RejectChanges&lt;/td&gt;
&lt;td&gt;변경 내용을 취소&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</content:encoded></item><item><title><![CDATA[Notion API(2)]]></title><description><![CDATA[무엇을 하는가? Notion API를 이용해서 내가 쓴 글 들을 불러와 MD…]]></description><link>https://sharknia.github.io/Notion-API2/</link><guid isPermaLink="false">https://sharknia.github.io/Notion-API2/</guid><pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;무엇을 하는가?&lt;/h2&gt;
&lt;p&gt;Notion API를 이용해서 내가 쓴 글 들을 불러와 MD 파일로 만들려고 한다. 그 과정을 실시간으로 기록하려고 한다. 명확하게 가능한가? 는 사실 아직 알아보지 않았다. &lt;/p&gt;
&lt;h2&gt;왜 하는가?&lt;/h2&gt;
&lt;p&gt;너무나 너무나 귀찮기 때문이다.&lt;/p&gt;
&lt;p&gt;블로그 포스팅을 위해서 마크다운 에디터로 노션을 쓰고 싶기 때문이다. 아니? 노션으로 쓴 것을 그대로 블로그에 커밋해버리고 싶기 때문이다. 그 과정을 자동화해버리고 싶기 때문이다. &lt;/p&gt;
&lt;p&gt;즉, 노션에 글만 써두면 자동으로 마크다운으로 받아져서 깃허브에 커밋이 되고 깃허브 페이지에 배포가 되는 원대한 자동화를 원한다. &lt;/p&gt;
&lt;h2&gt;어떻게 하는가?&lt;/h2&gt;
&lt;h3&gt;환경&lt;/h3&gt;
&lt;p&gt;Node.js 18.17.1 버전을 사용한다.&lt;/p&gt;
&lt;p&gt;Node.js 프로젝트 시작&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; init&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;.env 생성&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;NOTION_KEY&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;노션키&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;NOTION_PAGE_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;PageId&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;.gitignore에 .env 등록&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;.env&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;.env 안의 내용을 가져올 수 있도록 &lt;code class=&quot;language-text&quot;&gt;dotenv&lt;/code&gt; 패키지 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; dotenv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notion API를 이용할 수 있도록 패키지 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; @notionhq/client&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;API 확인&lt;/h3&gt;
&lt;h4&gt;코드&lt;/h4&gt;
&lt;p&gt;Notion API reference에 아주 친절하게 JavaScript 예제 코드까지 전부 붙어있다. Node.js를 선택한 이유이기도 하다. 예제 코드가 자바스크립트로 되어있어 그대로 갖다 붙이기 쉬워 보였기 때문이다. 일단 API의 결과물이 어떻게 날아오는지 확인하기 위해 있는 대로 갖다 붙였다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dotenv&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Client &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;@notionhq/client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_PAGE_ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; key &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; process&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;NOTION_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; notion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; key &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;databases&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;database_id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; pageId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// console.log(response);&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//페이지들을 돌면서 id로 페이지를 읽어온다. &lt;/span&gt;
        response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pageId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;//page properties&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;page_id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; pageId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;----------Page Properties----------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;//page contents&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blockId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blocks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;retrieve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token literal-property property&quot;&gt;block_id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; blockId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;----------Page Contents as Block----------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blockId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pageId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; notion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blocks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token literal-property property&quot;&gt;block_id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; blockId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token literal-property property&quot;&gt;page_size&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;----------Page Block List----------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Error querying the database:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;노션의 페이지 구성&lt;/h4&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d66ebcb40149754ca4d4201abad4eef1/d5d41/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 55.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByElEQVR42m1SS47TQBTMlViwQ4glB2A1XIEbIHGcsBgYic1sYDaAEIhFJkIiv0kcJ47tOLHbseNP4k9Rr6MwM7JbKnX36/fqfbo6SZLAtm342y08z0OgFPzAR+ATQYDNZgOlAjxc9fGIwrLQtjphqNDv9zCd3uFuMsLgzy3msylGoyEmkzGGg78Y8/yYsUbluvCYbLlcwiK54zioqgqdmo9lWUL2moY8iVEWRSOzvEuA9qN/uVrhSL/D4aBxZNW6Qrnkea6N2plGCRRIItkb5CSq4ri9ZQkS9oJOcn7Ylqw8zTD+1UPv2098/f4Dxu/PSNYWahW2EwqZ6zqcga0RhqGG4ucUhwwTy8fblxd4/fQFnjx7jnev3mDZMwC14YjqJqFUpphNfjvLUqTpCTIGWUFS4ObTNb58vES3+x5XH24Q7zivraf99vs9Yrb/f4ZxHOkfFtnIQxRFGnIWBUS7ECnJkyxjkoyzlkT8oPUaW8a4/G2BkGvCPQPNuQFzMcec+2Jh6t2gdE73BWZTno2ZltGKEhE1lCRsnaG06lDYMsfzLG1KwrZPONulNUHCSkpWW5imVoRWRn0/y87Z8EhnDVQNYdctchLCfwhURTchecHcAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/d66ebcb40149754ca4d4201abad4eef1/ca1dc/image1.png&apos; srcset=&apos;/static/d66ebcb40149754ca4d4201abad4eef1/e7570/image1.png 170w,
/static/d66ebcb40149754ca4d4201abad4eef1/f46e7/image1.png 340w,
/static/d66ebcb40149754ca4d4201abad4eef1/ca1dc/image1.png 680w,
/static/d66ebcb40149754ca4d4201abad4eef1/02d09/image1.png 1020w,
/static/d66ebcb40149754ca4d4201abad4eef1/9d567/image1.png 1360w,
/static/d66ebcb40149754ca4d4201abad4eef1/d5d41/image1.png 2238w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
page properties는 정확하게 마크다운의 Front Matter에 사용하면 될 것 같다. &lt;/p&gt;
&lt;p&gt;그리고, 마크다운의 콘텐츠에 page content가 들어가면 되겠다. &lt;/p&gt;
&lt;p&gt;page properties를 얻기 위해서는 notion.pages.retrieve method를 이용하면 된다. &lt;/p&gt;
&lt;h4&gt;코드 실행 결과문 분석&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;notion.pages.retrieve&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;page&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;created_time&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2023-08-23T13:32:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;last_edited_time&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2023-09-01T12:45:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;created_by&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;last_edited_by&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;cover&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;icon&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;parent&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;database_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;database_id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;archived&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;tags&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;PHNF&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;multi_select&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;multi_select&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;AWS&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;brown&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...id...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;TAG2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pink&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;url&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://www.notion.so/...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;public_url&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://name.notion.site/...&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;정확하게 페이지의 속성들을 가져오고 있다. Front Matter에 필요한 내용들을 속성으로 만들어두면 완벽할 것 같다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;notion.blocks.retrieve&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;notion.blocks.retrieve는 page ID를 넣으면 해당 페이지의 정보를 가져다 주는데 왜냐면 노션에서 모든 단위가 블록이기 때문이다. 해당 페이지의 블록으로서의 데이터를 주는 것이기 때문에 지금 내 상황에선 그다지 사용할 필요가 없어 보인다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;notion.blocks.children.list&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;list&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;results&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;block&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;parent&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;page_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;page_id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;created_time&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2023-09-01T12:00:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;last_edited_time&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2023-09-01T12:12:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;created_by&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;last_edited_by&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;object&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;has_children&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;archived&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;heading_1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;heading_1&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;rich_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;제목1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;annotations&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;italic&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;strikethrough&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;underline&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;plain_text&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;제목1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token null keyword&quot;&gt;null&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;is_toggleable&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	...
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;우리가 원하는 Page Content들의 내용이 드디어 보인다. 위의 결과에는 나타나지 않았지만, 들여쓰기가 된 경우에는 해당 들여쓰기가 된 block의 상위 요소에게 종속된다. 다시 말 내 다음 블록에 들여쓰기를 한 블록이 있다면 &lt;code class=&quot;language-text&quot;&gt;has_children&lt;/code&gt; 속성이 true가 된다. 그 안을 다시 파고 들어가면 될 것 같다. &lt;/p&gt;
&lt;h2&gt;오늘의 결론&lt;/h2&gt;
&lt;h4&gt;코드 기록&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Sharknia/Notion-to-Markdown/tree/check-api-test-complete&quot;&gt;https://github.com/Sharknia/Notion-to-Markdown/tree/check-api-test-complete&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;이렇게 해서, API를 통해서 내 노션에 올려진 글들을 가져오는 데에 성공했다. 이제 다음 시간에는 이 JSON들을 가공해서 Markdown으로 변환하려고 한다. &lt;/p&gt;
&lt;p&gt;방법은 세 가지 정도를 생각하고 있다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;노션 내부 API 사용&lt;/p&gt;
&lt;p&gt;실제 노션 페이지를 띄울 때 오고 가는 요청값 들을 확인해 이를 사용하여 마크다운 파일을 바로 만들 수 있는 것으로 보인다. 이는 만들기가 가장 쉬워 보이나, 언제 폭파 될지 모른다는 문제점을 갖고 있다.  만약 폭파된다면 귀찮게도 다시 만들어야 한다는 치명적인 문제 때문에 지금 당장은 고려하고 있지 않지만 실패할 가능성도 가장 적어 보이므로, 귀찮아지면 언제든지 이쪽으로 틀도록 하자. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;오픈 소스 사용&lt;/p&gt;
&lt;p&gt;Notion 블록을 마크다운 형식으로 바꿔주는 오픈 소스가 있는 것으로 보인다. 아직 자세히 살펴보지는 않았다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;직접 구현&lt;/p&gt;
&lt;p&gt;그냥.. 직접 만든다. 아마 많은 기능을 지원하지는 못하겠지만 노션을 쓰면서 느낀 건데 많은 기능을 딱히 사용하지 않는다. 정말 개인적인 용도라면 그냥 생각보다 쉽게 될 것 같기도 하다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;일단 코드를 막 짜고 있는데, 이번에는 변화에 닫힌, 확장에 열린 코드를 짜보려고 한다. 설계도 신경써서 하고 싶다. &lt;/p&gt;
&lt;p&gt;또 여유가 허락된다면 타입스크립트도 써보고 싶다. &lt;/p&gt;
&lt;h2&gt;참고문서&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.notion.com/reference&quot;&gt;https://developers.notion.com/reference&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.hwahae.co.kr/all/tech/10960&quot;&gt;https://blog.hwahae.co.kr/all/tech/10960&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[npx]]></title><description><![CDATA[npx란? npx는 Node.js와 함께 제공되는 패키지 실행도구이다.  npm에서 제공하는 패키지를 설치하지 않고 즉시 실행하게 해주는 역할을 한다.  npx…]]></description><link>https://sharknia.github.io/npx/</link><guid isPermaLink="false">https://sharknia.github.io/npx/</guid><pubDate>Thu, 31 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;npx란?&lt;/h4&gt;
&lt;p&gt;npx는 Node.js와 함께 제공되는 패키지 실행도구이다.  npm에서 제공하는 패키지를 설치하지 않고 즉시 실행하게 해주는 역할을 한다. &lt;/p&gt;
&lt;h4&gt;npx의 특징 및 기능&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;전역설치 없이 실행&lt;/p&gt;
&lt;p&gt;패키지를 전역으로 설치하지 않고 즉시 명령어를 바로 실행할 수 있다.&lt;/p&gt;
&lt;p&gt;에를 들어  gh-pages와 같은 CLI 도구를 전역적으로 설치하지 않아도 npx gh-pages로 바로 실행할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;일회성 실행&lt;/p&gt;
&lt;p&gt;npx를 사용하여 패키지를 실행하면 해당 패키지는 일시적으로 다운로드 되어 실행되고 실행 후에는 시스템에서 제거된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;명령어 실행&lt;/li&gt;
&lt;li&gt;Github gist 실행&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;임시 패키지 실행&lt;/p&gt;
&lt;p&gt;특정 버전의 패키지나 다른 레지스트리의 패키지를 실행하는데 npx를 사용할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;npx의 장점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;디스크 공간 절약&lt;/p&gt;
&lt;p&gt;사용 후에 패키지가 제거되므로, 불필요한 디스크 공간을 사용하지 않는다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;항상 최신 버전 사용&lt;/p&gt;
&lt;p&gt;최신 버전의 패키지를 가져와 실행한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;전역 충돌 방지&lt;/p&gt;
&lt;p&gt;패키지를 전역 설치하지 않으므로 다른 버전의 동일한 패키지가 설치되어 있을 때 충돌을 피할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;npx의 단점&lt;/h4&gt;
&lt;p&gt;매번 다시 받을 필요 없는 자주 사용하는 패키지나 용량이 큰 패키지의 경우 의미 없이 시간이 걸릴 수 있다. &lt;/p&gt;
&lt;h4&gt;npx의 실행순서&lt;/h4&gt;
&lt;p&gt;예를 들어 &lt;code class=&quot;language-text&quot;&gt;npx gh-pages -d public&lt;/code&gt; 를 실행하면 다음의 과정을 거친다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;시스템에 &lt;code class=&quot;language-text&quot;&gt;gh-pages&lt;/code&gt;가 설치되어 있는지 확인한다. &lt;/li&gt;
&lt;li&gt;설치되어 있지 않다면, 일시적으로 &lt;code class=&quot;language-text&quot;&gt;gh-pages&lt;/code&gt;를 다운로드한다. &lt;/li&gt;
&lt;li&gt;다운로드 된 &lt;code class=&quot;language-text&quot;&gt;gh-pages&lt;/code&gt; 패키지의 실행 파일을 사용하여 &lt;code class=&quot;language-text&quot;&gt;-d public&lt;/code&gt; 옵션과 함께 실행한다. &lt;/li&gt;
&lt;li&gt;실행이 완료된 후에 &lt;code class=&quot;language-text&quot;&gt;gh-pages&lt;/code&gt; 패키지는 시스템에서 제거된다. &lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[github.io 자동배포]]></title><description><![CDATA[왜 하는가 나는 귀찮은게 너무 귀찮다.  커밋 한 이후에  를 해야 배포가 되는 것도 너무 귀찮았다.  무엇을 하는가 그래서, 이걸  을 이용해서 자동화를 했다.  에 임의의 yml 파일을 넣어주면 해당 작업을 github action…]]></description><link>https://sharknia.github.io/githubio-자동배포/</link><guid isPermaLink="false">https://sharknia.github.io/githubio-자동배포/</guid><pubDate>Wed, 30 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;왜 하는가&lt;/h4&gt;
&lt;p&gt;나는 귀찮은게 너무 귀찮다. &lt;/p&gt;
&lt;p&gt;커밋 한 이후에 &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; run deploy-gh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;를 해야 배포가 되는 것도 너무 귀찮았다. &lt;/p&gt;
&lt;h4&gt;무엇을 하는가&lt;/h4&gt;
&lt;p&gt;그래서, 이걸 &lt;code class=&quot;language-text&quot;&gt;github action&lt;/code&gt; 을 이용해서 자동화를 했다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;.gitbub/workflows&lt;/code&gt;에 임의의 yml 파일을 넣어주면 해당 작업을 github action에서 진행한다. &lt;/p&gt;
&lt;h4&gt;어떻게 했는가&lt;/h4&gt;
&lt;p&gt;yml 파일 내용은 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;name: Deploy

on: &lt;span class=&quot;token comment&quot;&gt;# 어떤 작업이 수행될 때 deploy.yml 작업이 수행된다. (트리거)&lt;/span&gt;
  push: &lt;span class=&quot;token comment&quot;&gt;# push 작업이 수행될 때&lt;/span&gt;
    branches: &lt;span class=&quot;token comment&quot;&gt;# 특정 브랜치를 대상으로&lt;/span&gt;
      - master

permissions: &lt;span class=&quot;token comment&quot;&gt;# github action이 수행되는 환경에서 특정 권한을 준다&lt;/span&gt;
  contents: &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: &lt;span class=&quot;token number&quot;&gt;20.3&lt;/span&gt;.1

      - name: Install &lt;span class=&quot;token function&quot;&gt;node&lt;/span&gt; packages
        run: &lt;span class=&quot;token function&quot;&gt;yarn&lt;/span&gt;
        
      - name: Check lint
        run: &lt;span class=&quot;token function&quot;&gt;yarn&lt;/span&gt; check:lint
        
      &lt;span class=&quot;token comment&quot;&gt;# 아래와 같은 오류가 남&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# error Command failed with exit code 1.&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# - name: Check prettier&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;#   run: yarn check:prettier&lt;/span&gt;
      
      - name: Build
        run: &lt;span class=&quot;token function&quot;&gt;yarn&lt;/span&gt; build
        
      - name: Set up GitHub token
        env:
          GITHUB_TOKEN: &lt;span class=&quot;token variable&quot;&gt;${{ secrets.Token}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        run: &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; config &lt;span class=&quot;token parameter variable&quot;&gt;--global&lt;/span&gt; user.email &lt;span class=&quot;token string&quot;&gt;&quot;email입력&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; config &lt;span class=&quot;token parameter variable&quot;&gt;--global&lt;/span&gt; user.name &lt;span class=&quot;token string&quot;&gt;&quot;name입력&quot;&lt;/span&gt;

      - name: Set Git remote URL with token
        run: &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; remote set-url origin https://&lt;span class=&quot;token variable&quot;&gt;${{ secrets.classicToken }&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;@github.com/Sharknia/Sharknia.github.io

      - name: Deploy to GitHub Pages
        run: npx gh-pages &lt;span class=&quot;token parameter variable&quot;&gt;-d&lt;/span&gt; public&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;문제는 없었는가&lt;/h4&gt;
&lt;p&gt;처음에는 npm install을 사용했었는데, 패키지가 없다던지 여러가지 문제가 났다. 해당 문제는 npx 명령을 사용하는 것으로 해결돼&lt;/p&gt;
&lt;p&gt;Deploy 까지 자동으로 하기 위해서는 깃허브 설정 관련 명령어가 필요했다. &lt;/p&gt;
&lt;p&gt;특히, 반드시 토큰을 발행하고 Github Action의 환경 변수에 추가를 해주어야 한다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[github.io를 이용한 블로그]]></title><description><![CDATA[https://devhudi.github.io/gatsby-starter-hoodie/quick-start-kr/ 디자인이 마음에 들고, 필요로 하는 기능이 모두 들어가 있기 때문에 해당 테마를 선택했다. (시리즈 기능, 목차 기능, 댓글 기능)…]]></description><link>https://sharknia.github.io/githubio를-이용한-블로그/</link><guid isPermaLink="false">https://sharknia.github.io/githubio를-이용한-블로그/</guid><pubDate>Mon, 28 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://devhudi.github.io/gatsby-starter-hoodie/quick-start-kr/&quot;&gt;https://devhudi.github.io/gatsby-starter-hoodie/quick-start-kr/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;디자인이 마음에 들고, 필요로 하는 기능이 모두 들어가 있기 때문에 해당 테마를 선택했다. (시리즈 기능, 목차 기능, 댓글 기능)&lt;/p&gt;
&lt;p&gt;5번까지는 무사히 테스트 했는데, &lt;/p&gt;
&lt;p&gt;6번 특히 Netlify를 활용한 배포에서 막혔다. &lt;/p&gt;
&lt;p&gt;Repository를 생성 후, 해당 저장소를 바로 Netlify에서 빌드하려고 하면 의존성 오류가 났다. &lt;/p&gt;
&lt;p&gt;Netlify를 활용하려고 한 이유는 Github Pages를 통해 배포할 경우 마스터 브랜치와 별도의 브랜치가 생성되는것이 번잡스러웠기 때문이다. &lt;/p&gt;
&lt;p&gt;조금 더 알아본 결과,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; run build&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;를 실행하면, &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/public&lt;/code&gt; 에 빌드 결과물이 생성되고 해당 폴더만 배포하면 될 것 같긴하다. 또는 &lt;code class=&quot;language-text&quot;&gt;github action&lt;/code&gt; 을 이용할 수도 있겠다. &lt;/p&gt;
&lt;p&gt;조금 더 편하게 블로그를 하려는 길은 아직 멀고 험하다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Notion API(1)]]></title><description><![CDATA[Notion API를 사용해보려고 한다.  이것으로 무엇을 할 것인가? 는 생각해둔게 있지만, 가능하다고 생각된 시점에서 본격적으로 해보려고 하고, 일단 오늘은 Notion API를 살펴보려고 한다.  간단한 소개 https://developers…]]></description><link>https://sharknia.github.io/Notion-API1/</link><guid isPermaLink="false">https://sharknia.github.io/Notion-API1/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Notion API를 사용해보려고 한다. &lt;/p&gt;
&lt;p&gt;이것으로 무엇을 할 것인가? 는 생각해둔게 있지만, 가능하다고 생각된 시점에서 본격적으로 해보려고 하고, 일단 오늘은 Notion API를 살펴보려고 한다. &lt;/p&gt;
&lt;h4&gt;간단한 소개&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.notion.com/&quot;&gt;https://developers.notion.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Notion의 공개 Rest API를 이용하여 Notion Workspace와 상호 작용 할 수 있다.&lt;/p&gt;
&lt;p&gt;페이지, 데이터베이스, 사용자, 페이지 및 인라인 주석, Workspace의 포스팅에 대한 검색 등등.. &lt;/p&gt;
&lt;p&gt;점점 지원 영역이 늘어나는 것 같다. change-log가 꽤 활발해보인다. &lt;/p&gt;
&lt;h4&gt;API 생성 및 권한 부여&lt;/h4&gt;
&lt;p&gt;일단 우선, API를 생성하고 권한 부여 작업을 해야 한다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.notion.so/my-integrations&quot;&gt;https://www.notion.so/my-integrations&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;올라와 있는 한글 블로그들과 현재의 API 권한 부여 방식이 달라지는 바람에  여기서 은근 헤맸다… 역시 공식 가이드를 우선적으로 봐야한다. &lt;/p&gt;
&lt;p&gt;위 페이지에서 새 &lt;code class=&quot;language-text&quot;&gt;API 통합 만들기&lt;/code&gt; 를 선택한다. &lt;/p&gt;
&lt;p&gt;API의 권한은 워크스페이스별로 관리되므로, &lt;code class=&quot;language-text&quot;&gt;연결된 워크스페이스&lt;/code&gt; 를 정확히 선택해준다. &lt;/p&gt;
&lt;p&gt;필수 항목을 입력해주고 &lt;code class=&quot;language-text&quot;&gt;제출&lt;/code&gt; 을 눌러주자. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 476px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/b4786f442a67ccd65a59902b3261a38c/09261/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 37.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAz0lEQVR42qWRywrCMBBF+/9f5EJciKALF4JbQbSKbaNR82yaxzWpBa248DFwuTCTOTNksuAdgrcIIbkDwn/Klos5ZrMpRsMBJpMxUqQBPwNPpEC+3WC3XWO/zxPuPyB6EdJ69yL8R4DwCrSmRqvGoDE6eg1nTeveNV/BWiA9EpwpBT1WKMtDK8YuoCcCrUS39Xugi0e01vUOminFISV7oy4v2MM7iSitOVYFw7riIFcBcuHwto7A1Pj0uNf8POClrrRAcZYwRoEriauQ8YsMbpcEcK3ihZd7AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/b4786f442a67ccd65a59902b3261a38c/09261/image1.png&apos; srcset=&apos;/static/b4786f442a67ccd65a59902b3261a38c/e7570/image1.png 170w,
/static/b4786f442a67ccd65a59902b3261a38c/f46e7/image1.png 340w,
/static/b4786f442a67ccd65a59902b3261a38c/09261/image1.png 476w&apos; sizes=&apos;(max-width: 476px) 100vw, 476px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
그럼 바로 위와 같은 화면으로 넘어온다. 표시를 눌러서 시크릿 키를 복사해서 보관해주자. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 509px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ea5eeced68059fd25375b5fbb8290f34/98235/image2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 112.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACWElEQVR42pWU2bLTMBBE8/9/xRu88wbcJN73fZWXoXvsa8glgOOqKcmy1ZrlaC7LNErftyKyPNr6YXy2vs6Pc9hlhmBV5jLPRiYzyoT3yQyyTPs7zIwDvm/rZuzVOOfeCd8mvK/LtAny5yyJpa4KKYtM4iiQKPQlS2OJw1DHFMZvbVNJU5dqXdfIMHS6RqO4Ci44eey3U43p9WOPnzl2LTb1nYzY+Cst625PwqcgF1qeCg97bDx+5vgxj/umf9mFsX/63opl2xL4roS+o14xpwvsPTdnDYKzBKWROImQr0hzlueJGkM/PD0vOMnnW68eeq4t1v0q99ubFoF5HfpGK/qSh05uIFBsHmaxNE25VRRGpLq2Fv53WvALPLxZlrgO7Q7xXLHYcDCnC7JVeaedYRGNcejVow2b+uDrvCDEqrJQWBeGdXC2/sHYKUGikcSBeAjVdWzJs1RRoWe856+io1VmuHEYSIJrV+SpdAi3LFLMM72ShlU+CzY9SMGgY9/Etu8SBp7MaAgD8kkbATnxebkoxIPe0Jq6UE+5Rh5fwoZiZgAidYXQUFF9fiuKLK9j89Xt4FWl91hbWByiOLGsL1T3QTCsJwXZ92yJUJgAwlHoHSHXdXGE/r/OA0EgIZMWgIXJs0R8dp3Axd2GMIrEA/QQHKZ9ERv/hpJ6yNDYBHzPAZOhjnHk65zdnPMYXTyK/O2+gwpehGeiyuEyI+SmluvbN0mSUBzrqt4SdL778M5DOhzrhk70Qw8kBU8F3yeEu1R0Sil3ZLTj4F3XmMsKOS0x7og9a2s/ASLGAUHcd7NBAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image2&apos; title=&apos;&apos; src=&apos;/static/ea5eeced68059fd25375b5fbb8290f34/98235/image2.png&apos; srcset=&apos;/static/ea5eeced68059fd25375b5fbb8290f34/e7570/image2.png 170w,
/static/ea5eeced68059fd25375b5fbb8290f34/f46e7/image2.png 340w,
/static/ea5eeced68059fd25375b5fbb8290f34/98235/image2.png 509w&apos; sizes=&apos;(max-width: 509px) 100vw, 509px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
기능도 커스텀 할 수 있는데, 일단 기본적인 기능을 넣어주었다. &lt;/p&gt;
&lt;p&gt;배포는 당연히 공개로 해두지 않았다. &lt;/p&gt;
&lt;p&gt;이후, 노션으로 돌아와 API와 연결된 워크스페이스를 선택하고 &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ebf883758d0060d2c1bb5cb519b74d8b/df2dd/image3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 231.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAuCAYAAAAoaDnGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFqElEQVR42pWW2VKjVRSFeQOrWhtIwpQ5JAQSkhAIM2EIczM10o1YhVZZljdeemPpvQ/hlWXpG/hYvEC26zv2Tv9JE1svVp3xX2ft4ezzj8Risafx8fFn4WsvX758Gh0d7Y1pY2o/HRt7uozHn87V3gktzY+Mx+OWTqdtbm7OstmsFQoFm52dtfn5eUskEmHu+PjYNjc3TcShrddqYa1zeGhfJZM2pf0lfX+juZHYi0+68Xi8OzU11Z2YmOiBsZSEfi6X64q4K5VdHRTGCa0tNBrdI61fJpPds3Sq+6i5kfjt9zadydmE2Kemp8PJIgntzMxMwOTkpOkAS0oNfTCtvXH2qN3S+HEmaRv5ko1M/PKXlWsN29neslarZa9evQom0q6srNjCwoLVZOLi4qJVq9XQZ9/y8rKtra2Ffm25aYV6wxLzdRtJ/PS7zVVrtrfbDpuur6+t3W7b7u5uIKxUKoHIATH7wIrIIGw2GlapLtp0qQLhH5afm7eUzJFveqZhKm0mkwmBAQSPcT6fD2A/yINiSYRVmfzzn5bOz9r62qoVSyU7ODgI6ra3t+3s7Cz0UdGQiv39fVtdXe07JIBxvmAz5do/hCkRtne2lTplOzo6CqSYfXl5Gfrr6+vWbDbDATs7O0FpH2E2Y5lc3mrtYxH++JvlSuUQraykexQB0QZEFBfgjlQq1TM5ilxh1pb2TuTDH3617GzJVhSpkkxGDdja2rKNjY1gOi1AZb+y90hLYWNXCuPlhqUzWTtU1hNFTOZj0gZiUgjz8R2+HEooPzZaG7opn70IPkEd0skzQLrU63UrFovBXEwFz5HxXUYcjeaKCHWXiVqn0wlJfHFxYaenpz1lbqanyHOEiKGtL7dEGIsFhZChplwuB1AsKBLMDTMzeggcDQhVjsLk+fl58CGpQr4B/Ig/MXVQHVZxKG6hMmUGCfGby/dS9n/Qp5AaeHt7G04jed+8eRPu7LAgOHAT+whg8GHznQ+Rz6InKQo5xCNI302mZT+gz1ovylGTHx4ebG9vL9xdVBJh8o78ZPz27dswh19RReDwOUJQyAENjzKE1DYW8CGb6eNsgGI+pl1aWgp9os/e9z6PEGIKyevliRbgQzfNzfQ9jmjUe4QMMIeTuHoEiMSm2FK2IMFPqMZEz1VMx4JeUKKJTYSR7yUfcj5w9ahkHVMdPmZvTyEliY8ICKfd3NyEawi4dlxDKo4nd9TcqNm9PCTsDHgjOImqgpk4HwX0UUpN5En4sLgOJPbY2FjIJRRBgA+pyqiiJlKxabmKpBQRHnwCuPM8A8GHmAUhH+BcTOe1Yx6VjDmAMfP4d1AlfuzzoQcFYkggoCjgBvokOOuQ4gIneNZkXyCx8SFVGrWkDSZeXV0FlRzAPP82uGYooacGwWAjPkIJeee/Il6xvf3gGR2sNmy6u7sL0cREUoe+P+peSIdV7D5C/OSpwweoIEX8+kUr87+hLyhMEEGIOQCTiSZ+9SfgPxO6Wa9fvw7X7uTkJDwH5CWBwa+e0FHVQ03GV9HiSXpAzDVEJS17/JeOXA0FdViUuSksevRQ5FWYisIt8BpJWoHngtMXFDZQvviQXOPlozJj/v39ffCrX4CPmuwbPQ+5CfT9+pHImOuV2R/1oYRekf3nksTGT/4LHP1zdd9+NCjR5I3WuFwE+Uhb4LV7h/xg2hAUNhbl/DxPp8gdGSEtJLmGQ5D0XHTCZfkpLSIqyr4KQ0XkFS2CGr5Vu6f2RDgeAHObWi/qm0k3OaFr1tbgAWjhS234Qv3Qanyt/pGwq/G+2ig46EJ4VMrtKwaLIcra+LUmz1UUpmX2gcpVR69dS5V6Q9W7KtWj2hOXeXGZFosg/g5pRf87ER4u6f+wrKAg/xvd2Y4+vOahUjTP5IZTkVyr/VabP9eeQ6Hj4J9SuEKh2otUUr/VLfsbDteB7KWNckEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image3&apos; title=&apos;&apos; src=&apos;/static/ebf883758d0060d2c1bb5cb519b74d8b/df2dd/image3.png&apos; srcset=&apos;/static/ebf883758d0060d2c1bb5cb519b74d8b/e7570/image3.png 170w,
/static/ebf883758d0060d2c1bb5cb519b74d8b/df2dd/image3.png 264w&apos; sizes=&apos;(max-width: 264px) 100vw, 264px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
오른쪽 상단의 … 를 눌러서 연결추가 를 선택한 다음, 아까 만들어준 API의 이름을 검색해 해당 API와 연결을 해주면 된다.&lt;/p&gt;
&lt;p&gt;이 부분이 UI가 달라진 부분이어서 공식 가이드를 보기 전까지 한참 헤맸던 부분이었다.&lt;/p&gt;
&lt;p&gt;이제, API와 Notion Workspace가 연결되었다!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[PRG 패턴 (Post/Redirect/Get)]]></title><description><![CDATA[정의 PRG 패턴은 웹 어플리케이션에서 폼 제출 후의 중복 제출 문제를 해결하기 위한 웹 디자인 패턴입니다. 사용자가 웹 폼을 제출한 후 (Post), 서버가 해당 요청을 처리하고 사용자를 새로운 위치로 리다이렉트 (Redirect…]]></description><link>https://sharknia.github.io/PRG-패턴-PostRedirectGet/</link><guid isPermaLink="false">https://sharknia.github.io/PRG-패턴-PostRedirectGet/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;정의&lt;/h4&gt;
&lt;p&gt;PRG 패턴은 웹 어플리케이션에서 폼 제출 후의 중복 제출 문제를 해결하기 위한 웹 디자인 패턴입니다. 사용자가 웹 폼을 제출한 후 (Post), 서버가 해당 요청을 처리하고 사용자를 새로운 위치로 리다이렉트 (Redirect) 시킵니다. 이후 사용자는 리다이렉트된 위치의 정보를 (Get) 요청하여 표시합니다.&lt;/p&gt;
&lt;h4&gt;특징&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;중복 폼 제출 방지: 사용자가 새로고침을 눌렀을 때, 같은 폼 데이터가 다시 제출되는 것을 방지합니다.&lt;/li&gt;
&lt;li&gt;향상된 사용자 경험: 사용자가 폼 제출 후 브라우저의 뒤로 가기 버튼을 사용할 때, &quot;폼 데이터 제출 확인&quot;과 같은 경고 메시지가 나타나지 않습니다.&lt;/li&gt;
&lt;li&gt;검색 엔진 최적화: 리다이렉트된 URL은 검색 엔진에 의해 색인화될 수 있기 때문에, POST 요청으로 인한 잘못된 URL 색인화를 방지합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;브라우저 호환성: 대부분의 웹 브라우저에서 지원되므로 호환성 문제가 적습니다.&lt;/li&gt;
&lt;li&gt;직관적인 URL: 리다이렉트 후의 URL은 대체로 사용자에게 직관적이며, 북마크나 공유하기에 적합합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;추가적인 서버 응답: 리다이렉트로 인해 추가적인 서버 응답이 필요하므로, 약간의 성능 저하가 발생할 수 있습니다.&lt;/li&gt;
&lt;li&gt;구현 복잡성: 일부 웹 어플리케이션 프레임워크에서는 PRG 패턴의 구현이 복잡할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;쇠퇴 이유&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;프레임워크의 발전: 많은 현대 웹 프레임워크와 라이브러리가 이 문제를 내부적으로 처리합니다.&lt;/li&gt;
&lt;li&gt;Single Page Applications (SPA): AJAX와 함께 SPA의 인기가 높아지면서 전통적인 폼 제출 방식이 적게 사용되게 되었습니다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Python venv (Windows)]]></title><description><![CDATA[venv란? Python의 표준 라이브러리에 포함된 가상 환경 모듈이다. 가상환경은 프로젝트마다 독립적인 Python…]]></description><link>https://sharknia.github.io/Python-venv-Windows/</link><guid isPermaLink="false">https://sharknia.github.io/Python-venv-Windows/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;venv란?&lt;/h4&gt;
&lt;p&gt;Python의 표준 라이브러리에 포함된 가상 환경 모듈이다. 가상환경은 프로젝트마다 독립적인 Python 환경을 생성하여 패키지 의존성을 분리하고 관리할 수 있는 기능을 제공한다. &lt;/p&gt;
&lt;p&gt;한 시스템 내에서 여러 프로젝트를 개발하거나 실행할 때 각 프로젝트별로 필요한 패키지를 격리된 환경에서 관리할 수 있다. &lt;/p&gt;
&lt;p&gt;Python 3.3부터 venv가 표준 라이브러리에 탑재되었다. &lt;/p&gt;
&lt;h4&gt;venv의 장점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;독립성&lt;/li&gt;
&lt;li&gt;의존성 분리&lt;/li&gt;
&lt;li&gt;가볍고 효율적&lt;/li&gt;
&lt;li&gt;파일 분리&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;venv를 이용한 가상환경 생성&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;가상환경을 생성할 디렉토리를 생성하고 이동한다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;가상환경 생성&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;phthon &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; venv venv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;마지막 “venv”는 가상환경 이름이다. 이렇게 하면 현재 디렉토리 하에 가상환경의 이름으로 새로운 디렉토리가 생성된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;가상환경 활성화&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;venv&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Scripts&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;activate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;첫번째 venv는 가상환경의 이름이다. 가상환경이 활성화되면, 프롬포트에서 가장 앞에 가상 환경의 이름이 나타난다. 이제부터 설치한 패키지는 해당 가상환경에만 적용이 된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;가상환경 비활성화&lt;/p&gt;
&lt;p&gt;가상환경이 활성화된 상태에서 &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;deactivate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[print와 pprint]]></title><description><![CDATA[print와 pprint는 모두 Python에서 사용되는 출력 관련 함수이다.  print 값을 터미널에 간단히 출력할 때 사용한다.  pprint pprint는 pretty print…]]></description><link>https://sharknia.github.io/print와-pprint/</link><guid isPermaLink="false">https://sharknia.github.io/print와-pprint/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;print와 pprint는 모두 Python에서 사용되는 출력 관련 함수이다. &lt;/p&gt;
&lt;h3&gt;print&lt;/h3&gt;
&lt;p&gt;값을 터미널에 간단히 출력할 때 사용한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 출력: 10 Hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;pprint&lt;/h3&gt;
&lt;p&gt;pprint는 pretty print의 약자로, 복잡한 데이터 구조를 읽기 쉽게 출력하는 데에 사용된다. 데이터 구조를 계층적으로 출력하고 들여쓰기를 적용하여 가독성을 향상시킨다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pprint

data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;John&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;age&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;city&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;New York&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
pprint&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pprint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;예를 들어 위와 같은 코드를 실행하면,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;age&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;token string&quot;&gt;&apos;city&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;New York&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;token string&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;John&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;로 출력이 된다. &lt;/p&gt;
&lt;p&gt;딕셔너리, 리스트, 중첩된 데이터 구조 등을 보기 좋게 출력해주어 디버깅이나 데이터 분석시에 유리하다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[정규화와 역정규화]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/정규화와-역정규화/</link><guid isPermaLink="false">https://sharknia.github.io/정규화와-역정규화/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;정규화&lt;/h2&gt;
&lt;p&gt;정규화는 데이터베이스 설계 과정 중에서 중복을 최소화하고 데이터의 일관성과 무결성을 유지하기 위한 기법이다. 정규화는 데이터를 더 작은 논리적 단위로 분할하고 이를 통해 중복 데이터를 제거하여 데이터베이스의 효율성과 유지보수 용이성을 향상 시킨다. &lt;/p&gt;
&lt;p&gt;정규화는 대표적으로 업데이트 이상, 삽입 이상, 삭제 이상과 같은 무제를 해결한다. &lt;/p&gt;
&lt;h4&gt;주요 정규화 단계&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;제 1정규형(1NF)&lt;/li&gt;
&lt;li&gt;제 2정규형(2NF)&lt;/li&gt;
&lt;li&gt;제 3정규형(3NF)&lt;/li&gt;
&lt;li&gt;보이스-코드 정규형(BCNF)&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;정규화의 필요성&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;데이터 중복 최소화&lt;/p&gt;
&lt;p&gt;중복 데이터는 데이터베이스 내에서 일관성 문제를 일으킨다. 중복된 데이터가 변경될 경우 모든 복사본을 일관되게 업데이트 해야 하며, 이를 놓칠경우 불일치가 발생할 수 있다. &lt;/p&gt;
&lt;p&gt;정규화는 데이터를 더 작은 단위로 분할하여 중복을 최소화 하고 이로 인한 불일치 가능성을 낮춘다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터 일관성 유지&lt;/p&gt;
&lt;p&gt;데이터를 여러 테이블에 나누고 관계를 설정함으로써 데이터 간의 의미적 관계를 명확하게 정의할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터 이상 방지&lt;/p&gt;
&lt;p&gt;삽입, 업데이트, 삭제 시 발생할 수 있는 이상 현상을 방지한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;검색 성능 개선&lt;/li&gt;
&lt;li&gt;데이터베이스 구조의 명확성&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;유지보수 용이성&lt;/p&gt;
&lt;p&gt;정규화된 데이터는 데이터베이스 변경이 필요한 경우에도 수정 작업이 해당 테이블에서만 이루어질 가능성이 높다. 이로써 수정이 다른 부분에 미치는 영향을 최소화 하고 유지보수를 용이하게 만든다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터베이스 확장성&lt;/p&gt;
&lt;p&gt;추후 DB 확장 또는 새로운 기능 추가할 때 더 유연하게 대응할 수 있는 기반이 된다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터 무결성 강화&lt;/p&gt;
&lt;p&gt;중복이 최소화 되고 일관성이 유지되면서 데이터의 무결성이 강화된다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;정규화의 단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;정규화되면 데이터의 일부가 여러 테이블에 나눠져 저장되어 테이블이 증가하므로 아래와 같은 문제점들이 발생할 수 있다. &lt;/li&gt;
&lt;li&gt;조인의 증가&lt;/li&gt;
&lt;li&gt;읽기 작업의 복잡성&lt;/li&gt;
&lt;li&gt;데이터 일관성 유지의 어려움&lt;/li&gt;
&lt;li&gt;갱신 작업의 비효율성&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;정규화시 주의해야 할 점&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;과도한 정규화&lt;/p&gt;
&lt;p&gt;너무 과도한 정규화는 복잡한 쿼리, 늘어난 조인으로 성능 저하의 원인이 될 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터베이스 디자인의 복잡성&lt;/p&gt;
&lt;p&gt;데이터가 분산되어 복잡한 조인과 서브쿼리가 늘어나면서 쿼리 작성, 유지보수가 어려워 질 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;역정규화의 필요성&lt;/p&gt;
&lt;p&gt;때로 성능 향상이나 특정 요구사항을 위해 데이터 무결성을 해칠 위험을 각오하고도 역정규화가 필요할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;역정규화&lt;/h2&gt;
&lt;p&gt;성능 향상 또는 특정 비즈니스 요구에 맞추기 위해 데이터베이스의 구조를 다시 조정하는 과정을 말한다. 정규화된 데이터를 다시 조합하여 중복 데이터를 허용하는 등의 작업이다.&lt;/p&gt;
&lt;h4&gt;역정규화가 필요한 이유&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;성능향상&lt;/p&gt;
&lt;p&gt;과도한 정규화는 여러 테이블에 데이터를 나누어 저장하므로 데이터 추출 또는 조인 시 성능 저하의 우려가 있다. 데이터를 조합하여 빠른 검색과 조인을 가능하게 하여 성능을 향상 시킬 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;복잡한 쿼리 간소화&lt;/p&gt;
&lt;p&gt;마찬가지로 과도한 정규화는 많은 조인으로 인해 쿼리문이 복잡해진다. 역정규화를 통해 쿼리문의 간소화를 노릴 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;비즈니스 요구 사항 충족&lt;/p&gt;
&lt;p&gt;보고서 생성 및 분석이나 실시간 대시보드 처럼 데이터를 실시간으로 수집하거나 집계해야 하는 경우 데이터베이스 구조를 최적화 하거나 데이터를 임의로 중복저장 하여 성능향상을 노릴 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;결론&lt;/h3&gt;
&lt;p&gt;정규화와 역정규화는 서로 장점, 단점을 역으로 공유한다. 따라서 데이터의 무결성이나 성능, 일관성 등 여러가지를 신중하게 검토하여 최적의 전략을 선택해야 한다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/DB-%ED%8A%9C%EB%8B%9D-%EA%B2%BD%ED%97%98&quot;&gt;DB 튜닝 경험&lt;/a&gt;  &lt;/p&gt;</content:encoded></item><item><title><![CDATA[트래픽 튜닝]]></title><description><![CDATA[트래픽 튜닝(traffic tuning…]]></description><link>https://sharknia.github.io/트래픽-튜닝/</link><guid isPermaLink="false">https://sharknia.github.io/트래픽-튜닝/</guid><pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;트래픽 튜닝(traffic tuning)은 네트워크 성능을 최적화하기 위한 방법 중 하나이다.&lt;/p&gt;
&lt;p&gt;트래픽 튜닝은 대부분 네트워크의 병목 현상을 최소화하고, 서비스 응답 시간을 개선하며, 사용자의 경험을 향상시키는 데 목표를 둔다. 다음은 트래픽 튜닝과 관련된 몇 가지 주요 측면과 전략이다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;로드 밸런싱 (Load Balancing)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;로드 밸런싱은 서비스의 안정성을 유지하는 핵심 요소이다. 서비스에 과부하가 걸리지 않도록 여러 서버간에 트래픽을 균등하게 분산시켜 주는 역할을 한다. 이는 서비스의 가용성을 향상시키며, 단일 서버의 과부하를 방지한다.&lt;/p&gt;
&lt;p&gt;로드 밸런서는 일반적으로 클라이언트와 서버 중간에 위치하여 요청을 전달하는 역할을 한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;로드 밸런싱의 특징 및 이점&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;고가용성/장애복구/무정지 업그레이드&lt;/p&gt;
&lt;p&gt;로드 밸런서의 도입으로 서버 중 하나에 문제가 발생해도 다른 서버가 작업을 처리하므로 서비스 중단을 최소화 가능하다. &lt;/p&gt;
&lt;p&gt;또한 특정 서버에 장애가 발생했을 때에도 로드 밸런서가 그 사실을 인지하고 자동으로 정상 작동하는 서버로 트래픽을 전환할 수 있다. &lt;/p&gt;
&lt;p&gt;또, 서버의 유지보수나 업그레이드시 서비스 중단 없이 서버를 순차적으로 점검 또는 업그레이드 할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;확장성&lt;/p&gt;
&lt;p&gt;트래픽이 늘어나면 추가 서버를 쉽게 추가하여 트래픽을 처리할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;균등한 분산&lt;/p&gt;
&lt;p&gt;서버 간의 트래픽이나 작업 부하를 균등하게 분산하여 각 서버의 효율적인 작동을 지원한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;로드 밸런싱의 주요 유형&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DNS 로드 밸런싱&lt;/p&gt;
&lt;p&gt;DNS 쿼리를 기반으로 요청을 다양한 서버 IP 주소로 리디렉션한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;레이어 4 로드 밸런싱&lt;/p&gt;
&lt;p&gt;전송 계층(TCP/UDP)에서 작동하며, IP 주소와 포트 정보를 기반으로 트래픽을 분산시킨다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;레이어 7 로드 밸런싱&lt;/p&gt;
&lt;p&gt;응용 프로그램 계층에서 작동하며 HTTP 헤더, 쿠키, URL 등의 내용을 기반으로 트래픽을 분산시킨다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;로드 밸런싱의 주의 또는 단점&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;설정의 복잡성&lt;/p&gt;
&lt;p&gt;올바르게 설정하지 않으면 문제 발생 가능&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단일 장애점&lt;/p&gt;
&lt;p&gt;로드 밸런서 자체가 단일 장애점(SPOF, Single Point Of Failure)이 될 수 있다. 이를 예방하기 위해서 고가용성 구성을 가진 여러 로드 밸런서를 사용해야 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;세션 유지 문제&lt;/p&gt;
&lt;p&gt;로드 밸런서는 상태가 없는(stateless) 방식으로 작동하므로 특정 사용자의 세션을 특정 서버에 고정 시키기 위해 추가적인 설정이 필요&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;데이터 동기화 문제&lt;/p&gt;
&lt;p&gt;여러 서버에 걸쳐 데이터가 저장된다면 이를 동기화 하는 것이 중요하다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;기타&lt;/p&gt;
&lt;p&gt;비용, 지연 시간 등이 추가로 발생할 수 있다. 또한 로드 밸런서는 시스템 중앙에 위치하므로 보안 설정 및 업데이트에 주의를 기울여야한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;데이터베이스 최적화&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;대형 서비스에서는 많은 양의 데이터가 데이터베이스에 저장되기 때문에, 데이터베이스의 성능은 서비스의 성능에 직접적인 영향을 미친다. 쿼리 최적화, 인덱싱, 캐싱 등의 방법으로 데이터베이스 응답 시간을 최적화하는 것이 중요하다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://sharknia.github.io/DB-%ED%8A%9C%EB%8B%9D-%EA%B2%BD%ED%97%98&quot;&gt;DB 튜닝 경험&lt;/a&gt;  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;캐싱 (Caching)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;많은 사용자가 동일한 정보나 페이지에 접근할 가능성이 높다. 캐싱을 통해 빈번하게 접근되는 데이터나 페이지를 빠르게 제공할 수 있으며, 네트워크 트래픽과 데이터베이스 부하를 줄일 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;데이터 압축&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;대규모 서비스에서는 데이터 전송량이 많을 수 있다. 압축을 통해 네트워크 부하를 줄이고 응답 속도를 향상시킬 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;로깅 및 모니터링&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;실시간으로 서비스의 상태를 모니터링하고, 문제가 발생할 경우 빠르게 대응하기 위해 로깅 및 모니터링 시스템의 구축이 중요하다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CDN 사용&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;이미지나 정적 파일과 같은 컨텐츠를 전세계적으로 빠르게 제공하기 위해 CDN 사용을 고려할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[Nuget 패키지 dll 추출]]></title><description><![CDATA[파일의 확장자를 으로 변경합니다. 예를 들어, 을 으로 변경합니다. ZIP 압축 해제 도구 (예: WinRAR, 7-Zip…]]></description><link>https://sharknia.github.io/Nuget-패키지-dll-추출/</link><guid isPermaLink="false">https://sharknia.github.io/Nuget-패키지-dll-추출/</guid><pubDate>Tue, 22 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.nupkg&lt;/code&gt; 파일의 확장자를 &lt;code class=&quot;language-text&quot;&gt;.zip&lt;/code&gt;으로 변경합니다. 예를 들어, &lt;code class=&quot;language-text&quot;&gt;tiktokensharp.1.0.6.nupkg&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;tiktokensharp.1.0.6.zip&lt;/code&gt;으로 변경합니다.&lt;/li&gt;
&lt;li&gt;ZIP 압축 해제 도구 (예: WinRAR, 7-Zip 등)를 사용하여 변경된 &lt;code class=&quot;language-text&quot;&gt;.zip&lt;/code&gt; 파일을 엽니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.zip&lt;/code&gt; 파일 내에서 &lt;code class=&quot;language-text&quot;&gt;lib&lt;/code&gt; 폴더나 해당하는 폴더를 찾아 &lt;code class=&quot;language-text&quot;&gt;.dll&lt;/code&gt; 파일을 찾습니다.&lt;/li&gt;
&lt;li&gt;해당 &lt;code class=&quot;language-text&quot;&gt;.dll&lt;/code&gt; 파일을 추출합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이렇게 하면 &lt;code class=&quot;language-text&quot;&gt;.nupkg&lt;/code&gt;에서 원하는 &lt;code class=&quot;language-text&quot;&gt;.dll&lt;/code&gt; 파일을 얻을 수 있습니다.&lt;/p&gt;
&lt;p&gt;이렇게 하면 의존성, 버전 호환성 등의 문제가 발생할 수 있고 NuGet 패키지 관리 기능도 사용할 수 없기 때문에 권장하지 않는 방법입니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[무료 웹 호스팅 비교]]></title><description><![CDATA[gh-pages (GitHub Pages) 설명: GitHub Pages는 GitHub…]]></description><link>https://sharknia.github.io/무료-웹-호스팅-비교/</link><guid isPermaLink="false">https://sharknia.github.io/무료-웹-호스팅-비교/</guid><pubDate>Tue, 22 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;gh-pages (GitHub Pages)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;설명&lt;/strong&gt;: GitHub Pages는 GitHub 저장소를 기반으로 정적 웹사이트를 무료로 호스팅할 수 있는 서비스입니다. 주로 프로젝트 페이지, 개인 포트폴리오, 단순한 블로그 등을 호스팅하는 데 사용됩니다. Jekyll과 같은 정적 사이트 생성 도구와 함께 사용될 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;비슷한 서비스&lt;/strong&gt;: GitLab Pages, Bitbucket Pages.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Heroku&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;설명&lt;/strong&gt;: Heroku는 클라우드 플랫폼으로 개발자들이 다양한 프로그래밍 언어로 작성된 애플리케이션을 쉽게 배포, 운영, 스케일링 할 수 있게 해줍니다. 기본적으로 무료 티어를 제공하며, 필요에 따라 리소스를 추가적으로 구매할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;비슷한 서비스&lt;/strong&gt;: Google Cloud Run, AWS Elastic Beanstalk, Microsoft Azure App Service.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Vercel&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;설명&lt;/strong&gt;: Vercel은 주로 프론트엔드와 서버리스 함수를 위한 배포 및 호스팅 플랫폼입니다. Next.js, Gatsby와 같은 프론트엔드 프레임워크에 특화되어 있지만, 다른 프로젝트에도 사용될 수 있습니다. 푸시를 할 때마다 자동으로 배포되는 Continuous Deployment를 지원합니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;비슷한 서비스&lt;/strong&gt;: Netlify, Surge.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Vercel, Netlify, Surge에 대해 더 알아보자.&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Vercel&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Next.js의 개발팀에 의해 만들어진 서비스로, 특히 Next.js와의 통합이 매우 간편함.&lt;/li&gt;
&lt;li&gt;서버리스 함수의 지원.&lt;/li&gt;
&lt;li&gt;자동화된 Continuous Deployment (CD).&lt;/li&gt;
&lt;li&gt;무료 플랜과 함께 커스텀 도메인 연결 지원.&lt;/li&gt;
&lt;li&gt;최적의 사용 사례: Next.js를 사용한 프로젝트, React 프로젝트, 서버리스 함수가 필요한 프로젝트.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Netlify&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;다양한 정적 사이트 생성기와의 통합 (Gatsby, Hugo, Jekyll 등).&lt;/li&gt;
&lt;li&gt;서버리스 함수 지원.&lt;/li&gt;
&lt;li&gt;자동화된 Continuous Deployment (CD)와 Git 리포지토리 연동.&lt;/li&gt;
&lt;li&gt;Netlify Identity, Netlify CMS 등의 추가 기능을 제공.&lt;/li&gt;
&lt;li&gt;무료 플랜에도 커스텀 도메인 연결 지원.&lt;/li&gt;
&lt;li&gt;분할 A/B 테스팅, 인증 및 더 많은 기능 제공.&lt;/li&gt;
&lt;li&gt;최적의 사용 사례: 다양한 정적 사이트 생성 도구를 사용하는 프로젝트, 서버리스 함수가 필요한 프로젝트, 웹사이트에 추가 기능이 필요한 경우.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Surge&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;매우 간단하고 빠른 정적 웹사이트 배포.&lt;/li&gt;
&lt;li&gt;CLI를 통한 간단한 배포 경험.&lt;/li&gt;
&lt;li&gt;무료 플랜에서 커스텀 도메인 연결 가능.&lt;/li&gt;
&lt;li&gt;HTTPS 자동 지원.&lt;/li&gt;
&lt;li&gt;최적의 사용 사례: 빠르게 정적 사이트를 배포하고자 하는 프로젝트.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;요약&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Vercel은 특히 Next.js와 함께 사용하기에 최적화된 서비스입니다.&lt;/li&gt;
&lt;li&gt;Netlify는 다양한 정적 사이트 생성 도구와의 호환성과 다양한 추가 기능을 통해 풍부한 개발 경험을 제공합니다.&lt;/li&gt;
&lt;li&gt;Surge는 정적 웹사이트를 빠르고 간단하게 배포하는데 초점을 맞춘 서비스입니다.
각 프로젝트의 요구 사항에 따라 적합한 플랫폼을 선택할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[웹 사이트 프로젝트 vs 웹 응용 프로그램 프로젝트]]></title><description><![CDATA[웹 사이트 프로젝트 특징 웹 사이트 프로젝트는 파일 시스템을 기반으로 하는 프로젝트 유형입니다. 웹 애플리케이션의 파일들이 프로젝트 디렉토리 내에 그대로 위치하며, ASP.NET…]]></description><link>https://sharknia.github.io/웹-사이트-프로젝트-vs-웹-응용-프로그램-프로젝트/</link><guid isPermaLink="false">https://sharknia.github.io/웹-사이트-프로젝트-vs-웹-응용-프로그램-프로젝트/</guid><pubDate>Mon, 21 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;웹 사이트 프로젝트&lt;/h2&gt;
&lt;h3&gt;특징&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;웹 사이트 프로젝트는 파일 시스템을 기반으로 하는 프로젝트 유형입니다. 웹 애플리케이션의 파일들이 프로젝트 디렉토리 내에 그대로 위치하며, &lt;a href=&quot;http://asp.net/&quot;&gt;ASP.NET&lt;/a&gt; 컴파일러에 의해 실시간으로 컴파일됩니다.&lt;/li&gt;
&lt;li&gt;프로젝트 파일이 없고, 각 파일은 개별적으로 관리됩니다. 이로 인해 각 파일의 수정이 간단하며, 특히 작은 프로젝트나 신속한 개발에 유리합니다.&lt;/li&gt;
&lt;li&gt;런타임 시 컴파일되므로 변경된 파일만 다시 컴파일되고 재시작하지 않아도 됩니다.&lt;/li&gt;
&lt;li&gt;소스 코드 파일이 웹 서버에 그대로 배포되므로, 보안 측면에서 주의가 필요합니다.&lt;/li&gt;
&lt;li&gt;개발 및 디버깅이 상대적으로 더 간단합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;장단점&lt;/h3&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;신속한 개발과 테스트가 가능합니다.&lt;/li&gt;
&lt;li&gt;작은 규모의 프로젝트나 간단한 웹 사이트에 적합합니다.&lt;/li&gt;
&lt;li&gt;파일 단위로 변경 및 배포가 가능하여 유연성이 높습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;대규모 프로젝트에서는 파일의 분산 관리 및 성능 문제가 발생할 수 있습니다.&lt;/li&gt;
&lt;li&gt;보안 취약성이 있을 수 있으며, 코드를 직접 노출시키기 때문에 보안에 더욱 신경을 써야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;웹 응용 프로그램 프로젝트&lt;/h2&gt;
&lt;h3&gt;특징&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;웹 응용 프로그램 프로젝트는 Visual Studio 솔루션 파일에 의해 관리되며, 컴파일된 어셈블리로 배포됩니다.&lt;/li&gt;
&lt;li&gt;컴파일된 어셈블리 파일은 웹 서버에 배치되므로, 소스 코드가 직접 노출되지 않습니다.&lt;/li&gt;
&lt;li&gt;코드 비하인드 파일과 레이어 분리가 쉽게 가능하며, 따라서 대규모 및 복잡한 프로젝트에 적합합니다.&lt;/li&gt;
&lt;li&gt;런타임 이전에 컴파일되므로, 타입 오류 등을 컴파일 단계에서 미리 확인할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;장단점&lt;/h3&gt;
&lt;h4&gt;장점:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;대규모 및 복잡한 프로젝트에 적합하며, 레이어 구조와 코드 분리를 지원하여 유지 보수가 용이합니다.&lt;/li&gt;
&lt;li&gt;컴파일된 어셈블리의 배포로 인해 보안 측면에서 더욱 안전합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;컴파일 단계가 추가되므로 개발 및 디버깅이 웹 사이트 프로젝트에 비해 상대적으로 복잡할 수 있습니다.&lt;/li&gt;
&lt;li&gt;프로젝트 설정이 복잡하거나 변경되어야 할 때 번거로울 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[MORETHAN-LOG 수정]]></title><description><![CDATA[아주 마음에 드는 오픈소스로, 다만 내 취향에 맞게 짜잘짜잘 임의로 몇 가지 부분을 수정했다.  Tags 정렬 등록한 태그들이 블로그 좌측에 나열되는데, 이를 이름 순서대로 나오게 정렬했다.  자동썸네일 기능 테스트 src\routes\Detail…]]></description><link>https://sharknia.github.io/MORETHAN-LOG-수정/</link><guid isPermaLink="false">https://sharknia.github.io/MORETHAN-LOG-수정/</guid><pubDate>Sun, 20 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;아주 마음에 드는 오픈소스로, 다만 내 취향에 맞게 짜잘짜잘 임의로 몇 가지 부분을 수정했다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Tags 정렬&lt;/p&gt;
&lt;p&gt;등록한 태그들이 블로그 좌측에 나열되는데, 이를 이름 순서대로 나오게 정렬했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// itemObj를 item name으로 정렬&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sortedItemObj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;entries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;itemObj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;localeCompare&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;acc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; val&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      acc&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; val
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; acc
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;itemName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; sortedItemObj&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;자동썸네일 기능 테스트&lt;/p&gt;
&lt;p&gt;src\routes\Detail\PostDetail\PostHeader.tsx 에서 썸네일을 가져오고 있고, &lt;/p&gt;
&lt;p&gt;src\pages[slug].tsx 에서 ogImageGenerateURL을 이용한 부분이 있다. &lt;/p&gt;
&lt;p&gt;다만 ogImageGenerateURL을 이용한 부분은 meta에만 적용되고 있고, 자동 썸네일 용 &lt;a href=&quot;https://og-image-korean.vercel.app/&quot;&gt;https://og-image-korean.vercel.app&lt;/a&gt; 는 만약 사용을 위해서라면 내 이미지를 활용한것으로 수정해야 할 것 같다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[NestJS 설치]]></title><description><![CDATA[모 회사 과제 때문에 NestJS를 설치해 볼 일이 생겨 기록해둔다.  Node.js 설치 NestJS는 Node.js를 기반으로 한다. Node.js에서 맞는 버전을 설치한다.  NestJS 프로젝트 생성 Node.js에 npm…]]></description><link>https://sharknia.github.io/NestJS-설치/</link><guid isPermaLink="false">https://sharknia.github.io/NestJS-설치/</guid><pubDate>Sun, 20 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;모 회사 과제 때문에 NestJS를 설치해 볼 일이 생겨 기록해둔다. &lt;/p&gt;
&lt;h4&gt;Node.js 설치&lt;/h4&gt;
&lt;p&gt;NestJS는 Node.js를 기반으로 한다. &lt;a href=&quot;https://nodejs.org/ko/download&quot;&gt;Node.js&lt;/a&gt;에서 맞는 버전을 설치한다. &lt;/p&gt;
&lt;h4&gt;NestJS 프로젝트 생성&lt;/h4&gt;
&lt;p&gt;Node.js에 npm이 포함되어있다. NestJS 서버를 구성하기 위해서는 @nestjs/cli 를 설치해야 한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; i &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; @nestjs/cli&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;원하는 디렉토리로 이동해서 프로젝트를 초기화한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;nest new &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;project-Name&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;project-Name&gt; 에는 원하는 프로젝트 이름을 입력한다. 패키지 매니저를 선택할 수 있는데, npm을 선택했다. &lt;/p&gt;
&lt;h4&gt;NestJS 프로젝트 구동&lt;/h4&gt;
&lt;p&gt;npm run start 명령어로 구동할 수 있지만, &lt;/p&gt;
&lt;p&gt;NestJS에는 내부적으로 내부적으로 &lt;a href=&quot;https://webpack.js.org/&quot;&gt;&lt;strong&gt;webpack&lt;/strong&gt;&lt;/a&gt;과 함께 작동하는 &lt;a href=&quot;https://docs.nestjs.com/cli/overview&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;@nestjs/cli&lt;/code&gt;&lt;/a&gt;를 제공한다. &lt;/p&gt;
&lt;p&gt;이 CLI 도구는 소스 코드의 변경을 감지하고 자동으로 애플리케이션을 재시작하는 기능을 포함하고 있다. &lt;/p&gt;
&lt;p&gt;개발 모드로 애플리케이션을 실행하려면 다음 명령어를 사용하면 된다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; run start:dev&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 localhost:3000 에서 서버가 실행되었음을 확인할 수 있다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[NestJS의 디렉토리 구조]]></title><description><![CDATA[NestJS는 MVC 패턴을 지원하지만, 전통적인 Express.js 스타일의 MVC 구조와는 약간 차이가 있다.  NestJS의 기본적인 디렉토리 구조는 다음과 같다.  NestJS…]]></description><link>https://sharknia.github.io/NestJS의-디렉토리-구조/</link><guid isPermaLink="false">https://sharknia.github.io/NestJS의-디렉토리-구조/</guid><pubDate>Sun, 20 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;NestJS는 MVC 패턴을 지원하지만, 전통적인 Express.js 스타일의 MVC 구조와는 약간 차이가 있다. &lt;/p&gt;
&lt;p&gt;NestJS의 기본적인 디렉토리 구조는 다음과 같다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;lua&quot;&gt;&lt;pre class=&quot;language-lua&quot;&gt;&lt;code class=&quot;language-lua&quot;&gt;src&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- app.module.ts         // 앱의 주 모듈&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- main.ts               // 앱의 진입점&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- controllers/          // 컨트롤러 폴더&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- app.controller.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- services/             // 서비스 폴더&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- app.service.ts&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;NestJS에서는 각 기능별로 (예: 사용자, 포스트, 댓글 등) 모듈을 분리하는 것을 권장한다. 따라서 각 기능별로 모듈을 생성하고, 해당 모듈 내에서 MVC 구조를 구성하는 것이 더 일반적이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;lua&quot;&gt;&lt;pre class=&quot;language-lua&quot;&gt;&lt;code class=&quot;language-lua&quot;&gt;src&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- app.module.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- main.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- user/&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- user.module.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- user.controller.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- user.service.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- user.model.ts (또는 user.entity.ts)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- post/&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- post.module.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- post.controller.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- post.service.ts&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;-- post.model.ts (또는 post.entity.ts)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;MVC 패턴과의 비교&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;NestJS의 장점:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;모듈화: NestJS는 기능별로 코드를 모듈로 분리하고 관리하도록 설계되었다. 이로 인해 각 기능이 독립적으로 개발되고 테스트될 수 있으며, 코드 재사용성도 향상된다.&lt;/li&gt;
&lt;li&gt;의존성 주입: NestJS는 내장된 의존성 주입 컨테이너를 제공하므로, 코드의 결합도를 낮추고 유닛 테스트를 쉽게 할 수 있다.&lt;/li&gt;
&lt;li&gt;타입 안전성: TypeScript를 기본 언어로 사용하기 때문에, 타입 검사와 관련된 오류를 컴파일 시점에 발견할 수 있다.&lt;/li&gt;
&lt;li&gt;데코레이터 기반: 데코레이터를 사용하여 메타데이터를 기반으로 하는 다양한 기능을 쉽게 추가할 수 있다.&lt;/li&gt;
&lt;li&gt;플랫폼 독립성: NestJS는 기본적으로 Express.js를 사용하지만, Fastify와 같은 다른 HTTP 서버 라이브러리로 쉽게 전환할 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;NestJS의 단점:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;학습 곡선: NestJS에는 다양한 개념과 기능이 있으므로 초기에 학습하기가 다소 어려울 수 있다.&lt;/li&gt;
&lt;li&gt;추가적인 추상화: 모듈화와 의존성 주입과 같은 기능들은 유용하지만, 간단한 애플리케이션에서는 오버헤드로 느껴질 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MVC 패턴의 장점:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;간단함: 전통적인 MVC 패턴은 많은 웹 개발자들에게 잘 알려져 있으므로 학습 곡선이 낮다.&lt;/li&gt;
&lt;li&gt;직관성: 모델, 뷰, 컨트롤러의 구조는 웹 애플리케이션의 데이터 흐름을 이해하기 쉽다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MVC 패턴의 단점:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;확장성: 애플리케이션의 복잡도가 증가하면 MVC 구조만으로는 코드의 복잡성을 관리하기 어려울 수 있다.&lt;/li&gt;
&lt;li&gt;타이트 커플링: 모델, 뷰, 컨트롤러 간에 타이트 커플링이 발생할 수 있어, 변경 사항이 여러 컴포넌트에 영향을 줄 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[var와 let,const]]></title><description><![CDATA[var와 let, 그리고 const는 JavaScript에서 변수를 선언할 때 사용되는 키워드이다. 그러나 둘 사이엔 중요한 차이점들이 있으며, 이를 명확히 이해하고 사용해야 한다.  let과 const는 ES6에서 도입된 키워드로, ES…]]></description><link>https://sharknia.github.io/var와-letconst/</link><guid isPermaLink="false">https://sharknia.github.io/var와-letconst/</guid><pubDate>Sat, 19 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;var와 let, 그리고 const는 JavaScript에서 변수를 선언할 때 사용되는 키워드이다. 그러나 둘 사이엔 중요한 차이점들이 있으며, 이를 명확히 이해하고 사용해야 한다. &lt;/p&gt;
&lt;p&gt;let과 const는 ES6에서 도입된 키워드로, ES6 이전에 변수를 선언하는 유일한 방법은 var 사용 뿐이었다. &lt;/p&gt;
&lt;p&gt;var는 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;블록범위를 지원하지 않는다. &lt;/li&gt;
&lt;li&gt;Hoisting되어 해당 범위의 맨 위로 이동하게 되어 변수 선언 전에 변수를 사용해도 오류가 발생하지 않는다. &lt;/li&gt;
&lt;li&gt;동일한 범위 내에서 같은 이름의 변수를 여러 번 선언할 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이러한 문제는 개발자가 의도하지 않은 오류를 발생시킬 가능성이 높았기 때문에 ES6에서 let과 const이 등장하게 되었다. &lt;/p&gt;
&lt;p&gt;let과 const는 var와 비교해서 아래와 같은 특성을 가진다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Scope&lt;/p&gt;
&lt;p&gt;블록범위를 지원한다. 가장 가까운 중괄호 내에서만 변수가 유효하다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hoisting&lt;/p&gt;
&lt;p&gt;선언 자체는 호이스팅 되지만, 선언 전에 접근하려면 오류가 발생한다. 이를 일시적 죽은 영역(Temporal Dead Zone, TDZ)이라고 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;재선언&lt;/p&gt;
&lt;p&gt;동일한 범위 내에서 변수를 재선언 할 수 없다. &lt;/p&gt;
&lt;p&gt;다만, let은 재할당이 가능하지만 const는 재할당도 할 수 없다. (상수 선언)&lt;/p&gt;
&lt;p&gt;따라서 let은 초기 선언 시 초기 값을 제공하지 않을 수 있지만, const는 초기 선언시에 반드시 초기값을 제공해야 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;언뜻 보면 마구 쓰기에 var 선언이 더 편하다고 생각할 수 있다. 하지만 인간은 늘 실수를 하기 때문에, 특히 코드가 길어지고 복잡해질수록 이런 제한 조건이 더욱 필요해지는 것 같다. &lt;/p&gt;
&lt;p&gt;원래 브라우저에서만 쓰이려고 태어난 JavaScript 언어가 브라우저의 역할이 늘어나고, 심지어 단순히 브라우저에서만 쓰이는 걸 넘어서 다양한 플랫폼과 환경에서 더 많은 역할을 하게 되면서 이런 것들이 생기는 것 같다. 이러한 맥락에서 ES6 → TypeScript가 생긴게 아닐까?&lt;/p&gt;</content:encoded></item><item><title><![CDATA[DB 튜닝 경험]]></title><description><![CDATA[DB  처음에는 단순히 코드 짜는것에만 집중했었는데, 어느 순간 단순한 에러 고침 또는 간단한 로직 수정을 넘어서 더 큰 의미의 유지보수 또는 고도화를 겪으면서 DB…]]></description><link>https://sharknia.github.io/DB-튜닝-경험/</link><guid isPermaLink="false">https://sharknia.github.io/DB-튜닝-경험/</guid><pubDate>Fri, 18 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;DB &lt;/p&gt;
&lt;p&gt;처음에는 단순히 코드 짜는것에만 집중했었는데, 어느 순간 단순한 에러 고침 또는 간단한 로직 수정을 넘어서 더 큰 의미의 유지보수 또는 고도화를 겪으면서 DB 튜닝이 속도에 큰 영향을 미침을 인지하고, 더 빠른 페이지를 만드는것에 집중했다.&lt;/p&gt;
&lt;p&gt;그때 아래와 같은 것들을 시도하였다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;인덱싱 : 자주 사용하는, 자주 불려오는 테이블들, 자주 사용되는 컬럼에 대해 인덱싱&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;인덱싱이란?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;데이터를 빠르게 조회하기 위한 자료구조(B-tree 등)&lt;/li&gt;
&lt;li&gt;색인과 유사한 개념&lt;/li&gt;
&lt;li&gt;특정행을 찾기 위한 경로를 미리 만들어 두는 것과 같아 검색 시간을 크게 줄일 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;인덱싱 사용할 때 주의할 점&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;추가적인 공간을 사용하므로 무작정 늘려서는 안된다. 가장 자주 조회되는 &lt;/li&gt;
&lt;li&gt;복합 인덱스 생성시에는 가장 많이 쿼리되는 열을 인덱스의 앞부분에 둔다. &lt;/li&gt;
&lt;li&gt;인덱스는 쓰기 연산(Insert, Update, Delete)시에 유지 비용이 발생(쉽게 생각하면 색인을 새로 만들어야 하므로)하므로 연산이 빈번하게 일어나는 테이블에 대해 많은 인덱스를 만들면 성능 저하가 일어날 수 있음 &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;쿼리 최적화 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;불필요한 컬럼 제거(select *(스타) 지양)&lt;/li&gt;
&lt;li&gt;서브쿼리 대신 조인 사용&lt;/li&gt;
&lt;li&gt;데이터 타입을 최적화 하기 위해 노력(적절한 크기 지정, 숫자형이나 날짜형 형식을 주의해서 용도에 맞게 사용, 예를 들면 idx로 사용할건데 또는 학번에는 숫자만 사용되는데 varchar형식으로 선언되는 경우도 있었는데 그런 경우를 피하기 위해 노력)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;정규화와 반정규화&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;회사의 테이블들이 중복된 데이터들이 저장되어있는 경우가 많았다. 따라서 데이터의 무결성을 해치거나 해치지 않더라도 유지보수에 어려움을 야기하는 경우가 자주 발생 → 이런것들을 최대한 피하고 싶어서 직접 설계한 스키마는 이런것들을 최대한 피하고자 했다. 중복 데이터를 피하기 위한 정규화를 진행.&lt;/li&gt;
&lt;li&gt;정규화를 빈틈없이 했더니 테이블이 많이 쪼개지고, 중복된 데이터들이 하나도 없어서 조인을 여러 테이블을 해야 하는 경우가 많았다. 정규화를 한 경우에는 반드시 자체 협업툴에 스키마에 대한 문서를 남겼다(정규화가 덜 된 테이블에 비해 상대적으로 알아보기 어려우므로).  또한, 정규화된 테이블들을 이쁘게 조인해서 뷰로 만들어서 문서로 함께 제공했다. &lt;/li&gt;
&lt;li&gt;소수의 데이터만 필요한데 조인을 너무 많이 해야 하는 경우나, 특정 집계 결과가 필요한 경우 또는 학생의 역량별 성적같이 조회가 많은데 잦은 계산이 필요한 경우 에는 반정규화를 하기도 했다. 반정규화를 한 경우에는, 테이블 관리(update, insert, edit등)하는 코드를 가능한 한 한군데로 모으고 자체 협업툴에 문서를 자세히 적어서 다른 개발자가 유지보수 시 최대한 알 수 있도록 했다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[MORETHAN-LOG 설치]]></title><description><![CDATA[개발자로서 어엿한 블로그 하나는 있어야 하지 않을까, 생각을 항상 하곤 했다.   하지만 블로그라는게 여간 귀찮은 일이 아니다.  공부한 내용을 노션에 적어두기 시작한지 좀 됐는데, 티스토리나 velog…]]></description><link>https://sharknia.github.io/MORETHAN-LOG-설치/</link><guid isPermaLink="false">https://sharknia.github.io/MORETHAN-LOG-설치/</guid><pubDate>Fri, 18 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;개발자로서 어엿한 블로그 하나는 있어야 하지 않을까, 생각을 항상 하곤 했다.  &lt;/p&gt;
&lt;p&gt;하지만 블로그라는게 여간 귀찮은 일이 아니다.  공부한 내용을 노션에 적어두기 시작한지 좀 됐는데, 티스토리나 velog나 여러 방법을 시도한적이 있었지만 노션에 적은 내용을 거기로 옮기는게 얼마나 귀찮은지, 시작은 해도 도무지 꾸준히 이어할 수가 없었다. &lt;/p&gt;
&lt;p&gt;그냥 언젠가 노션에 쓰기만 하면 블로그가 되는게 없나 그냥 가끔 검색만 하는 정도였는데, 어느샌가 나온 것이다. 그런 천지개벽할 물건이. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c03971264fd9083e9b65a4a3d1818362/7ca0c/image1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 19.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAxUlEQVR42n2QzQ6CMBCEOfuPCigqxbYU2lIhYPT9n2zcrolHD5tvsk0nM5vMzwHGT2jcCOMGqC5AdwNsmJGXNRabI1a7/O8stxlznRZIpDa4yY5MHhDKoiItjWeerhL7/Io0uzD3xVcfioqZHkscaJ+da9bRNCmFYbM498b/0t3JtLGkHzM0sQsT+vGFtp/gxzeUCdRopD89WmpY3hRWlDQ5V5qXqg1ERykdm9faQ2jHjMaS3iM1UWgLIS3tek4ezxLrxsofMH5tp9NAXXwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image1&apos; title=&apos;&apos; src=&apos;/static/c03971264fd9083e9b65a4a3d1818362/7ca0c/image1.png&apos; srcset=&apos;/static/c03971264fd9083e9b65a4a3d1818362/e7570/image1.png 170w,
/static/c03971264fd9083e9b65a4a3d1818362/f46e7/image1.png 340w,
/static/c03971264fd9083e9b65a4a3d1818362/7ca0c/image1.png 569w&apos; sizes=&apos;(max-width: 569px) 100vw, 569px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
커밋할 필요도, 포스트 할 필요도 없다. 단지 노션에 글을 적으면 바로 포스팅 된다. &lt;/p&gt;
&lt;p&gt;게다가 Readme에 설치방법이 10단계로 스크린샷까지 동봉되어서 너무나 친절하게 나와있다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/morethanmin/morethan-log#readme&quot;&gt;https://github.com/morethanmin/morethan-log#readme&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;블로그로 대성하겠다, 이런 마음가짐은 없기 때문에 심플한 구성과 간단한 기능이 너무 마음에 들었다. 누구나 따라할 수 있을 만큼 쉽게 되어있기 때문에 그대로 그대로 따라하는데,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;Failed to compile&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;src&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;routes&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Detail&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;PostDetail&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;CommentBox&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Utterances&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tsx&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;
Type error&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Type &lt;span class=&quot;token string&quot;&gt;&apos;{ repo: string | undefined; &quot;issue-term&quot;: string; label: string; }&apos;&lt;/span&gt; is not assignable to type &lt;span class=&quot;token string&quot;&gt;&apos;{ [key: string]: string; }&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  Property &lt;span class=&quot;token string&quot;&gt;&apos;repo&apos;&lt;/span&gt; is incompatible &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; index signature&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    Type &lt;span class=&quot;token string&quot;&gt;&apos;string | undefined&apos;&lt;/span&gt; is not assignable to type &lt;span class=&quot;token string&quot;&gt;&apos;string&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
      Type &lt;span class=&quot;token string&quot;&gt;&apos;undefined&apos;&lt;/span&gt; is not assignable to type &lt;span class=&quot;token string&quot;&gt;&apos;string&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;     script&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;issue-term&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; issueTerm&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;27&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;     script&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;theme&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;28&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; string&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; string &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CONFIG&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;utterances&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config
     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;           &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;29&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;     Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;       script&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; config&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;31&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
error Command failed &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; exit code &lt;span class=&quot;token number&quot;&gt;1.&lt;/span&gt;
info Visit https&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;yarnpkg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;com&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;en&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;docs&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cli&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;run &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; documentation about &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt; command&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token literal-property property&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Command &lt;span class=&quot;token string&quot;&gt;&quot;yarn run build&quot;&lt;/span&gt; exited &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;글쎄 대체 나만 Deploy가 안되는것이다. &lt;/p&gt;
&lt;p&gt;ISSUE에 나와 같은 오류를 겪은 외국인이 한 명 더 있었는데, 다른 플랫폼으로 갈아탄 모양인지 해결방법은 적혀있지 않았다. &lt;/p&gt;
&lt;p&gt;타입스크립트, 리액트는 처음이었기 때문에 정확히 알 수 없었는데, site.config.js 의 utterances-config 의 값을 가져올 때 오류가 나는 것이라고 짐작을 할 수 있었기 때문에 해당 부분을 챗지피티의 도움을 받아 코드를 수정했다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot;&gt;&lt;pre class=&quot;language-typescript&quot;&gt;&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; config&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;entries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CONFIG&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;utterances&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;acc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;acc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 하여, 무사히 deploy를 마치고 블로그 포스팅에 성공한것이다. &lt;/p&gt;
&lt;p&gt;문제는 여기서 끝나지 않았는데 노션에 글을 써도 도무지 블로그에 새로운 글이 포스팅되지 않았다. &lt;/p&gt;
&lt;p&gt;이것 때문에 잠도 못자고 설쳐가면서 새벽에 새로고침을 해보기도 했는데 자고 일어나도 되어있지 않았다. &lt;/p&gt;
&lt;p&gt;결론부터 이야기하자면, 아무것도 오류는 아니었다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://vercel.com/docs/functions/serverless-functions&quot;&gt;https://vercel.com/docs/functions/serverless-functions&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;vercel의 Serverless Functions 기능은 모든 plan에서 이용가능하며, 이 기능을 이용해서 Notion API를 활용해서 글 내용을 불러오도록 되어있었다. &lt;/p&gt;
&lt;p&gt;site.config.js를 확인하면 revalidateTime 변수가 있는데 처음에는 이 값이 42시간(!)으로 설정되어있었으므로, 이를 임의로 1시간으로 수정해주었다. &lt;/p&gt;
&lt;p&gt;성격이 급해서 1시간 단위로 갱신되게 해두었는데, 지금 와서 생각해보면 굳이 1시간일 필요도 없다는 생각이 든다. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[RDB(관계형 데이터베이스) + RDBMS]]></title><description><![CDATA[RDB(관계형 데이터베이스)란? RDB(Relational Database) Oracle, MySQL 둘 다 관계형 데이터베이스이다.  모든 데이터를…]]></description><link>https://sharknia.github.io/RDB관계형-데이터베이스-RDBMS/</link><guid isPermaLink="false">https://sharknia.github.io/RDB관계형-데이터베이스-RDBMS/</guid><pubDate>Fri, 18 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;RDB(관계형 데이터베이스)란?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RDB(Relational Database)&lt;/li&gt;
&lt;li&gt;Oracle, MySQL 둘 다 관계형 데이터베이스이다. &lt;/li&gt;
&lt;li&gt;모든 데이터를 2차원의 테이블 형태로 표현한다. &lt;/li&gt;
&lt;li&gt;데이터의 독립성이 높고 고수준의 데이터 조작 언어를 사용하여 결합, 제약, 투영등의 관계 조작에 의해 비약적으로 표현 능력을 높일 수 있다. &lt;/li&gt;
&lt;li&gt;관계 조작에 의해 자유롭게 구조를 변경할 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RDBMS란?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;RDBMS(Relational Database Management System)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;R&lt;/p&gt;
&lt;p&gt;관계형은 DBMS의 특정한 종류를 의미하고, 여러개의 테이블을 조합해 원하는 데이터를 찾아올 수 있게한다. 보통 한 개의 테이블로 답을 얻을 수 없는 상황에서 이 관계성을 사용해 더 복잡한 요구를 실현할 수 있다. &lt;/p&gt;
&lt;p&gt;관계형을 지원하기 위해 트랜잭션, ACID 등의 개념이 도입되었다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DB&lt;/p&gt;
&lt;p&gt;일종의 저장소(Storage)&lt;/p&gt;
&lt;p&gt;정보를 단순하고 규칙적인 모양새로 구성한 저장소&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MS&lt;/p&gt;
&lt;p&gt;관리 시스템은은 레코드들을 삽입, 탐색, 수정, 삭제 할 수 있도록 해주는 소프트웨어를 지칭&lt;/p&gt;
&lt;p&gt;데이터를 처리할 수 있는 기능을 의미함&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;관계형 데이터베이스를 생성하고 수정/관리할 수 있는 소프트웨어&lt;/li&gt;
&lt;li&gt;모든 데이터를 2차원 테이블로 표현&lt;/li&gt;
&lt;li&gt;테이블은 Row, Column으로 이루어진 기본 데이터 저장 단위&lt;/li&gt;
&lt;li&gt;상호 관련성을 가진 테이블의 집합&lt;/li&gt;
&lt;li&gt;만들거나 이용하기도 비교적 쉽지만, 확장이 가장 용이함&lt;/li&gt;
&lt;li&gt;데이터베이스의 설계도를 ER(Entity Relationship) 모델로 나타낼 수 있다. &lt;/li&gt;
&lt;li&gt;ER모델에 따라 데이터베이스가 만들어지며, 데이터베이스는 하나 이상의 테이블로 구성된다. &lt;/li&gt;
&lt;li&gt;ER 모델에서 엔티티를 기반으로 테이블이 만들어진다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JOIN&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;INNER JOIN&lt;/p&gt;
&lt;p&gt;교집합&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OUTER JOIN&lt;/p&gt;
&lt;p&gt;특정 테이블 기준으로 데이터를 보여줌&lt;/p&gt;
&lt;p&gt;ex) Left Outer Join : 왼쪽 테이블 A의 모든 데이터와 A와 B 테이블의 중복 데이터가 검색됨&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[NestJS 소개]]></title><description><![CDATA[Nest.js란? Node.js 서버측 애플리케이션을 구축하기 위한 프레임워크 TypeScript 기반으로 구축되어 완벽하게 지원 Express를 기본으로 채택하고 그 위에 여러 기능을 미리 구현한 것이 NestJS Nest.js…]]></description><link>https://sharknia.github.io/NestJS-소개/</link><guid isPermaLink="false">https://sharknia.github.io/NestJS-소개/</guid><pubDate>Wed, 25 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Nest.js란?&lt;/p&gt;
&lt;p&gt;Node.js 서버측 애플리케이션을 구축하기 위한 프레임워크&lt;/p&gt;
&lt;p&gt;TypeScript 기반으로 구축되어 완벽하게 지원&lt;/p&gt;
&lt;p&gt;Express를 기본으로 채택하고 그 위에 여러 기능을 미리 구현한 것이 NestJS&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nest.js의 특징&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;확장 가능하며 유지 관리가 쉬운 애플리케이션을 개발할 수 있다&lt;/li&gt;
&lt;li&gt;TypeScript, OOP, FP, FRP 요소의 결합&lt;/li&gt;
&lt;li&gt;타입스크립트 적극 도입&lt;/li&gt;
&lt;li&gt;모듈로 감싸는 형태로 테스트 코드의 작성이 용이함&lt;/li&gt;
&lt;li&gt;모듈을 사용하여 확장이 용이함&lt;/li&gt;
&lt;li&gt;스프링과 유사한 경험을 제공한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Express&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Express 특징&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;전 세계 node.js 프레임워크 1위, 개발 규칙이 강제되어 코드 및 구조의 통일성이 향상됨&lt;/li&gt;
&lt;li&gt;레퍼런스가 많다&lt;/li&gt;
&lt;li&gt;구조에 대한 자유도가 높다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;차이점&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NestJS는 타입스크립트를 적극 채용하여 json 파일을 만들고 세팅하는 과정이 복잡하지 않다. &lt;/li&gt;
&lt;li&gt;NestJS는 아키텍쳐 정의가 프레임워크에서 제공되므로 각 개발자들의 아키텍쳐가 통일되어있다. (장점이자 단점)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;라우팅의 차이&lt;/p&gt;
&lt;p&gt;Express는 라우팅 할 때 app.use 처럼 등록해서 사용하지만 NestJS는 모듈별로 나누어서 라우팅한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;컨트롤러&lt;/p&gt;
&lt;p&gt;NestJS는 클래스별로 컨트롤러에서 메소드에 데코레이터를 사용한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서비스&lt;/p&gt;
&lt;p&gt;NestJS는 create 함수 인자로 인터페이스로 정한 값들이 들어오고 return 타입을 공통 coreOutput이라는 인터페이스로 정한 ok, message로 리턴한다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[JavaScript 클로저]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/JavaScript-클로저/</link><guid isPermaLink="false">https://sharknia.github.io/JavaScript-클로저/</guid><pubDate>Sat, 21 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;클로저란?&lt;/p&gt;
&lt;p&gt;자신을 포함하고 있는 외부함수보다 내부함수가 더 오래 유지되는 경우, 외부 함수 밖에서 내부함수가 호출되더라도 외부함수의 지역 변수에 접근할 수 있는데 이러한 함수를 클로저라고 부른다. &lt;/p&gt;
&lt;p&gt;클로저는 반환된 내부함수가 자신이 선언됐을 때의 환경인 스코프를 기억하여 자신이 선언됐을 때의 환경밖에서 호출되어도 그 환경에 접근할 수 있는 함수를 말한다.&lt;/p&gt;
&lt;p&gt;간단히 말하면 클로저는 자신이 생성될 때의 환경을 기억하는 함수 라고 말할 수 있다. &lt;/p&gt;
&lt;p&gt;내부 함수가 클로저이며, 외부함수는 자유변수라고 부른다. 클로저라는 이름은 자유변수에 함수가 닫혀있다는 의미로 의역하면 자유변수에 엮여있는 함수라는 뜻이다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클로저의 활용&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;상태 유지&lt;/p&gt;
&lt;p&gt;클로저가 가장 유용하게 사용되는 상황은 현재 상태를 기억하고 변경된 최신 상태를 유지하는 것이다. &lt;/p&gt;
&lt;p&gt;클로저가 아니고 전역변수를 사용할 수 있지만 전역 변수는 언제든지 누구나 접근할 수 있고 변경할 수 있기 때문에 많은 부작용을 유발하므로 사용하지 않는 것이 좋다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;전역 변수 사용의 억제&lt;/p&gt;
&lt;p&gt;변수의 값은 누군가에 의해 언제든지 변경될 수 있어 오류 발생의 근본적인 원인이 될 수 있다. 상태 변경이나 가변 데이터를 피하고 불변성을 유지향하는 함수형 프로그래밍에서 사이드 이펙트를 최대한 억제하여 오류를 피하고 프로그램의 안정성을 높이기 위해 클로저를 사용한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;정보의 은닉&lt;/p&gt;
&lt;p&gt;자신이 생성됐을 때의 렉시컬 환경인 생성자 함수의 변수에 접근 가능한 클로저의 특징을 사용해 private 키워드를 흉내낼 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[JavaScript의 타입 변환과 단축 평가]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/JavaScript의-타입-변환과-단축-평가/</link><guid isPermaLink="false">https://sharknia.github.io/JavaScript의-타입-변환과-단축-평가/</guid><pubDate>Tue, 10 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;타입변환이란?&lt;/p&gt;
&lt;p&gt;자바스크립트의 모든 값은 타입이 있다. 값의 타입은 다른 타입으로 개발자에 의해 의도적으로 변환할 수 있다. 또는 자바스크립트 엔진에 의해 암묵적으로 자동 변환될 수 있다.&lt;/p&gt;
&lt;p&gt;개발자가 의도적으로 타입을 변경하는 것을 명시적 타입 변환(Explict coercion) 또는 타입 캐스팅(Type casting) 이라고 한다. &lt;/p&gt;
&lt;p&gt;자바스크립트 엔진이 타입을 자동 변환 하는 것을 암묵적 타입 변환(Implict coercion) 또는 타입 강제 변환(Type coercion)이라고 한다. &lt;/p&gt;
&lt;p&gt;타입변환이 값을 직접 변경하는 것은 아니다. 변수 값을 변경하려면 재할당을 통해 새로운 메모리 공간을 확보하고 그 곳에 원시 값을 저장한 후 변수명이 재할당된 원시값이 저장된 메모리 공간의 주소를 기억하도록 해야 한다. &lt;/p&gt;
&lt;p&gt;압묵적 타입 변환은 변수 값을 재할당하는 것이 아니라 자바스크립트 엔진이 표현식을 에러없이 평가하기 위해 기존 값을 바탕으로 새로운 타입의 값을 만들어 단 한 번 사용하고 버린다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;암묵적 타입 변환&lt;/p&gt;
&lt;p&gt;자바스크립트 엔진은 표현식을 평가할 때에 컨텍스트를 고려하여 가급적 에러를 발생시키지 않도록 암묵적으로 타입 변환을 실시한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;boolean 타입으로 변환&lt;/p&gt;
&lt;p&gt;자바스크립트 엔진은 다음과 같은 값을 false로 평가한다. 아래의 값을 제외한 값은 모두 true로 판단한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;false&lt;/li&gt;
&lt;li&gt;undefined&lt;/li&gt;
&lt;li&gt;null&lt;/li&gt;
&lt;li&gt;0, -0&lt;/li&gt;
&lt;li&gt;NaN&lt;/li&gt;
&lt;li&gt;‘’(빈 문자열)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;명시적 타입 변환&lt;/p&gt;
&lt;p&gt;암묵적 타입 변환을 이용해서 명시적 타입 변환을 할 수도 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단축평가&lt;/p&gt;
&lt;p&gt;논리곱(&amp;#x26;&amp;#x26;) 논리합(||) 연산자&lt;/p&gt;
&lt;p&gt;단축평가는 다음과 같은 상황에서 유리하다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;객체가 null 인지 확인하고 프로퍼티를 참조할 때에&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;함수의 인수를 초기화할 때&lt;/p&gt;
&lt;p&gt;함수를 호출할 때에 인수를 전달하지 않으면 매개변수는 undefined를 갖는다. 이때 단축 평가를 사용하여 매개변수의 기본값을 설정하면 undefined로 인해 발생할 수 있는 에러를 방지할 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[JavaScript의 변수]]></title><description><![CDATA[변수 호이스팅 (Variable Hoisting) 자바스크립트에서는 모든 변수는 호이스팅 된다. 호이스팅이란 var 선언문이나 function 선언문 등 모든 선언문이 해당 Scope…]]></description><link>https://sharknia.github.io/JavaScript의-변수/</link><guid isPermaLink="false">https://sharknia.github.io/JavaScript의-변수/</guid><pubDate>Sat, 07 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;변수 호이스팅 (Variable Hoisting)&lt;/p&gt;
&lt;p&gt;자바스크립트에서는 모든 변수는 호이스팅 된다. 호이스팅이란 var 선언문이나 function 선언문 등 모든 선언문이 해당 Scope의 선두로 옮겨진 것처럼 동작하는 특성을 말한다. 즉 자바스크립트에서는 모든 선언문(var, let, const, function, function*, class)이 선언되기 이전에도 참조가 가능하다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;var 키워드로 생성된 변수의 문제점&lt;/p&gt;
&lt;p&gt;ES5에서는 오직 var 키워드로만 변수의 선언이 가능하다. 이는 다음과 같은 특징을 가지며 주의를 기울이지 않으면 심각한 문제를 발생시킨다. &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;함수 레벨 스코프&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;전역변수의 남발&lt;/li&gt;
&lt;li&gt;for문에서 초기화식에 사용한 변수를 for문 외부 또는 전역에서 참조할 수 있다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;var 키워드 생략 허용&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;의도하지 않은 변수의 전역화&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;중복 선언 허용&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;의도하지 않은 변수값 변경&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;변수 호이스팅&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ES6는 이런 단점을 보완하기 위해 let, const 키워드를 도입하였다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[JavaScript 기본 문법]]></title><description><![CDATA[변수(Variable…]]></description><link>https://sharknia.github.io/JavaScript-기본-문법/</link><guid isPermaLink="false">https://sharknia.github.io/JavaScript-기본-문법/</guid><pubDate>Fri, 06 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;변수(Variable)&lt;/p&gt;
&lt;p&gt;메모리상의 주소(위치)를 기억하는 저장소. 즉 메모리 주소에 접근하기 위해 사람이 이해할 수 있는 언어로 지정한 식별자&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;값&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;데이터 타입 - 프로그래밍 언어에서 사용할 수 있는 값의 종료&lt;/li&gt;
&lt;li&gt;변수 - 값이 저장된 메모리를 가리키는 식별자&lt;/li&gt;
&lt;li&gt;리터럴 - 소스코드 안에 직접 만들어낸 상수 값 자체. 값의 최소 단위&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;값은 프로그램에 의해 조작될 수 있는 대상을 말한다. &lt;/p&gt;
&lt;p&gt;자바스크립트의 모든 값은 자바스크립트가 제공하는 7가지 데이터 타입 중 하나를 갖는다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;데이터타입&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;원시타입(Privitive data type)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;number&lt;/li&gt;
&lt;li&gt;string&lt;/li&gt;
&lt;li&gt;boolean&lt;/li&gt;
&lt;li&gt;null&lt;/li&gt;
&lt;li&gt;undefined&lt;/li&gt;
&lt;li&gt;symbol(ES6)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;객체 타입(Object data type)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;object&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;자바스크립트는 데이터 타입을 미리 지정하지 않는다. 값의 타입에 의해 동적으로 변수의 타입이 결정되며, 이를 동적 타이핑이라고 한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;연산자&lt;/p&gt;
&lt;p&gt;피연산자의 타입이 반드시 일치할 필요가 없다. 암묵적 타입 강제 변환을 통해 연산을 수행한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;키워드&lt;/p&gt;
&lt;p&gt;키워드는 수행할 동작을 규정한다. 예를 들어 var 는 변수를 생성할 것을 지시한다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;주석&lt;/p&gt;
&lt;p&gt;// 로 쓴다. 또는 /* */ 사이에 쓴다. &lt;/p&gt;
&lt;p&gt;주석은 해석기가 무시하며 실행되지 않는다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;문&lt;/p&gt;
&lt;p&gt;브라우저에 의해 단계별로 수행될 명령들의 집합. 문은 리터럴, 연산자, 표현식, 키워드 등으로 구성되며 세미콜론으로 끝나야 한다. &lt;/p&gt;
&lt;p&gt;문은 코드 블록으로 그룹화 할 수 있다. &lt;/p&gt;
&lt;p&gt;자바스크립트는 블록 유효범위 (Block-Level Scope)를 생성하지 않는다. 함수 단위의 유효범위 (Function-Level Scope)만 생성된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;표현식&lt;/p&gt;
&lt;p&gt;표현식은 하나의 값으로 평가된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;문과 표현식의 비교&lt;/p&gt;
&lt;p&gt;문은 표현식을 포함한다. 표현식은 그 자체로 하나의 문이 될 수도 있다. &lt;/p&gt;
&lt;p&gt;표현식은 평가되어 값을 만들지만 그 이상의 행위는 할 수 없다. &lt;/p&gt;
&lt;p&gt;표현식을 통해 평가한 값을 통해 실제로 컴퓨터에게 명령을 하여 무언가를 하는 것은 문이다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;함수&lt;/p&gt;
&lt;p&gt;어떤 작업을 수행하기 위해 필요한 문들의 집함. 이름과 매개변수를 가진다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;객체&lt;/p&gt;
&lt;p&gt;자바스크립트는 객체(object) 기반의 스크립트 언어로 자바스크립트를 이루는 거의 모든 것이 객체이다. &lt;/p&gt;
&lt;p&gt;원시 타입을 제외한 나머지 값들은 모두 객체이다. (함수, 배열, 정규표현식 등)&lt;/p&gt;
&lt;p&gt;자바스크립트 객체는 키(이름)와 값으로 구성된 프로퍼티(property)의 집합이다. 프로퍼티의 값으로 자바스크립트에서 사용할 수 있는 모든 값을 사용할 수 있다. 자바스크립트의 함수는 일급 객체이므로 값으로 취급할 수 있다. &lt;/p&gt;
&lt;p&gt;따라서 프로퍼티 값으로 함수를 사용할수도 있으며, 프로퍼티 값이 함수일 경우 일반 함수와 구분하기 위헤 메소드라 부른다. &lt;/p&gt;
&lt;p&gt;객체는 데이터를 의미하는 프로퍼티와 데이터를 참조하고 조작할 수 있는 동작을 의미하는 메소드로 구성된 집합이다. 객체는 데이터(프로퍼티)와 그 데이터에 관련되는 동작(메소드)을 모두 포함할 수 있기 때문에 데이터와 동작을 하나의 단위로 구조화할 수 있어 유용하다. &lt;/p&gt;
&lt;p&gt;자바스크립트의 객체는 객체지향의 상속을 구현하기 위해 “프로토타입”이라고 불리는 객체의 프로퍼티와 메소드를 상속받을 수 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;배열&lt;/p&gt;
&lt;p&gt;자바스크립트의 배열은 객체이다. 유용한 내장 메소드를 포함하고 있다. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[JavaScript의 특징, 브라우저 동작 원리]]></title><description><![CDATA[…]]></description><link>https://sharknia.github.io/JavaScript의-특징-브라우저-동작-원리/</link><guid isPermaLink="false">https://sharknia.github.io/JavaScript의-특징-브라우저-동작-원리/</guid><pubDate>Thu, 05 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;자바스크립트의 특징&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;웹브라우저에서 동작하는 유일한 프로그래밍 언어&lt;/li&gt;
&lt;li&gt;별도의 컴파일 작업을 수행하지 않는 인터프리터 언어 &lt;/li&gt;
&lt;li&gt;명령형, 함수형, 프로토타입 기반 객체지향 프로그래밍을 지원하는 멀티 패러다임 프로그래밍 언어&lt;/li&gt;
&lt;li&gt;강력한 프로토타입 기반의 객체지향 언어&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;브라우저 동작 원리&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;브라우저의 핵심 기능은 사용자가 참조하고자 하는 페이지를 서버에 요청(Request) 하고 서버의 응답(Response)를 받아 브라우저에 표시하는 것. 브라우저는 서버로부터 HTML, CSS, JavaScript, 이미지 파일 등을 응답받는다. HTML, CSS 파일은 렌더링 엔진의 HTML 파서와 CSS 파서에 의해 파싱되어 DOM, CSSOM 트리로 변환되고 렌더 트리로 결합된다. 렌더 트리를 기반으로 브라우저는 웹페이지를 표시한다. &lt;/li&gt;
&lt;li&gt;자바스크립트는 렌더링 엔진이 아닌 자바스크립트 엔진이 처리한다. HTML 파서는 script 태그를 만나면 자바스크립트 코드를 실행하기 위해 DOM 생성 프로세스를 중지하고 자바스크립트 엔진으로 제어 권한을 넘긴다. 제어 권한을 넘겨 받은 자바스크립트 엔진은 script 태그 내의 자바스크립트 코드 또는 script 태그의 src 속성에 정의된 자바스크립트 파일을 로드하고 파싱하여 실행한다. 자바스크립트의 실행이 완료되면 다시 HTML 파서가 제어 권한을 받아 DOM 생성을 재개한다. &lt;/li&gt;
&lt;li&gt;이처럼 브라우저는 동기적으로 HTML, CSS, JAVASCRIPT를 처리한다. 이것은 script 위치에 따라 블로킹이 발생하여 DOM 구조 생성이 지연될 수 있음을 의미한다. 따라서 script 태그의 위치는 중요한 의미를 갖는다. &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;body 요소의 가장 아래에 자바스크립트를 위치시키는 것은 좋은 아이디어다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTML 요소들이 지연없이 렌더링 되므로 페이지 로딩 시간이 단축된다. &lt;/li&gt;
&lt;li&gt;DOM이 완성되지 않은 상태에서 자바스크립트가 DOM을 조작한다면 에러가 발생한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[화상상담을 위한 Janus 구성]]></title><description><![CDATA[Stun 서버와 Turn 서버를 위한 Coturn Server도 함께 설치 환경구성 Ubuntu 18.04 bionic Python 3.7 설치 명령어 정리 파이썬 및 기본 소프트웨어 설치 Janus 설치 https://ourcodeworld.com…]]></description><link>https://sharknia.github.io/화상상담을-위한-Janus-구성/</link><guid isPermaLink="false">https://sharknia.github.io/화상상담을-위한-Janus-구성/</guid><pubDate>Tue, 03 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    Janus를 우분투에 설치하면서 사용한 명령어 정리&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Stun 서버와 Turn 서버를 위한 Coturn Server도 함께 설치&lt;/p&gt;
&lt;h3&gt;환경구성&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu 18.04 bionic&lt;/li&gt;
&lt;li&gt;Python 3.7&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;설치 명령어 정리&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;파이썬 및 기본 소프트웨어 설치&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Janus 설치&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ourcodeworld.com/articles/read/1197/how-to-install-janus-gateway-in-ubuntu-server-18-04&quot;&gt;https://ourcodeworld.com/articles/read/1197/how-to-install-janus-gateway-in-ubuntu-server-18-04&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Janus 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;packagelist&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; 
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; 
libmicrohttpd-dev 
libjansson-dev 
libssl-dev 
libsrtp-dev 
libsofia-sip-ua-dev 
libglib2.0-dev 
libopus-dev 
libogg-dev 
libcurl4-openssl-dev 
liblua5.3-dev 
libconfig-dev 
pkg-config 
gengetopt 
libtool 
automake 
gtk-doc-tools 
cmake 
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${packagelist&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;@&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;libnice 설치&lt;/p&gt;
&lt;p&gt;&lt;em&gt;※ 최소 파이썬 3.7을 요구한다.&lt;/em&gt; &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pip3 &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;meson&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.61&lt;/span&gt;.5 
&lt;span class=&quot;token function&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; /usr/local/bin/meson /usr/bin/ 
&lt;span class=&quot;token function&quot;&gt;wget&lt;/span&gt; https://github.com/ninja-build/ninja/releases/download/v1.10.1/ninja-linux.zip 
&lt;span class=&quot;token function&quot;&gt;unzip&lt;/span&gt; ninja-linux.zip 
&lt;span class=&quot;token function&quot;&gt;cp&lt;/span&gt; ninja /usr/bin/ 
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://gitlab.freedesktop.org/libnice/libnice.git
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; libnice 
meson &lt;span class=&quot;token parameter variable&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr build 
ninja &lt;span class=&quot;token parameter variable&quot;&gt;-C&lt;/span&gt; build 
ninja &lt;span class=&quot;token parameter variable&quot;&gt;-C&lt;/span&gt; build &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;libstrp 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;wget&lt;/span&gt; https://github.com/cisco/libsrtp/archive/v2.2.0.tar.gz 
&lt;span class=&quot;token function&quot;&gt;tar&lt;/span&gt; xfv v2.2.0.tar.gz 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; libsrtp-2.2.0 
./configure —prefix&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr —enable-openssl 
&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; shared_library &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;usrctp 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/sctplab/usrsctp 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; usrsctp 
./bootstrap 
./configure &lt;span class=&quot;token parameter variable&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;libwebsockets 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/warmcat/libwebsockets.git 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; libwebsockets 
&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; build 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; build 
cmake &lt;span class=&quot;token parameter variable&quot;&gt;-DLWS_MAX_SMP&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-LWS_IPV6&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ON &lt;span class=&quot;token parameter variable&quot;&gt;-DCMAKE_INSTALL_PREFIX:PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;token parameter variable&quot;&gt;-DCMAKE_C_FLAGS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;-fpic&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt; 
&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;mqtt 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/eclipse/paho.mqtt.c.git 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; paho.mqtt.c 
&lt;span class=&quot;token assign-left variable&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;NanoMSG 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; libnanomsg-dev &lt;span class=&quot;token parameter variable&quot;&gt;-y&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RabbitMQ C AMQP 설치&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/alanxz/rabbitmq-c 
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; rabbitmq-c 
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; submodule init 
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; submodule update 
&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; build &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; build 
cmake &lt;span class=&quot;token parameter variable&quot;&gt;-DCMAKE_INSTALL_PREFIX&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;janus 컴파일링&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/meetecho/janus-gateway.git
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; janus-gateway
&lt;span class=&quot;token function&quot;&gt;sh&lt;/span&gt; autogen.sh
./configure —prefix&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/opt/janus
&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; configs&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Janus 설정&lt;/p&gt;
&lt;p&gt;설정 파일 위치 : /opt/janus/etc/janus&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;janus.jcfg&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;- log_to_file &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 
- admin_secret &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 변경 &lt;span class=&quot;token string&quot;&gt;&quot;PW&quot;&lt;/span&gt; 
- rtp_port_range &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 및 변경 &lt;span class=&quot;token string&quot;&gt;&quot;20000-60000&quot;&lt;/span&gt; 
- stun_server &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 변경 &lt;span class=&quot;token string&quot;&gt;&quot;Stun Server Domain&quot;&lt;/span&gt; 
- stun_port &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 
- nat_1_1_mapping &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 변경 &lt;span class=&quot;token string&quot;&gt;&quot;Server IP&quot;&lt;/span&gt; 
- turn_server &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 변경 &lt;span class=&quot;token string&quot;&gt;&quot;Turn Server Domain&quot;&lt;/span&gt; 
- turn_port &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 
- turn_type &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 
- turn_user &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 및 변경 &lt;span class=&quot;token string&quot;&gt;&quot;Turn ID&quot;&lt;/span&gt; 
- turn_pwd &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 및 변경 &lt;span class=&quot;token string&quot;&gt;&quot; Turn PW&quot;&lt;/span&gt; 
- ipv6 &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 및 변경 &lt;span class=&quot;token string&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;janus.plugin.videoroom.jcfg&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;general&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
admin_key &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석해제 및 변경 &lt;span class=&quot;token string&quot;&gt;&quot;비밀번호&quot;&lt;/span&gt; 
publishers &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 생성 값 &lt;span class=&quot;token string&quot;&gt;&quot;10&quot;&lt;/span&gt; 
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;janus.transport.http.jcfg&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;https &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 값 변경 &lt;span class=&quot;token string&quot;&gt;&quot;true&quot;&lt;/span&gt; 
secure_port &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석 해제 
admin_https &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 주석처리 값 변경 &lt;span class=&quot;token string&quot;&gt;&quot;true&quot;&lt;/span&gt; 
cert_pem &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 값 변경 &lt;span class=&quot;token string&quot;&gt;&quot;crt.pem 위치&quot;&lt;/span&gt; 
cert_key &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 값 변경 &lt;span class=&quot;token string&quot;&gt;&quot;key.pem 위치&quot;&lt;/span&gt; 
cert_pwd &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; 값 변경 &lt;span class=&quot;token string&quot;&gt;&quot;인증서 비밀번호&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Coturn 설치&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://john-home.iptime.org:8085/xe/index.php?mid=board_sKSz42&amp;#x26;document_srl=1546&quot;&gt;http://john-home.iptime.org:8085/xe/index.php?mid=board&lt;em&gt;sKSz42&amp;#x26;document&lt;/em&gt;srl=1546&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item></channel></rss>