{"componentChunkName":"component---src-templates-post-jsx","path":"/FastAPI의-Pagenation/","result":{"data":{"site":{"siteMetadata":{"title":"SharkniA"}},"markdownRemark":{"id":"ef31575e-f174-58f7-84b7-832d38e952f9","excerpt":"서론 FatAPI에는 페이징을 위한 공식 라이브러리가 존재한다. 하지만 예제대로 진행해도 코드는 오류를 내뿜었다. 왜냐하면, FastAPI의 페이지네이션 라이브러리는 SqlAlchemy 2.0의 비동기 엔진을 지원하지 않기 때문이다.  그래서 직접 구현했다.  (이 라이브러리를 쓰면 Async pagination 지원합니다. 여러분은 이거 쓰세요.) 목적…","html":"<h2>서론</h2>\n<p>FatAPI에는 페이징을 위한 <a href=\"https://uriyyo-fastapi-pagination.netlify.app/\">공식 라이브러리</a>가 존재한다. 하지만 예제대로 진행해도 코드는 오류를 내뿜었다. 왜냐하면, FastAPI의 페이지네이션 라이브러리는 SqlAlchemy 2.0의 비동기 엔진을 지원하지 않기 때문이다. </p>\n<p>그래서 직접 구현했다. </p>\n<p><del>(이</del> <a href=\"https://pypi.org/project/fastapi-sqla/\"><del>라이브러리</del></a><del>를 쓰면 Async pagination 지원합니다. 여러분은 이거 쓰세요.)</del></p>\n<h2>목적</h2>\n<h3>응답값 고정</h3>\n<p>모든 페이징 쿼리에 대해 동일한 응답값을 제공하기 위해 Response에 사용할 Pydantic Model도 함께 정의한다. </p>\n<h3>가능한 한 간단한 사용 방법</h3>\n<p>Sqlalchemy의 Select 객체를 받아 바로 처리할 수 있도록 한다. 즉, 개발자는 쿼리문만 생성하고 사이즈/페이지만 정해주면 바로 고정된 응답값을 받을 수 있다. </p>\n<h3>현재 서버에 필요한 사양에 맞춘 기능</h3>\n<p>복잡한 쿼리나 여러 층의 정렬을 현재는 필요로 하지 않는다. 이에 발맞춰 기본적인 relationship을 활용한 조인, 단일 컬럼 sort만 지원하여 사용법을 간략화 한다. </p>\n<h2>구현</h2>\n<h3>PaginationReturn Class 구현</h3>\n<p>페이지네이션의 결과의 데이터 모델을 미리 정의해 둔 클래스이다. </p>\n<p>응답값은 다음의 내용들로 고정된다.</p>\n<ul>\n<li>itemList : 페이지에 포함된 Row의 리스트</li>\n<li>totalCount : 전체 항목의 개수</li>\n<li>totalPage : 전체 페이지의 개수 </li>\n<li>nowPage : 현재 페이지 번호</li>\n<li>nowSize : 현재 설정한 사이즈 </li>\n<li>prevPage : 이전 페이지 번호</li>\n<li>nextPage : 다음 페이지 번호</li>\n</ul>\n<details>\n<summary>전체 코드</summary>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">class PaginationReturn(BaseModel<span class=\"token punctuation\">,</span> Generic<span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span>)<span class=\"token punctuation\">:</span>\n    \"\"\"\n    PaginationReturn 클래스는 페이지네이션 결과를 나타내는 모델입니다.\n\n    <span class=\"token key atrule\">Attributes</span><span class=\"token punctuation\">:</span>\n        itemList (List<span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span>)<span class=\"token punctuation\">:</span> 페이지에 포함된 항목의 리스트입니다.\n        <span class=\"token key atrule\">totalCount (int)</span><span class=\"token punctuation\">:</span> 전체 항목의 개수입니다.\n        <span class=\"token key atrule\">totalPages (int)</span><span class=\"token punctuation\">:</span> 전체 페이지의 개수입니다.\n        <span class=\"token key atrule\">nowPage (int)</span><span class=\"token punctuation\">:</span> 현재 페이지 번호입니다.\n        <span class=\"token key atrule\">nowSize (int)</span><span class=\"token punctuation\">:</span> 현재 페이지에 포함된 항목의 개수입니다.\n        prevPage (Optional<span class=\"token punctuation\">[</span>int<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token key atrule\">optional)</span><span class=\"token punctuation\">:</span> 이전 페이지 번호입니다. 기본값은 None입니다.\n        nextPage (Optional<span class=\"token punctuation\">[</span>int<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token key atrule\">optional)</span><span class=\"token punctuation\">:</span> 다음 페이지 번호입니다. 기본값은 None입니다.\n    \"\"\"\n    <span class=\"token key atrule\">itemList</span><span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">totalCount</span><span class=\"token punctuation\">:</span> int\n    <span class=\"token key atrule\">totalPages</span><span class=\"token punctuation\">:</span> int\n    <span class=\"token key atrule\">nowPage</span><span class=\"token punctuation\">:</span> int\n    <span class=\"token key atrule\">nowSize</span><span class=\"token punctuation\">:</span> int\n    <span class=\"token key atrule\">prevPage</span><span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span>int<span class=\"token punctuation\">]</span> = None\n    <span class=\"token key atrule\">nextPage</span><span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span>int<span class=\"token punctuation\">]</span> = None</code></pre></div>\n</details>\n<h3>Pagination Class 구현</h3>\n<p>pagination은 static 메소드로 만들어서 필요한 값을 넣으면 바로 PaginationReturn을 받을 수 있게 만들었다. static method로 만든것은 FastAPI의 Pagination 라이브러리를 본딴것이다. 이 방법이 가장 사용하기 편해보이기도 했다. </p>\n<h4><code class=\"language-text\">get_paginated_list</code></h4>\n<p>처음 구현한 메소드이다. 모델을 파라미터로 받아 페이징을 한다. 따로 select문을 만들 필요 없이 모델과 where절만 만들어서 넣어줘도 정의된 응답값 데이터 모델에 리스트를 담아 반환해준다. </p>\n<details>\n<summary>전체 코드</summary>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@classmethod</span>\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">get_paginated_list</span><span class=\"token punctuation\">(</span>\n        cls<span class=\"token punctuation\">,</span>\n        db<span class=\"token punctuation\">:</span> AsyncSession<span class=\"token punctuation\">,</span>\n        model<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">,</span>\n        filters<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span>List<span class=\"token punctuation\">[</span>BinaryExpression<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n        order_column<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n        order_direction<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"desc\"</span><span class=\"token punctuation\">,</span>\n        size<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n        page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> PaginationReturn<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># page 와 size 기본 유효성 검증</span>\n        <span class=\"token keyword\">if</span> page <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span> <span class=\"token keyword\">or</span> size <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string\">\"Page and size parameters must be greater than 0\"</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 기본 쿼리 생성</span>\n        query <span class=\"token operator\">=</span> select<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># fileter 처리</span>\n        <span class=\"token keyword\">if</span> filters <span class=\"token keyword\">and</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>filters<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>filters<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 정렬 처리</span>\n        <span class=\"token keyword\">if</span> order_column<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> order_direction<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"asc\"</span><span class=\"token punctuation\">:</span>\n                query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span>asc<span class=\"token punctuation\">(</span><span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> order_column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span>desc<span class=\"token punctuation\">(</span><span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> order_column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        total_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 페이징</span>\n            offset_value <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>page <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> size\n            query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>offset<span class=\"token punctuation\">(</span>offset_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>limit<span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span>\n            result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n            items <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>scalars<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"[Pagination Query] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>query<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># total_count 계산</span>\n            total_query <span class=\"token operator\">=</span> select<span class=\"token punctuation\">(</span>func<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>select_from<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> filters<span class=\"token punctuation\">:</span>\n                total_query <span class=\"token operator\">=</span> total_query<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>filters<span class=\"token punctuation\">)</span>\n            total_result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>total_query<span class=\"token punctuation\">)</span>\n            total_count <span class=\"token operator\">=</span> total_result<span class=\"token punctuation\">.</span>scalar_one<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> SQLAlchemyError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An error occurred while fetching data from the database : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An unexpected error occurred : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n\n        total_pages<span class=\"token punctuation\">,</span> prev_page<span class=\"token punctuation\">,</span> next_page <span class=\"token operator\">=</span> calculate_pagination<span class=\"token punctuation\">(</span>total_count<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 응답값 생성</span>\n        items_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>serialize_sqlalchemy_obj<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">]</span>\n\n        res <span class=\"token operator\">=</span> PaginationReturn<span class=\"token punctuation\">(</span>\n            itemList<span class=\"token operator\">=</span>items_dict<span class=\"token punctuation\">,</span>\n            totalCount<span class=\"token operator\">=</span>total_count<span class=\"token punctuation\">,</span>\n            totalPages<span class=\"token operator\">=</span>total_pages<span class=\"token punctuation\">,</span>\n            nowPage<span class=\"token operator\">=</span>page<span class=\"token punctuation\">,</span>\n            nowSize<span class=\"token operator\">=</span>size<span class=\"token punctuation\">,</span>\n            prevPage<span class=\"token operator\">=</span>prev_page<span class=\"token punctuation\">,</span>\n            nextPage<span class=\"token operator\">=</span>next_page<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> res</code></pre></div>\n</details>\n<p>BaseModel 객체는 직렬화 기능이 없으므로, Response로 응답을 내려보낼때에 귀찮아지는 문제가 있다. 모델의 키값과 밸류를 사용해 dictionary로 바꾸면 해당 문제를 해결할 수 있는데, 만약 리스트에 들어있는 값들에 대해 커스텀이 필요하다면 dictionary를 그대로 다루는 것은 아무래도 모델을 커스텀 하는 것보다 불편한 문제가 발생한다. </p>\n<p>이 문제를 해결하기 위해 모델 객체를 기반으로 Pydantic Model 객체를 동적으로 생성하여 Pydantic model의 리스트를 결과값에 담아 리턴하기로 했다. 이렇게 하면 응답값을 바로 Response로 내려보내도 직렬화가 가능해 문제가 발생하지 않으며, 혹시 아이템 내용을 커스텀 해야 할 때에도 모델을 다룰 때와 같은 방법으로 사용할 수 있으므로 훨씬 간편하다. 개선된 코드는 아래와 같다. </p>\n<details>\n<summary>개선된 코드</summary>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@classmethod</span>\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">get_paginated_list</span><span class=\"token punctuation\">(</span>\n        cls<span class=\"token punctuation\">,</span>\n        db<span class=\"token punctuation\">:</span> AsyncSession<span class=\"token punctuation\">,</span>\n        model<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">,</span>\n        filters<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span>List<span class=\"token punctuation\">[</span>BinaryExpression<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n        order_column<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n        order_direction<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"desc\"</span><span class=\"token punctuation\">,</span>\n        size<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n        page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> PaginationReturn<span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        페이징을 해서 아이템을 뽑아내서 결과를 반환한다.\n        Args:\n            db: AsyncSession\n            model: 데이터를 가져올 모델\n            filters: [InitQuizList.is_deleted == False, InitQuizList.is_active == True] 의 꼴 where절\n            order_column: 정렬할 컬럼\n            order_direction: 'asc' or 'desc'\n            size: 페이지에 나타낼 아이템의 개수 (기본값 10)\n            page: page 번호 (기본값 1)\n        Returns:\n            PaginationReturn\n        \"\"\"</span>\n\n        <span class=\"token comment\"># page 와 size 기본 유효성 검증</span>\n        <span class=\"token keyword\">if</span> page <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span> <span class=\"token keyword\">or</span> size <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string\">\"Page and size parameters must be greater than 0\"</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 기본 쿼리 생성</span>\n        query <span class=\"token operator\">=</span> select<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># fileter 처리</span>\n        <span class=\"token keyword\">if</span> filters <span class=\"token keyword\">and</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>filters<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>filters<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 정렬 처리</span>\n        <span class=\"token keyword\">if</span> order_column<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> order_direction<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"asc\"</span><span class=\"token punctuation\">:</span>\n                query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span>asc<span class=\"token punctuation\">(</span><span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> order_column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>order_by<span class=\"token punctuation\">(</span>desc<span class=\"token punctuation\">(</span><span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">,</span> order_column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        total_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 페이징</span>\n            offset_value <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>page <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> size\n            query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>offset<span class=\"token punctuation\">(</span>offset_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>limit<span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span>\n            result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n            items <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>scalars<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"[Pagination Query] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>query<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># total_count 계산</span>\n            total_query <span class=\"token operator\">=</span> select<span class=\"token punctuation\">(</span>func<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>select_from<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> filters<span class=\"token punctuation\">:</span>\n                total_query <span class=\"token operator\">=</span> total_query<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>filters<span class=\"token punctuation\">)</span>\n            total_result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>total_query<span class=\"token punctuation\">)</span>\n            total_count <span class=\"token operator\">=</span> total_result<span class=\"token punctuation\">.</span>scalar_one<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> SQLAlchemyError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An error occurred while fetching data from the database : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An unexpected error occurred : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n\n        total_pages<span class=\"token punctuation\">,</span> prev_page<span class=\"token punctuation\">,</span> next_page <span class=\"token operator\">=</span> calculate_pagination<span class=\"token punctuation\">(</span>total_count<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 응답값 생성</span>\n        <span class=\"token comment\"># 동적 Pydantic 모델 생성</span>\n        PydanticModel <span class=\"token operator\">=</span> sqlalchemy_to_pydantic<span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 페이징 처리된 쿼리 결과를 Pydantic 모델 리스트로 변환</span>\n        pydantic_items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>PydanticModel<span class=\"token punctuation\">.</span>model_validate<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">]</span>\n\n        res <span class=\"token operator\">=</span> PaginationReturn<span class=\"token punctuation\">(</span>\n            itemList<span class=\"token operator\">=</span>pydantic_items<span class=\"token punctuation\">,</span>\n            totalCount<span class=\"token operator\">=</span>total_count<span class=\"token punctuation\">,</span>\n            totalPages<span class=\"token operator\">=</span>total_pages<span class=\"token punctuation\">,</span>\n            nowPage<span class=\"token operator\">=</span>page<span class=\"token punctuation\">,</span>\n            nowSize<span class=\"token operator\">=</span>size<span class=\"token punctuation\">,</span>\n            prevPage<span class=\"token operator\">=</span>prev_page<span class=\"token punctuation\">,</span>\n            nextPage<span class=\"token operator\">=</span>next_page<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> res\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">sqlalchemy_to_pydantic</span><span class=\"token punctuation\">(</span>db_model<span class=\"token punctuation\">:</span> Type<span class=\"token punctuation\">[</span>DeclarativeMeta<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Type<span class=\"token punctuation\">[</span>BaseModel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    SQLAlchemy 모델을 동적으로 생성된 동일한 스키마의 Pydantic 모델로 변환합니다.\n    :param db_model: SQLAlchemy 모델 클래스\n    :return: 생성된 Pydantic 모델 클래스\n    \"\"\"</span>\n    fields <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> column <span class=\"token keyword\">in</span> inspect<span class=\"token punctuation\">(</span>db_model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>c<span class=\"token punctuation\">:</span>\n        python_type <span class=\"token operator\">=</span> column<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">.</span>python_type\n        default <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">if</span> column<span class=\"token punctuation\">.</span>default <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">else</span> column<span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">.</span>arg\n        <span class=\"token keyword\">if</span> column<span class=\"token punctuation\">.</span>nullable<span class=\"token punctuation\">:</span>\n            python_type <span class=\"token operator\">=</span> Optional<span class=\"token punctuation\">[</span>python_type<span class=\"token punctuation\">]</span>\n        fields<span class=\"token punctuation\">[</span>column<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>python_type<span class=\"token punctuation\">,</span> default<span class=\"token punctuation\">)</span>\n\n    pydantic_model <span class=\"token operator\">=</span> create_model<span class=\"token punctuation\">(</span>db_model<span class=\"token punctuation\">.</span>__name__ <span class=\"token operator\">+</span> <span class=\"token string\">\"Pydantic\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>fields<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> pydantic_model</code></pre></div>\n<p>모델의 컬럼값으로 동적으로 pydantic model을 생성하는 sqlalchemy<em>to</em>pydantic 메소드를 생성하고 해당 메소드를 활용해 응답값에 담도록 해주었다. </p>\n</details>\n<h4><code class=\"language-text\">get_paginated_list_by_query</code></h4>\n<p>처음에 신나서 만들었는데, 기존  <code class=\"language-text\">get_paginated_list</code> 메소드는 치명적인 문제가 있다. 쿼리가 복잡한 경우를 전혀 생각하지 않았다. 말 그대로 단일 테이블에서만 값을 가져올 수 있는 것이다. 그래서 이 점을 개선해야했다. 그래서 개발자가 조금 더 귀찮아지지만 쿼리문은 이 메소드를 이용할 작업자가 직접 구현을 하고, 그 쿼리문을 넣으면 리스트를 담아서 돌려주는 형식으로 다시 만들기로 했다. </p>\n<p>기존 메소드에서는 모델만을 조회하는 것이므로 모델을 기반으로 Pydantic model을 생성하면 문제가 없었는데, 이번에는 모델에서 컬럼값을 추출해서 사용할 수 없으므로 키 값을 동적으로 정의하는 코드를 따로 작성해주었다. </p>\n<p>쿼리된 내용에서 컬럼값을 조회해서 사용하였으며, 쿼리된 내용에는 시스템에서 사용하는 속성값도 존재하는데 해당 속성값들은 <code class=\"language-text\">_</code>로 시작하므로 해당 내용은 제거하고 동적으로 Pydantic model에 추가해주었다. relationship도 대응할 수 있게 별도의 예외처리를 추가해주었다. relationship 속성은 Select 객체의 컬럼에는 포함이 되지 않는데 조회된 결과물의 속성에는 들어있으므로 해당 값이 relationship 속성이라고 가정하고 따로 예외처리를 해주었다. </p>\n<details>\n<summary>전체 코드</summary>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@classmethod</span>\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">get_paginated_list_by_query</span><span class=\"token punctuation\">(</span>\n        cls<span class=\"token punctuation\">,</span>\n        db<span class=\"token punctuation\">:</span> AsyncSession<span class=\"token punctuation\">,</span>\n        query<span class=\"token punctuation\">:</span> Select<span class=\"token punctuation\">[</span>Any<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        size<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n        page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        Query에 대한 paging 생성\n        Args:\n            db: AsyncSession\n            query: sqlalchemy의 Select의 리턴값\n            size: 한 번에 보여줄 아이템의 개수(기본값 10)\n            page: 페이지(기본값 1)\n        Returns:\n            PaginationReturn\n        \"\"\"</span>\n        <span class=\"token comment\"># 매개변수 검증</span>\n        <span class=\"token keyword\">if</span> page <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span> <span class=\"token keyword\">or</span> size <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string\">\"Page and size parameters must be greater than 0\"</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 페이징 적용</span>\n        offset_value <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>page <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> size\n        paginated_query <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>offset<span class=\"token punctuation\">(</span>offset_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>limit<span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 쿼리 실행</span>\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n            result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>paginated_query<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> SQLAlchemyError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An error occurred while fetching data from the database : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> PagingException<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An unexpected error occurred : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        items <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>scalars<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        pydantic_items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        total_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token keyword\">if</span> items<span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 컬럼과 데이터 타입 파악</span>\n            columns <span class=\"token operator\">=</span> query<span class=\"token punctuation\">.</span>columns\n            fields <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>col<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>Optional<span class=\"token punctuation\">[</span>col<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">.</span>python_type<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> columns<span class=\"token punctuation\">}</span>\n\n            <span class=\"token comment\"># relationship 처리</span>\n            relationship_keys <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            sample_item <span class=\"token operator\">=</span> items<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            item_dict <span class=\"token operator\">=</span> sample_item<span class=\"token punctuation\">.</span>__dict__\n            <span class=\"token keyword\">for</span> key <span class=\"token keyword\">in</span> item_dict<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">if</span> key <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> fields <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> key<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token comment\"># 관계형 속성의 키를 저장</span>\n                    relationship_keys<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># 관계형 속성에 대한 필드 정의 추가</span>\n            <span class=\"token keyword\">for</span> key <span class=\"token keyword\">in</span> relationship_keys<span class=\"token punctuation\">:</span>\n                fields<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Optional<span class=\"token punctuation\">[</span>Any<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># 관계형 속성을 포함한 동적 Pydantic 모델 생성</span>\n            DynamicPydanticModel <span class=\"token operator\">=</span> create_model<span class=\"token punctuation\">(</span><span class=\"token string\">\"DynamicPydanticModel\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>fields<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> items<span class=\"token punctuation\">:</span>\n                item_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>k<span class=\"token punctuation\">:</span> v <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> item<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> k<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                <span class=\"token comment\"># 관계형 속성을 딕셔너리로 변환</span>\n                <span class=\"token keyword\">for</span> key <span class=\"token keyword\">in</span> relationship_keys<span class=\"token punctuation\">:</span>\n                    relation <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">if</span> relation<span class=\"token punctuation\">:</span>\n                        <span class=\"token comment\"># SQLAlchemy 내부 상태 정보를 제외하고 변환</span>\n                        item_dict<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n                            k<span class=\"token punctuation\">:</span> v <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> relation<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> k<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                        item_dict<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n                pydantic_items<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>DynamicPydanticModel<span class=\"token punctuation\">.</span>model_validate<span class=\"token punctuation\">(</span>item_dict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># 총 개수 계산</span>\n            total_count_query <span class=\"token operator\">=</span> select<span class=\"token punctuation\">(</span>func<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>select_from<span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">.</span>subquery<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            total_count_result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>total_count_query<span class=\"token punctuation\">)</span>\n            total_count <span class=\"token operator\">=</span> total_count_result<span class=\"token punctuation\">.</span>scalar_one<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 결과 반환</span>\n        total_pages<span class=\"token punctuation\">,</span> prev_page<span class=\"token punctuation\">,</span> next_page <span class=\"token operator\">=</span> calculate_pagination<span class=\"token punctuation\">(</span>total_count<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> PaginationReturn<span class=\"token punctuation\">(</span>\n            itemList<span class=\"token operator\">=</span>pydantic_items<span class=\"token punctuation\">,</span>\n            totalCount<span class=\"token operator\">=</span>total_count<span class=\"token punctuation\">,</span>\n            totalPages<span class=\"token operator\">=</span>total_pages<span class=\"token punctuation\">,</span>\n            nowPage<span class=\"token operator\">=</span>page<span class=\"token punctuation\">,</span>\n            nowSize<span class=\"token operator\">=</span>size<span class=\"token punctuation\">,</span>\n            prevPage<span class=\"token operator\">=</span>prev_page<span class=\"token punctuation\">,</span>\n            nextPage<span class=\"token operator\">=</span>next_page<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span></code></pre></div>\n</details>\n<h2>결론</h2>\n<p>아직 기능이 많이 부족하지만, 현재 회사에서 사용을 하면서 필요한 기능은 대부분 구현을 했다고 생각이 든다. 그래서 일단 개발은 여기서 멈추었다. </p>\n<p>개발에 아주 오랜 시간이 걸리지는 않았다. 집중도와 실제 사용 시간을 따지면 이틀 좀 안되게 썼다고 생각이 든다. </p>\n<p>만드는것은 재미있는 과정이었고, 필요한 것이 잘 만들어져 뿌듯함도 있었지만 역시 있는 라이브러리를 쓰는게 시간 최적화에서는 더 좋았던 것 같다. </p>","frontmatter":{"title":"FastAPI의 Pagenation","date":"January 17, 2024","update":"February 06, 2024","tags":["Work","FastAPI","SqlAlchemy","Python"],"series":null},"fields":{"slug":"/FastAPI의-Pagenation/","readingTime":{"minutes":13.28}}},"seriesList":{"edges":[{"node":{"id":"b1fa34d8-79a6-5920-b77c-fbf3bc57100b","fields":{"slug":"/화상상담을-위한-Janus-구성/"},"frontmatter":{"title":"화상상담을 위한 Janus 구성"}}},{"node":{"id":"36ed6446-4d80-5d51-87fe-7cbb02582980","fields":{"slug":"/JavaScript의-특징-브라우저-동작-원리/"},"frontmatter":{"title":"JavaScript의 특징, 브라우저 동작 원리"}}},{"node":{"id":"1890a1d7-34c1-53bd-a8bd-9bdfd39e91c3","fields":{"slug":"/JavaScript-기본-문법/"},"frontmatter":{"title":"JavaScript 기본 문법"}}},{"node":{"id":"61ba989b-e166-5573-a895-1f71aa176358","fields":{"slug":"/JavaScript의-변수/"},"frontmatter":{"title":"JavaScript의 변수"}}},{"node":{"id":"09afa1c5-5d39-532c-8dbb-5ba9e4af5b42","fields":{"slug":"/JavaScript의-타입-변환과-단축-평가/"},"frontmatter":{"title":"JavaScript의 타입 변환과 단축 평가"}}},{"node":{"id":"a81f1c25-10c3-52c4-8594-54806409ea15","fields":{"slug":"/JavaScript-클로저/"},"frontmatter":{"title":"JavaScript 클로저"}}},{"node":{"id":"6f1a58a9-6d27-5238-a531-618fc2d38f6a","fields":{"slug":"/NestJS-소개/"},"frontmatter":{"title":"NestJS 소개"}}},{"node":{"id":"b1b9709f-6909-592c-b003-7ff67d3ca0fe","fields":{"slug":"/DB-튜닝-경험/"},"frontmatter":{"title":"DB 튜닝 경험"}}},{"node":{"id":"6a1bda4f-ebe2-5b4f-980e-0484f92834f9","fields":{"slug":"/MORETHAN-LOG-설치/"},"frontmatter":{"title":"MORETHAN-LOG 설치"}}},{"node":{"id":"192dff3e-aa73-5307-a245-65393ab4e1d9","fields":{"slug":"/RDB관계형-데이터베이스-RDBMS/"},"frontmatter":{"title":"RDB(관계형 데이터베이스) + RDBMS"}}},{"node":{"id":"7ac316a8-f6ea-52cc-a790-b5be80f2bec7","fields":{"slug":"/var와-letconst/"},"frontmatter":{"title":"var와 let,const"}}},{"node":{"id":"e86672d9-847c-55f9-a249-42b4d896508f","fields":{"slug":"/MORETHAN-LOG-수정/"},"frontmatter":{"title":"MORETHAN-LOG 수정"}}},{"node":{"id":"6a5ef575-d133-5b56-b0b6-4db4af7aa70d","fields":{"slug":"/NestJS-설치/"},"frontmatter":{"title":"NestJS 설치"}}},{"node":{"id":"c9c69060-c0a8-5657-b744-46feb11aa3bd","fields":{"slug":"/NestJS의-디렉토리-구조/"},"frontmatter":{"title":"NestJS의 디렉토리 구조"}}},{"node":{"id":"6c0e93ce-fab2-5cd8-b369-8c7e35114bd4","fields":{"slug":"/웹-사이트-프로젝트-vs-웹-응용-프로그램-프로젝트/"},"frontmatter":{"title":"웹 사이트 프로젝트 vs 웹 응용 프로그램 프로젝트"}}},{"node":{"id":"e6017a82-883c-5533-b084-e4d128fba3f5","fields":{"slug":"/Nuget-패키지-dll-추출/"},"frontmatter":{"title":"Nuget 패키지 dll 추출"}}},{"node":{"id":"0747e4e2-4d9c-5f2e-9ad4-db4690dc2756","fields":{"slug":"/무료-웹-호스팅-비교/"},"frontmatter":{"title":"무료 웹 호스팅 비교"}}},{"node":{"id":"dec52422-f02f-5520-bfe2-d277ddc7a455","fields":{"slug":"/PRG-패턴-PostRedirectGet/"},"frontmatter":{"title":"PRG 패턴 (Post/Redirect/Get)"}}},{"node":{"id":"ef3f3ed5-f90e-552f-8c1a-f24d1eeb0573","fields":{"slug":"/Python-venv-Windows/"},"frontmatter":{"title":"Python venv (Windows)"}}},{"node":{"id":"73f61a9c-4b13-5f3c-b288-9f971499e1c9","fields":{"slug":"/print와-pprint/"},"frontmatter":{"title":"print와 pprint"}}},{"node":{"id":"42d9a8c0-c330-548e-a36c-c8b97811df23","fields":{"slug":"/정규화와-역정규화/"},"frontmatter":{"title":"정규화와 역정규화"}}},{"node":{"id":"8bcc825c-89ec-552c-9144-ac6b2afced1e","fields":{"slug":"/트래픽-튜닝/"},"frontmatter":{"title":"트래픽 튜닝"}}},{"node":{"id":"1f906753-4b2c-58e9-8b1d-65dbacd5a5ed","fields":{"slug":"/npx/"},"frontmatter":{"title":"npx"}}},{"node":{"id":"90f8d06a-0a5c-5fa2-bcb7-7ac1b4fccbdc","fields":{"slug":"/Branch/"},"frontmatter":{"title":"Branch"}}},{"node":{"id":"3e072448-1152-518b-89a4-0154bf7ed441","fields":{"slug":"/DataTable-클래스/"},"frontmatter":{"title":"DataTable 클래스"}}},{"node":{"id":"4e96b425-fd44-57b0-a26c-205a2db9f3f9","fields":{"slug":"/Typescript-시작하기/"},"frontmatter":{"title":"Typescript 시작하기"}}},{"node":{"id":"825a1946-8a6a-559a-9e11-93447cdedcdf","fields":{"slug":"/gitignore/"},"frontmatter":{"title":"gitignore"}}},{"node":{"id":"c65d18a5-967b-591b-a184-2f380d3f7847","fields":{"slug":"/Factory-Pattern/"},"frontmatter":{"title":"Factory Pattern"}}},{"node":{"id":"ee0abcf0-eb6f-569e-a2df-26ef807ffd53","fields":{"slug":"/네이밍-규칙naming-conventions/"},"frontmatter":{"title":"네이밍 규칙(naming conventions)"}}},{"node":{"id":"b3e00fd2-84a2-5bbc-8976-a76d7948ba15","fields":{"slug":"/AWS-API-Gateway/"},"frontmatter":{"title":"AWS API Gateway"}}},{"node":{"id":"c1d28daf-f0b4-521c-926c-88c14a61a609","fields":{"slug":"/ColdStart/"},"frontmatter":{"title":"ColdStart"}}},{"node":{"id":"45a48b17-f235-5fcf-90c4-f186e96b788e","fields":{"slug":"/Serverless/"},"frontmatter":{"title":"Serverless"}}},{"node":{"id":"59b56ebf-8c53-5362-82a7-3deb113c9308","fields":{"slug":"/Dynamo-DB/"},"frontmatter":{"title":"Dynamo DB"}}},{"node":{"id":"b1e5d38b-5dfb-5406-a693-d18281ac16f8","fields":{"slug":"/NoSQL/"},"frontmatter":{"title":"NoSQL"}}},{"node":{"id":"97236b20-03d7-59be-b021-0cf4f12ba08f","fields":{"slug":"/REST/"},"frontmatter":{"title":"REST"}}},{"node":{"id":"67555ff4-c43d-50d6-91fc-7db62ae5324a","fields":{"slug":"/TypeError-non-default-argument-content-follows-default-argument/"},"frontmatter":{"title":"TypeError: non-default argument 'content' follows default argument"}}},{"node":{"id":"247e0d6c-cb1f-523b-a365-12fbdf26de54","fields":{"slug":"/브랜치-관리-전략/"},"frontmatter":{"title":"브랜치 관리 전략"}}},{"node":{"id":"fd68eada-5e64-5d6e-ad3e-e7cccc28c242","fields":{"slug":"/Unit-Test단위-테스트/"},"frontmatter":{"title":"Unit Test(단위 테스트)"}}},{"node":{"id":"8fc059ee-a057-5299-9416-e5fe9a21f3b5","fields":{"slug":"/__post_init__/"},"frontmatter":{"title":"__post_init__"}}},{"node":{"id":"facbb85b-b3b0-54f1-b2ac-5593cedf9d02","fields":{"slug":"/dataclass/"},"frontmatter":{"title":"dataclass"}}},{"node":{"id":"f517cf21-d25d-5ad1-90b2-7cd04bdc1de5","fields":{"slug":"/FastAPI와-DDD/"},"frontmatter":{"title":"FastAPI와 DDD"}}},{"node":{"id":"c76d3263-2674-5711-9753-c7b1884886a2","fields":{"slug":"/vercel-배포-자동화/"},"frontmatter":{"title":"vercel 배포 자동화"}}},{"node":{"id":"643a5e74-e453-5eaf-be99-4fe90007fc0d","fields":{"slug":"/AWS-ECSElastic-Container-Service/"},"frontmatter":{"title":"AWS ECS(Elastic Container Service)"}}},{"node":{"id":"295a3a5e-5f68-53dd-a096-99c650a09f85","fields":{"slug":"/Blue-Green-Deploy-전략/"},"frontmatter":{"title":"Blue Green Deploy 전략"}}},{"node":{"id":"ef099c50-5b09-5374-b773-1646367f1a07","fields":{"slug":"/CloudFront/"},"frontmatter":{"title":"CloudFront"}}},{"node":{"id":"f2c13448-7669-5227-8e74-c0db79f8efa6","fields":{"slug":"/Poetry/"},"frontmatter":{"title":"Poetry"}}},{"node":{"id":"327528cd-aa5a-5ecb-9d02-1747c311b92a","fields":{"slug":"/DynamoDB의-동시성-제어Concurrency-Control/"},"frontmatter":{"title":"DynamoDB의 동시성 제어(Concurrency Control)"}}},{"node":{"id":"c61f89ee-7345-5822-a5bb-1ee417382592","fields":{"slug":"/FastAPI/"},"frontmatter":{"title":"FastAPI"}}},{"node":{"id":"6fde18dc-7c77-5d99-8142-13ade8537ae3","fields":{"slug":"/Pydantic-모델/"},"frontmatter":{"title":"Pydantic 모델"}}},{"node":{"id":"f97d2d57-9678-56e0-a700-2bd7ef00aca3","fields":{"slug":"/FastAPI의-데코레이터/"},"frontmatter":{"title":"FastAPI의 데코레이터"}}},{"node":{"id":"9b37002b-b912-5345-b81b-46951cc4a970","fields":{"slug":"/생성기generate-패턴/"},"frontmatter":{"title":"생성기(generate) 패턴"}}},{"node":{"id":"483a498b-b542-5587-989a-52dab4c1214c","fields":{"slug":"/FastAPI에서-데코레이터와-Dependency/"},"frontmatter":{"title":"FastAPI에서 데코레이터와 Dependency"}}},{"node":{"id":"80de20ad-d374-517c-ac92-d2877e4c06a8","fields":{"slug":"/FastAPI와-asyncio/"},"frontmatter":{"title":"FastAPI와 asyncio"}}},{"node":{"id":"87a218c9-82b0-5f05-90fa-a0d9da888853","fields":{"slug":"/aiohttp/"},"frontmatter":{"title":"aiohttp"}}},{"node":{"id":"222a8a91-8da9-500a-9074-4dd115cbe21f","fields":{"slug":"/단축어로-SLACK-프로필-변경하기/"},"frontmatter":{"title":"단축어로 SLACK 프로필 변경하기"}}},{"node":{"id":"75fcb75f-0a52-533f-a038-0a8460398f25","fields":{"slug":"/PynamoDB와-boto3-PynamoDB의-커넥션/"},"frontmatter":{"title":"PynamoDB와 boto3, PynamoDB의 커넥션"}}},{"node":{"id":"f15732ca-1b29-5230-aa8f-d32fd8ce5769","fields":{"slug":"/FastAPI에서-Postgresql의-커넥션-관리/"},"frontmatter":{"title":"FastAPI에서 Postgresql의 커넥션 관리"}}},{"node":{"id":"e0b43964-5998-5379-becc-614d8c62f076","fields":{"slug":"/Sqlalchemy-비동기-엔진에서의-Postgresql-Pooler/"},"frontmatter":{"title":"Sqlalchemy 비동기 엔진에서의 Postgresql Pooler"}}},{"node":{"id":"ef31575e-f174-58f7-84b7-832d38e952f9","fields":{"slug":"/FastAPI의-Pagenation/"},"frontmatter":{"title":"FastAPI의 Pagenation"}}},{"node":{"id":"c661de9c-fcb1-5bc6-b987-28d7cd303acb","fields":{"slug":"/SqlAlchemy의-QueuePool/"},"frontmatter":{"title":"SqlAlchemy의 QueuePool"}}},{"node":{"id":"7591133a-cdeb-5c9a-ab49-4ca7c8f3dea7","fields":{"slug":"/Pydantic-Model의-응용/"},"frontmatter":{"title":"Pydantic Model의 응용"}}},{"node":{"id":"cf792859-1afc-5118-bf50-0752527a6569","fields":{"slug":"/Union-Type/"},"frontmatter":{"title":"Union Type"}}},{"node":{"id":"c2c531ea-1018-5ad8-87b3-c1c027e8f2ee","fields":{"slug":"/우분투-용량-관리/"},"frontmatter":{"title":"우분투 용량 관리"}}},{"node":{"id":"ccff0278-8778-54c6-a28a-ffad6d97612d","fields":{"slug":"/Sqlalchemy에서의-트랜잭션-격리-수준-구현/"},"frontmatter":{"title":"Sqlalchemy에서의 트랜잭션 격리 수준 구현"}}},{"node":{"id":"ee1bfa9e-9eeb-52a2-a33a-88916dcc9119","fields":{"slug":"/트랜잭션-격리-수준Transaction-Isolation-Level/"},"frontmatter":{"title":"트랜잭션 격리 수준(Transaction Isolation Level)"}}},{"node":{"id":"a7292f80-7079-5082-9645-3def2d6750b8","fields":{"slug":"/PostgreSQL-Advisory-Locks-트랜잭션-레벨에서-구현/"},"frontmatter":{"title":"PostgreSQL Advisory Locks 트랜잭션 레벨에서 구현"}}},{"node":{"id":"acd438b5-e05c-5772-9da1-3ea3a67cefe0","fields":{"slug":"/Sqlalchemy의-func/"},"frontmatter":{"title":"Sqlalchemy의 func"}}},{"node":{"id":"8221080c-9128-57cc-b79e-c8a9e7959a90","fields":{"slug":"/동시성-제어문제-해결/"},"frontmatter":{"title":"동시성 제어문제 해결"}}},{"node":{"id":"4e23a734-8707-55b2-824e-d120641e8f1a","fields":{"slug":"/vscode-quick-Suggestions/"},"frontmatter":{"title":"vscode-quick Suggestions"}}},{"node":{"id":"1f589451-3bb6-501a-a892-6492654e760c","fields":{"slug":"/Typescript의-열거형/"},"frontmatter":{"title":"Typescript의 열거형"}}},{"node":{"id":"a5babc02-b843-5c39-85e7-1b34cce43cdd","fields":{"slug":"/Github-Action-Output/"},"frontmatter":{"title":"Github Action Output"}}},{"node":{"id":"8b1f5d89-c5ae-52b6-b3c7-19a8d6afda7a","fields":{"slug":"/Github-Actions/"},"frontmatter":{"title":"Github Actions"}}},{"node":{"id":"b81485d3-7cab-52c0-adf9-f489724dc88f","fields":{"slug":"/Github-Actions-Job---needs/"},"frontmatter":{"title":"Github Actions Job - needs"}}},{"node":{"id":"72e50b04-cb8a-55a6-b4ac-636d3dce4b78","fields":{"slug":"/Github-Actions-Workflow-수동으로-실행하기/"},"frontmatter":{"title":"Github Actions Workflow 수동으로 실행하기"}}},{"node":{"id":"2b53a4ed-50b1-5166-bde5-00f56edc9436","fields":{"slug":"/Typescript의-Testcode-맛보기/"},"frontmatter":{"title":"Typescript의 Testcode 맛보기"}}},{"node":{"id":"dbdceb4a-2ed6-5dbc-aa20-7dc961d63f54","fields":{"slug":"/시맨틱-버전-관리/"},"frontmatter":{"title":"시맨틱 버전 관리"}}},{"node":{"id":"6e6deb6d-e36d-5d2f-b11a-55fbc674c2ea","fields":{"slug":"/SQLAlchemy-create_all-메소드로-데이터베이스-테이블-자동-생성하기/"},"frontmatter":{"title":"SQLAlchemy create_all() 메소드로 데이터베이스 테이블 자동 생성하기"}}},{"node":{"id":"dd65c1da-59ff-5d58-a092-3ecc81bdb4fd","fields":{"slug":"/Sqlalchemy의-index/"},"frontmatter":{"title":"Sqlalchemy의 index"}}},{"node":{"id":"2de5adbd-b426-5f30-8811-ebd7fc04ff66","fields":{"slug":"/위치-기반-검색-기능의-구현/"},"frontmatter":{"title":"위치 기반 검색 기능의 구현"}}},{"node":{"id":"50b9db01-3888-5f30-80bc-b2d8ffd25486","fields":{"slug":"/인앱결제에서-백엔드는-무엇을-준비해야-할까/"},"frontmatter":{"title":"인앱결제에서 백엔드는 무엇을 준비해야 할까?"}}},{"node":{"id":"bb95007b-56db-5930-a9b8-4c09e2e118c4","fields":{"slug":"/식별-관계와-비식별-관계-그리고-CASCADE-옵션의-이해/"},"frontmatter":{"title":"식별 관계와 비식별 관계, 그리고 CASCADE 옵션의 이해"}}},{"node":{"id":"f76f95c7-1554-5431-a30b-7d03c93ac41c","fields":{"slug":"/arc-browser/"},"frontmatter":{"title":"arc browser"}}},{"node":{"id":"ae4611cf-ac19-58f9-be47-e8452f25a2df","fields":{"slug":"/Apple-Silicon과-pyenv/"},"frontmatter":{"title":"Apple Silicon과 pyenv"}}},{"node":{"id":"fe32f546-1476-5dc1-99f4-355cd81fba19","fields":{"slug":"/FastAPI-프로젝트의-시작/"},"frontmatter":{"title":"FastAPI 프로젝트의 시작"}}},{"node":{"id":"7edd7ada-7dda-553b-b007-2e7eacdc0c25","fields":{"slug":"/Geocoder와-Reverse-Geocoder/"},"frontmatter":{"title":"Geocoder와 Reverse Geocoder"}}},{"node":{"id":"ef7e194d-396d-5189-87b2-9905aa8edea4","fields":{"slug":"/Postgresql의-JSON과-JSONB/"},"frontmatter":{"title":"Postgresql의 JSON과 JSONB"}}},{"node":{"id":"ad9ce5f7-33b5-5f19-9087-52c928903f92","fields":{"slug":"/SQLModel에서-unique_constraints-설정하기/"},"frontmatter":{"title":"SQLModel에서 unique_constraints 설정하기"}}},{"node":{"id":"fbd5faae-ec78-5d51-ac80-d809dc5137d2","fields":{"slug":"/Supabase-Local-Dev-환경-꾸미기/"},"frontmatter":{"title":"Supabase Local Dev 환경 꾸미기"}}},{"node":{"id":"939d0130-e4ea-5ae4-a169-be69c0f404f9","fields":{"slug":"/Supabase와-Row-Level-Security-RLS/"},"frontmatter":{"title":"Supabase와 Row-Level Security (RLS) "}}},{"node":{"id":"6c085c2e-fa7b-5dcc-a26f-df91cf9354ea","fields":{"slug":"/Supabase-Local-개발-환경-꾸미기---DB-세팅/"},"frontmatter":{"title":"Supabase Local 개발 환경 꾸미기 - DB 세팅"}}},{"node":{"id":"2a0b1ae0-7af6-5ce1-90ad-57af39dc2085","fields":{"slug":"/Supabase-EdgeFunction---Deno-개발환경-꾸미기/"},"frontmatter":{"title":"Supabase EdgeFunction  - Deno 개발환경 꾸미기"}}}]},"previous":{"fields":{"slug":"/Sqlalchemy-비동기-엔진에서의-Postgresql-Pooler/"},"frontmatter":{"title":"Sqlalchemy 비동기 엔진에서의 Postgresql Pooler"}},"next":{"fields":{"slug":"/SqlAlchemy의-QueuePool/"},"frontmatter":{"title":"SqlAlchemy의 QueuePool"}}},"pageContext":{"id":"ef31575e-f174-58f7-84b7-832d38e952f9","series":null,"previousPostId":"e0b43964-5998-5379-becc-614d8c62f076","nextPostId":"c661de9c-fcb1-5bc6-b987-28d7cd303acb"}},"staticQueryHashes":[],"slicesMap":{}}