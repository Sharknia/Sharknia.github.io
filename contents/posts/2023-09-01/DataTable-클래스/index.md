---
tags:
  - ASP.Net
update: "2024-01-31"
date: "2023-09-01"
상태: "Ready"
title: "DataTable 클래스"
---
### DataTable 개요

DataTable은 .Net 프레임워크와 .Net Core, 그리고 .Net 5 이후 버전에서 제공하는 ADO.Net의 일부이다. 메모리 상에서 데이터의 테이블 형태를 관리하기 위한 .Net의 클래스이다. 

1. DataTable은 클래스이다. 객체를 인스턴스화하고 메서드와 속성에 액세스 할 수 있다. 

1. 메모리상에서 데이터의 테이블 형태를 표현한다. 열(DataColumn)과 행(DataRow)로 이루어진다. 

1. 데이터베이스 쿼리 결과 저장, 사용자 인터페이스에 데이터 표시, 데이터 처리 및 변환, XML과 같은 다른 형식으로 데이터 직렬화 등 다양한 곳에 사용될 수 있다. 

1. DataTable은 DataSet 내에 존재할 수 있다. DataSet은 여러 DataTable 객체를 포함할 수 있으며, 이러한 테이블간에 관계(DataRelation)를 정의할 수 있다. 

### 장점과 단점

#### 장점

1. 자유로운 데이터 접근 : 행과 열을 사용하여 데이터에 액세스 할 수 있으므로 데이터를 쉽게 탐색/수정 할 수 있다. 

1. 자체적인 변경 추적 : 데이터 변경 내역을 추적할 수 있다. 

1. 연결 독립성 : 메모리 상의 데이터 구조이므로 데이터베이스 연결이 필요 없다. 

1. 스키마 정보 포함 : 스키마 정보를 포함하므로 데이터의 형식 및 관계를 정의하고 이해하기 쉽다. 

1. 필터 및 계산 기능 : 데이터를 필터링 하거나 계산 할 수 있다. 

#### 단점

1. 메모리 사용량 : 메모리 기반의 구조이므로 큰 데이터 세트를 로딩할 경우 상당한 양의 메모리를 사용할 수 있다. 

1. 성능 : 엔터티나 객체와 같은 스트림라인된 모델에 비해 처리 및 직렬화에 상대적으로 더 많은 리소스를 요구한다. 

1. 타이핑 : 데이터를 액세스 할 때 타입 캐스팅이 필요할 수 있다. 

1. 학습 곡선 : ORM이나 LINQ 같은 현대적인 접근법에 익숙한 개발자에게는 학습곡선이 필요하다. 

1. 모듈성과 확장성 : 객체지향적인 접근법이나 도메인 주도 설계와 같은 설계 패턴에 직접 통합하기 어려울 수 있다. 

### DataTable.Compute의 사용 가능한 주요 표현식

#### 집계함수

| Sum | 합계 |
| --- | --- |
| Avg | 평균 |
| Min | 최소값 |
| Max | 최대값 |
| Count | 항목의 수 |
| StDev | 표준 편차 |
| Var | 분산 |

#### 산술 연산자

`+`, `-`, `*`, `/`, `%`

#### 비교 연산자

`=`, `<>`, `>`, `<`, `>=`, `<=`

#### 논리 연산자

`AND`, `OR`, `NOT`

#### 문자열 함수

| LEN | 문자열의 길이 |
| --- | --- |
| SUBSTRING | 부분 문자열 |
| TRIM | 앞 뒤 공백 제거 |
| UPPER | 대문자로 변환 |
| LOWER | 소문자로 변환 |

#### 기타 함수

| ISNULL | NULL일 경우 대체할 값 반환 |
| --- | --- |
| CONVERT | 데이터 타입 변환 |

### 기타 다른 주요 메소드

| Select | 특정 조건을 만족하는 행을 DataRow 배열로 반환 |
| --- | --- |
| NewRow | 새 DataRow를 생성 |
| Rows.Add | 행을 추가 |
| Rows.Remove | 행을 삭제 |
| Rows.RemoveAt | 지정한 위치의 행을 삭제 |
| Clear | 모든 행을 삭제 |
| Copy | DataTable의 사본을 생성 |
| Clone | 구조만 복사한 새 DataTable을 반환 |
| GetChanges | 변경된 행들만을 포함하는 새 DataTable을 반환 |
| AcceptChanges | 변경 내용을 확정 |
| RejectChanges | 변경 내용을 취소 |

