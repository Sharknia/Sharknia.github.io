---
IDX: "NUM-17"
tags:
  - DataBase
  - Postgresql
update: "2024-02-02T16:32:00.000Z"
date: "2024-01-29"
상태: "Ready"
title: "트랜잭션 격리 수준(Transaction Isolation Level)"
---
## 트랜잭션 격리 수준(Transaction Isolation Level)이란?

트랜잭션 격리 수준은 데이터베이스 시스템에서 동시에 여러 트랜잭션이 실행될 때, 트랜잭션 간에 데이터를 어떻게 고립시킬지를 결정하는 설정이다. 이 설정은 트랜잭션이 다른 트랜잭션의 작업에 영향을 받지 않도록 보장하는 동시에 여러 트랜잭션이 데이터베이스의 동일한 데이터에 접근할 때 발생하는 문제들을 관리하는데 중요한 역할을 한다. 

격리 수준이 높을 수록 트랜잭션 간의 고립 정도가 증가하지만, 그만큼 데이터베이스의 처리량(throughput)과 동시성(concurrency)이 감소할 수 있다. 반대로 격리 수준이 낮으면 처리량과 동시성은 증가하지만 데이터 무결성 문제가 발생할 위험이 높아진다. 따라서 적절한 격리 수준을 선택해야 한다. 

데이터베이스의 동일한 데이터에 접근할 때 발생할 수 있는 문제들은 다음과 같다. 

### Dirty Read

한 트랜잭션이 아직 커밋되지 않은 데이터를 읽는 경우

### Non-repeatable Read

한 트랜잭션이 동일한 쿼리를 여러 번 실행할 떄마다 다른 결과를 얻는 경우. 이는 다른 트랜잭션이 데이터를 변경하거나 삭제했기 때문이다. 

### Phantom Read

한 트랜잭션이 동일한 쿼리를 여러 번 실행할 때, 새로 삽입된 행이 결과에 나타나는 현상이다. 

### Serialization Anomaly

트랜잭션들이 서로 다른 순서로 실행될 때 발생할 수 있는 일관성 없는 결과를 말한다. 

## 격리 수준의 종류

각 데이터베이스 시스템은 아래의 격리 수준을 제공하며, 이는 ANSI SQL 표준에 의해 정의된다. 

### Read Uncommitted

- 가장 낮은 격리 수준이다. 

- 다른 트랜잭션에서 아직 커밋되지 않은 변경 사항을 조회할 수 있다. (Dirty Read)

- Postgreql에서는 구현되지 있지 않아 Read Committed로 자동 처리된다. 

#### 장점

높은 동시성과 성능을 보여준다. 

#### 단점

데이터 무결성 문제가 발생할 수 있다. 

#### 고려사항

- 데이터의 정확성보다 동시성이 중요한 경우에 고려될 수 있으나, 일반적으로 권장되지 않는다. 

### Read Committed

- 각 쿼리가 실행될 때 커밋된 데이터만 읽는다. 

- 다른 트랜잭션에서 커밋된 변경 사항을 쿼리 시점에 볼 수 있다. (Non-repeatable Read이 발생할 수 있다. )

#### 장점

적당한 수준의 동시성과 성능을 보여준다. 

#### 단점

같은 트랜잭션 내에서 같은 데이터를 두 번 읽을 때 다른 결과가 나올 수 있다. 

#### 고려사항

- 일반적인 응용 프로그램에서 광범위하게 사용된다. 

- 대부분의 경우에 적합한 격리 수준이다. 

### Repeatable Read

- 트랜잭션이 시작될 때의 데이터 상태를 유지한다. 

- 트랜잭션 중에 다른 트랜잭션이 커밋한 변경 사항이 보이지 않음(Phantom Read이 발생할 수 있다.)

#### 장점

하나의 트랜잭션 내에서 일관된 조회 결과를 보장한다. 

#### 단점

트랜잭션이 길어질수록 다른 트랜잭션과의 충돌 가능성이 증가한다. 

#### 고려사항

- 일관된 데이터 읽기가 필요할 때 사용한다. 

- 데이터 무결정이 중요한 경우 적합하지만, 긴 트랜잭션은 피해야 한다. 

### Serializable

- 데이터베이스 트랜잭션에서 가장 높은 격리 수준이다. 

- 트랜잭션이 서로 독립적으로 작동하며, 동시에 여러 트랜잭션이 수행되는 경우에도 하나의 트랜잭션이 완료된 것 처럼 작동한다. 

- 다른 트랜잭션이 동시에 같은 데이터를 수정하지 못하도록 하여 데이터의 일관성을 보장한다. 

- 하나의 트랜잭션 동안 새로 삽입되거나 삭제된 행이 다른 트랜잭션에 의해 보이지 않도록 해서 Phantom Read를 방지한다. 

- 각 트랜잭션이 독립적인 환경에서 실행되며 다른 트랜잭션의 중간 결과를 볼 수 없다. 

#### 장점

높은 수준의 데이터 무결성을 제공한다. 데이터베이스 내의 데이터는 모든 트랜잭션에 대해 완전히 일관된 상태를 유지한다. 

따라서 동시성 문제도 최소화된다. 동시에 여러 트랜잭션이 실행되는 환경에서 발생할 수 있는 대부분의 동시성 문제를 예방한다. 

#### 단점

트랜잭션의 격리 수준이 높을 수록 데이터베이스의 처리량이 감소할 수 있다. 락 경합(lock contention)이 증가하고, 이는 성능저하로 이어질 가능성이 높다. 

서로 다른 트랜잭션이 같은 자원을 기다리는 상황이 발생할 수 있으며, 이는 데드락으로 이어질 수 있다. 

#### 고려사항

- 데이터 무결성이 중요한 경우에 적합하지만 성능상의 영향을 고려해야 한다. 

- 데드락을 방지하기 위해 트랜잭션 설계 시 주의가 필요하다. 

- 읽기만 수행하는 트랜잭션의 경우 더 낮은 격리 수준을 고려하는 것이 성능상 이점이 있을 수 있다. 



